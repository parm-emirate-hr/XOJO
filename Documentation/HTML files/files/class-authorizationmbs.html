<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - AuthorizationMBS class</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="AuthorizationMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">AuthorizationMBS class</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<H3>AuthorizationMBS class</H3>
<div class="M">

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>class</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion28.shtml" class=version>2.8</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
A class to run a root shell on Mac OS X.<BR>
<B>Notes:</B> 
<BR>
Some notes from Ilija Injac on this usage of this class:<BR>
<BR>
The main problem for the execution of the perl script was, that perl is not able to find the required perl-modules at execution with the option &quot;-U&quot; (this switch is set for security reasons). <BR>
It was also neccessary to include the perl-modules from inside the perl script wich has to be executed.<BR>
Inside the Xojo code i created a <A href="class-authorizationitemmbs.html">AuthorizationItemMBS</A> with the value &quot;/usr/bin/perl&quot;:<BR>
...<BR>
i = new <A href="class-authorizationitemmbs.html">AuthorizationItemMBS</A><BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">i.name </TD><TD valign="top">= a.kAuthorizationItemRightExecute</TD></TR>
<TR><TD valign="top">i.value </TD><TD valign="top">= &quot;/usr/bin/perl&quot;</TD></TR>
</TABLE>
...<BR>
Actually it is the same source as in Christians &quot;Authorization 1&quot; example  within the &quot;test1&quot; function. And it works !<BR>
</div>
<ul>
<LI>5 properties<UL>
<li class="M">property <A href="authorization-authorizationmbs-property.html">Authorized</A> as Boolean</li>
<li class="M">property <A href="authorization-authorizationmbs-property.html#2">Handle</A> as Integer</li>
<li class="M">property <A href="authorization-authorizationmbs-property.html#3">KeepRights</A> as Boolean</li>
<li class="M">property <A href="authorization-authorizationmbs-property.html#4">LastError</A> as Integer</li>
<li class="M">property <A href="authorization-authorizationmbs-property.html#5">StreamHandle</A> as Integer</li>
</UL></LI>
<LI>19 methods<UL>
<li class="M">method <A href="authorization-authorizationmbs-method.html">Authorize</A>(rights as <A href="class-authorizationitemsetmbs.html">AuthorizationItemSetMBS</A>, flags as Integer)</li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#2">Authorize</A>(rights as <A href="class-authorizationitemsetmbs.html">AuthorizationItemSetMBS</A>, flags as Integer, byref outrights as <A href="class-authorizationitemsetmbs.html">AuthorizationItemSetMBS</A>)</li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#3">Available</A> as boolean</li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#4">close</A></li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#5">closeStream</A></li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#6">EOFStream</A> as boolean</li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#7">Execute</A>(toolpath as string, parameters() as string)</li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#8">Execute</A>(toolpath as string, parameters() as string, openstream as boolean)</li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#9">ExternalForm</A> as string</li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#10">FlushStream</A></li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#11">Info</A> as <A href="class-authorizationitemsetmbs.html">AuthorizationItemSetMBS</A></li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#12">MakeStreamAsyncron</A></li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#13">NewAuthorization</A>(rights as <A href="class-authorizationitemsetmbs.html">AuthorizationItemSetMBS</A>, flags as Integer) as Boolean</li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#14">NewAuthorizationFromExternalForm</A>(s as string) as Boolean</li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#15">ReadStream</A>(count as Integer) as string</li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#16">SimpleAuthorize</A></li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#17">SimpleNewAuthorization</A> as Boolean</li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#18">Wait</A> as Integer</li>
<li class="M">method <A href="authorization-authorizationmbs-method.html#19">WriteStream</A>(s as string) as Integer</li>
</UL></LI>
<LI>23 constants<UL>
<li class="M">const <A href="authorization-authorizationmbs-const.html#15">kAuthorizationEmptyEnvironment</A> = nil</li>
<li class="M">const <A href="authorization-authorizationmbs-const.html#16">kAuthorizationExternalFormLength</A> = 32</li>
</UL></LI>
</ul>
<h3 lang="en">Error Codes</h3>
<table cellpadding=2 cellspacing=2>
<tr>
<th bgcolor="#DDDDDD">Constant</th>
<th bgcolor="#DDDDDD">Value</th>
<th bgcolor="#DDDDDD">Description</th>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html">errAuthorizationCanceled </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -60006</td>
<td bgcolor="#DDDDDD" valign=top>
The authorization was cancelled by the user.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#2">errAuthorizationDenied </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -60005</td>
<td bgcolor="#DDDDDD" valign=top>
The authorization was denied.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#3">errAuthorizationExternalizeNotAllowed </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -60009</td>
<td bgcolor="#DDDDDD" valign=top>
The authorization is not allowed to be converted to an external format.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#4">errAuthorizationInteractionNotAllowed </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -60007</td>
<td bgcolor="#DDDDDD" valign=top>
The authorization was denied since no user interaction was possible.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#5">errAuthorizationInternal </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -60008</td>
<td bgcolor="#DDDDDD" valign=top>
Unable to obtain authorization for this operation.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#6">errAuthorizationInternalizeNotAllowed </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -60010</td>
<td bgcolor="#DDDDDD" valign=top>
The authorization is not allowed to be created from an external format.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#7">errAuthorizationInvalidFlags </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -60011</td>
<td bgcolor="#DDDDDD" valign=top>
The provided option flag(s) are invalid for this authorization operation.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#8">errAuthorizationInvalidPointer </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -60004</td>
<td bgcolor="#DDDDDD" valign=top>
The returned authorization is invalid. <BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#9">errAuthorizationInvalidRef </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -60002</td>
<td bgcolor="#DDDDDD" valign=top>
The authorization reference is invalid.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#10">errAuthorizationInvalidSet </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -60001</td>
<td bgcolor="#DDDDDD" valign=top>
The authorization rights are invalid.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#11">errAuthorizationInvalidTag </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -60003</td>
<td bgcolor="#DDDDDD" valign=top>
The authorization tag is invalid.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#12">errAuthorizationSuccess </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 0</td>
<td bgcolor="#DDDDDD" valign=top>
No error.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#13">errAuthorizationToolEnvironmentError </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -60032</td>
<td bgcolor="#DDDDDD" valign=top>
An invalid status was returned during execution of a privileged tool.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#14">errAuthorizationToolExecuteFailure </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -60031</td>
<td bgcolor="#DDDDDD" valign=top>
The specified program could not be executed. <BR>
</td>
</tr>
</table>
<h3 lang="en">Flag values</h3>
<table cellpadding=2 cellspacing=2>
<tr>
<th bgcolor="#DDDDDD">Constant</th>
<th bgcolor="#DDDDDD">Value</th>
<th bgcolor="#DDDDDD">Description</th>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#17">kAuthorizationFlagCanNotPreAuthorize </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 1</td>
<td bgcolor="#DDDDDD" valign=top>
Indicates the Security Server could not preauthorize the right.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#18">kAuthorizationFlagDefaults </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 0</td>
<td bgcolor="#DDDDDD" valign=top>
If no bits are set, none of the following features are available.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#19">kAuthorizationFlagDestroyRights </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 8</td>
<td bgcolor="#DDDDDD" valign=top>
If the bit specified by this mask is set, the Security Server revokes authorization from the process as well as from any other process that is sharing the authorization. If the bit specified by this mask is not set, the Security Server revokes authorization from the process but not from other processes that share the authorization.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#20">kAuthorizationFlagExtendRights </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 2</td>
<td bgcolor="#DDDDDD" valign=top>
If the bit specified by this mask is set, the Security Server attempts to grant the rights requested. Once the Security Server denies one right, it ignores the remaining requested rights.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#21">kAuthorizationFlagInteractionAllowed </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 1</td>
<td bgcolor="#DDDDDD" valign=top>
If the bit specified by this mask is set, you permit the Security Server to interact with the user when necessary.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#22">kAuthorizationFlagPartialRights </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 4</td>
<td bgcolor="#DDDDDD" valign=top>
If the bit specified by this mask and the kAuthorizationFlagExtendRights mask are set, the Security Server grants or denies rights on an individual basis and all rights are checked.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="authorization-authorizationmbs-const.html#23">kAuthorizationFlagPreAuthorize </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 16</td>
<td bgcolor="#DDDDDD" valign=top>
If the bit specified by this mask is set, the Security Server preauthorizes the rights requested.<BR>
</td>
</tr>
</table>
<p>This class has no sub classes.</p>
<h4>Some methods using this class:</h4><ul>
<li class="M"><A href="loginitems-servicemanagementmodulembs-method.html#2" translate="no">ServiceManagementModuleMBS.CreateAuthorization</A> as AuthorizationMBS</li>
<li class="M"><A href="loginitems-servicemanagementmodulembs-method.html#3" translate="no">ServiceManagementModuleMBS.JobBless</A>(domain as string, executableLabel as string, auth as AuthorizationMBS, byref error as Variant) as boolean</li>
<li class="M"><A href="loginitems-servicemanagementmodulembs-method.html#5" translate="no">ServiceManagementModuleMBS.JobRemove</A>(domain as string, jobLabel as string, auth as AuthorizationMBS, wait as boolean, byref error as <A href="class-cferrormbs.html">CFErrorMBS</A>) as boolean</li>
<li class="M"><A href="loginitems-servicemanagementmodulembs-method.html#6" translate="no">ServiceManagementModuleMBS.JobSubmit</A>(domain as string, job as Dictionary, auth as AuthorizationMBS, byref error as <A href="class-cferrormbs.html">CFErrorMBS</A>) as boolean</li>
</ul>
<h4>Some examples using this class:</h4>
<ul translate="no">
<li class=""><A href="example-maccf-authorization-authorizationwithstream.html">/MacCF/Authorization/Authorization with Stream</A></li>
<li class=""><A href="example-maccf-authorization-authorizationwithstreamasync.html">/MacCF/Authorization/Authorization with Stream Async</A></li>
<li class=""><A href="example-maccf-smjobblessinxojo-mainapp.html">/MacCF/SMJobBless in Xojo/MainApp</A></li>
</ul>
<h4>Blog Entries</h4>
<ul>
<li><a href="https://www.mbsplugins.de/archive/2020-11-09/MBS_Xojo_Plugins_version_205pr/monkeybreadsoftware_blog_xojo">MBS Xojo Plugins, version 20.5pr8</a></li>
<li><a href="https://www.mbsplugins.de/archive/2017-07-10/MBS_Xojo_Plugins_version_173pr/monkeybreadsoftware_blog_xojo">MBS Xojo Plugins, version 17.3pr5</a></li>
<li><a href="https://www.mbsplugins.de/archive/2017-06-29/MBS_Xojo_Plugins_version_173pr/monkeybreadsoftware_blog_xojo">MBS Xojo Plugins, version 17.3pr4</a></li>
<li><a href="https://www.mbsplugins.de/archive/2014-05-10/MBS_Xojo__Real_Studio_Plugins_/monkeybreadsoftware_blog_xojo">MBS Xojo / Real Studio Plugins, version 14.2pr5</a></li>
</ul>
<BR>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a>.</p>
<br clear=all><p>
<a href="class-authorizationitemsetmbs.html">AuthorizationItemSetMBS</a>
 &nbsp; - &nbsp; 
<a href="class-avahibrowsermbs.html">AvahiBrowserMBS</a>
</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=class-authorizationmbs">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

