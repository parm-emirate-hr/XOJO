<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - WindowsICMProfileMBS shared methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="WindowsICMProfileMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">WindowsICMProfileMBS shared methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-windowsicmprofilembs.html">WindowsICMProfileMBS</a> class.  </p>
<div class="W">
<b><a href="class-windowsicmprofilembs.html">WindowsICMProfileMBS</a>.<A name="1">OpenProfileData(data as string, DesiredAccess as Integer) as <A href="class-windowsicmprofilembs.html">WindowsICMProfileMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-windowsicm.html" translate="no">Windows ICM</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion111.shtml" class=version>11.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
The OpenColorProfile function opens or create a color profile.<BR>
<B>Notes:</B> 
<BR>
file: The file where to load profile from.<BR>
DesiredAccess: Specifies how to access the given profile. This parameter must take one the following constant values.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Value</TD><TD valign="top">Meaning</TD></TR>
<TR><TD valign="top">PROFILE_READ</TD><TD valign="top">Opens the profile for read access.</TD></TR>
<TR><TD valign="top">PROFILE_READWRITE</TD><TD valign="top">Opens the profile for both read and write access. Has no effect for WCS XML profiles.</TD></TR>
</TABLE>
<BR>
Returns the profile on success and nil on error.<BR>
<BR>
For ICC and WCS profiles, a CAMP and GMMP are provided by the function based on the current default CAMP and GMMP in the registry.<BR>
<BR>
When OpenColorProfile encounters an ICC profile with an embedded WCS profile, and if the dwType member within the Profile structure does not take the value DONT_USE_EMBEDDED_WCS_PROFILES, it should extract and use the WCS profile(s) contained in this WcsProfilesTag. The HPROFILE returned would be a WCS HPROFILE.<BR>
<BR>
When the function opens the ICC profile, it will look for a WcsProfilesTag and, if there is one, it will extract and use the original WCS profiles contained therein. (See WcsCreateIccProfile.)<BR>
<BR>
An profile with WCS profile information is derived from a DMP by acquiring the default CAMP and default GMMP from the registry. An HPROFILE is a composition of a DMP, CAMP and GMMP.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-icm-windowsicmconvertcolors.html">/Win/ICM/Windows ICM Convert Colors</A></li>
<li><A href="example-win-icm-windowsicmconvertpicture.html">/Win/ICM/Windows ICM Convert Picture</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-windowsicmprofilembs.html">WindowsICMProfileMBS</a>.<A name="2">OpenProfileFile(file as folderitem, DesiredAccess as Integer, ShareMode as Integer, CreationMode as Integer) as <A href="class-windowsicmprofilembs.html">WindowsICMProfileMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-windowsicm.html" translate="no">Windows ICM</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion111.shtml" class=version>11.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
The OpenColorProfile function opens or create a color profile.<BR>
<B>Notes:</B> 
<BR>
file: The file where to load profile from.<BR>
DesiredAccess: Specifies how to access the given profile. This parameter must take one the following constant values.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Value</TD><TD valign="top">Meaning</TD></TR>
<TR><TD valign="top">PROFILE_READ</TD><TD valign="top">Opens the profile for read access.</TD></TR>
<TR><TD valign="top">PROFILE_READWRITE</TD><TD valign="top">Opens the profile for both read and write access. Has no effect for WCS XML profiles.</TD></TR>
</TABLE>
<BR>
ShareMode: Specifies how the profile should be shared, if the profile is contained in a file. A value of zero prevents the profile from being shared at all. The parameter can contain one or both of the following constants (combined by addition or logical OR).<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Value</TD><TD valign="top">Meaning</TD></TR>
<TR><TD valign="top">FILE_SHARE_READ</TD><TD valign="top">Other open operations can be performed on the profile for read access.</TD></TR>
<TR><TD valign="top">FILE_SHARE_WRITE</TD><TD valign="top">Other open operations can be performed on the profile for write access. Has no effect for WCS XML profiles.</TD></TR>
</TABLE>
<BR>
CreationMode: Specifies which actions to take on the profile while opening it, if it is contained in a file. This parameter must take one of the following constant values.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Value</TD><TD valign="top">Meaning</TD></TR>
<TR><TD valign="top">CREATE_NEW</TD><TD valign="top">Creates a new profile. Fails if the profile already exists.</TD></TR>
<TR><TD valign="top">CREATE_ALWAYS</TD><TD valign="top">Creates a new profile. Overwrites the profile if it exists.</TD></TR>
<TR><TD valign="top">OPEN_EXISTING</TD><TD valign="top">Opens the profile. Fails if it does not exist</TD></TR>
<TR><TD valign="top">OPEN_ALWAYS</TD><TD valign="top">Opens the profile if it exists. For ICC profiles, if the profile does not exist, creates the profile. For WCS XML profiles, if the profile does not exist, returns an error.</TD></TR>
<TR><TD valign="top">TRUNCATE_EXISTING</TD><TD valign="top">Opens the profile, and truncates it to zero bytes, returning a blank ICC profile. Fails if the profile doesn&#39;t exist.</TD></TR>
</TABLE>
<BR>
Returns the profile on success and nil on error.<BR>
<BR>
For ICC and WCS profiles, a CAMP and GMMP are provided by the function based on the current default CAMP and GMMP in the registry.<BR>
<BR>
When OpenColorProfile encounters an ICC profile with an embedded WCS profile, and if the dwType member within the Profile structure does not take the value DONT_USE_EMBEDDED_WCS_PROFILES, it should extract and use the WCS profile(s) contained in this WcsProfilesTag. The HPROFILE returned would be a WCS HPROFILE.<BR>
<BR>
CreationMode flags CREATE_NEW, CREATE_ALWAYS, and TRUNCATE_EXISTING, will always return blank ICC HPROFILEs. If other CreationMode flags are present, InternalOpenColorProfile is called (using the flags as provided by the API) to determine whether the profile is ICC or WCS XML.<BR>
<BR>
Within the ICC code path, an ICC Profile is returned using the requested sharing, access and creation flags as specified in the tables above.<BR>
<BR>
Within the WCS path, the CreationMode flag OPEN_ALWAYS will fail if the profile doesn&#39;t exist, since WCS profiles cannot be created or edited within the WCS architecture (they must be edited outside of it, using MSXML6). For the same reason, dwShareMode flag FILE_SHARE_WRITE, and dwDesiredAccess flag PROFILE_READWRITE are ignored within the WCS path.<BR>
<BR>
When the function opens the ICC profile, it will look for a WcsProfilesTag and, if there is one, it will extract and use the original WCS profiles contained therein. (See WcsCreateIccProfile.)<BR>
<BR>
An profile with WCS profile information is derived from a DMP by acquiring the default CAMP and default GMMP from the registry. An HPROFILE is a composition of a DMP, CAMP and GMMP.<BR>
</div>
<div class="W">
<b><a href="class-windowsicmprofilembs.html">WindowsICMProfileMBS</a>.<A name="3">OpenProfilePath(path as string, DesiredAccess as Integer, ShareMode as Integer, CreationMode as Integer) as <A href="class-windowsicmprofilembs.html">WindowsICMProfileMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-windowsicm.html" translate="no">Windows ICM</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion111.shtml" class=version>11.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
The OpenColorProfile function opens or create a color profile.<BR>
<B>Notes:</B> 
<BR>
file: The file where to load profile from.<BR>
DesiredAccess: Specifies how to access the given profile. This parameter must take one the following constant values.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Value</TD><TD valign="top">Meaning</TD></TR>
<TR><TD valign="top">PROFILE_READ</TD><TD valign="top">Opens the profile for read access.</TD></TR>
<TR><TD valign="top">PROFILE_READWRITE</TD><TD valign="top">Opens the profile for both read and write access. Has no effect for WCS XML profiles.</TD></TR>
</TABLE>
<BR>
ShareMode: Specifies how the profile should be shared, if the profile is contained in a file. A value of zero prevents the profile from being shared at all. The parameter can contain one or both of the following constants (combined by addition or logical OR).<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Value</TD><TD valign="top">Meaning</TD></TR>
<TR><TD valign="top">FILE_SHARE_READ</TD><TD valign="top">Other open operations can be performed on the profile for read access.</TD></TR>
<TR><TD valign="top">FILE_SHARE_WRITE</TD><TD valign="top">Other open operations can be performed on the profile for write access. Has no effect for WCS XML profiles.</TD></TR>
</TABLE>
<BR>
CreationMode: Specifies which actions to take on the profile while opening it, if it is contained in a file. This parameter must take one of the following constant values.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Value</TD><TD valign="top">Meaning</TD></TR>
<TR><TD valign="top">CREATE_NEW</TD><TD valign="top">Creates a new profile. Fails if the profile already exists.</TD></TR>
<TR><TD valign="top">CREATE_ALWAYS</TD><TD valign="top">Creates a new profile. Overwrites the profile if it exists.</TD></TR>
<TR><TD valign="top">OPEN_EXISTING</TD><TD valign="top">Opens the profile. Fails if it does not exist</TD></TR>
<TR><TD valign="top">OPEN_ALWAYS</TD><TD valign="top">Opens the profile if it exists. For ICC profiles, if the profile does not exist, creates the profile. For WCS XML profiles, if the profile does not exist, returns an error.</TD></TR>
<TR><TD valign="top">TRUNCATE_EXISTING</TD><TD valign="top">Opens the profile, and truncates it to zero bytes, returning a blank ICC profile. Fails if the profile doesn&#39;t exist.</TD></TR>
</TABLE>
<BR>
Returns the profile on success and nil on error.<BR>
<BR>
For ICC and WCS profiles, a CAMP and GMMP are provided by the function based on the current default CAMP and GMMP in the registry.<BR>
<BR>
When OpenColorProfile encounters an ICC profile with an embedded WCS profile, and if the dwType member within the Profile structure does not take the value DONT_USE_EMBEDDED_WCS_PROFILES, it should extract and use the WCS profile(s) contained in this WcsProfilesTag. The HPROFILE returned would be a WCS HPROFILE.<BR>
<BR>
CreationMode flags CREATE_NEW, CREATE_ALWAYS, and TRUNCATE_EXISTING, will always return blank ICC HPROFILEs. If other CreationMode flags are present, InternalOpenColorProfile is called (using the flags as provided by the API) to determine whether the profile is ICC or WCS XML.<BR>
<BR>
Within the ICC code path, an ICC Profile is returned using the requested sharing, access and creation flags as specified in the tables above.<BR>
<BR>
Within the WCS path, the CreationMode flag OPEN_ALWAYS will fail if the profile doesn&#39;t exist, since WCS profiles cannot be created or edited within the WCS architecture (they must be edited outside of it, using MSXML6). For the same reason, dwShareMode flag FILE_SHARE_WRITE, and dwDesiredAccess flag PROFILE_READWRITE are ignored within the WCS path.<BR>
<BR>
When the function opens the ICC profile, it will look for a WcsProfilesTag and, if there is one, it will extract and use the original WCS profiles contained therein. (See WcsCreateIccProfile.)<BR>
<BR>
An profile with WCS profile information is derived from a DMP by acquiring the default CAMP and default GMMP from the registry. An HPROFILE is a composition of a DMP, CAMP and GMMP.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-icm-windowsicm.html">/Win/ICM/Windows ICM</A></li>
</ul>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbswinplugin.html">MBS Win Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=windowsicm-windowsicmprofilembs-shared-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

