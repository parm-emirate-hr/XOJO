<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /MacFrameworks/FSEvents/FSEventsMBS Demo</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /MacFrameworks/FSEvents/FSEventsMBS Demo</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/MacFrameworks/FSEvents/<A href="class-fseventsmbs.html">FSEventsMBS</A> Demo</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS MacOSX Plugin, MBS MacFrameworks Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /MacFrameworks/FSEvents/<A href="class-fseventsmbs.html">FSEventsMBS</A> Demo<BR>
This example is the version from Thu, 8th Mar 2017.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;FSEventsMBS</span> <span style="color:#6500FE">Demo.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kEditClear = <span style="color:#6500FE">&quot;&amp;Delete&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuit = <span style="color:#6500FE">&quot;&amp;Quit&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuitShortcut = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> FolderMonitor</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Delegate</span> <span style="color:#0000FF;font-weight: bold">Sub</span> FolderChangedProc(path <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>)</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(path <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>, callee <span style="color:#0000FF;font-weight: bold">as</span> FolderChangedProc)
			<span style="color:#0000FF;font-weight: bold">if</span> path.Left(<span style="color:#326598">1</span>) &lt;&gt; <span style="color:#6500FE">&quot;/&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">raise</span> <span style="color:#0000FF;font-weight: bold">new</span> InvalidParentException <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">Paths</span> <span style="color:#7F0000;text-style:italic">may</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">relative</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> path.Right(<span style="color:#326598">1</span>) &lt;&gt; <span style="color:#6500FE">&quot;/&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Paths</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">end</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">&quot;/&quot;</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">matching</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">handleFSEvent()</span>
				path = path + <span style="color:#6500FE">&quot;/&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Determine</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">path</span> <span style="color:#7F0000;text-style:italic">requires</span> <span style="color:#7F0000;text-style:italic">us</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">watch</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">FSEvents</span> <span style="color:#7F0000;text-style:italic">root</span> <span style="color:#7F0000;text-style:italic">path</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> needsNewRoot <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>, commonPath <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">if</span> gWatcher = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">or</span> gCurrentFSEventsPath = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				needsNewRoot = <span style="color:#0000FF;font-weight: bold">true</span>
				commonPath = path
				<span style="color:#0000FF;font-weight: bold">if</span> DefaultLatencyInSeconds &lt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> DefaultLatencyInSeconds = <span style="color:#326598">1</span> <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">default:</span> <span style="color:#7F0000;text-style:italic">1</span> <span style="color:#7F0000;text-style:italic">second</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				commonPath = determineCommonPath (path, gCurrentFSEventsPath)
				<span style="color:#0000FF;font-weight: bold">if</span> commonPath.Len &lt; gCurrentFSEventsPath.Len <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">means</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">path</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">parent</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">currently</span> <span style="color:#7F0000;text-style:italic">used</span> <span style="color:#7F0000;text-style:italic">FSEvents</span> <span style="color:#7F0000;text-style:italic">path</span>
					needsNewRoot = <span style="color:#0000FF;font-weight: bold">true</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> needsNewRoot <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">By</span> <span style="color:#7F0000;text-style:italic">monitoring</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">root</span> <span style="color:#7F0000;text-style:italic">dir,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">learn</span> <span style="color:#7F0000;text-style:italic">about</span> <span style="color:#7F0000;text-style:italic">changes</span> <span style="color:#7F0000;text-style:italic">even</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">other</span> <span style="color:#7F0000;text-style:italic">volumes,</span> <span style="color:#7F0000;text-style:italic">including</span> <span style="color:#7F0000;text-style:italic">network</span> <span style="color:#7F0000;text-style:italic">volumes</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> since <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt64</span>
				<span style="color:#0000FF;font-weight: bold">if</span> gWatcher = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Let&#39;s</span> <span style="color:#7F0000;text-style:italic">start</span> <span style="color:#7F0000;text-style:italic">watching</span> <span style="color:#7F0000;text-style:italic">now</span>
					since = FSEventsMBS.kFSEventStreamEventIdSinceNow
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Let&#39;s</span> <span style="color:#7F0000;text-style:italic">start</span> <span style="color:#7F0000;text-style:italic">watching</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">currently</span> <span style="color:#7F0000;text-style:italic">last</span> <span style="color:#7F0000;text-style:italic">reported</span> <span style="color:#7F0000;text-style:italic">event</span>
					gWatcher.Stop
					since = gWatcher.GetLatestEventId
					gWatcher = <span style="color:#0000FF;font-weight: bold">nil</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				gCurrentFSEventsPath = commonPath
				gWatcher = <span style="color:#0000FF;font-weight: bold">new</span> FSEventsMBS (gCurrentFSEventsPath, since, DefaultLatencyInSeconds, <span style="color:#326598">0</span>)
				<span style="color:#0000FF;font-weight: bold">AddHandler</span> gWatcher.Callback, <span style="color:#0000FF;font-weight: bold">AddressOf</span> handleFSEvent
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> gWatcher.Start <span style="color:#0000FF;font-weight: bold">then</span>
					break <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">huh?</span>
					<span style="color:#0000FF;font-weight: bold">raise</span> <span style="color:#0000FF;font-weight: bold">new</span> UnsupportedOperationException
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> gClientPaths = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				gClientPaths = <span style="color:#0000FF;font-weight: bold">new</span> Dictionary
			<span style="color:#0000FF;font-weight: bold">end</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> Variant = gClientPaths.Lookup (path, <span style="color:#0000FF;font-weight: bold">nil</span>)
			<span style="color:#0000FF;font-weight: bold">if</span> v <span style="color:#0000FF;font-weight: bold">is</span> <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				gClientPaths.Value (path) = callee
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">already</span> <span style="color:#7F0000;text-style:italic">watch</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">path</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">value</span> <span style="color:#7F0000;text-style:italic">may</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">single</span> <span style="color:#7F0000;text-style:italic">entry</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">type</span> <span style="color:#7F0000;text-style:italic">FolderChangedProc</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">array</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">them</span>
				<span style="color:#0000FF;font-weight: bold">if</span> v <span style="color:#0000FF;font-weight: bold">isA</span> FolderChangedProc <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">turn</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Dictionary&#39;s</span> <span style="color:#7F0000;text-style:italic">value</span> <span style="color:#7F0000;text-style:italic">into</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">array</span>
					<span style="color:#0000FF;font-weight: bold">if</span> v = callee <span style="color:#0000FF;font-weight: bold">then</span>
						break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we&#39;ve</span> <span style="color:#7F0000;text-style:italic">already</span> <span style="color:#7F0000;text-style:italic">registered</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">one</span>
						<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">do</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">want</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">mPath</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">mCallee</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Destructor</span> <span style="color:#7F0000;text-style:italic">won&#39;t</span> <span style="color:#7F0000;text-style:italic">release</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">duplicate</span>
					<span style="color:#0000FF;font-weight: bold">end</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> callees() <span style="color:#0000FF;font-weight: bold">as</span> FolderChangedProc
					callees.Append v
					callees.Append callee
					gClientPaths.Value (path) = callees
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">it&#39;s</span> <span style="color:#7F0000;text-style:italic">already</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">array</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">add</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">it</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> callees() <span style="color:#0000FF;font-weight: bold">as</span> FolderChangedProc = v
					<span style="color:#0000FF;font-weight: bold">if</span> callees.IndexOf (callee) &gt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
						break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we&#39;ve</span> <span style="color:#7F0000;text-style:italic">already</span> <span style="color:#7F0000;text-style:italic">registered</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">one</span>
						<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">do</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">want</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">mPath</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">mCallee</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Destructor</span> <span style="color:#7F0000;text-style:italic">won&#39;t</span> <span style="color:#7F0000;text-style:italic">release</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">duplicate</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					callees.Append callee
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			mPath = path
			mCallee = callee
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> Destructor()
			<span style="color:#0000FF;font-weight: bold">if</span> mCallee = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">was</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">duplicate</span>
				<span style="color:#0000FF;font-weight: bold">return</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> Variant = gClientPaths.Lookup (mPath, <span style="color:#0000FF;font-weight: bold">nil</span>)
			<span style="color:#0000FF;font-weight: bold">if</span> v <span style="color:#0000FF;font-weight: bold">is</span> <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				break <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">huh?</span>
			<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isA</span> FolderChangedProc <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">if</span> v &lt;&gt; mCallee <span style="color:#0000FF;font-weight: bold">then</span>
					break <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">huh?</span>
				<span style="color:#0000FF;font-weight: bold">else</span>
					gClientPaths.Remove (mPath)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">it&#39;s</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">array</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">remove</span> <span style="color:#7F0000;text-style:italic">our</span> <span style="color:#7F0000;text-style:italic">callee</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">it</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> callees() <span style="color:#0000FF;font-weight: bold">as</span> FolderChangedProc = v
				<span style="color:#0000FF;font-weight: bold">dim</span> idx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = callees.IndexOf (mCallee)
				<span style="color:#0000FF;font-weight: bold">if</span> idx &lt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					break <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">huh?</span>
				<span style="color:#0000FF;font-weight: bold">else</span>
					callees.Remove idx
					<span style="color:#0000FF;font-weight: bold">if</span> callees.Ubound &lt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
						gClientPaths.Remove (mPath)
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> gClientPaths.Count = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">No</span> <span style="color:#7F0000;text-style:italic">more</span> <span style="color:#7F0000;text-style:italic">clients</span> <span style="color:#7F0000;text-style:italic">-&gt;</span> <span style="color:#7F0000;text-style:italic">dispose</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">FSEvents</span> <span style="color:#7F0000;text-style:italic">watcher</span>
				gWatcher = <span style="color:#0000FF;font-weight: bold">nil</span>
				gClientPaths = <span style="color:#0000FF;font-weight: bold">nil</span>
				gCurrentFSEventsPath = <span style="color:#6500FE">&quot;&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> determineCommonPath(path1 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>, path2 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> dirs1() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = path1.Split(<span style="color:#6500FE">&quot;/&quot;</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> dirs2() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = path2.Split(<span style="color:#6500FE">&quot;/&quot;</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> n <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Min (dirs1.Ubound-<span style="color:#326598">1</span>, dirs2.Ubound-<span style="color:#326598">1</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">for</span> i = <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">to</span> n
				<span style="color:#0000FF;font-weight: bold">if</span> dirs1(i) &lt;&gt; dirs2(i) <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">exit</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">next</span>
			<span style="color:#0000FF;font-weight: bold">redim</span> dirs1(i)
			dirs1(i) = <span style="color:#6500FE">&quot;&quot;</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> res <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = Join (dirs1, <span style="color:#6500FE">&quot;/&quot;</span>)
			<span style="color:#0000FF;font-weight: bold">return</span> res
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Shared</span> <span style="color:#0000FF;font-weight: bold">Sub</span> handleFSEvent(sender <span style="color:#0000FF;font-weight: bold">as</span> FSEventsMBS, index <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, count <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, path <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, flags <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, eventID <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt64</span>)
			<span style="color:#0000FF">#if</span> DebugBuild
				System.DebugLog <span style="color:#6500FE">&quot;handleFSEvent:</span> <span style="color:#6500FE">&quot;</span>+path
			<span style="color:#0000FF">#endif</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> gClientPaths &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> Variant = gClientPaths.Lookup (path, <span style="color:#0000FF;font-weight: bold">nil</span>)
				<span style="color:#0000FF;font-weight: bold">if</span> v = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">we&#39;re</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">monitoring</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">path</span>
				<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isA</span> FolderChangedProc <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> callee <span style="color:#0000FF;font-weight: bold">as</span> FolderChangedProc = v
					callee.Invoke (path)
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">it&#39;s</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">array</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">call</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">callees</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">it</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> callees() <span style="color:#0000FF;font-weight: bold">as</span> FolderChangedProc = v
					<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> callee <span style="color:#0000FF;font-weight: bold">as</span> FolderChangedProc <span style="color:#0000FF;font-weight: bold">in</span> callees
						callee.Invoke (path)
					<span style="color:#0000FF;font-weight: bold">next</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;About&quot;</span>
<div class="RB_Comment">			This class was written on 8 Mar 2017 by Thomas Tempelmann, tempelmann@gmail.com.
			You may use this code freely without restrictions.
			
			It provides an easy way to monitor changes to particular folders. It uses the MBS plugin's
			FSEventsMBS class. While the FSEventsMBS is meant to monitor not only just one folder
			but also all its contained folders, this class makes it possible to instead just pick single
			folders (by their paths, which you can obtain with FolderItem.UnixpathMBS) and get a
			callback when one of them changes.
			
			This class takes care of all the management requires for this, such as having multiple
			watchers interested in the same path, and disposing of the FSEventsMBS watcher once
			there's no monitoring requested any more.
			
			To use it, write something like
			
			   dim monitor as new FolderMonitor (file.UnixpathMBS, AddressOf handleFolderChange)
			
			and then store 'monitor' in a property for as long as you want the given folder monitored.
			
			You also have to implement a method like this:
			
			  sub handleFolderChange (path as String)
			
			It will be called once the given folder has changed, with up to about a second delay, usually.
			
			See FolderMonitorTestWin for a demo.</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Shared</span> DefaultLatencyInSeconds <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Shared</span> gClientPaths <span style="color:#0000FF;font-weight: bold">As</span> Dictionary
<div class="RB_Comment">			Key: path as String, Value: callee as FolderChangedProc or an array of them.</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Shared</span> gCurrentFSEventsPath <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Shared</span> gWatcher <span style="color:#0000FF;font-weight: bold">As</span> FSEventsMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mCallee <span style="color:#0000FF;font-weight: bold">As</span> FolderChangedProc</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mPath <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> FolderMonitorTestWin <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control monitorList <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance monitorList <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> KeyDown(Key <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
				<span style="color:#0000FF;font-weight: bold">if</span> key.Asc = <span style="color:#326598">127</span> <span style="color:#0000FF;font-weight: bold">or</span> key.Asc = <span style="color:#326598">8</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">Delete</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">Backspace?</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Let&#39;s</span> <span style="color:#7F0000;text-style:italic">remove</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">selected</span> <span style="color:#7F0000;text-style:italic">rows</span>
					<span style="color:#0000FF;font-weight: bold">for</span> row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#0000FF;font-weight: bold">me</span>.ListCount-<span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">downTo</span> <span style="color:#326598">0</span>
						<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">me</span>.Selected(row) <span style="color:#0000FF;font-weight: bold">then</span>
							<span style="color:#0000FF;font-weight: bold">me</span>.RemoveRow row <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">clears</span> <span style="color:#7F0000;text-style:italic">its</span> <span style="color:#7F0000;text-style:italic">Tag,</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">assigned</span> <span style="color:#7F0000;text-style:italic">FolderMonitor</span> <span style="color:#7F0000;text-style:italic">object</span> <span style="color:#7F0000;text-style:italic">will</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">freed</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">well</span>
						<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">next</span>
					<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">true</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Label1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Label1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control changesList <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance changesList <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Label2 <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Label2 <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> DropObject(obj <span style="color:#0000FF;font-weight: bold">As</span> DragItem, action <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">do</span>
				<span style="color:#0000FF;font-weight: bold">if</span> obj.FolderItemAvailable <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> f <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = obj.FolderItem
					<span style="color:#0000FF;font-weight: bold">if</span> f &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> f.Directory <span style="color:#0000FF;font-weight: bold">then</span> f = f.Parent
						addFolder f
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">loop</span> <span style="color:#0000FF;font-weight: bold">until</span> <span style="color:#0000FF;font-weight: bold">not</span> obj.NextItem
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#0000FF;font-weight: bold">self</span>.AcceptRawDataDrop <span style="color:#6500FE">&quot;public.file-url&quot;</span> <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">same</span> <span style="color:#7F0000;text-style:italic">as:</span> <span style="color:#7F0000;text-style:italic">self.AcceptFileDrop</span> <span style="color:#7F0000;text-style:italic">FileTypesFolder.All</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> addFolder(dir <span style="color:#0000FF;font-weight: bold">as</span> FolderItem)
			<span style="color:#0000FF;font-weight: bold">dim</span> path <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = dir.UnixpathMBS
			monitorList.AddRow path
			<span style="color:#0000FF;font-weight: bold">dim</span> row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = monitorList.LastIndex
			monitorList.RowTag(row) = <span style="color:#0000FF;font-weight: bold">new</span> FolderMonitor (path, <span style="color:#0000FF;font-weight: bold">AddressOf</span> folderHasChanged)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> folderHasChanged(path <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> now <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> Date
			changesList.AddRow now.LongTime
			<span style="color:#0000FF;font-weight: bold">dim</span> row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = changesList.LastIndex
			changesList.Cell (row, <span style="color:#326598">1</span>) = path
			changesList.ScrollPosition = row <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">scrolls</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">bottom</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	FileTypesFolder</div>
<div class="RB_Code">		Filetype special/disk</div>
<div class="RB_Code">		Filetype special/folder</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> FileTypesFolder</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar MenuBar1</div>
<div class="RB_Code">		MenuItem FileMenu = <span style="color:#6500FE">&quot;&amp;File&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;#App.kFileQuit&quot;</span></div>
<div class="RB_Code">		MenuItem EditMenu = <span style="color:#6500FE">&quot;&amp;Edit&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;&amp;Undo&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu1 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;Cu&amp;t&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;&amp;Copy&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;&amp;Paste&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;#App.kEditClear&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu0 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditSelectAll = <span style="color:#6500FE">&quot;Select</span> <span style="color:#6500FE">&amp;All&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmacframeworksplugin.html">MBS MacFrameworks Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-macframeworks-fsevents-fseventsmbsdemo">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

