<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - XMPFilesMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="XMPFilesMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">XMPFilesMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-xmpfilesmbs.html">XMPFilesMBS</a> class.  </p>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="1">CanPutXMP(xmpPacket as string) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
CanPutXMP() reports whether this file can be updated with a specific XMP packet.<BR>
<B>Notes:</B> 
Use to determine if the file can probably be updated with a given set of XMP metadata. This depends on the size of the packet, the options with which the file was opened, and the capabilities of the handler for the file format. The function obtains the length of the serialized packet for the provided XMP, but does not keep it or modify it, and does not cause the file to be written when closed.<BR>
<p>See also:<ul>
<li><A href="xmp-xmpfilesmbs-method.html#2">CanPutXMP(xmpPacket as XMPMetaMBS) as boolean</A></li>
</ul></p>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-xmp-createexif.html">/XMP/Create EXIF</A></li>
<li><A href="example-xmp-createxmp.html">/XMP/Create XMP</A></li>
<li><A href="example-xmp-modifyexif.html">/XMP/Modify EXIF</A></li>
<li><A href="example-xmp-modifyingcomplexproperties.html">/XMP/Modifying Complex Properties</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="2">CanPutXMP(xmpPacket as <A href="class-xmpmetambs.html">XMPMetaMBS</A>) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
<br>
CanPutXMP() reports whether this file can be updated with a specific XMP packet,<BR>
passed in a string object.<BR>
<p>See also:<ul>
<li><A href="xmp-xmpfilesmbs-method.html">CanPutXMP(xmpPacket as string) as boolean</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="3">CloseFile(closeFlags as Integer)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
CloseFile() explicitly closes an opened file.<BR>
<B>Notes:</B> 
<BR>
Performs any necessary output to the file and closes it. Files that are opened for update are written to only when closing.<BR>
<BR>
If the file is opened for read-only access (passing kOpenForRead), the disk<BR>
file is closed immediately after reading the data from it; the XMPFiles object, however, remains in the open state. You must call CloseFile() when finished using it. Other methods, such as GetXMP(), can only be used between the OpenFile() and CloseFile() calls. The XMPFiles destructor does not call CloseFile(); if you call it without closing, any pending updates are lost.<BR>
<BR>
If the file is opened for update (passing kOpenForUpdate), the disk file remains<BR>
open until CloseFile() is called. The disk file is only updated once, when CloseFile() is called, regardless of how many calls are made to PutXMP().<BR>
<BR>
closeFlags: Option flags for optional closing actions. This bit-flag constant is<BR>
defined:<BR>
<BR>
<UL><LI>
kUpdateSafely - Write into a temporary file then swap for crash safety.
</UL>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="4">Constructor</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Default constructor initializes an object that is associated with no file.<BR>
<B>Notes:</B> 
The destructor does not call CloseFile(); pending updates are lost when the destructor is run.<BR>
<p>See also:<ul>
<li><A href="xmp-xmpfilesmbs-method.html#5">Constructor(path as folderitem, format as Integer=&h20202020, OpenFlags as Integer=0)</A></li>
<li><A href="xmp-xmpfilesmbs-method.html#6">Constructor(path as string, format as Integer=&h20202020, OpenFlags as Integer=0)</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="5">Constructor(path as folderitem, format as Integer=&amp;h20202020, OpenFlags as Integer=0)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Opens a file for metadata access.<BR>
<B>Notes:</B> 
<BR>
Opens a file for the requested forms of metadata access. Opening the file at a minimum causes the raw XMP packet to be read from the file. If the file handler supports legacy metadata reconciliation then legacy metadata is also read, unless kOpenOnlyXMP is passed. If the file handler supports native thumbnails and kOpenCacheTNail is passed, the native thumbnail is cached.<BR>
If the file is opened for read-only access (passing kOpenForRead), the disk file is closed immediately after reading the data from it; the XMPFiles object, however, remains in the open state. You must call CloseFile() when finished using it. Other methods, such as GetXMP(), can only be used between the OpenFile() and CloseFile() calls. The XMPFiles destructor does not call CloseFile(); if you call it without closing, any pending updates are lost.<BR>
If the file is opened for update (passing kOpenForUpdate), the disk file remains open until CloseFile() is called. The disk file is only updated once, when CloseFile() is called, regardless of how many calls are made to PutXMP().<BR>
Typically, the XMP is not parsed and legacy reconciliation is not performed until GetXMP() is called, but this is not guaranteed. Specific file handlers might do earlier parsing of the XMP. Delayed parsing and early disk file close for read-only access are optimizations to help clients implementing file browsers, so that they can access the file briefly and possibly display a thumbnail, then postpone more expensive XMP processing until later.<BR>
<BR>
path: The path for the file, appropriate for the local operating system. <BR>
format: The format of the file. If the format is unknown (kUnknownFile) the format is determined from the file content. The first handler to check is guessed from the file&#39;s extension. Passing a specific format value is generally just a hint about what file handler to try first (instead of the one based on the extension). If kOpenStrictly is set, then any format other than kUnknownFile requires that the file actually be that format; otherwise an exception is thrown.<BR>
openFlags: A set of option flags that describe the desired access. By default (zero) the file is opened for read-only access and the format handler decides on the level of reconciliation that will be performed. A logical OR of these bit-flag constants:<BR>
<BR>
<UL><LI>
kOpenForRead - Open for read-only access.
</LI><LI>
kOpenForUpdate - Open for reading and writing.
</LI><LI>
kOpenOnlyXMP - Only the XMP is wanted, no reconciliation.
</LI><LI>
kOpenCacheTNail - Cache thumbnail if possible, GetThumbnail will be called.
</LI><LI>
kOpenStrictly - Be strict about locating XMP and reconciling with other forms. By default, a best effort is made to locate the correct XMP and to reconcile XMP with other forms (if reconciliation is done). This option forces stricter rules, resulting in exceptions for errors. The definition of strictness is specific to each handler, there might be no difference.
</LI><LI>
kOpenUseSmartHandler - Require the use of a smart handler.
</LI><LI>
kOpenUsePacketScanning - Force packet scanning, do not use a smart handler.
</LI></UL>
<BR>
Throws an exception for serious problems.<BR>
<p>See also:<ul>
<li><A href="xmp-xmpfilesmbs-method.html#4">Constructor</A></li>
<li><A href="xmp-xmpfilesmbs-method.html#6">Constructor(path as string, format as Integer=&h20202020, OpenFlags as Integer=0)</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="6">Constructor(path as string, format as Integer=&amp;h20202020, OpenFlags as Integer=0)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Alternate constructor associates the new XMPFiles object with a specific file.<BR>
<B>Notes:</B> 
<BR>
Calls OpenFile() to open the specified file after performing a default construct.<BR>
<BR>
path: The path for the file, specified as an UTF-8 string. (use FolderItem.NativePath)<BR>
format: A format hint for the file, if known.<BR>
openFlags: Options for how the file is to be opened (for read or read/write, for example). Use a logical OR of these bit-flag constants:<BR>
<BR>
<UL><LI>
kOpenForRead
</LI><LI>
kOpenForUpdate
</LI><LI>
kOpenOnlyXMP
</LI><LI>
kOpenCacheTNail
</LI><LI>
kOpenStrictly
</LI><LI>
kOpenUseSmartHandler
</LI><LI>
kOpenUsePacketScanning
</LI><LI>
kOpenLimitedScanning
</LI><LI>
kOpenInBackground
</LI></UL>
<BR>
The destructor does not call CloseFile(); pending updates are lost when the destructor is run.<BR>
<p>See also:<ul>
<li><A href="xmp-xmpfilesmbs-method.html#4">Constructor</A></li>
<li><A href="xmp-xmpfilesmbs-method.html#5">Constructor(path as folderitem, format as Integer=&h20202020, OpenFlags as Integer=0)</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="7">GetFileInfo(byref path as string, byref openFlags as UInt32, byref format as UInt32, byref handlerFlags as UInt32) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
GetFileInfo() retrieves basic information about an opened file.<BR>
<B>Notes:</B> 
<BR>
path: A buffer in which to return the path passed to OpenFile(). Can be<BR>
null if value is not wanted.<BR>
<BR>
openFlags: A variable in which to return the option flags passed to<BR>
OpenFile.<BR>
format: A variable in which to return the file format. <BR>
handlerFlags:  [out] A variable in which to return the handler&#39;s capability flags. <BR>
<BR>
Returns true if the file object is in the open state; that is, OpenFile() has been called but CloseFile() has not. False otherwise. Even if the file object is open, the actual disk file might be closed in the host file-system sense; see OpenFile().<BR>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="8">GetXMP(byref xmp as <A href="class-xmpmetambs.html">XMPMetaMBS</A>, byref xmppacket as string, byref PacketInfo as <A href="class-xmppacketinfombs.html">XMPPacketInfoMBS</A>) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
GetXMP() retrieves the XMP metadata from an open file.<BR>
<B>Notes:</B> 
<BR>
The function reports whether XMP is present in the file; you can choose to retrieve any or all of the parsed XMP, the raw XMP packet, or information about the raw XMP packet. The options provided when the file was opened determine if reconciliation is done with other forms of metadata.<BR>
<BR>
xmp: An XMP object in which to return the parsed XMP metadata.<BR>
xmppacket: An string in which to return the raw XMP packet as stored in<BR>
the file. The encoding of the packet is given in the packetInfo. Returns an<BR>
empty string if the low level file handler does not provide the raw packet.<BR>
packetInfo: A packetinfo object in which to return the location and form of the raw XMP in the file. PacketInfo.charForm and PacketInfo.writeable reflect the<BR>
raw XMP in the file. The parsed XMP property values are always UTF-8. The writeable flag is taken from the packet trailer; it applies only to &quot;format ignorant&quot; writing. The PacketInfo object always reflects the state of the XMP in the file. The offset, length, and character form do not change as a result of calling PutXMP() unless the file is also written. Some file handlers might not return location or contents of the raw packet string. To determine whether one does, check the kReturnsRawPacket bit returned by GetFormatInfo(). If the low-level file handler does not provide the raw packet location, PacketInfo.offset and PacketInfo.length are both 0, PacketInfo.charForm is UTF-8, and PacketInfo.writeable is false.<BR>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="9">OpenFile(path as folderitem, format as Integer=&amp;h20202020, OpenFlags as Integer=0) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Alternate constructor associates the new XMPFiles object with a specific file.<BR>
<B>Notes:</B> 
<BR>
Calls OpenFile() to open the specified file after performing a default construct.<BR>
<BR>
path: The path for the file, specified as folderitem.<BR>
format: A format hint for the file, if known.<BR>
openFlags: Options for how the file is to be opened (for read or read/write, for example). Use a logical OR of these bit-flag constants:<BR>
<BR>
<UL><LI>
kOpenForRead
</LI><LI>
kOpenForUpdate
</LI><LI>
kOpenOnlyXMP
</LI><LI>
kOpenCacheTNail
</LI><LI>
kOpenStrictly
</LI><LI>
kOpenUseSmartHandler
</LI><LI>
kOpenUsePacketScanning
</LI><LI>
kOpenLimitedScanning
</LI><LI>
kOpenInBackground
</LI></UL>
<BR>
The destructor does not call CloseFile(); pending updates are lost when the destructor is run.<BR>
<p>See also:<ul>
<li><A href="xmp-xmpfilesmbs-method.html#10">OpenFile(path as string, format as Integer=&h20202020, OpenFlags as Integer=0) as boolean</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="10">OpenFile(path as string, format as Integer=&amp;h20202020, OpenFlags as Integer=0) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Opens a file for metadata access.<BR>
<B>Notes:</B> 
<BR>
Opens a file for the requested forms of metadata access. Opening the file at a minimum causes the raw XMP packet to be read from the file. If the file handler supports legacy metadata reconciliation then legacy metadata is also read, unless kOpenOnlyXMP is passed. If the file handler supports native thumbnails and kOpenCacheTNail is passed, the native thumbnail is cached.<BR>
If the file is opened for read-only access (passing kOpenForRead), the disk file is closed immediately after reading the data from it; the XMPFiles object, however, remains in the open state. You must call CloseFile() when finished using it. Other methods, such as GetXMP(), can only be used between the OpenFile() and CloseFile() calls. The XMPFiles destructor does not call CloseFile(); if you call it without closing, any pending updates are lost.<BR>
If the file is opened for update (passing kOpenForUpdate), the disk file remains open until CloseFile() is called. The disk file is only updated once, when CloseFile() is called, regardless of how many calls are made to PutXMP().<BR>
Typically, the XMP is not parsed and legacy reconciliation is not performed until GetXMP() is called, but this is not guaranteed. Specific file handlers might do earlier parsing of the XMP. Delayed parsing and early disk file close for read-only access are optimizations to help clients implementing file browsers, so that they can access the file briefly and possibly display a thumbnail, then postpone more expensive XMP processing until later.<BR>
<BR>
path: The path for the file, specified as an UTF-8 string. (use FolderItem.NativePath)<BR>
format: The format of the file. If the format is unknown (kUnknownFile) the format is determined from the file content. The first handler to check is guessed from the file&#39;s extension. Passing a specific format value is generally just a hint about what file handler to try first (instead of the one based on the extension). If kOpenStrictly is set, then any format other than kUnknownFile requires that the file actually be that format; otherwise an exception is thrown.<BR>
openFlags: A set of option flags that describe the desired access. By default (zero) the file is opened for read-only access and the format handler decides on the level of reconciliation that will be performed. A logical OR of these bit-flag constants:<BR>
<BR>
<UL><LI>
kOpenForRead - Open for read-only access.
</LI><LI>
kOpenForUpdate - Open for reading and writing.
</LI><LI>
kOpenOnlyXMP - Only the XMP is wanted, no reconciliation.
</LI><LI>
kOpenCacheTNail - Cache thumbnail if possible, GetThumbnail will be called.
</LI><LI>
kOpenStrictly - Be strict about locating XMP and reconciling with other forms. By default, a best effort is made to locate the correct XMP and to reconcile XMP with other forms (if reconciliation is done). This option forces stricter rules, resulting in exceptions for errors. The definition of strictness is specific to each handler, there might be no difference.
</LI><LI>
kOpenUseSmartHandler - Require the use of a smart handler.
</LI><LI>
kOpenUsePacketScanning - Force packet scanning, do not use a smart handler.
</LI></UL>
<BR>
Returns true if the file is succesfully opened and attached to a file handler. False for anticipated problems, such as passing kOpenUseSmartHandler but not having an appropriate smart handler. Throws an exception for serious problems.<BR>
<p>See also:<ul>
<li><A href="xmp-xmpfilesmbs-method.html#9">OpenFile(path as folderitem, format as Integer=&h20202020, OpenFlags as Integer=0) as boolean</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="11">PutXMP(xmpPacket as string)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
PutXMP() updates the XMP metadata in this object without writing out the file,<BR>
<B>Notes:</B> 
Overloads the basic form of the function, allowing you to pass the metadata as a string object instead of an XMP object. It is otherwise identical; see details in the canonical form.<BR>
<p>See also:<ul>
<li><A href="xmp-xmpfilesmbs-method.html#12">PutXMP(xmpPacket as XMPMetaMBS)</A></li>
</ul></p>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-xmp-createexif.html">/XMP/Create EXIF</A></li>
<li><A href="example-xmp-createxmp.html">/XMP/Create XMP</A></li>
<li><A href="example-xmp-modifyexif.html">/XMP/Modify EXIF</A></li>
<li><A href="example-xmp-modifyingcomplexproperties.html">/XMP/Modifying Complex Properties</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="12">PutXMP(xmpPacket as <A href="class-xmpmetambs.html">XMPMetaMBS</A>)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
PutXMP() updates the XMP metadata in this object without writing out the file.<BR>
<B>Notes:</B> 
This function supplies new XMP for the file. However, the disk file is not written until the object is closed with CloseFile(). The options provided when the file was opened determine if reconciliation is done with other forms of metadata.<BR>
<p>See also:<ul>
<li><A href="xmp-xmpfilesmbs-method.html#11">PutXMP(xmpPacket as string)</A></li>
</ul></p>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=xmp-xmpfilesmbs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

