<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - XMPFilesMBS shared methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="XMPFilesMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">XMPFilesMBS shared methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-xmpfilesmbs.html">XMPFilesMBS</a> class.  </p>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="1">CheckFileFormat(path as string) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
CheckFileFormat() tries to determine the format of a file.<BR>
<B>Notes:</B> 
<BR>
CheckFileFormat tries to determine the format of a file, returning an format value. It uses the same logic as OpenFile will use to select a smart handler.<BR>
<BR>
path: The path for the file, appropriate for the local operating system. Passed as a UTF-8 string. The path is the same as would be passed to OpenFile.<BR>
<BR>
Returns the file&#39;s format if a smart handler would be selected, otherwise kUnknownFile.<BR>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="2">CheckPackageFormat(path as string) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
CheckPackageFormat() tries to determine the format of a &quot;package&quot; folder.<BR>
<B>Notes:</B> 
<BR>
CheckPackageFormat tries to determine the format of a &quot;package&quot; given the name of the top level folder, returning an XMP_FileFormat value. Examples of recognized packages include the video formats P2, XDCAM, or Sony HDV. These packages contain collections of &quot;clips&quot;, stored as multiple files in specific subfolders.<BR>
<BR>
Path: The path for the top level folder, appropriate for the local operating<BR>
system. Passed as an UTF-8 string. The path is not the same as would be passed to OpenFile. For example the path passed to CheckPackageFormat might be &quot;.../MyMovie&quot;, while the path passed to OpenFile would be &quot;.../MyMovie/SomeClip&quot;.<BR>
<BR>
Returns the package&#39;s format if a smart handler would be selected, otherwise kUnknownFile.<BR>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="3">GetFormatInfo(format as Integer, byref handlerFlags as UInt32) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
GetFormatInfo() reports what features are supported for a specific file format.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> flags <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">UInt32</span><br /><span style="color: #0000FF;">if</span> <A href="class-xmpfilesmbs.html">XMPFilesMBS</A>.GetFormatInfo(<A href="class-xmpfilesmbs.html">XMPFilesMBS</A>.kJPEGFile, flags) <span style="color: #0000FF;">then</span><br />  <br />  <span style="color: #0000FF;">if</span> BitwiseAnd(flags, <A href="class-xmpfilesmbs.html">XMPFilesMBS</A>.kCanInjectXMP) &lt;&gt; <span style="color: #336698;">0</span> <span style="color: #0000FF;">then</span><br />    MsgBox <span style="color: #6600FE;">&quot;Can inject first-time XMP into an existing file.&quot;</span><br />  <span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br />  <br />  <span style="color: #0000FF;">if</span> BitwiseAnd(flags, <A href="class-xmpfilesmbs.html">XMPFilesMBS</A>.kCanExpand) &lt;&gt; <span style="color: #336698;">0</span> <span style="color: #0000FF;">then</span><br />    MsgBox <span style="color: #6600FE;">&quot;Can expand XMP or other metadata in an existing file.&quot;</span><br />  <span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br />  <br />  <span style="color: #0000FF;">if</span> BitwiseAnd(flags, <A href="class-xmpfilesmbs.html">XMPFilesMBS</A>.kCanRewrite) &lt;&gt; <span style="color: #336698;">0</span> <span style="color: #0000FF;">then</span><br />    MsgBox <span style="color: #6600FE;">&quot;Can copy one file to another, writing new metadata (as in SaveAs).&quot;</span><br />  <span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br />  <br />  <span style="color: #0000FF;">if</span> BitwiseAnd(flags, <A href="class-xmpfilesmbs.html">XMPFilesMBS</A>.kCanReconcile) &lt;&gt; <span style="color: #336698;">0</span> <span style="color: #0000FF;">then</span><br />    MsgBox <span style="color: #6600FE;">&quot;Supports reconciliation between XMP and other forms.&quot;</span><br />  <span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br />  <br />  <span style="color: #0000FF;">if</span> BitwiseAnd(flags, <A href="class-xmpfilesmbs.html">XMPFilesMBS</A>.kAllowsOnlyXMP) &lt;&gt; <span style="color: #336698;">0</span> <span style="color: #0000FF;">then</span><br />    MsgBox <span style="color: #6600FE;">&quot;Allows access to just the XMP, ignoring other forms.&quot;</span><br />  <span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br />  <br />  <span style="color: #0000FF;">if</span> BitwiseAnd(flags, <A href="class-xmpfilesmbs.html">XMPFilesMBS</A>.kReturnsTNail) &lt;&gt; <span style="color: #336698;">0</span> <span style="color: #0000FF;">then</span><br />    MsgBox <span style="color: #6600FE;">&quot;File handler returns native thumbnail information.&quot;</span><br />  <span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br />  <br />  <span style="color: #0000FF;">if</span> BitwiseAnd(flags, <A href="class-xmpfilesmbs.html">XMPFilesMBS</A>.kReturnsRawPacket) &lt;&gt; <span style="color: #336698;">0</span> <span style="color: #0000FF;">then</span><br />    MsgBox <span style="color: #6600FE;">&quot;File handler returns raw XMP packet information and string.&quot;</span><br />  <span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br />  <br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
The file handlers for different file formats vary considerably in what features they support. Support depends on both the general capabilities of the format and the implementation of the handler for that format.<BR>
<BR>
format: The file format whose support flags are desired.<BR>
handlerFlags: A variable in which to return a logical OR of option bit flags.<BR>
The following constants are defined:<BR>
<BR>
<UL><LI>
kCanInjectXMP - Can inject first-time XMP into an existing file.
</LI><LI>
kCanExpand - Can expand XMP or other metadata in an existing file.
</LI><LI>
kCanRewrite - Can copy one file to another, writing new metadata (as in SaveAs)
</LI><LI>
kCanReconcile - Supports reconciliation between XMP and other forms.
</LI><LI>
kAllowsOnlyXMP - Allows access to just the XMP, ignoring other forms.
</LI></UL>
  This is only meaningful if kCanReconcile is set.<BR>
<UL><LI>
kReturnsTNail - File handler returns native thumbnail information.
</LI><LI>
kReturnsRawPacket - File handler returns raw XMP packet information and string.
</LI></UL>
<BR>
Even if kReturnsRawPacket is set, the returned packet information might have an<BR>
offset of -1 to indicate an unknown offset. While all file handlers should be able to return the raw packet, some might not know the offset of the packet within the file. This is typical in cases where external libraries are used. These cases might not even allow return of the raw packet.<BR>
<BR>
Returns true if the format has explicit &quot;smart&quot; support, false if the format is handled by the default packet scanning plus heuristics. <BR>
</div>
<div class="WLM">
<b><a href="class-xmpfilesmbs.html">XMPFilesMBS</a>.<A name="4">GetVersionInfo as <A href="class-xmpversioninfombs.html">XMPVersionInfoMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-xmp.html" translate="no">XMP</A></td>
<td class=grau><a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a></td>
<td class=grau><a href="newinversion94.shtml" class=version>9.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
GetVersionInfo() retrieves version information for the XMPFiles component.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsxmpplugin.html">MBS XMP Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=xmp-xmpfilesmbs-shared-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

