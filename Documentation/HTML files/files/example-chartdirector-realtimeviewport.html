<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /ChartDirector/RealTime ViewPort</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /ChartDirector/RealTime ViewPort</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/ChartDirector/RealTime ViewPort</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS ChartDirector Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /ChartDirector/RealTime ViewPort<BR>
This example is the version from Fri, 9th Feb 2023.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;RealTime</span> <span style="color:#6500FE">ViewPort.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kEditClear = <span style="color:#6500FE">&quot;&amp;Delete&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuit = <span style="color:#6500FE">&quot;&amp;Quit&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuitShortcut = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">CDBaseChartMBS.set</span> <span style="color:#7F0000;text-style:italic">License</span> <span style="color:#7F0000;text-style:italic">Code</span> <span style="color:#7F0000;text-style:italic">...</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> RealTimeWindow <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> initialFullRange = <span style="color:#326598">180</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> initialVisibleRange = <span style="color:#326598">30</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> sampleSize = <span style="color:#326598">10000</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> zoomInLimit = <span style="color:#326598">5</span></div>
<div class="RB_MainItem">
<div class="RB_Code">		Control savePB <span style="color:#0000FF;font-weight: bold">Inherits</span> BevelButton</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance savePB <span style="color:#0000FF;font-weight: bold">Inherits</span> BevelButton</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				onSave
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control zoomOutPB <span style="color:#0000FF;font-weight: bold">Inherits</span> BevelButton</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance zoomOutPB <span style="color:#0000FF;font-weight: bold">Inherits</span> BevelButton</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				<span style="color:#0000FF;font-weight: bold">If</span> <span style="color:#0000FF;font-weight: bold">Me</span>.Value <span style="color:#0000FF;font-weight: bold">Then</span>
					onMouseUsageChanged ChartViewer.MouseUsageZoomOut
					
					pointerPB.Value = <span style="color:#0000FF;font-weight: bold">False</span>
					zoomInPB.Value = <span style="color:#0000FF;font-weight: bold">False</span>
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control zoomInPB <span style="color:#0000FF;font-weight: bold">Inherits</span> BevelButton</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance zoomInPB <span style="color:#0000FF;font-weight: bold">Inherits</span> BevelButton</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				<span style="color:#0000FF;font-weight: bold">If</span> <span style="color:#0000FF;font-weight: bold">Me</span>.Value <span style="color:#0000FF;font-weight: bold">Then</span>
					onMouseUsageChanged ChartViewer.MouseUsageZoomIn
					
					pointerPB.Value = <span style="color:#0000FF;font-weight: bold">False</span>
					zoomOutPB.Value = <span style="color:#0000FF;font-weight: bold">False</span>
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control pointerPB <span style="color:#0000FF;font-weight: bold">Inherits</span> BevelButton</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance pointerPB <span style="color:#0000FF;font-weight: bold">Inherits</span> BevelButton</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				<span style="color:#0000FF;font-weight: bold">If</span> <span style="color:#0000FF;font-weight: bold">Me</span>.Value <span style="color:#0000FF;font-weight: bold">Then</span>
					onMouseUsageChanged ChartViewer.MouseUsageDefault
					
					zoomInPB.Value = <span style="color:#0000FF;font-weight: bold">False</span>
					zoomOutPB.Value = <span style="color:#0000FF;font-weight: bold">False</span>
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control ChartViewer <span style="color:#0000FF;font-weight: bold">Inherits</span> ChartViewerCanvas</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance ChartViewer <span style="color:#0000FF;font-weight: bold">Inherits</span> ChartViewerCanvas</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> mouseMovePlotArea(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
				<span style="color:#0000FF;font-weight: bold">self</span>.onMouseMovePlotArea MouseEvent
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> viewPortChanged()
				<span style="color:#0000FF;font-weight: bold">Self</span>.onViewPortChanged
				ViewPortControl.onViewPortChanged
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control ChartUpdateTimer <span style="color:#0000FF;font-weight: bold">Inherits</span> Timer</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance ChartUpdateTimer <span style="color:#0000FF;font-weight: bold">Inherits</span> Timer</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				onChartUpdateTimer
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control LeftLine <span style="color:#0000FF;font-weight: bold">Inherits</span> Line</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance LeftLine <span style="color:#0000FF;font-weight: bold">Inherits</span> Line</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control TopLine <span style="color:#0000FF;font-weight: bold">Inherits</span> Line</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance TopLine <span style="color:#0000FF;font-weight: bold">Inherits</span> Line</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control BottomLine <span style="color:#0000FF;font-weight: bold">Inherits</span> Line</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance BottomLine <span style="color:#0000FF;font-weight: bold">Inherits</span> Line</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control RightLine <span style="color:#0000FF;font-weight: bold">Inherits</span> Line</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance RightLine <span style="color:#0000FF;font-weight: bold">Inherits</span> Line</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control SecondCanvas <span style="color:#0000FF;font-weight: bold">Inherits</span> ViewPortControlCanvas</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance SecondCanvas <span style="color:#0000FF;font-weight: bold">Inherits</span> ViewPortControlCanvas</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control HelpLabel <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance HelpLabel <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Close()
			dataSource.stopThread
			
			<span style="color:#0000FF;font-weight: bold">If</span> ViewPortControl &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				ViewPortControl.Close
				ViewPortControl = <span style="color:#0000FF;font-weight: bold">Nil</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#0000FF;font-weight: bold">Redim</span> <span style="color:#0000FF;font-weight: bold">Self</span>.timeStamps(sampleSize-<span style="color:#326598">1</span>)
			<span style="color:#0000FF;font-weight: bold">Redim</span> <span style="color:#0000FF;font-weight: bold">self</span>.dataSeriesA(sampleSize-<span style="color:#326598">1</span>)
			<span style="color:#0000FF;font-weight: bold">Redim</span> <span style="color:#0000FF;font-weight: bold">self</span>.dataSeriesB(sampleSize-<span style="color:#326598">1</span>)
			
			
			Setup
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> InitRandomWalk()
			dataSource = <span style="color:#0000FF;font-weight: bold">New</span> RandomWalk
			
			<span style="color:#0000FF;font-weight: bold">AddHandler</span> dataSource.GotNewValues, WeakAddressOf onData
			
			dataSource.run
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Setup()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">connect</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">controls</span>
			
			ChartViewer.LeftLine = LeftLine
			ChartViewer.RightLine = RightLine
			ChartViewer.TopLine = TopLine
			ChartViewer.BottomLine = BottomLine
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Pointer</span> <span style="color:#7F0000;text-style:italic">push</span> <span style="color:#7F0000;text-style:italic">button</span>
			pointerPB.Value = <span style="color:#0000FF;font-weight: bold">True</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">push</span> <span style="color:#7F0000;text-style:italic">button</span>
			zoomInPB.Value = <span style="color:#0000FF;font-weight: bold">False</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">Out</span> <span style="color:#7F0000;text-style:italic">push</span> <span style="color:#7F0000;text-style:italic">button</span>
			zoomOutPB.Value = <span style="color:#0000FF;font-weight: bold">False</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Save</span> <span style="color:#7F0000;text-style:italic">push</span> <span style="color:#7F0000;text-style:italic">button</span>
			
			
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Chart</span> <span style="color:#7F0000;text-style:italic">Viewer</span>
			<span style="color:#7F0000;text-style:italic">&#39;ChartViewer.setGeometry(0,</span> <span style="color:#7F0000;text-style:italic">0,</span> <span style="color:#7F0000;text-style:italic">640,</span> <span style="color:#7F0000;text-style:italic">350)</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Viewport</span> <span style="color:#7F0000;text-style:italic">Control</span>
			ViewPortControl = <span style="color:#0000FF;font-weight: bold">New</span> ViewPortControl
			ViewPortControl.Output = SecondCanvas <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">&lt;-</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">output</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">Xojo</span>
			ViewPortControl.setViewer(ChartViewer)
			
			SecondCanvas.ViewPortControl = ViewPortControl
			ChartViewer.HelpLabel = HelpLabel
			
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Initialize</span> <span style="color:#7F0000;text-style:italic">member</span> <span style="color:#7F0000;text-style:italic">variables</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.currentIndex = <span style="color:#326598">0</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Initially,</span> <span style="color:#7F0000;text-style:italic">auto-move</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">make</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">follow</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">series</span>
			<span style="color:#0000FF;font-weight: bold">self</span>.trackLineEndPos = <span style="color:#326598">0</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.trackLineIsAtEnd = <span style="color:#0000FF;font-weight: bold">True</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Initially</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">drag</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">scroll</span> <span style="color:#7F0000;text-style:italic">mode.</span>
			pointerPB.Value = <span style="color:#0000FF;font-weight: bold">True</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Enable</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">wheel</span> <span style="color:#7F0000;text-style:italic">zooming</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">setting</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">ratio</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">1.1</span> <span style="color:#7F0000;text-style:italic">per</span> <span style="color:#7F0000;text-style:italic">wheel</span> <span style="color:#7F0000;text-style:italic">event</span>
			ChartViewer.setMouseWheelZoomRatio(<span style="color:#006532">1.1</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Configure</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">initial</span> <span style="color:#7F0000;text-style:italic">viewport</span>
			ChartViewer.setViewPortWidth(initialVisibleRange / initialFullRange)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Start</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">random</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">generator</span>
			InitRandomWalk
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">timer</span>
			ChartUpdateTimer.mode = timer.ModeMultiple
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">rate</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">100ms</span>
			ChartUpdateTimer.Period = <span style="color:#326598">100</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> drawChart(viewer <span style="color:#0000FF;font-weight: bold">as</span> ChartViewerCanvas)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">chart</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">start</span> <span style="color:#7F0000;text-style:italic">date</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">end</span> <span style="color:#7F0000;text-style:italic">date</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">visible</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart.</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> viewPortStartDate <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = viewer.getValueAtViewPort(<span style="color:#6500FE">&quot;x&quot;</span>, viewer.getViewPortLeft)
			<span style="color:#0000FF;font-weight: bold">Dim</span> viewPortEndDate   <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = viewer.getValueAtViewPort(<span style="color:#6500FE">&quot;x&quot;</span>, viewer.getViewPortLeft + viewer.getViewPortWidth)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Extract</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">part</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">arrays</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">visible.</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> viewPortTimeStamps() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> viewPortDataSeriesA() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> viewPortDataSeriesB() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">self</span>.currentIndex &gt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">array</span> <span style="color:#7F0000;text-style:italic">indexes</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">corresponds</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">visible</span> <span style="color:#7F0000;text-style:italic">start</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">end</span> <span style="color:#7F0000;text-style:italic">dates</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> startIndex <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Floor(CDXYChartMBS.bSearch(DoubleArray(<span style="color:#0000FF;font-weight: bold">self</span>.timeStamps, <span style="color:#0000FF;font-weight: bold">self</span>.currentIndex), viewPortStartDate))
				<span style="color:#0000FF;font-weight: bold">Dim</span> endIndex   <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> =  Ceil(CDXYChartMBS.bSearch(DoubleArray(<span style="color:#0000FF;font-weight: bold">self</span>.timeStamps, <span style="color:#0000FF;font-weight: bold">self</span>.currentIndex), viewPortEndDate))
				<span style="color:#0000FF;font-weight: bold">Dim</span> noOfPoints <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = endIndex - startIndex + <span style="color:#326598">1</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Extract</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">visible</span> <span style="color:#7F0000;text-style:italic">data</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">self</span>.timeStamps(endIndex) &gt;= viewPortStartDate) <span style="color:#0000FF;font-weight: bold">Then</span>
					viewPortTimeStamps  = DoubleArray(<span style="color:#0000FF;font-weight: bold">self</span>.timeStamps , noOfPoints, startIndex)
					viewPortDataSeriesA = DoubleArray(<span style="color:#0000FF;font-weight: bold">self</span>.dataSeriesA, noOfPoints, startIndex)
					viewPortDataSeriesB = DoubleArray(<span style="color:#0000FF;font-weight: bold">self</span>.dataSeriesB, noOfPoints, startIndex)
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Keep</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">latest</span> <span style="color:#7F0000;text-style:italic">available</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">plotting</span> <span style="color:#7F0000;text-style:italic">time</span>
				<span style="color:#0000FF;font-weight: bold">self</span>.trackLineEndPos = <span style="color:#0000FF;font-weight: bold">self</span>.timeStamps(<span style="color:#0000FF;font-weight: bold">self</span>.currentIndex - <span style="color:#326598">1</span>)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">At</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">stage,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">extracted</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">visible</span> <span style="color:#7F0000;text-style:italic">data.</span> <span style="color:#7F0000;text-style:italic">We</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">those</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart.</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			
			<span style="color:#7F0000;text-style:italic">//================================================================================</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Configure</span> <span style="color:#7F0000;text-style:italic">overall</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">appearance.</span>
			<span style="color:#7F0000;text-style:italic">//================================================================================</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Create</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">XYChart</span> <span style="color:#7F0000;text-style:italic">object</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">size</span> <span style="color:#7F0000;text-style:italic">640</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">350</span> <span style="color:#7F0000;text-style:italic">pixels</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> c <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> CDXYChartMBS(<span style="color:#326598">640</span>, <span style="color:#326598">350</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">2x</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">higher</span> <span style="color:#7F0000;text-style:italic">DPI</span> <span style="color:#7F0000;text-style:italic">displays</span>
			c.setOutputOptions(<span style="color:#6500FE">&quot;bmpscale=2&quot;</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">plotarea</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">(20,</span> <span style="color:#7F0000;text-style:italic">30)</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">41</span> <span style="color:#7F0000;text-style:italic">pixels</span> <span style="color:#7F0000;text-style:italic">less</span> <span style="color:#7F0000;text-style:italic">than</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">width,</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">height</span> <span style="color:#7F0000;text-style:italic">50</span> <span style="color:#7F0000;text-style:italic">pixels</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">less</span> <span style="color:#7F0000;text-style:italic">than</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">height.</span> <span style="color:#7F0000;text-style:italic">Use</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">vertical</span> <span style="color:#7F0000;text-style:italic">gradient</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">light</span> <span style="color:#7F0000;text-style:italic">blue</span> <span style="color:#7F0000;text-style:italic">(f0f6ff)</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">sky</span> <span style="color:#7F0000;text-style:italic">blue</span> <span style="color:#7F0000;text-style:italic">(a0c0ff)</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">background.</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">border</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">transparent</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">grid</span> <span style="color:#7F0000;text-style:italic">lines</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">white</span> <span style="color:#7F0000;text-style:italic">(ffffff).</span>
			<span style="color:#0000FF;font-weight: bold">Call</span> c.setPlotArea(<span style="color:#326598">20</span>, <span style="color:#326598">30</span>, c.getWidth - <span style="color:#326598">41</span>, c.getHeight - <span style="color:#326598">50</span>, c.linearGradientColor(<span style="color:#326598">0</span>, <span style="color:#326598">30</span>, <span style="color:#326598">0</span>, c.getHeight - <span style="color:#326598">50</span>, <span style="color:#326598">&amp;hf0f6ff</span>, <span style="color:#326598">&amp;ha0c0ff</span>), -<span style="color:#326598">1</span>, c.kTransparent, <span style="color:#326598">&amp;hffffff</span>, <span style="color:#326598">&amp;hffffff</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">As</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">lie</span> <span style="color:#7F0000;text-style:italic">outside</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">plotarea</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">zoomed</span> <span style="color:#7F0000;text-style:italic">chart,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">enable</span> <span style="color:#7F0000;text-style:italic">clipping.</span>
			c.setClipping
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">title</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">18pt</span> <span style="color:#7F0000;text-style:italic">Arial</span> <span style="color:#7F0000;text-style:italic">font</span>
			<span style="color:#0000FF;font-weight: bold">Call</span> c.addTitle(<span style="color:#6500FE">&quot;</span>   <span style="color:#6500FE">Multithreading</span> <span style="color:#6500FE">Real-Time</span> <span style="color:#6500FE">Chart&quot;</span>, <span style="color:#6500FE">&quot;arial.ttf&quot;</span>, <span style="color:#326598">18</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">legend</span> <span style="color:#7F0000;text-style:italic">box</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">(55,</span> <span style="color:#7F0000;text-style:italic">25)</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">horizontal</span> <span style="color:#7F0000;text-style:italic">layout.</span> <span style="color:#7F0000;text-style:italic">Use</span> <span style="color:#7F0000;text-style:italic">10pt</span> <span style="color:#7F0000;text-style:italic">Arial</span> <span style="color:#7F0000;text-style:italic">Bold</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">font.</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">background</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">border</span> <span style="color:#7F0000;text-style:italic">color</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">transparent</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">style</span> <span style="color:#7F0000;text-style:italic">legend</span> <span style="color:#7F0000;text-style:italic">key.</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> b <span style="color:#0000FF;font-weight: bold">As</span> CDLegendBoxMBS = c.addLegend(<span style="color:#326598">55</span>, <span style="color:#326598">25</span>, <span style="color:#0000FF;font-weight: bold">False</span>, <span style="color:#6500FE">&quot;arialbd.ttf&quot;</span>, <span style="color:#326598">10</span>)
			b.setBackground(c.kTransparent)
			b.setLineStyleKey
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">y</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">stems</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">transparent</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">font</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">10pt</span> <span style="color:#7F0000;text-style:italic">Arial</span>
			c.xAxis.setColors(c.kTransparent)
			c.yAxis.setColors(c.kTransparent)
			<span style="color:#0000FF;font-weight: bold">Call</span> c.xAxis.setLabelStyle(<span style="color:#6500FE">&quot;arial.ttf&quot;</span>, <span style="color:#326598">10</span>)
			<span style="color:#0000FF;font-weight: bold">Call</span> c.yAxis.setLabelStyle(<span style="color:#6500FE">&quot;arial.ttf&quot;</span>, <span style="color:#326598">10</span>, <span style="color:#326598">&amp;h336699</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">y-axis</span> <span style="color:#7F0000;text-style:italic">tick</span> <span style="color:#7F0000;text-style:italic">length</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">0</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">disable</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">tick</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">put</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">labels</span> <span style="color:#7F0000;text-style:italic">closer</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">axis.</span>
			c.yAxis.setTickLength(<span style="color:#326598">0</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">title</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">10pt</span> <span style="color:#7F0000;text-style:italic">Arial</span> <span style="color:#7F0000;text-style:italic">Bold</span> <span style="color:#7F0000;text-style:italic">Italic</span> <span style="color:#7F0000;text-style:italic">font</span>
			<span style="color:#0000FF;font-weight: bold">Call</span> c.yAxis.setTitle(<span style="color:#6500FE">&quot;Ionic</span> <span style="color:#6500FE">Temperature</span> <span style="color:#6500FE">(C)&quot;</span>, <span style="color:#6500FE">&quot;arialbd.ttf&quot;</span>, <span style="color:#326598">10</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Configure</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">y-axis</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">inside</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">above</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">horizontal</span> <span style="color:#7F0000;text-style:italic">grid</span> <span style="color:#7F0000;text-style:italic">lines</span>
			c.yAxis.setLabelGap(-<span style="color:#326598">1</span>)
			c.yAxis.setLabelAlignment(<span style="color:#326598">1</span>)
			c.yAxis.setMargin(<span style="color:#326598">20</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Configure</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">x-axis</span> <span style="color:#7F0000;text-style:italic">labels</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">left</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">vertical</span> <span style="color:#7F0000;text-style:italic">grid</span> <span style="color:#7F0000;text-style:italic">lines</span>
			c.xAxis.setLabelAlignment(<span style="color:#326598">1</span>)
			
			<span style="color:#7F0000;text-style:italic">//================================================================================</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">chart</span>
			<span style="color:#7F0000;text-style:italic">//================================================================================</span>
			
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">example,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">represent</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">lines.</span> <span style="color:#7F0000;text-style:italic">You</span> <span style="color:#7F0000;text-style:italic">may</span> <span style="color:#7F0000;text-style:italic">modify</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">code</span> <span style="color:#7F0000;text-style:italic">below</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">other</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">representations</span> <span style="color:#7F0000;text-style:italic">(areas,</span> <span style="color:#7F0000;text-style:italic">scatter</span> <span style="color:#7F0000;text-style:italic">plot,</span> <span style="color:#7F0000;text-style:italic">etc).</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">layer</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">lines,</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">2</span> <span style="color:#7F0000;text-style:italic">pixels</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> layer <span style="color:#0000FF;font-weight: bold">As</span> CDLineLayerMBS = c.addLineLayer
			layer.setLineWidth(<span style="color:#326598">2</span>)
			layer.setFastLineMode
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Now</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">add</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">2</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">series</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">layer</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">red</span> <span style="color:#7F0000;text-style:italic">(ff0000)</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">green</span> <span style="color:#7F0000;text-style:italic">(00cc00)</span> <span style="color:#7F0000;text-style:italic">colors</span>
			layer.setXData(viewPortTimeStamps)
			<span style="color:#0000FF;font-weight: bold">Call</span> layer.addDataSet(viewPortDataSeriesA, <span style="color:#326598">&amp;hff0000</span>, <span style="color:#6500FE">&quot;Alpha&quot;</span>)
			<span style="color:#0000FF;font-weight: bold">Call</span> layer.addDataSet(viewPortDataSeriesB, <span style="color:#326598">&amp;h00cc00</span>, <span style="color:#6500FE">&quot;Beta&quot;</span>)
			
			<span style="color:#7F0000;text-style:italic">//================================================================================</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Configure</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">scale</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">labelling</span>
			<span style="color:#7F0000;text-style:italic">//================================================================================</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">x-axis</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">date/time</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">scale</span> <span style="color:#7F0000;text-style:italic">according</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">view</span> <span style="color:#7F0000;text-style:italic">port</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">range.</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">self</span>.currentIndex &gt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				c.xAxis.setDateScale(viewPortStartDate, viewPortEndDate, <span style="color:#006532">5.0</span>)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">For</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">automatic</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">labels,</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">minimum</span> <span style="color:#7F0000;text-style:italic">spacing</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">75/30</span> <span style="color:#7F0000;text-style:italic">pixels</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">x/y</span> <span style="color:#7F0000;text-style:italic">axis.</span>
			c.xAxis.setTickDensity(<span style="color:#326598">75</span>)
			c.yAxis.setTickDensity(<span style="color:#326598">30</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">We</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">&quot;hh:nn:ss&quot;</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">format.</span>
			c.xAxis.setLabelFormat(<span style="color:#6500FE">&quot;{value|hh:nn:ss}&quot;</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">We</span> <span style="color:#7F0000;text-style:italic">make</span> <span style="color:#7F0000;text-style:italic">sure</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">tick</span> <span style="color:#7F0000;text-style:italic">increment</span> <span style="color:#7F0000;text-style:italic">must</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">least</span> <span style="color:#7F0000;text-style:italic">1</span> <span style="color:#7F0000;text-style:italic">second.</span>
			c.xAxis.setMinTickInc(<span style="color:#326598">1</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">auto-scale</span> <span style="color:#7F0000;text-style:italic">margin</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">0.05,</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">zero</span> <span style="color:#7F0000;text-style:italic">affinity</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">0.6</span>
			c.yAxis.setAutoScale(<span style="color:#006532">0.05</span>, <span style="color:#006532">0.05</span>, <span style="color:#006532">0.6</span>)
			
			<span style="color:#7F0000;text-style:italic">//================================================================================</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Output</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span>
			<span style="color:#7F0000;text-style:italic">//================================================================================</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">We</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">too.</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">moving</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">(eg.</span> <span style="color:#7F0000;text-style:italic">if</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">user</span> <span style="color:#7F0000;text-style:italic">drags</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">scroll</span> <span style="color:#7F0000;text-style:italic">it),</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">will</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">updated</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">MouseMovePlotArea</span> <span style="color:#7F0000;text-style:italic">event.</span> <span style="color:#7F0000;text-style:italic">Otherwise,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">here.</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Not</span> ChartViewer.isInMouseMoveEvent) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> x <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
				<span style="color:#0000FF;font-weight: bold">If</span> <span style="color:#0000FF;font-weight: bold">self</span>.trackLineIsAtEnd <span style="color:#0000FF;font-weight: bold">Then</span>
					x = c.getWidth
				<span style="color:#0000FF;font-weight: bold">Else</span>
					x = ChartViewer.getPlotAreaMouseX
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				<span style="color:#0000FF;font-weight: bold">Call</span> trackLineLabel(c, x)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">QChartViewer</span>
			
			viewer.setChart(c)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> drawFullChart(vpc <span style="color:#0000FF;font-weight: bold">as</span> ViewPortControl)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">full</span> <span style="color:#7F0000;text-style:italic">thumbnail</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">display</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">given</span> <span style="color:#7F0000;text-style:italic">QViewPortControl</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Create</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">XYChart</span> <span style="color:#7F0000;text-style:italic">object</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">size</span> <span style="color:#7F0000;text-style:italic">640</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">60</span> <span style="color:#7F0000;text-style:italic">pixels</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> c <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> CDXYChartMBS(<span style="color:#326598">640</span>, <span style="color:#326598">60</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">2x</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">higher</span> <span style="color:#7F0000;text-style:italic">DPI</span> <span style="color:#7F0000;text-style:italic">displays</span>
			c.setOutputOptions(<span style="color:#6500FE">&quot;bmpscale=2&quot;</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">plotarea</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">same</span> <span style="color:#7F0000;text-style:italic">horizontal</span> <span style="color:#7F0000;text-style:italic">position</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">main</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">alignment.</span>
			<span style="color:#0000FF;font-weight: bold">Call</span> c.setPlotArea(<span style="color:#326598">20</span>, <span style="color:#326598">0</span>, c.getWidth - <span style="color:#326598">41</span>, c.getHeight - <span style="color:#326598">1</span>, <span style="color:#326598">&amp;hc0d8ff</span>, -<span style="color:#326598">1</span>, <span style="color:#326598">&amp;hcccccc</span>, c.kTransparent, <span style="color:#326598">&amp;hffffff</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">stem</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">transparent</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">font</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">10pt</span> <span style="color:#7F0000;text-style:italic">Arial</span>
			c.xAxis.setColors(c.kTransparent)
			<span style="color:#0000FF;font-weight: bold">Call</span> c.xAxis.setLabelStyle(<span style="color:#6500FE">&quot;Arial&quot;</span>, <span style="color:#326598">10</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Put</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">x-axis</span> <span style="color:#7F0000;text-style:italic">labels</span> <span style="color:#7F0000;text-style:italic">inside</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">setting</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">negative</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">gap.</span> <span style="color:#7F0000;text-style:italic">Use</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">setLabelAlignment</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">put</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">right</span> <span style="color:#7F0000;text-style:italic">side</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">tick.</span>
			c.xAxis.setLabelGap(-<span style="color:#326598">1</span>)
			c.xAxis.setLabelAlignment(<span style="color:#326598">1</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">y</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">stem</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">labels</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">transparent</span> <span style="color:#7F0000;text-style:italic">(that</span> <span style="color:#7F0000;text-style:italic">is,</span> <span style="color:#7F0000;text-style:italic">hide</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">labels)</span>
			c.yAxis.setColors(c.kTransparent, c.kTransparent)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">layer</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">lines</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">fast</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">mode</span> <span style="color:#7F0000;text-style:italic">enabled</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> layer <span style="color:#0000FF;font-weight: bold">As</span> CDLineLayerMBS = c.addLineLayer
			layer.setFastLineMode
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Now</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">add</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">3</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">series</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">layer,</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">color</span> <span style="color:#7F0000;text-style:italic">red</span> <span style="color:#7F0000;text-style:italic">(&amp;hff3333),</span> <span style="color:#7F0000;text-style:italic">green</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">(&amp;h008800)</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">blue</span> <span style="color:#7F0000;text-style:italic">(&amp;h3333cc)</span>
			layer.setXData( DoubleArray(<span style="color:#0000FF;font-weight: bold">self</span>.timeStamps, <span style="color:#0000FF;font-weight: bold">self</span>.currentIndex) )
			<span style="color:#0000FF;font-weight: bold">Call</span> layer.addDataSet(DoubleArray(<span style="color:#0000FF;font-weight: bold">self</span>.dataSeriesA, <span style="color:#0000FF;font-weight: bold">self</span>.currentIndex), <span style="color:#326598">&amp;hff3333</span>)
			<span style="color:#0000FF;font-weight: bold">Call</span> layer.addDataSet(DoubleArray(<span style="color:#0000FF;font-weight: bold">Self</span>.dataSeriesB, <span style="color:#0000FF;font-weight: bold">Self</span>.currentIndex), <span style="color:#326598">&amp;h008800</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">scales</span> <span style="color:#7F0000;text-style:italic">should</span> <span style="color:#7F0000;text-style:italic">reflect</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">full</span> <span style="color:#7F0000;text-style:italic">range</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">view</span> <span style="color:#7F0000;text-style:italic">port</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> lowerLimit  <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = vpc.getViewer.getValueAtViewPort(<span style="color:#6500FE">&quot;x&quot;</span>, <span style="color:#326598">0</span>)
			<span style="color:#0000FF;font-weight: bold">Dim</span> higherLimit <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = vpc.getViewer.getValueAtViewPort(<span style="color:#6500FE">&quot;x&quot;</span>, <span style="color:#326598">1</span>)
			
			c.xAxis.setDateScale(lowerLimit, higherLimit, <span style="color:#326598">10</span>)
			c.xAxis.setLabelFormat(<span style="color:#6500FE">&quot;{value|nn:ss}&quot;</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">For</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">automatic</span> <span style="color:#7F0000;text-style:italic">x-axis</span> <span style="color:#7F0000;text-style:italic">labels,</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">minimum</span> <span style="color:#7F0000;text-style:italic">spacing</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">75</span> <span style="color:#7F0000;text-style:italic">pixels.</span>
			c.xAxis.setTickDensity(<span style="color:#326598">75</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">For</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">auto-scaled</span> <span style="color:#7F0000;text-style:italic">y-axis,</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">hide</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">labels,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">disable</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">rounding.</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">can</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">make</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">scale</span> <span style="color:#7F0000;text-style:italic">fit</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">tighter.</span>
			c.yAxis.setRounding(<span style="color:#0000FF;font-weight: bold">False</span>, <span style="color:#0000FF;font-weight: bold">False</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Output</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span>
			vpc.SetChart c
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> onChartUpdateTimer()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">queue,</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">viewport</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">display</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">necessary.</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> viewer <span style="color:#0000FF;font-weight: bold">As</span> ChartViewerCanvas = <span style="color:#0000FF;font-weight: bold">Self</span>.ChartViewer
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Enables</span> <span style="color:#7F0000;text-style:italic">auto</span> <span style="color:#7F0000;text-style:italic">scroll</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">viewport</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">showing</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">latest</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">before</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">update</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> autoScroll <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = <span style="color:#0000FF;font-weight: bold">False</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.currentIndex &gt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> value <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = viewer.getValueAtViewPort(<span style="color:#6500FE">&quot;x&quot;</span>, viewer.getViewPortLeft + viewer.getViewPortWidth)
				<span style="color:#0000FF;font-weight: bold">Dim</span> LastTimestamp <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#0000FF;font-weight: bold">Self</span>.timeStamps(<span style="color:#0000FF;font-weight: bold">Self</span>.currentIndex - <span style="color:#326598">1</span>)
				
				autoScroll = (<span style="color:#006532">0.001</span> + value &gt;= LastTimestamp)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">queue</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">append</span> <span style="color:#7F0000;text-style:italic">them</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">arrays</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> NewQueue() <span style="color:#0000FF;font-weight: bold">As</span> DataPacket
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">take</span> <span style="color:#7F0000;text-style:italic">old</span> <span style="color:#7F0000;text-style:italic">queue</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Packets() <span style="color:#0000FF;font-weight: bold">As</span> DataPacket = Queue
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">put</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">array</span> <span style="color:#7F0000;text-style:italic">there</span> <span style="color:#7F0000;text-style:italic">instead</span>
			Queue = NewQueue
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">now</span> <span style="color:#7F0000;text-style:italic">did</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">data?</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> count <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Packets.Ubound + <span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">If</span> count &lt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">arrays</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">insufficient</span> <span style="color:#7F0000;text-style:italic">space,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">remove</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">old</span> <span style="color:#7F0000;text-style:italic">data.</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.currentIndex + count &gt;= sampleSize) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">For</span> <span style="color:#7F0000;text-style:italic">safety,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">queue</span> <span style="color:#7F0000;text-style:italic">contains</span> <span style="color:#7F0000;text-style:italic">too</span> <span style="color:#7F0000;text-style:italic">much</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">than</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">entire</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">arrays.</span> <span style="color:#7F0000;text-style:italic">If</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">case,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">latest</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">completely</span> <span style="color:#7F0000;text-style:italic">fill</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">arrays.</span>
				<span style="color:#0000FF;font-weight: bold">While</span> (count &gt; sampleSize)
					packets.Remove(<span style="color:#326598">0</span>)
					count = count -<span style="color:#326598">1</span>
				<span style="color:#0000FF;font-weight: bold">Wend</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Remove</span> <span style="color:#7F0000;text-style:italic">oldest</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">leave</span> <span style="color:#7F0000;text-style:italic">space</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">data.</span> <span style="color:#7F0000;text-style:italic">To</span> <span style="color:#7F0000;text-style:italic">avoid</span> <span style="color:#7F0000;text-style:italic">frequent</span> <span style="color:#7F0000;text-style:italic">removal,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">ensure</span> <span style="color:#7F0000;text-style:italic">at</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">least</span> <span style="color:#7F0000;text-style:italic">5%</span> <span style="color:#7F0000;text-style:italic">empty</span> <span style="color:#7F0000;text-style:italic">space</span> <span style="color:#7F0000;text-style:italic">available</span> <span style="color:#7F0000;text-style:italic">after</span> <span style="color:#7F0000;text-style:italic">removal.</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> originalIndex <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#0000FF;font-weight: bold">Self</span>.currentIndex
				<span style="color:#0000FF;font-weight: bold">Self</span>.currentIndex = sampleSize * <span style="color:#326598">95</span> / <span style="color:#326598">100</span> - <span style="color:#326598">1</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.currentIndex &gt; sampleSize - count) <span style="color:#0000FF;font-weight: bold">Then</span>
					<span style="color:#0000FF;font-weight: bold">Self</span>.currentIndex = sampleSize - count
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				<span style="color:#0000FF;font-weight: bold">For</span> i <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">To</span> <span style="color:#0000FF;font-weight: bold">Self</span>.currentIndex - <span style="color:#326598">1</span>
					
					<span style="color:#0000FF;font-weight: bold">Dim</span> srcIndex <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = i + originalIndex - <span style="color:#0000FF;font-weight: bold">Self</span>.currentIndex
					<span style="color:#0000FF;font-weight: bold">Self</span>.timeStamps(i)  = <span style="color:#0000FF;font-weight: bold">Self</span>.timeStamps(srcIndex)
					<span style="color:#0000FF;font-weight: bold">Self</span>.dataSeriesA(i) = <span style="color:#0000FF;font-weight: bold">Self</span>.dataSeriesA(srcIndex)
					<span style="color:#0000FF;font-weight: bold">Self</span>.dataSeriesB(i) = <span style="color:#0000FF;font-weight: bold">Self</span>.dataSeriesB(srcIndex)
				<span style="color:#0000FF;font-weight: bold">Next</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Append</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">queue</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">arrays</span>
			<span style="color:#0000FF;font-weight: bold">For</span> n <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">To</span> count-<span style="color:#326598">1</span>
				<span style="color:#0000FF;font-weight: bold">self</span>.timeStamps(<span style="color:#0000FF;font-weight: bold">self</span>.currentIndex)  = packets(n).elapsedTime
				<span style="color:#0000FF;font-weight: bold">self</span>.dataSeriesA(<span style="color:#0000FF;font-weight: bold">self</span>.currentIndex) = packets(n).series0
				<span style="color:#0000FF;font-weight: bold">self</span>.dataSeriesB(<span style="color:#0000FF;font-weight: bold">self</span>.currentIndex) = packets(n).series1
				<span style="color:#0000FF;font-weight: bold">self</span>.currentIndex = <span style="color:#0000FF;font-weight: bold">self</span>.currentIndex + <span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">Next</span>
			
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">As</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">added</span> <span style="color:#7F0000;text-style:italic">more</span> <span style="color:#7F0000;text-style:italic">data,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">may</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">full</span> <span style="color:#7F0000;text-style:italic">range</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">viewport.</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> startDate <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#0000FF;font-weight: bold">self</span>.timeStamps(<span style="color:#326598">0</span>)
			<span style="color:#0000FF;font-weight: bold">Dim</span> endDate <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#0000FF;font-weight: bold">self</span>.timeStamps(<span style="color:#0000FF;font-weight: bold">self</span>.currentIndex - <span style="color:#326598">1</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Use</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">initialFullRange</span> <span style="color:#7F0000;text-style:italic">(which</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">60</span> <span style="color:#7F0000;text-style:italic">seconds</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">demo)</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">sufficient.</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> duration <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = endDate - startDate
			<span style="color:#0000FF;font-weight: bold">If</span> (duration &lt; initialFullRange) <span style="color:#0000FF;font-weight: bold">Then</span>
				endDate = startDate + initialFullRange
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">full</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">range</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">include</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">latest</span> <span style="color:#7F0000;text-style:italic">data</span>
			<span style="color:#0000FF;font-weight: bold">Const</span> KeepVisibleRange = <span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> axisScaleHasChanged <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = viewer.updateFullRangeH(<span style="color:#6500FE">&quot;x&quot;</span>, startDate, endDate, KeepVisibleRange)
			
			<span style="color:#0000FF;font-weight: bold">If</span> (autoScroll) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Scroll</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">viewport</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">necessary</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">display</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">latest</span> <span style="color:#7F0000;text-style:italic">data</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> viewPortEndPos <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = viewer.getViewPortAtValue(<span style="color:#6500FE">&quot;x&quot;</span>, <span style="color:#0000FF;font-weight: bold">Self</span>.timeStamps(<span style="color:#0000FF;font-weight: bold">Self</span>.currentIndex - <span style="color:#326598">1</span>))
				<span style="color:#0000FF;font-weight: bold">Dim</span> ViewPortLeft <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = viewer.getViewPortLeft
				<span style="color:#0000FF;font-weight: bold">Dim</span> ViewPortWidth <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = viewer.getViewPortWidth
				
				<span style="color:#0000FF;font-weight: bold">If</span> (viewPortEndPos &gt; ViewPortLeft + ViewPortWidth) <span style="color:#0000FF;font-weight: bold">Then</span>
					viewer.setViewPortLeft(viewPortEndPos - ViewPortWidth)
					axisScaleHasChanged = <span style="color:#0000FF;font-weight: bold">true</span>
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">limit</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">ratio</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">full</span> <span style="color:#7F0000;text-style:italic">range</span>
			viewer.setZoomInWidthLimit(zoomInLimit / (viewer.getValueAtViewPort(<span style="color:#6500FE">&quot;x&quot;</span>, <span style="color:#326598">1</span>) - viewer.getValueAtViewPort(<span style="color:#6500FE">&quot;x&quot;</span>, <span style="color:#326598">0</span>)))
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Trigger</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">viewPortChanged</span> <span style="color:#7F0000;text-style:italic">event.</span> <span style="color:#7F0000;text-style:italic">Updates</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">scale</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">changed</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">(scrolling</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">zooming)</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">added</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">existing</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">scale.</span>
			viewer.updateViewPort(axisScaleHasChanged <span style="color:#0000FF;font-weight: bold">Or</span> (duration &lt; initialFullRange), <span style="color:#0000FF;font-weight: bold">False</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> onData(r <span style="color:#0000FF;font-weight: bold">As</span> RandomWalk, currentTime <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, value1 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, value2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>)
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Handles</span> <span style="color:#7F0000;text-style:italic">realtime</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">RandomWalk.</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">RandomWalk</span> <span style="color:#7F0000;text-style:italic">will</span> <span style="color:#7F0000;text-style:italic">call</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">method</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">its</span> <span style="color:#7F0000;text-style:italic">own</span> <span style="color:#7F0000;text-style:italic">thread.</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">connect</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">event</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> p <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> DataPacket
			p.elapsedTime = currentTime
			p.series0 = value1
			p.series1 = value2
			
			Queue.Append p
			
			
			<span style="color:#0000FF">#Pragma</span> unused r
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> onMouseMovePlotArea(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">cursor</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">moving</span> <span style="color:#7F0000;text-style:italic">over</span> <span style="color:#7F0000;text-style:italic">plotarea</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> BaseChart <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS = ChartViewer.currentChart
			<span style="color:#0000FF;font-weight: bold">Dim</span> Chart <span style="color:#0000FF;font-weight: bold">As</span> CDXYChartMBS = CDXYChartMBS(BaseChart)
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> trackLinePos <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = trackLineLabel(Chart, ChartViewer.getPlotAreaMouseX)
			
			<span style="color:#0000FF;font-weight: bold">self</span>.trackLineIsAtEnd = (<span style="color:#0000FF;font-weight: bold">self</span>.currentIndex &lt;= <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">or</span> (trackLinePos = <span style="color:#0000FF;font-weight: bold">self</span>.trackLineEndPos)
			
			ChartViewer.updateDisplay
			
			
			
			<span style="color:#0000FF">#Pragma</span> unused MouseEvent
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> onMouseUsageChanged(mouseUsage <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Pointer/zoom</span> <span style="color:#7F0000;text-style:italic">in/zoom</span> <span style="color:#7F0000;text-style:italic">out</span> <span style="color:#7F0000;text-style:italic">button</span> <span style="color:#7F0000;text-style:italic">clicked</span>
			
			ChartViewer.setMouseUsage(mouseUsage)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> onSave()
			<span style="color:#0000FF;font-weight: bold">Dim</span> p <span style="color:#0000FF;font-weight: bold">As</span> Picture = ChartViewer.GetPicture
			
			<span style="color:#0000FF;font-weight: bold">If</span> p &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> f <span style="color:#0000FF;font-weight: bold">As</span> FolderItem = GetSaveFolderItem(FileTypes1.Png, <span style="color:#6500FE">&quot;chart.png&quot;</span>)
				
				<span style="color:#0000FF;font-weight: bold">If</span> f &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
					
					p.Save(f, Picture.SaveAsPNG)
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> onViewPortChanged()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">View</span> <span style="color:#7F0000;text-style:italic">port</span> <span style="color:#7F0000;text-style:italic">changed</span> <span style="color:#7F0000;text-style:italic">event</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">necessary</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (ChartViewer.needUpdateChart) <span style="color:#0000FF;font-weight: bold">Then</span>
				drawChart(ChartViewer)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">full</span> <span style="color:#7F0000;text-style:italic">chart</span>
			drawFullChart(ViewPortControl)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> trackLineLabel(c <span style="color:#0000FF;font-weight: bold">as</span> CDXYChartMBS, mouseX <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">point</span> <span style="color:#7F0000;text-style:italic">labels</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Clear</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">dynamic</span> <span style="color:#7F0000;text-style:italic">layer</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">DrawArea</span> <span style="color:#7F0000;text-style:italic">object</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">draw</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">it.</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> d <span style="color:#0000FF;font-weight: bold">As</span> CDDrawAreaMBS = c.initDynamicLayer
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area</span> <span style="color:#7F0000;text-style:italic">object</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> plotArea <span style="color:#0000FF;font-weight: bold">As</span> CDPlotAreaMBS = c.getPlotArea
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">x-value</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">nearest</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse,</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">find</span> <span style="color:#7F0000;text-style:italic">its</span> <span style="color:#7F0000;text-style:italic">pixel</span> <span style="color:#7F0000;text-style:italic">coordinate.</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> xValue <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = c.getNearestXValue(mouseX)
			<span style="color:#0000FF;font-weight: bold">Dim</span> xCoor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = c.getXCoor(xValue)
			<span style="color:#0000FF;font-weight: bold">If</span> (xCoor &lt; plotArea.getLeftX) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">Return</span> xValue
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">vertical</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">x-position</span>
			d.vline(plotArea.getTopY, plotArea.getBottomY, xCoor, <span style="color:#326598">&amp;h888888</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">x-axis</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">show</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">position.</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> xlabel <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			xlabel =          <span style="color:#6500FE">&quot;&lt;*font,bgColor=000000*&gt;</span> <span style="color:#6500FE">&quot;</span>
			xlabel = xlabel + c.xAxis.getFormattedLabel(xValue + <span style="color:#006532">0.00499</span>, <span style="color:#6500FE">&quot;hh:nn:ss.ff&quot;</span>)
			xlabel = xlabel + <span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&lt;*/font*&gt;&quot;</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> t <span style="color:#0000FF;font-weight: bold">As</span> CDTTFTextMBS = d.Text(xlabel, <span style="color:#6500FE">&quot;arialbd.ttf&quot;</span>, <span style="color:#326598">10</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Restrict</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">x-pixel</span> <span style="color:#7F0000;text-style:italic">position</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">make</span> <span style="color:#7F0000;text-style:italic">sure</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">stays</span> <span style="color:#7F0000;text-style:italic">inside</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image.</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> xLabelPos <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Max(<span style="color:#326598">0</span>, Min(xCoor - t.getWidth / <span style="color:#326598">2</span>, c.getWidth - t.getWidth))
			t.draw(xLabelPos, plotArea.getBottomY + <span style="color:#326598">2</span>, <span style="color:#326598">&amp;hffffff</span>)
			t.destroy
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Iterate</span> <span style="color:#7F0000;text-style:italic">through</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">layers</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">draw</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">labels</span>
			<span style="color:#0000FF;font-weight: bold">For</span> i <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">To</span> c.getLayerCount-<span style="color:#326598">1</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> layer <span style="color:#0000FF;font-weight: bold">As</span> CDLayerMBS = c.getLayerByZ(i)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">array</span> <span style="color:#7F0000;text-style:italic">index</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">x-value</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> xIndex <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = layer.getXIndexOf(xValue)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Iterate</span> <span style="color:#7F0000;text-style:italic">through</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">sets</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">layer</span>
				<span style="color:#0000FF;font-weight: bold">For</span> j <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">To</span> layer.getDataSetCount-<span style="color:#326598">1</span>
					
					<span style="color:#0000FF;font-weight: bold">Dim</span> dataSet <span style="color:#0000FF;font-weight: bold">As</span> CDDataSetMBS = layer.getDataSetByZ(j)
					<span style="color:#0000FF;font-weight: bold">Dim</span> dataSetName <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> = dataSet.getDataName
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">color,</span> <span style="color:#7F0000;text-style:italic">name</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">position</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">label</span>
					<span style="color:#0000FF;font-weight: bold">Dim</span> ColorValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = dataSet.getDataColor
					<span style="color:#0000FF;font-weight: bold">Dim</span> yCoor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = c.getYCoor(dataSet.getPosition(xIndex), dataSet.getUseYAxis)
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">dot</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">next</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">visible</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">points</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area</span>
					<span style="color:#0000FF;font-weight: bold">If</span> ((yCoor &gt;= plotArea.getTopY) <span style="color:#0000FF;font-weight: bold">And</span> (yCoor &lt;= plotArea.getBottomY) <span style="color:#0000FF;font-weight: bold">And</span> (ColorValue &lt;&gt; c.kTransparent) <span style="color:#0000FF;font-weight: bold">And</span> dataSetName.Len &gt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
						
						d.circle(xCoor, yCoor, <span style="color:#326598">4</span>, <span style="color:#326598">4</span>, ColorValue, ColorValue)
						
						<span style="color:#0000FF;font-weight: bold">Dim</span> label <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
						label =         <span style="color:#6500FE">&quot;&lt;*font,bgColor=&quot;</span>
						label = label + Right(<span style="color:#6500FE">&quot;000000&quot;</span>+Hex(ColorValue), <span style="color:#326598">6</span>)
						label = label + <span style="color:#6500FE">&quot;*&gt;</span> <span style="color:#6500FE">&quot;</span>
						label = label + c.formatValue(dataSet.getValue(xIndex), <span style="color:#6500FE">&quot;{value|P4}&quot;</span>)
						label = label + <span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&lt;*font*&gt;&quot;</span>
						
						t = d.Text(label, <span style="color:#6500FE">&quot;arialbd.ttf&quot;</span>, <span style="color:#326598">10</span>)
						
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">right</span> <span style="color:#7F0000;text-style:italic">side</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">dot</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">left</span> <span style="color:#7F0000;text-style:italic">side</span> <span style="color:#7F0000;text-style:italic">the</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">chart,</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">vice</span> <span style="color:#7F0000;text-style:italic">versa.</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">ensures</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">will</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">go</span> <span style="color:#7F0000;text-style:italic">outside</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image.</span>
						<span style="color:#0000FF;font-weight: bold">If</span> (xCoor &lt;= (plotArea.getLeftX + plotArea.getRightX) / <span style="color:#326598">2</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
							t.draw(xCoor + <span style="color:#326598">6</span>, yCoor, <span style="color:#326598">&amp;hffffff</span>, c.kLeft)
						<span style="color:#0000FF;font-weight: bold">Else</span>
							t.draw(xCoor - <span style="color:#326598">6</span>, yCoor, <span style="color:#326598">&amp;hffffff</span>, c.kRight)
						<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
						
						t.destroy
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">next</span>
			<span style="color:#0000FF;font-weight: bold">Next</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> xValue
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Queue() <span style="color:#0000FF;font-weight: bold">As</span> DataPacket</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ViewPortControl <span style="color:#0000FF;font-weight: bold">As</span> ViewPortControl</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> currentIndex <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> dataSeriesA() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> dataSeriesB() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> dataSource <span style="color:#0000FF;font-weight: bold">As</span> RandomWalk</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> fullChart <span style="color:#0000FF;font-weight: bold">As</span> CDXYChartMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> timeStamps() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> trackLineEndPos <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>
<div class="RB_Comment">			If the track cursor Is at the End Of the data series, we will automatic move the track line when new data arrives.</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> trackLineIsAtEnd <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
<div class="RB_Comment">			If the track cursor Is at the End Of the data series, we will automatic move the track line when new data arrives.</div></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar MainMenuBar</div>
<div class="RB_Code">		MenuItem FileMenu = <span style="color:#6500FE">&quot;&amp;File&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;#App.kFileQuit&quot;</span></div>
<div class="RB_Code">		MenuItem EditMenu = <span style="color:#6500FE">&quot;&amp;Edit&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;&amp;Undo&quot;</span></div>
<div class="RB_Code">			MenuItem EditSeparator1 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;Cu&amp;t&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;&amp;Copy&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;&amp;Paste&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;#App.kEditClear&quot;</span></div>
<div class="RB_Code">			MenuItem EditSeparator2 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditSelectAll = <span style="color:#6500FE">&quot;Select</span> <span style="color:#6500FE">&amp;All&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> RandomWalk <span style="color:#0000FF;font-weight: bold">Inherits</span> Thread</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> GotNewValues(currentTime <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>, value1 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>, value2 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Run()
			<span style="color:#0000FF;font-weight: bold">Dim</span> currentTime <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Int64</span> = <span style="color:#326598">0</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> nextTime <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Int64</span> = <span style="color:#326598">0</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Random</span> <span style="color:#7F0000;text-style:italic">walk</span> <span style="color:#7F0000;text-style:italic">variables</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> series0 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#326598">32</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> series1 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#326598">63</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> upperLimit <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#326598">94</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> scaleFactor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = Sqrt(interval * <span style="color:#006532">0.3</span>)
			<span style="color:#0000FF;font-weight: bold">Dim</span> r <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> Random
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Variables</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">keep</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">timing</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> startTime <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Int64</span> = Microseconds
			
			
			<span style="color:#0000FF;font-weight: bold">While</span> <span style="color:#0000FF;font-weight: bold">Not</span> stoppedThread
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Compute</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">next</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">value</span>
				currentTime = Microseconds - startTime
				
				series0 = Abs(series0 + (r.Number - <span style="color:#006532">0.5</span>) * scaleFactor)
				<span style="color:#0000FF;font-weight: bold">If</span> (series0 &gt; upperLimit) <span style="color:#0000FF;font-weight: bold">Then</span>
					series0 = upperLimit * <span style="color:#326598">2</span> - series0
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				series1 = Abs(series1 + (r.Number - <span style="color:#006532">0.5</span>) * scaleFactor)
				<span style="color:#0000FF;font-weight: bold">If</span> (series1 &gt; upperLimit) <span style="color:#0000FF;font-weight: bold">Then</span>
					series1 = upperLimit * <span style="color:#326598">2</span> - series1
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Call</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">handler</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> milliseconds <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = currentTime / <span style="color:#006532">1000.0</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> seconds <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = milliseconds / <span style="color:#006532">1000.0</span>
				<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> GotNewValues(seconds, series0, series1)
				<span style="color:#7F0000;text-style:italic">&#39;System.DebugLog</span> <span style="color:#7F0000;text-style:italic">Str(milliseconds,</span> <span style="color:#7F0000;text-style:italic">&quot;0.0&quot;)+&quot;</span> <span style="color:#7F0000;text-style:italic">&quot;+Str(series0)+&quot;</span> <span style="color:#7F0000;text-style:italic">&quot;+Str(series1)</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Sleep</span> <span style="color:#7F0000;text-style:italic">until</span> <span style="color:#7F0000;text-style:italic">next</span> <span style="color:#7F0000;text-style:italic">walk</span>
				nextTime = nextTime + interval
				<span style="color:#0000FF;font-weight: bold">If</span> (nextTime &lt;= currentTime) <span style="color:#0000FF;font-weight: bold">Then</span>
					nextTime = currentTime + interval
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> delta <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Int64</span> = (nextTime - currentTime)
				<span style="color:#0000FF;font-weight: bold">Me</span>.Sleep delta
				
				
			<span style="color:#0000FF;font-weight: bold">Wend</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> stopThread()
			stoppedThread = <span style="color:#0000FF;font-weight: bold">True</span>
			app.YieldToNextThread
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">wait</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">ending</span>
			<span style="color:#0000FF;font-weight: bold">While</span> <span style="color:#0000FF;font-weight: bold">Me</span>.State = <span style="color:#0000FF;font-weight: bold">Me</span>.Running
				app.YieldToNextThread
			<span style="color:#0000FF;font-weight: bold">Wend</span>
			
			
			stoppedThread = <span style="color:#0000FF;font-weight: bold">False</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> interval <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">100</span>
<div class="RB_Comment">			// The period of the data series in milliseconds. This random series implementation just use the 
			// windows timer for timing. In many computers, the default windows timer resolution is 1/64 sec,
			// or 15.6ms. This means the interval may not be exactly accurate.</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> stoppedThread <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> DataPacket</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> elapsedTime <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> series0 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> series1 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ChartViewerCanvas <span style="color:#0000FF;font-weight: bold">Inherits</span> ViewPortManagerCanvas</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> CLOCKS_PER_SEC = <span style="color:#326598">1000</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> MouseUsageDefault = <span style="color:#326598">0</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> MouseUsageScroll = <span style="color:#326598">1</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> MouseUsageZoomIn = <span style="color:#326598">3</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> MouseUsageZoomOut = <span style="color:#326598">4</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> NEED_DELAY = <span style="color:#326598">1</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> NEED_UPDATE = <span style="color:#326598">2</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> NO_DELAY = <span style="color:#326598">0</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> UNDEFINED_COOR = -<span style="color:#326598">1073741823</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> Open()
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> clicked(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> mouseLeaveChart(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> mouseLeavePlotArea(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> mouseMove(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> mouseMoveChart(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> mouseMovePlotArea(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> mouseWheel(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> viewPortChanged()
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> MouseDown(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> m <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MouseEvent(x,y)
			m.SetButton
			
			mousePressEvent(m)
			
			<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">True</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseDrag(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">Dim</span> m <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MouseEvent(x,y)
			m.SetButton
			
			mouseMoveEvent m
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseEnter()
			<span style="color:#7F0000;text-style:italic">&#39;Dim</span> <span style="color:#7F0000;text-style:italic">m</span> <span style="color:#7F0000;text-style:italic">As</span> <span style="color:#7F0000;text-style:italic">New</span> <span style="color:#7F0000;text-style:italic">MouseEvent(Self.Mousex,</span> <span style="color:#7F0000;text-style:italic">Self.MouseY)</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseExit()
			<span style="color:#0000FF;font-weight: bold">Dim</span> m <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MouseEvent(<span style="color:#0000FF;font-weight: bold">Self</span>.Mousex, <span style="color:#0000FF;font-weight: bold">Self</span>.MouseY)
			
			leaveEvent m
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseMove(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">Dim</span> m <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MouseEvent(x,y)
			
			mouseMoveEvent m
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseUp(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">Dim</span> m <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MouseEvent(x,y)
			m.SetButton
			
			mouseReleaseEvent(m)
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> MouseWheel(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, deltaX <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, deltaY <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> m <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MouseEvent(x,y)
			m.delta = deltay
			
			wheelEvent(m)
			
			
			
			<span style="color:#0000FF">#Pragma</span> Unused deltaX
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			ViewPortManager = <span style="color:#0000FF;font-weight: bold">New</span> CDViewPortManagerMBS
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">hot</span> <span style="color:#7F0000;text-style:italic">spot</span> <span style="color:#7F0000;text-style:italic">tester</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.currentChart = <span style="color:#0000FF;font-weight: bold">Nil</span>
			hotSpotTester = <span style="color:#0000FF;font-weight: bold">nil</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">initialize</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">configuration</span>
			selectBoxLineColor = &amp;c<span style="color:#FF0000">00</span><span style="color:#00FF00">00</span><span style="color:#0000FF">00</span>
			selectBoxLineWidth = <span style="color:#326598">2</span>
			mouseUsage = ChartViewerCanvas.MouseUsageDefault
			zoomDirection = CDBaseChartMBS.kDirectionHorizontal
			zoomInRatio = <span style="color:#326598">2</span>
			zoomOutRatio = <span style="color:#006532">0.5</span>
			mouseWheelZoomRatio = <span style="color:#326598">1</span>
			scrollDirection = CDBaseChartMBS.kDirectionHorizontal
			minDragAmount = <span style="color:#326598">5</span>
			updateInterval = <span style="color:#326598">20</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">state</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span>
			isOnPlotArea = <span style="color:#0000FF;font-weight: bold">false</span>
			isPlotAreaMouseDown = <span style="color:#0000FF;font-weight: bold">false</span>
			isDragScrolling = <span style="color:#0000FF;font-weight: bold">false</span>
			currentHotSpot = -<span style="color:#326598">1</span>
			isClickable = <span style="color:#0000FF;font-weight: bold">false</span>
			isMouseTracking = <span style="color:#0000FF;font-weight: bold">false</span>
			isInMouseMove = <span style="color:#0000FF;font-weight: bold">false</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">rate</span> <span style="color:#7F0000;text-style:italic">support</span>
			needUpdateChart = <span style="color:#0000FF;font-weight: bold">False</span>
			needUpdateImageMap = <span style="color:#0000FF;font-weight: bold">False</span>
			holdTimerActive = <span style="color:#0000FF;font-weight: bold">False</span>
			isInViewPortChanged = <span style="color:#0000FF;font-weight: bold">false</span>
			delayUpdateChart = NO_DELAY
			delayedChart = <span style="color:#0000FF;font-weight: bold">nil</span>
			lastMouseMove = <span style="color:#326598">0</span>
			delayedMouseEvent = <span style="color:#0000FF;font-weight: bold">nil</span>
			delayImageMapUpdate = <span style="color:#0000FF;font-weight: bold">false</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">cursor</span> <span style="color:#7F0000;text-style:italic">support</span>
			autoHideMsg = <span style="color:#6500FE">&quot;&quot;</span>
			currentMouseX = UNDEFINED_COOR
			currentMouseY = UNDEFINED_COOR
			isInMouseMovePlotArea = <span style="color:#0000FF;font-weight: bold">false</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">rectangle</span>
			<span style="color:#7F0000;text-style:italic">&#39;LeftLine</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">0</span>
			<span style="color:#7F0000;text-style:italic">&#39;RightLine</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">0</span>
			<span style="color:#7F0000;text-style:italic">&#39;TopLine</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">0</span>
			<span style="color:#7F0000;text-style:italic">&#39;BottomLine</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">0</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">xojo</span> <span style="color:#7F0000;text-style:italic">does</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">always</span>
			<span style="color:#7F0000;text-style:italic">&#39;setMouseTracking(True)</span>
			
			<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> Open
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Paint(g <span style="color:#0000FF;font-weight: bold">As</span> Graphics, areas() <span style="color:#0000FF;font-weight: bold">As</span> REALbasic.Rect)
			<span style="color:#0000FF;font-weight: bold">If</span> ChartPicture &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				g.DrawPicture ChartPicture, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, g.Width, g.height, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, ChartPicture.Width, ChartPicture.Height
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			
			<span style="color:#0000FF">#Pragma</span> Unused areas
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Calling</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">overridden</span> <span style="color:#7F0000;text-style:italic">superclass</span> <span style="color:#7F0000;text-style:italic">constructor.</span>
			<span style="color:#0000FF;font-weight: bold">Super</span>.Constructor
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> SetChart(c <span style="color:#0000FF;font-weight: bold">as</span> CDBaseChartMBS)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">control</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.currentChart = c
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> map <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">c.getHTMLImageMap(&quot;test&quot;)</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.setImageMap(map)
			
			<span style="color:#0000FF;font-weight: bold">If</span> c &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				commitPendingSyncAxis(c)
				
				<span style="color:#0000FF;font-weight: bold">If</span> delayUpdateChart &lt;&gt; NO_DELAY <span style="color:#0000FF;font-weight: bold">Then</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">render</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">now</span>
					<span style="color:#0000FF;font-weight: bold">Call</span> c.makeChart
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.updateDisplay
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> applyAutoHide(msg <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Attempt</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">hide</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">dynamic</span> <span style="color:#7F0000;text-style:italic">layer</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">specified</span> <span style="color:#7F0000;text-style:italic">message</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (autoHideMsg = msg) <span style="color:#0000FF;font-weight: bold">then</span>
				
				<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Nil</span> &lt;&gt; currentChart) <span style="color:#0000FF;font-weight: bold">Then</span>
					currentChart.removeDynamicLayer
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				autoHideMsg = <span style="color:#6500FE">&quot;&quot;</span>
				updateDisplay
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> clock() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">milliseconds</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> Microseconds / <span style="color:#006532">1000.0</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> commitMouseMove(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Remember</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">coordinates</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">later</span> <span style="color:#7F0000;text-style:italic">use</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.currentMouseX = MouseEvent.x
			<span style="color:#0000FF;font-weight: bold">Self</span>.currentMouseY = MouseEvent.y
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">updated</span> <span style="color:#7F0000;text-style:italic">more</span> <span style="color:#7F0000;text-style:italic">than</span> <span style="color:#7F0000;text-style:italic">once</span> <span style="color:#7F0000;text-style:italic">during</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">move.</span> <span style="color:#7F0000;text-style:italic">For</span> <span style="color:#7F0000;text-style:italic">example,</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">due</span> <span style="color:#7F0000;text-style:italic">to</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">drag</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">scroll,</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">also</span> <span style="color:#7F0000;text-style:italic">due</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">cursor.</span> <span style="color:#7F0000;text-style:italic">So</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">delay</span> <span style="color:#7F0000;text-style:italic">updating</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">display</span> <span style="color:#7F0000;text-style:italic">until</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">events</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">occured.</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.delayUpdateChart = NEED_DELAY
			<span style="color:#0000FF;font-weight: bold">Self</span>.isInMouseMove = <span style="color:#0000FF;font-weight: bold">True</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">dragging</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.isOnPlotArea = <span style="color:#0000FF;font-weight: bold">Self</span>.isPlotAreaMouseDown <span style="color:#0000FF;font-weight: bold">Or</span> inPlotArea(MouseEvent.x, MouseEvent.y)
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.isPlotAreaMouseDown) <span style="color:#0000FF;font-weight: bold">Then</span>
				onPlotAreaMouseDrag(MouseEvent)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Emit</span> <span style="color:#7F0000;text-style:italic">mouseMoveChart</span>
			<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> mouseMoveChart(MouseEvent)
			
			<span style="color:#0000FF;font-weight: bold">If</span> (inExtendedPlotArea(MouseEvent.x, MouseEvent.y)) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">extended</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area,</span> <span style="color:#7F0000;text-style:italic">emit</span> <span style="color:#7F0000;text-style:italic">mouseMovePlotArea</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.isInMouseMovePlotArea = <span style="color:#0000FF;font-weight: bold">True</span>
				<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> mouseMovePlotArea(MouseEvent)
				
			<span style="color:#0000FF;font-weight: bold">Elseif</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.isInMouseMovePlotArea) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Mouse</span> <span style="color:#7F0000;text-style:italic">was</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">extended</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area,</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">now,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">emit</span> <span style="color:#7F0000;text-style:italic">mouseLeavePlotArea</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.isInMouseMovePlotArea = <span style="color:#0000FF;font-weight: bold">False</span>
				<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> mouseLeavePlotArea(MouseEvent)
				applyAutoHide(<span style="color:#6500FE">&quot;mouseleaveplotarea&quot;</span>)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Show</span> <span style="color:#7F0000;text-style:italic">hot</span> <span style="color:#7F0000;text-style:italic">spot</span> <span style="color:#7F0000;text-style:italic">tool</span> <span style="color:#7F0000;text-style:italic">tips</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">necessary</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">(Due</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">QT</span> <span style="color:#7F0000;text-style:italic">bug,</span> <span style="color:#7F0000;text-style:italic">tooltip</span> <span style="color:#7F0000;text-style:italic">cannot</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">put</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">delayedMouseEvent,</span> <span style="color:#7F0000;text-style:italic">otherwise</span> <span style="color:#7F0000;text-style:italic">sometimes</span> <span style="color:#7F0000;text-style:italic">tooltip</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">position</span> <span style="color:#7F0000;text-style:italic">will</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">incorrect.)</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.delayImageMapUpdate) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#0000FF;font-weight: bold">Self</span>.delayImageMapUpdate = <span style="color:#0000FF;font-weight: bold">False</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Not</span> <span style="color:#0000FF;font-weight: bold">Self</span>.isPlotAreaMouseDown) <span style="color:#0000FF;font-weight: bold">Then</span>
					updateViewPort(<span style="color:#0000FF;font-weight: bold">False</span>, <span style="color:#0000FF;font-weight: bold">True</span>)
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			
			<span style="color:#0000FF;font-weight: bold">If</span> (MouseEvent.button &lt;&gt; MouseEvent.NoButton) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Hide</span> <span style="color:#7F0000;text-style:italic">tool</span> <span style="color:#7F0000;text-style:italic">tips</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">button</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">pressed.</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.HelpTag = <span style="color:#6500FE">&quot;&quot;</span>
				
				<span style="color:#0000FF;font-weight: bold">If</span> HelpLabel &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
					HelpLabel.Text = <span style="color:#6500FE">&quot;&quot;</span>
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">Else</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Use</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ChartDirector</span> <span style="color:#7F0000;text-style:italic">ImageMapHandler</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">determine</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">over</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">hot</span> <span style="color:#7F0000;text-style:italic">spot</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> hotSpotNo <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">0</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Nil</span> &lt;&gt; <span style="color:#0000FF;font-weight: bold">Self</span>.hotSpotTester) <span style="color:#0000FF;font-weight: bold">Then</span>
					hotSpotNo = <span style="color:#0000FF;font-weight: bold">Self</span>.hotSpotTester.getHotSpot(MouseEvent.x, MouseEvent.y)
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">same</span> <span style="color:#7F0000;text-style:italic">hot</span> <span style="color:#7F0000;text-style:italic">spot</span> <span style="color:#7F0000;text-style:italic">since</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">last</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">move</span> <span style="color:#7F0000;text-style:italic">event,</span> <span style="color:#7F0000;text-style:italic">there</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">no</span> <span style="color:#7F0000;text-style:italic">need</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">tool</span> <span style="color:#7F0000;text-style:italic">tip.</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (hotSpotNo &lt;&gt; <span style="color:#0000FF;font-weight: bold">Self</span>.currentHotSpot) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Hot</span> <span style="color:#7F0000;text-style:italic">spot</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">changed</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">tool</span> <span style="color:#7F0000;text-style:italic">tip</span> <span style="color:#7F0000;text-style:italic">text</span>
					<span style="color:#0000FF;font-weight: bold">Self</span>.currentHotSpot = hotSpotNo
					
					<span style="color:#0000FF;font-weight: bold">If</span> (hotSpotNo = <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
						
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">actually</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">hanlder</span> <span style="color:#7F0000;text-style:italic">hot</span> <span style="color:#7F0000;text-style:italic">spot</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">default</span> <span style="color:#7F0000;text-style:italic">tool</span> <span style="color:#7F0000;text-style:italic">tip</span> <span style="color:#7F0000;text-style:italic">text</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">reset</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">clickable</span> <span style="color:#7F0000;text-style:italic">flag.</span>
						
						<span style="color:#0000FF;font-weight: bold">Self</span>.HelpTag = <span style="color:#0000FF;font-weight: bold">Self</span>.defaultToolTip
						<span style="color:#0000FF;font-weight: bold">Self</span>.isClickable = <span style="color:#0000FF;font-weight: bold">False</span>
						
						<span style="color:#0000FF;font-weight: bold">If</span> HelpLabel &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
							HelpLabel.text = <span style="color:#0000FF;font-weight: bold">self</span>.defaultToolTip
						<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
						
					<span style="color:#0000FF;font-weight: bold">Else</span>
						
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">hot</span> <span style="color:#7F0000;text-style:italic">spot.</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">implementation,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">consider</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">hot</span> <span style="color:#7F0000;text-style:italic">spot</span> <span style="color:#7F0000;text-style:italic">as</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">clickable</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">its</span> <span style="color:#7F0000;text-style:italic">href</span> <span style="color:#7F0000;text-style:italic">(&quot;path&quot;)</span> <span style="color:#7F0000;text-style:italic">parameter</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">empty.</span>
						<span style="color:#0000FF;font-weight: bold">Dim</span> path <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> = <span style="color:#0000FF;font-weight: bold">Self</span>.hotSpotTester.getValue(<span style="color:#6500FE">&quot;path&quot;</span>)
						<span style="color:#0000FF;font-weight: bold">Self</span>.isClickable = (<span style="color:#6500FE">&quot;&quot;</span> &lt;&gt; path)
						
						<span style="color:#0000FF;font-weight: bold">Dim</span> s <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> = <span style="color:#0000FF;font-weight: bold">Self</span>.hotSpotTester.getValue(<span style="color:#6500FE">&quot;title&quot;</span>)
						<span style="color:#0000FF;font-weight: bold">Self</span>.HelpTag = s
						
						<span style="color:#0000FF;font-weight: bold">If</span> HelpLabel &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
							HelpLabel.Text = s
						<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
						
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Cancel</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">delayed</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">any</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.delayedMouseEvent &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				killTimer(delayedMouseEventTimerId)
				<span style="color:#0000FF;font-weight: bold">Self</span>.delayedMouseEvent = <span style="color:#0000FF;font-weight: bold">nil</span>
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Can</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">now</span>
			commitUpdateChart
			<span style="color:#0000FF;font-weight: bold">Self</span>.isInMouseMove = <span style="color:#0000FF;font-weight: bold">False</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.lastMouseMove = clock
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> commitUpdateChart()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Commit</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">display</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.delayUpdateChart = NEED_DELAY) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">No</span> <span style="color:#7F0000;text-style:italic">actual</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">occur</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.delayUpdateChart = NO_DELAY
				<span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">metrics</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> c <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS
			
			<span style="color:#0000FF;font-weight: bold">If</span> delayUpdateChart = NEED_UPDATE <span style="color:#0000FF;font-weight: bold">Then</span>
				c = <span style="color:#0000FF;font-weight: bold">Self</span>.delayedChart
			<span style="color:#0000FF;font-weight: bold">Else</span>
				c = <span style="color:#0000FF;font-weight: bold">Self</span>.currentChart
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> ChartMetrics <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> image <span style="color:#0000FF;font-weight: bold">as</span> Picture
			
			<span style="color:#0000FF;font-weight: bold">If</span> c &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Output</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">Device</span> <span style="color:#7F0000;text-style:italic">Indpendent</span> <span style="color:#7F0000;text-style:italic">Bitmap</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">file</span> <span style="color:#7F0000;text-style:italic">headers</span>
				
				image = c.makeChartPicture
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">metrics</span>
				ChartMetrics = c.getChartMetrics
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">QPixmap</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">display</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.ChartPicture = image
			<span style="color:#0000FF;font-weight: bold">Self</span>.Invalidate
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">metrics</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">clear</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">map</span>
			setChartMetrics(ChartMetrics)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Any</span> <span style="color:#7F0000;text-style:italic">delayed</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">been</span> <span style="color:#7F0000;text-style:italic">committed</span>
			<span style="color:#0000FF;font-weight: bold">self</span>.delayUpdateChart = NO_DELAY
			<span style="color:#0000FF;font-weight: bold">Self</span>.delayedChart = <span style="color:#0000FF;font-weight: bold">Nil</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> drawRect(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, width <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, height <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Create</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">edges</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">rectangle</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">already</span> <span style="color:#7F0000;text-style:italic">created</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">&lt;</span> <span style="color:#7F0000;text-style:italic">0</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">interpreted</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">rectangle</span> <span style="color:#7F0000;text-style:italic">extends</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">left</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">x.</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">height</span> <span style="color:#7F0000;text-style:italic">&lt;0</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">interpreted</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">rectangle</span> <span style="color:#7F0000;text-style:italic">extends</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">above</span> <span style="color:#7F0000;text-style:italic">y.</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (width &lt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				width = -width
				x = x - width
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (height &lt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				height = -height
				y = y - height
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Put</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">edges</span> <span style="color:#7F0000;text-style:italic">along</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">sides</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">rectangle</span>
			
			TopLine.X1 = <span style="color:#0000FF;font-weight: bold">Me</span>.Left + x
			TopLine.Y1 = <span style="color:#0000FF;font-weight: bold">Me</span>.top + y
			TopLine.X2 = TopLine.X1 + width
			TopLine.Y2 = TopLine.Y1
			TopLine.LineColor = selectBoxLineColor
			TopLine.BorderWidth = selectBoxLineWidth
			
			LeftLine.X1 = <span style="color:#0000FF;font-weight: bold">Me</span>.Left + x
			LeftLine.Y1 = <span style="color:#0000FF;font-weight: bold">Me</span>.top + y
			LeftLine.X2 = LeftLine.X1
			LeftLine.Y2 = LeftLine.Y1 + height
			LeftLine.LineColor = selectBoxLineColor
			LeftLine.BorderWidth = selectBoxLineWidth
			
			BottomLine.X1 = <span style="color:#0000FF;font-weight: bold">Me</span>.Left + x
			BottomLine.Y1 = <span style="color:#0000FF;font-weight: bold">Me</span>.top + y + height - selectBoxLineWidth + <span style="color:#326598">1</span>
			BottomLine.X2 = BottomLine.X1 + width
			BottomLine.Y2 = BottomLine.Y1
			BottomLine.LineColor = selectBoxLineColor
			BottomLine.BorderWidth = selectBoxLineWidth
			
			RightLine.X1 = <span style="color:#0000FF;font-weight: bold">Me</span>.Left + x + width - selectBoxLineWidth + <span style="color:#326598">1</span>
			RightLine.Y1 = <span style="color:#0000FF;font-weight: bold">Me</span>.top + y
			RightLine.X2 = RightLine.X1
			RightLine.Y2 = RightLine.Y1 + height
			RightLine.LineColor = selectBoxLineColor
			RightLine.BorderWidth = selectBoxLineWidth
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getChart() <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">back</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">same</span> <span style="color:#7F0000;text-style:italic">BaseChart</span> <span style="color:#7F0000;text-style:italic">pointer</span> <span style="color:#7F0000;text-style:italic">provided</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">previous</span> <span style="color:#7F0000;text-style:italic">setChart</span> <span style="color:#7F0000;text-style:italic">call.</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">self</span>.currentChart
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getChartMouseX() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">coordinate</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">used</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">move</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">handler</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> ret <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = currentMouseX
			
			<span style="color:#0000FF;font-weight: bold">If</span> (ret = UNDEFINED_COOR) <span style="color:#0000FF;font-weight: bold">then</span>
				ret = <span style="color:#0000FF;font-weight: bold">self</span>.getPlotAreaLeft + <span style="color:#0000FF;font-weight: bold">self</span>.getPlotAreaWidth
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> ret
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getChartMouseY() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">y</span> <span style="color:#7F0000;text-style:italic">coordinate</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">used</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">move</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">handler</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> ret <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = currentMouseY
			
			<span style="color:#0000FF;font-weight: bold">If</span> ret = UNDEFINED_COOR <span style="color:#0000FF;font-weight: bold">then</span>
				ret = <span style="color:#0000FF;font-weight: bold">Self</span>.getPlotAreaTop + <span style="color:#0000FF;font-weight: bold">Self</span>.getPlotAreaHeight
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> ret
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getImageMapHandler() <span style="color:#0000FF;font-weight: bold">As</span> CDImageMapHandlerMBS
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">map</span> <span style="color:#7F0000;text-style:italic">handler</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> hotSpotTester
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getMinimumDrag() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">minimum</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">drag</span> <span style="color:#7F0000;text-style:italic">before</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">dragging</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">considered</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">real.</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> minDragAmount
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getMouseUsage() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> mouseUsage
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getMouseWheelZoomRatio() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">wheel</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">ratio</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> mouseWheelZoomRatio
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getPicture() <span style="color:#0000FF;font-weight: bold">As</span> Picture
			<span style="color:#0000FF;font-weight: bold">If</span> ChartPicture &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Return</span> ChartPicture
			<span style="color:#0000FF;font-weight: bold">Else</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">needed</span>
				<span style="color:#0000FF;font-weight: bold">Return</span> currentChart.makeChartPicture
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getPlotAreaMouseX() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">coordinate</span> <span style="color:#7F0000;text-style:italic">bounded</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">used</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">handler</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> ret <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = getChartMouseX
			
			<span style="color:#0000FF;font-weight: bold">If</span> (ret &lt; getPlotAreaLeft) <span style="color:#0000FF;font-weight: bold">then</span>
				ret = getPlotAreaLeft
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (ret &gt; getPlotAreaLeft + getPlotAreaWidth) <span style="color:#0000FF;font-weight: bold">Then</span>
				ret = getPlotAreaLeft + getPlotAreaWidth
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> ret
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getPlotAreaMouseY() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">y</span> <span style="color:#7F0000;text-style:italic">coordinate</span> <span style="color:#7F0000;text-style:italic">bounded</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">used</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">handler</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> ret <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = getChartMouseY
			
			<span style="color:#0000FF;font-weight: bold">If</span> (ret &lt; getPlotAreaTop) <span style="color:#0000FF;font-weight: bold">Then</span>
				ret = getPlotAreaTop
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (ret &gt; getPlotAreaTop + getPlotAreaHeight)  <span style="color:#0000FF;font-weight: bold">Then</span>
				ret = getPlotAreaTop + getPlotAreaHeight
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> ret
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getScrollDirection() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">scroll</span> <span style="color:#7F0000;text-style:italic">direction</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> scrollDirection
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getSelectionBorderColor() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">color</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">border</span> <span style="color:#7F0000;text-style:italic">color</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">box.</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> selectBoxLineColor
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getSelectionBorderWidth() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> selectBoxLineWidth
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getUpdateInterval() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">minimum</span> <span style="color:#7F0000;text-style:italic">interval</span> <span style="color:#7F0000;text-style:italic">between</span> <span style="color:#7F0000;text-style:italic">ViewPortChanged</span> <span style="color:#7F0000;text-style:italic">events.</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">Self</span>.updateInterval
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getZoomDirection() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">direction</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> zoomDirection
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getZoomInRatio() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">zoom-in</span> <span style="color:#7F0000;text-style:italic">ratio</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">click</span> <span style="color:#7F0000;text-style:italic">zoom-in</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> zoomInRatio
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getZoomOutRatio() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">zoom-out</span> <span style="color:#7F0000;text-style:italic">ratio</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> zoomOutRatio
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> initRect()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Create</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">edges</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">rectangle</span>
			
			<span style="color:#7F0000;text-style:italic">&#39;LeftLine</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">New</span> <span style="color:#7F0000;text-style:italic">QLabel(this);</span>
			<span style="color:#7F0000;text-style:italic">&#39;LeftLine.setAutoFillBackground(True);</span>
			<span style="color:#7F0000;text-style:italic">&#39;RightLine</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">New</span> <span style="color:#7F0000;text-style:italic">QLabel(this);</span>
			<span style="color:#7F0000;text-style:italic">&#39;RightLine.setAutoFillBackground(True);</span>
			<span style="color:#7F0000;text-style:italic">&#39;TopLine</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">New</span> <span style="color:#7F0000;text-style:italic">QLabel(this);</span>
			<span style="color:#7F0000;text-style:italic">&#39;TopLine.setAutoFillBackground(True);</span>
			<span style="color:#7F0000;text-style:italic">&#39;BottomLine</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">New</span> <span style="color:#7F0000;text-style:italic">QLabel(this);</span>
			<span style="color:#7F0000;text-style:italic">&#39;BottomLine.setAutoFillBackground(True);</span>
			
			setSelectionBorderColor(getSelectionBorderColor)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> isDrag(direction <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Determines</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">dragging.</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">We</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">consider</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">dragging</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">dragged</span> <span style="color:#7F0000;text-style:italic">more</span> <span style="color:#7F0000;text-style:italic">than</span> <span style="color:#7F0000;text-style:italic">self.minDragAmount.</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">is</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">avoid</span> <span style="color:#7F0000;text-style:italic">small</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">vibrations</span> <span style="color:#7F0000;text-style:italic">triggering</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">drag.</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> spanX <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Abs(MouseEvent.X - <span style="color:#0000FF;font-weight: bold">self</span>.plotAreaMouseDownXPos)
			<span style="color:#0000FF;font-weight: bold">Dim</span> spanY <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Abs(MouseEvent.Y - <span style="color:#0000FF;font-weight: bold">Self</span>.plotAreaMouseDownYPos)
			
			<span style="color:#0000FF;font-weight: bold">Return</span> _
					((direction &lt;&gt; CDBaseChartMBS.kDirectionVertical  ) <span style="color:#0000FF;font-weight: bold">And</span> (spanX &gt;= minDragAmount)) <span style="color:#0000FF;font-weight: bold">Or</span> _
					((direction &lt;&gt; CDBaseChartMBS.kDirectionHorizontal) <span style="color:#0000FF;font-weight: bold">And</span> (spanY &gt;= minDragAmount))
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> isInMouseMoveEvent() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">currently</span> <span style="color:#7F0000;text-style:italic">processing</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">move</span> <span style="color:#7F0000;text-style:italic">event</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">self</span>.isInMouseMove
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> isInViewPortChangedEvent() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">currently</span> <span style="color:#7F0000;text-style:italic">processing</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">view</span> <span style="color:#7F0000;text-style:italic">port</span> <span style="color:#7F0000;text-style:italic">changed</span> <span style="color:#7F0000;text-style:italic">event</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> isInViewPortChanged
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> isMouseDragging() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">dragging</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">scroll</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">select</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">rectangle</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> isPlotAreaMouseDown
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> isMouseOnPlotArea() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">extended</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (isMouseTracking) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Return</span> inExtendedPlotArea(getChartMouseX, getChartMouseY)
			<span style="color:#0000FF;font-weight: bold">Else</span>
				<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">False</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> killTimer(<span style="color:#0000FF;font-weight: bold">byref</span> t <span style="color:#0000FF;font-weight: bold">as</span> timer)
			<span style="color:#0000FF;font-weight: bold">If</span> t &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				t.Mode = timer.ModeOff
				t = <span style="color:#0000FF;font-weight: bold">Nil</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> leaveEvent(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Process</span> <span style="color:#7F0000;text-style:italic">delayed</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">move,</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">any</span>
			onDelayedMouseMove
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Mouse</span> <span style="color:#7F0000;text-style:italic">tracking</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">no</span> <span style="color:#7F0000;text-style:italic">longer</span> <span style="color:#7F0000;text-style:italic">active</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.isMouseTracking = <span style="color:#0000FF;font-weight: bold">false</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">self</span>.isInMouseMovePlotArea) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Mouse</span> <span style="color:#7F0000;text-style:italic">was</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">extended</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area,</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">now,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">emit</span> <span style="color:#7F0000;text-style:italic">mouseLeavePlotArea</span>
				<span style="color:#0000FF;font-weight: bold">self</span>.isInMouseMovePlotArea = <span style="color:#0000FF;font-weight: bold">false</span>
				<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> mouseLeavePlotArea(MouseEvent)
				applyAutoHide(<span style="color:#6500FE">&quot;mouseleaveplotarea&quot;</span>)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">emit</span> <span style="color:#7F0000;text-style:italic">mouseLeaveChart</span>
			<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> mouseLeaveChart(MouseEvent)
			applyAutoHide(<span style="color:#6500FE">&quot;mouseleavechart&quot;</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> mouseMoveEvent(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Enable</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">tracking</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">detect</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">leave</span> <span style="color:#7F0000;text-style:italic">events</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.isMouseTracking = <span style="color:#0000FF;font-weight: bold">True</span>
			
			<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> mouseMove(MouseEvent)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">On</span> <span style="color:#7F0000;text-style:italic">Windows,</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">events</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">by-pass</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">queue.</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">there</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">too</span> <span style="color:#7F0000;text-style:italic">many</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">events,</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">queue</span> <span style="color:#7F0000;text-style:italic">may</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">processed,</span> <span style="color:#7F0000;text-style:italic">preventing</span> <span style="color:#7F0000;text-style:italic">other</span> <span style="color:#7F0000;text-style:italic">controls</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">updating.</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">two</span> <span style="color:#7F0000;text-style:italic">mouse</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">events</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">less</span> <span style="color:#7F0000;text-style:italic">than</span> <span style="color:#7F0000;text-style:italic">10ms</span> <span style="color:#7F0000;text-style:italic">apart,</span> <span style="color:#7F0000;text-style:italic">there</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">risk</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">too</span> <span style="color:#7F0000;text-style:italic">many</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">events.</span> <span style="color:#7F0000;text-style:italic">So</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">repost</span> <span style="color:#7F0000;text-style:italic">the</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">timer</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">queued</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">normally,</span> <span style="color:#7F0000;text-style:italic">allowing</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">queue</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">processed.</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> timeBetweenMouseMove <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = ((clock) - <span style="color:#0000FF;font-weight: bold">Self</span>.lastMouseMove) * <span style="color:#326598">1000</span> / CLOCKS_PER_SEC
			
			<span style="color:#0000FF;font-weight: bold">If</span> ((<span style="color:#0000FF;font-weight: bold">Self</span>.delayedMouseEvent &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">And</span> (timeBetweenMouseMove &lt; <span style="color:#326598">250</span>)) <span style="color:#0000FF;font-weight: bold">Or</span> (timeBetweenMouseMove &lt; <span style="color:#326598">10</span>)) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Nil</span> = <span style="color:#0000FF;font-weight: bold">Self</span>.delayedMouseEvent) <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">Self</span>.delayedMouseEventTimerId = startTimer(<span style="color:#326598">1</span>)
				<span style="color:#0000FF;font-weight: bold">Else</span>
					<span style="color:#0000FF;font-weight: bold">Self</span>.delayedMouseEvent = <span style="color:#0000FF;font-weight: bold">Nil</span>
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				<span style="color:#0000FF;font-weight: bold">Self</span>.delayedMouseEvent = MouseEvent
			<span style="color:#0000FF;font-weight: bold">Else</span>
				commitMouseMove(MouseEvent)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			onSetCursor
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> mousePressEvent(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Mouse</span> <span style="color:#7F0000;text-style:italic">button</span> <span style="color:#7F0000;text-style:italic">down</span> <span style="color:#7F0000;text-style:italic">event.</span>
			
			onDelayedMouseMove
			
			<span style="color:#0000FF;font-weight: bold">If</span> ((MouseEvent.button = MouseEvent.LeftButton) <span style="color:#0000FF;font-weight: bold">And</span> inPlotArea(MouseEvent.x, MouseEvent.y) <span style="color:#0000FF;font-weight: bold">And</span> (mouseUsage &lt;&gt; MouseUsageDefault)) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Mouse</span> <span style="color:#7F0000;text-style:italic">usage</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">drag</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">zoom/scroll.</span> <span style="color:#7F0000;text-style:italic">Capture</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">prepare</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">dragging</span> <span style="color:#7F0000;text-style:italic">and</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">save</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">down</span> <span style="color:#7F0000;text-style:italic">position</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">draw</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">rectangle.</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.isPlotAreaMouseDown = <span style="color:#0000FF;font-weight: bold">True</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.plotAreaMouseDownXPos = MouseEvent.x
				<span style="color:#0000FF;font-weight: bold">Self</span>.plotAreaMouseDownYPos = MouseEvent.y
				startDrag
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> mouseReleaseEvent(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Mouse</span> <span style="color:#7F0000;text-style:italic">button</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">event.</span>
			
			onDelayedMouseMove
			
			<span style="color:#0000FF;font-weight: bold">If</span> ((MouseEvent.button = MouseEvent.LeftButton) <span style="color:#0000FF;font-weight: bold">and</span> <span style="color:#0000FF;font-weight: bold">self</span>.isPlotAreaMouseDown) <span style="color:#0000FF;font-weight: bold">then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Release</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">capture.</span>
				<span style="color:#0000FF;font-weight: bold">self</span>.isPlotAreaMouseDown = <span style="color:#0000FF;font-weight: bold">false</span>
				setRectVisible(<span style="color:#0000FF;font-weight: bold">False</span>)
				<span style="color:#0000FF;font-weight: bold">Dim</span> hasUpdate <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = <span style="color:#0000FF;font-weight: bold">False</span>
				
				<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#0000FF;font-weight: bold">Self</span>.mouseUsage
					
				<span style="color:#0000FF;font-weight: bold">Case</span> MouseUsageZoomIn
					<span style="color:#0000FF;font-weight: bold">If</span> (canZoomIn(<span style="color:#0000FF;font-weight: bold">Self</span>.zoomDirection)) <span style="color:#0000FF;font-weight: bold">Then</span>
						<span style="color:#0000FF;font-weight: bold">If</span> (isDrag(<span style="color:#0000FF;font-weight: bold">Self</span>.zoomDirection, MouseEvent)) <span style="color:#0000FF;font-weight: bold">Then</span>
							<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">drag</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">rectangle.</span>
							hasUpdate = zoomTo(<span style="color:#0000FF;font-weight: bold">Self</span>.zoomDirection, <span style="color:#0000FF;font-weight: bold">Self</span>.plotAreaMouseDownXPos, <span style="color:#0000FF;font-weight: bold">Self</span>.plotAreaMouseDownYPos, MouseEvent.x, MouseEvent.y)
						<span style="color:#0000FF;font-weight: bold">Else</span>
							<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">User</span> <span style="color:#7F0000;text-style:italic">just</span> <span style="color:#7F0000;text-style:italic">click</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">point.</span> <span style="color:#7F0000;text-style:italic">Zoom-in</span> <span style="color:#7F0000;text-style:italic">around</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">cursor</span> <span style="color:#7F0000;text-style:italic">position.</span>
							hasUpdate = zoomAt(<span style="color:#0000FF;font-weight: bold">Self</span>.zoomDirection, MouseEvent.x, MouseEvent.y, <span style="color:#0000FF;font-weight: bold">Self</span>.zoomInRatio)
						<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
					
				<span style="color:#0000FF;font-weight: bold">Case</span> MouseUsageZoomOut
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">out</span> <span style="color:#7F0000;text-style:italic">around</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">cursor</span> <span style="color:#7F0000;text-style:italic">position.</span>
					<span style="color:#0000FF;font-weight: bold">If</span> (canZoomOut(<span style="color:#0000FF;font-weight: bold">Self</span>.zoomDirection)) <span style="color:#0000FF;font-weight: bold">Then</span>
						hasUpdate = zoomAt(<span style="color:#0000FF;font-weight: bold">Self</span>.zoomDirection, MouseEvent.x, MouseEvent.y, <span style="color:#0000FF;font-weight: bold">Self</span>.zoomOutRatio)
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
					
				<span style="color:#0000FF;font-weight: bold">Else</span>
					
					<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.isDragScrolling) <span style="color:#0000FF;font-weight: bold">Then</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Drag</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">scroll.</span> <span style="color:#7F0000;text-style:italic">We</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">map</span> <span style="color:#7F0000;text-style:italic">now</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">scrolling</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">finished.</span>
						updateViewPort(<span style="color:#0000FF;font-weight: bold">False</span>, <span style="color:#0000FF;font-weight: bold">True</span>)
					<span style="color:#0000FF;font-weight: bold">Else</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">zooming</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">scrolling,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">just</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">normal</span> <span style="color:#7F0000;text-style:italic">click</span> <span style="color:#7F0000;text-style:italic">event.</span>
						<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> clicked(MouseEvent)
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
				
				<span style="color:#0000FF;font-weight: bold">self</span>.isDragScrolling = <span style="color:#0000FF;font-weight: bold">false</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (hasUpdate) <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">View</span> <span style="color:#7F0000;text-style:italic">port</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">changed</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">it.</span>
					updateViewPort(<span style="color:#0000FF;font-weight: bold">True</span>, <span style="color:#0000FF;font-weight: bold">True</span>)
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">Else</span>
				<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> clicked(MouseEvent)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			onSetCursor
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> onDelayedMouseMove()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Delayed</span> <span style="color:#7F0000;text-style:italic">MouseMove</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">handler</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (delayedMouseEvent &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				commitMouseMove(<span style="color:#0000FF;font-weight: bold">Self</span>.delayedMouseEvent)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> onMouseWheelZoom(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, zDelta <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Handles</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">wheel</span> <span style="color:#7F0000;text-style:italic">zooming</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">ratio</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">1</span> <span style="color:#7F0000;text-style:italic">means</span> <span style="color:#7F0000;text-style:italic">no</span> <span style="color:#7F0000;text-style:italic">zooming</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.mouseWheelZoomRatio = <span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">False</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">X</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">Y</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">ratios</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> rx <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> ry <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (getZoomDirection &lt;&gt; CDBaseChartMBS.kDirectionVertical) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">If</span> zDelta = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">Then</span>
					
				<span style="color:#0000FF;font-weight: bold">elseIf</span> (zDelta &gt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					rx = <span style="color:#0000FF;font-weight: bold">Self</span>.mouseWheelZoomRatio
				<span style="color:#0000FF;font-weight: bold">Else</span>
					rx = <span style="color:#006532">1.0</span> / <span style="color:#0000FF;font-weight: bold">Self</span>.mouseWheelZoomRatio
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (getZoomDirection &lt;&gt; CDBaseChartMBS.kDirectionHorizontal) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">If</span> zDelta = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">Then</span>
					
				<span style="color:#0000FF;font-weight: bold">elseIf</span> (zDelta &gt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					ry = <span style="color:#0000FF;font-weight: bold">Self</span>.mouseWheelZoomRatio
				<span style="color:#0000FF;font-weight: bold">Else</span>
					ry = <span style="color:#006532">1.0</span> / <span style="color:#0000FF;font-weight: bold">Self</span>.mouseWheelZoomRatio
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Do</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">zooming</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (zoomAround(x, y, rx, ry)) <span style="color:#0000FF;font-weight: bold">Then</span>
				updateViewPort(<span style="color:#0000FF;font-weight: bold">True</span>, <span style="color:#0000FF;font-weight: bold">True</span>)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">True</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> onPlotAreaMouseDrag(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
			<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> mouseUsage
				
			<span style="color:#0000FF;font-weight: bold">Case</span> MouseUsageZoomIn
				
				<span style="color:#7F0000;text-style:italic">//</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">used</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">in.</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">rectangle</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">necessary.</span>
				<span style="color:#7F0000;text-style:italic">//</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> isDragZoom <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = canZoomIn(zoomDirection) <span style="color:#0000FF;font-weight: bold">And</span> isDrag(zoomDirection, MouseEvent)
				<span style="color:#0000FF;font-weight: bold">If</span> (isDragZoom) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					<span style="color:#0000FF;font-weight: bold">Dim</span> spanX <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = plotAreaMouseDownXPos - MouseEvent.x
					<span style="color:#0000FF;font-weight: bold">Dim</span> spanY <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = plotAreaMouseDownYPos - MouseEvent.y
					
					<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> zoomDirection
						
					<span style="color:#0000FF;font-weight: bold">Case</span> CDBaseChartMBS.kDirectionHorizontal
						drawRect(MouseEvent.x, getPlotAreaTop, spanX, getPlotAreaHeight)
						
					<span style="color:#0000FF;font-weight: bold">Case</span> CDBaseChartMBS.kDirectionVertical
						drawRect(getPlotAreaLeft, MouseEvent.y, getPlotAreaWidth, spanY)
						
					<span style="color:#0000FF;font-weight: bold">Else</span>
						drawRect(MouseEvent.x, MouseEvent.y, spanX, spanY)
						
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				setRectVisible(isDragZoom)
				
			<span style="color:#0000FF;font-weight: bold">Case</span> MouseUsageScroll
				
				<span style="color:#7F0000;text-style:italic">//</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">used</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">drag</span> <span style="color:#7F0000;text-style:italic">scrolling.</span> <span style="color:#7F0000;text-style:italic">Scroll</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">view</span> <span style="color:#7F0000;text-style:italic">port.</span>
				<span style="color:#7F0000;text-style:italic">//</span>
				
				<span style="color:#0000FF;font-weight: bold">If</span> (isDragScrolling <span style="color:#0000FF;font-weight: bold">Or</span> isDrag(scrollDirection, MouseEvent)) <span style="color:#0000FF;font-weight: bold">Then</span>
					isDragScrolling = <span style="color:#0000FF;font-weight: bold">True</span>
					<span style="color:#0000FF;font-weight: bold">If</span> (dragTo(scrollDirection, MouseEvent.x - plotAreaMouseDownXPos, MouseEvent.y - plotAreaMouseDownYPos)) <span style="color:#0000FF;font-weight: bold">then</span>
						updateViewPort(<span style="color:#0000FF;font-weight: bold">True</span>, <span style="color:#0000FF;font-weight: bold">False</span>)
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> onSetCursor()
			<span style="color:#0000FF;font-weight: bold">If</span> isDragScrolling <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> scrollDirection
				<span style="color:#0000FF;font-weight: bold">Case</span> CDBaseChartMBS.kDirectionHorizontal
					<span style="color:#0000FF;font-weight: bold">Me</span>.MouseCursor = System.Cursors.ArrowEastWest
				<span style="color:#0000FF;font-weight: bold">Case</span> CDBaseChartMBS.kDirectionVertical
					<span style="color:#0000FF;font-weight: bold">Me</span>.MouseCursor = System.Cursors.ArrowNorthSouth
				<span style="color:#0000FF;font-weight: bold">Else</span>
					<span style="color:#0000FF;font-weight: bold">Me</span>.MouseCursor = System.Cursors.StandardPointer
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
				<span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> isOnPlotArea <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">select</span> <span style="color:#0000FF;font-weight: bold">case</span> mouseUsage
					
				<span style="color:#0000FF;font-weight: bold">Case</span> MouseUsageZoomIn
					
					<span style="color:#0000FF;font-weight: bold">If</span> (canZoomIn(zoomDirection)) <span style="color:#0000FF;font-weight: bold">Then</span>
						<span style="color:#0000FF;font-weight: bold">Me</span>.MouseCursor = System.Cursors.MagnifyLarger
					<span style="color:#0000FF;font-weight: bold">Else</span>
						<span style="color:#0000FF;font-weight: bold">Me</span>.MouseCursor = System.Cursors.FingerPointer
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
					
					<span style="color:#0000FF;font-weight: bold">Return</span>
				<span style="color:#0000FF;font-weight: bold">Case</span> MouseUsageZoomOut
					<span style="color:#0000FF;font-weight: bold">If</span> (canZoomOut(zoomDirection)) <span style="color:#0000FF;font-weight: bold">Then</span>
						<span style="color:#0000FF;font-weight: bold">Me</span>.MouseCursor = System.Cursors.MagnifySmaller
					<span style="color:#0000FF;font-weight: bold">Else</span>
						<span style="color:#0000FF;font-weight: bold">Me</span>.MouseCursor = System.Cursors.FingerPointer
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
					
					<span style="color:#0000FF;font-weight: bold">Return</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">Select</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> isClickable <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Me</span>.MouseCursor = System.Cursors.FingerPointer
			<span style="color:#0000FF;font-weight: bold">Else</span>
				<span style="color:#0000FF;font-weight: bold">Me</span>.MouseCursor = <span style="color:#0000FF;font-weight: bold">Nil</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> removeDynamicLayer(msg <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">message</span> <span style="color:#7F0000;text-style:italic">used</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">remove</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">dynamic</span> <span style="color:#7F0000;text-style:italic">layer</span>
			
			autoHideMsg = msg.Lowercase
			
			<span style="color:#0000FF;font-weight: bold">If</span> autoHideMsg = <span style="color:#6500FE">&quot;now&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				applyAutoHide(msg)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setDefaultToolTip(d <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">default</span> <span style="color:#7F0000;text-style:italic">tool</span> <span style="color:#7F0000;text-style:italic">tip</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">use</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.defaultToolTip = d
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setImageMap(imageMap <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">map</span> <span style="color:#7F0000;text-style:italic">used</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			
			<span style="color:#7F0000;text-style:italic">//delete</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">existing</span> <span style="color:#7F0000;text-style:italic">ImageMapHandler</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.currentHotSpot = -<span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.isClickable = <span style="color:#0000FF;font-weight: bold">False</span>
			
			<span style="color:#7F0000;text-style:italic">//create</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">ImageMapHandler</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">represent</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">map</span>
			<span style="color:#0000FF;font-weight: bold">If</span> imageMap = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.hotSpotTester = <span style="color:#0000FF;font-weight: bold">Nil</span>
			<span style="color:#0000FF;font-weight: bold">Else</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.hotSpotTester = <span style="color:#0000FF;font-weight: bold">New</span> CDImageMapHandlerMBS(imageMap)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setMinimumDrag(offset <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">minimum</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">drag</span> <span style="color:#7F0000;text-style:italic">before</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">dragging</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">considered</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">real.</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">avoid</span> <span style="color:#7F0000;text-style:italic">small</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">vibrations</span> <span style="color:#7F0000;text-style:italic">triggering</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">drag.</span>
			
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.minDragAmount = offset
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setMouseUsage(m <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">usage</span> <span style="color:#7F0000;text-style:italic">mode</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.mouseUsage = m
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setMouseWheelZoomRatio(ratio <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">wheel</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">ratio</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.mouseWheelZoomRatio = ratio
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setRectVisible(b <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Show/hide</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">rectangle</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Create</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">edges</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">rectangle</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">already</span> <span style="color:#7F0000;text-style:italic">created</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Show/hide</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">edges</span>
			<span style="color:#0000FF;font-weight: bold">If</span> TopLine &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				
				TopLine.Visible = b
				LeftLine.Visible = b
				BottomLine.Visible = b
				RightLine.Visible = b
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setScrollDirection(value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">scroll</span> <span style="color:#7F0000;text-style:italic">direction</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.scrollDirection = value
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setSelectionBorderColor(c <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">color</span>)
			<span style="color:#0000FF;font-weight: bold">Self</span>.selectBoxLineColor = c
			
			<span style="color:#0000FF;font-weight: bold">If</span> TopLine &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				TopLine.LineColor = c
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> LeftLine &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				LeftLine.LineColor = c
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> RightLine &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				RightLine.LineColor = c
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> BottomLine &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				BottomLine.LineColor = c
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setSelectionBorderWidth(width <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">border</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">box</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.selectBoxLineWidth = width
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setUpdateInterval(interval <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">minimum</span> <span style="color:#7F0000;text-style:italic">interval</span> <span style="color:#7F0000;text-style:italic">between</span> <span style="color:#7F0000;text-style:italic">ViewPortChanged</span> <span style="color:#7F0000;text-style:italic">events.</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">avoid</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">being</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">updated</span> <span style="color:#7F0000;text-style:italic">too</span> <span style="color:#7F0000;text-style:italic">frequently.</span> <span style="color:#7F0000;text-style:italic">(Default</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">20ms</span> <span style="color:#7F0000;text-style:italic">between</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">updates.)</span> <span style="color:#7F0000;text-style:italic">Multiple</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">events</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">arrived</span> <span style="color:#7F0000;text-style:italic">during</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">interval</span> <span style="color:#7F0000;text-style:italic">will</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">merged</span> <span style="color:#7F0000;text-style:italic">into</span> <span style="color:#7F0000;text-style:italic">one</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">executed</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">end</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">interval.</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.updateInterval = interval
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setZoomDirection(value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">direction</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.zoomDirection = value
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setZoomInRatio(value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">zoom-in</span> <span style="color:#7F0000;text-style:italic">ratio</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">click</span> <span style="color:#7F0000;text-style:italic">zoom-in</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.zoomInRatio = value
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setZoomOutRatio(value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">zoom-out</span> <span style="color:#7F0000;text-style:italic">ratio</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.zoomOutRatio = value
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> startTimer(Interval <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> timer
			<span style="color:#0000FF;font-weight: bold">Dim</span> t <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> timer
			
			<span style="color:#0000FF;font-weight: bold">AddHandler</span> t.Action, WeakAddressOf timerEvent
			
			t.Period = Interval
			t.Mode = timer.ModeMultiple
			
			<span style="color:#0000FF;font-weight: bold">Return</span> t
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> timerEvent(timerId <span style="color:#0000FF;font-weight: bold">as</span> timer)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Chart</span> <span style="color:#7F0000;text-style:italic">hold</span> <span style="color:#7F0000;text-style:italic">timer.</span>
			
			
			<span style="color:#0000FF;font-weight: bold">If</span> (delayedMouseEvent &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">and</span> (timerId = delayedMouseEventTimerId)) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Is</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">delayed</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">move</span> <span style="color:#7F0000;text-style:italic">event</span>
				onDelayedMouseMove
				
			<span style="color:#0000FF;font-weight: bold">Elseif</span> (holdTimerActive <span style="color:#0000FF;font-weight: bold">And</span> (timerId = holdTimerId)) <span style="color:#0000FF;font-weight: bold">then</span>
				
				holdTimerId.mode = timer.ModeOff
				holdTimerActive = <span style="color:#0000FF;font-weight: bold">False</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">pending</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">request,</span> <span style="color:#7F0000;text-style:italic">handles</span> <span style="color:#7F0000;text-style:italic">them</span> <span style="color:#7F0000;text-style:italic">now.</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">self</span>.needUpdateChart <span style="color:#0000FF;font-weight: bold">Or</span> <span style="color:#0000FF;font-weight: bold">self</span>.needUpdateImageMap) <span style="color:#0000FF;font-weight: bold">Then</span>
					updateViewPort(<span style="color:#0000FF;font-weight: bold">self</span>.needUpdateChart, <span style="color:#0000FF;font-weight: bold">self</span>.needUpdateImageMap)
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> updateDisplay()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">display</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> delayUpdateChart = NO_DELAY <span style="color:#0000FF;font-weight: bold">Then</span>
				commitUpdateChart
			<span style="color:#0000FF;font-weight: bold">Else</span>
				
				delayUpdateChart = NEED_UPDATE
				
				delayedChart = currentChart
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> updateViewPort(NeedUpdateChartParam <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>, needUpdateImageMapParam <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Trigger</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ViewPortChanged</span> <span style="color:#7F0000;text-style:italic">event</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Already</span> <span style="color:#7F0000;text-style:italic">updating,</span> <span style="color:#7F0000;text-style:italic">no</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">again</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.isInViewPortChanged) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Merge</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">requests</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">any</span> <span style="color:#7F0000;text-style:italic">pending</span> <span style="color:#7F0000;text-style:italic">requests.</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.needUpdateChart = <span style="color:#0000FF;font-weight: bold">Self</span>.needUpdateChart <span style="color:#0000FF;font-weight: bold">Or</span> needUpdateChartParam
			<span style="color:#0000FF;font-weight: bold">self</span>.needUpdateImageMap = needUpdateImageMapParam
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Hold</span> <span style="color:#7F0000;text-style:italic">timer</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">expired,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">do</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">immediately.</span> <span style="color:#7F0000;text-style:italic">Keep</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">requests</span> <span style="color:#7F0000;text-style:italic">pending.</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.holdTimerActive) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">updated</span> <span style="color:#7F0000;text-style:italic">more</span> <span style="color:#7F0000;text-style:italic">than</span> <span style="color:#7F0000;text-style:italic">once</span> <span style="color:#7F0000;text-style:italic">during</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">move.</span> <span style="color:#7F0000;text-style:italic">For</span> <span style="color:#7F0000;text-style:italic">example,</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">due</span> <span style="color:#7F0000;text-style:italic">to</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">drag</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">scroll,</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">also</span> <span style="color:#7F0000;text-style:italic">due</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">track</span> <span style="color:#7F0000;text-style:italic">cursor.</span> <span style="color:#7F0000;text-style:italic">So</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">delay</span> <span style="color:#7F0000;text-style:italic">updating</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">display</span> <span style="color:#7F0000;text-style:italic">until</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">updates</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">occured.</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> hasDelayUpdate <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = (<span style="color:#0000FF;font-weight: bold">Self</span>.delayUpdateChart &lt;&gt; NO_DELAY)
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Not</span> hasDelayUpdate) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.delayUpdateChart = NEED_DELAY
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Can</span> <span style="color:#7F0000;text-style:italic">trigger</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ViewPortChanged</span> <span style="color:#7F0000;text-style:italic">event.</span>
			validateViewPort
			<span style="color:#0000FF;font-weight: bold">Self</span>.isInViewPortChanged = <span style="color:#0000FF;font-weight: bold">True</span>
			<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> viewPortChanged
			<span style="color:#0000FF;font-weight: bold">Self</span>.isInViewPortChanged = <span style="color:#0000FF;font-weight: bold">False</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Can</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">now</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Not</span> hasDelayUpdate) <span style="color:#0000FF;font-weight: bold">Then</span>
				commitUpdateChart
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Clear</span> <span style="color:#7F0000;text-style:italic">any</span> <span style="color:#7F0000;text-style:italic">pending</span> <span style="color:#7F0000;text-style:italic">updates.</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.needUpdateChart = <span style="color:#0000FF;font-weight: bold">False</span>
			<span style="color:#0000FF;font-weight: bold">self</span>.needUpdateImageMap = <span style="color:#0000FF;font-weight: bold">False</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">hold</span> <span style="color:#7F0000;text-style:italic">timer</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">prevent</span> <span style="color:#7F0000;text-style:italic">multiple</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">updates</span> <span style="color:#7F0000;text-style:italic">within</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">short</span> <span style="color:#7F0000;text-style:italic">period.</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.updateInterval &gt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.holdTimerActive = <span style="color:#0000FF;font-weight: bold">True</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.holdTimerId = startTimer(<span style="color:#0000FF;font-weight: bold">self</span>.updateInterval)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> wheelEvent(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
			<span style="color:#0000FF;font-weight: bold">Dim</span> hasReceivers <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = <span style="color:#0000FF;font-weight: bold">True</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">receivers(SIGNAL(mouseWheel(QWheelEvent</span> <span style="color:#7F0000;text-style:italic">*)))</span> <span style="color:#7F0000;text-style:italic">&gt;</span> <span style="color:#7F0000;text-style:italic">0;</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (hasReceivers) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Process</span> <span style="color:#7F0000;text-style:italic">delayed</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">move,</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">any</span>
				onDelayedMouseMove
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">emit</span> <span style="color:#7F0000;text-style:italic">mouseWheel</span> <span style="color:#7F0000;text-style:italic">event</span>
				<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> mouseWheel(MouseEvent)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Process</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">wheel</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">over</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> hasMouseWheelZoom <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = isMouseOnPlotArea <span style="color:#0000FF;font-weight: bold">And</span> onMouseWheelZoom(getPlotAreaMouseX, getPlotAreaMouseY, MouseEvent.delta)
			
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">not</span> (hasReceivers <span style="color:#0000FF;font-weight: bold">or</span> hasMouseWheelZoom)) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">ignore</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> BottomLine <span style="color:#0000FF;font-weight: bold">As</span> Line</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ChartPicture <span style="color:#0000FF;font-weight: bold">As</span> Picture</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> HelpLabel <span style="color:#0000FF;font-weight: bold">As</span> label</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> LeftLine <span style="color:#0000FF;font-weight: bold">As</span> Line</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> RightLine <span style="color:#0000FF;font-weight: bold">As</span> Line</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> TopLine <span style="color:#0000FF;font-weight: bold">As</span> Line</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> autoHideMsg <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">string</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> currentChart <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS
<div class="RB_Comment">			// Current BaseChart object</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> currentHotSpot <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
<div class="RB_Comment">			// The hot spot under the mouse cursor.</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> currentMouseX <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
<div class="RB_Comment">			// Get the mouse x-pixel coordinate</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> currentMouseY <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
<div class="RB_Comment">			// Get the mouse y-pixel coordinate</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> defaultToolTip <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">string</span>
<div class="RB_Comment">			// Default tool tip text</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> delayImageMapUpdate <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> delayUpdateChart <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> delayedChart <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> delayedMouseEvent <span style="color:#0000FF;font-weight: bold">As</span> MouseEvent</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> delayedMouseEventTimerId <span style="color:#0000FF;font-weight: bold">As</span> Timer</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> holdTimerActive <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
<div class="RB_Comment">			// Delay chart update to limit update frequency</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> holdTimerId <span style="color:#0000FF;font-weight: bold">As</span> timer</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> hotSpotTester <span style="color:#0000FF;font-weight: bold">As</span> CDImageMapHandlerMBS
<div class="RB_Comment">			// ImageMapHander representing the image map</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> isClickable <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
<div class="RB_Comment">			// Mouse is over a clickable hot spot.</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> isDragScrolling <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
<div class="RB_Comment">			// Is current dragging scrolling the chart.</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> isInMouseMove <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
<div class="RB_Comment">			// Is in mouse moeve event handler</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> isInMouseMovePlotArea <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
<div class="RB_Comment">			// flag to indicate if is in a mouse move plot area event.</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> isInViewPortChanged <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> isMouseTracking <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
<div class="RB_Comment">			// Is tracking mouse leave event</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> isOnPlotArea <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
<div class="RB_Comment">			// Mouse is over the plot area.</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> isPlotAreaMouseDown <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
<div class="RB_Comment">			// Mouse left button is down in the plot area.</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> lastMouseMove <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> minDragAmount <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
<div class="RB_Comment">			// Minimum drag amount</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> mouseUsage <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
<div class="RB_Comment">			// Mouse usage mode</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> mouseWheelZoomRatio <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>
<div class="RB_Comment">			// Mouse wheel zoom ratio</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> needUpdateChart <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
<div class="RB_Comment">			// Has pending chart update request</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> needUpdateImageMap <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
<div class="RB_Comment">			// Has pending image map udpate request</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> plotAreaMouseDownXPos <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> plotAreaMouseDownYPos <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> scrollDirection <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
<div class="RB_Comment">			// Scroll direction</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> selectBoxLineColor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">color</span>
<div class="RB_Comment">			// Selectiom box border color</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> selectBoxLineWidth <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
<div class="RB_Comment">			// Selectiom box border width</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> updateInterval <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
<div class="RB_Comment">			// Minimum interval between chart updates</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> zoomDirection <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
<div class="RB_Comment">			// Zoom direction</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> zoomInRatio <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>
<div class="RB_Comment">			// Click zoom in ratio</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> zoomOutRatio <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>
<div class="RB_Comment">			// Click zoom out ratio</div></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Module</span> UtilModule</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> DoubleArray(values() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>, Count <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Offset <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>()
			<span style="color:#0000FF;font-weight: bold">Dim</span> u <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = values.Ubound
			<span style="color:#0000FF;font-weight: bold">Dim</span> c <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = u + <span style="color:#326598">1</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> Offset = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">And</span> c = count <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">full</span> <span style="color:#7F0000;text-style:italic">array</span>
				<span style="color:#0000FF;font-weight: bold">Return</span> values
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> r() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			u = Offset + count - <span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">For</span> i <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Offset <span style="color:#0000FF;font-weight: bold">To</span> u
				r.Append values(i)
			<span style="color:#0000FF;font-weight: bold">Next</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> r
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Module</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ViewPortControl <span style="color:#0000FF;font-weight: bold">Inherits</span> CDViewPortControlBaseMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Close()
			<span style="color:#0000FF;font-weight: bold">If</span> <span style="color:#0000FF;font-weight: bold">Self</span>.output &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.output.ViewPortControl = <span style="color:#0000FF;font-weight: bold">Nil</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.Output = <span style="color:#0000FF;font-weight: bold">Nil</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.viewer = <span style="color:#0000FF;font-weight: bold">Nil</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Calling</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">overridden</span> <span style="color:#7F0000;text-style:italic">superclass</span> <span style="color:#7F0000;text-style:italic">constructor.</span>
			<span style="color:#0000FF;font-weight: bold">Super</span>.Constructor
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.Viewer = <span style="color:#0000FF;font-weight: bold">Nil</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.mouseDownX = <span style="color:#326598">0</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.mouseDownY = <span style="color:#326598">0</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getChart() <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">back</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">same</span> <span style="color:#7F0000;text-style:italic">BaseChart</span> <span style="color:#7F0000;text-style:italic">pointer</span> <span style="color:#7F0000;text-style:italic">provided</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">previous</span> <span style="color:#7F0000;text-style:italic">setChart</span> <span style="color:#7F0000;text-style:italic">call.</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">Self</span>.Chart
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getViewer() <span style="color:#0000FF;font-weight: bold">As</span> ChartViewerCanvas
			<span style="color:#0000FF;font-weight: bold">Return</span> viewer
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> isDrag(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Determines</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">dragging.</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> viewer = <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">False</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> minimumDrag <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = viewer.getMinimumDrag
			<span style="color:#0000FF;font-weight: bold">Dim</span> moveX <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Abs(<span style="color:#0000FF;font-weight: bold">Self</span>.mouseDownX - MouseEvent.x)
			<span style="color:#0000FF;font-weight: bold">Dim</span> moveY <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Abs(<span style="color:#0000FF;font-weight: bold">Self</span>.mouseDownY - MouseEvent.y)
			<span style="color:#0000FF;font-weight: bold">Return</span> (moveX &gt;= minimumDrag) <span style="color:#0000FF;font-weight: bold">Or</span> (moveY &gt;= minimumDrag)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> mouseMoveEvent(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">MouseMove</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">handler</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">QChartViewer</span> <span style="color:#7F0000;text-style:italic">zoom/scroll</span> <span style="color:#7F0000;text-style:italic">state</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">determine</span> <span style="color:#7F0000;text-style:italic">which</span> <span style="color:#7F0000;text-style:italic">type</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">action</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">allowed</span>
			syncState
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Handle</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">move</span> <span style="color:#7F0000;text-style:italic">event</span>
			handleMouseMove(toImageX(MouseEvent.x), toImageY(MouseEvent.y), isDrag(MouseEvent))
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">viewer</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">viewport</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">changed</span>
			updateChartViewerIfNecessary
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">cursor</span>
			updateCursor(<span style="color:#0000FF;font-weight: bold">Self</span>.Cursor)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">display</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (needUpdateDisplay) <span style="color:#0000FF;font-weight: bold">Then</span>
				paintDisplay
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> mousePressEvent(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Mouse</span> <span style="color:#7F0000;text-style:italic">button</span> <span style="color:#7F0000;text-style:italic">down</span> <span style="color:#7F0000;text-style:italic">event.</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (MouseEvent.button &lt;&gt; MouseEvent.LeftButton) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Remember</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">position</span>
			<span style="color:#0000FF;font-weight: bold">Self</span>.mouseDownX = MouseEvent.x
			<span style="color:#0000FF;font-weight: bold">self</span>.mouseDownY = MouseEvent.y
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">QChartViewer</span> <span style="color:#7F0000;text-style:italic">zoom/scroll</span> <span style="color:#7F0000;text-style:italic">state</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">determine</span> <span style="color:#7F0000;text-style:italic">which</span> <span style="color:#7F0000;text-style:italic">type</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">action</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">allowed</span>
			syncState
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Handle</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">down</span> <span style="color:#7F0000;text-style:italic">event</span>
			handleMouseDown(toImageX(MouseEvent.x), toImageY(MouseEvent.y))
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">viewer</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">viewport</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">changed</span>
			updateChartViewerIfNecessary
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> mouseReleaseEvent(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Mouse</span> <span style="color:#7F0000;text-style:italic">button</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">event.</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (MouseEvent.button &lt;&gt; MouseEvent.LeftButton) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">QChartViewer</span> <span style="color:#7F0000;text-style:italic">zoom/scroll</span> <span style="color:#7F0000;text-style:italic">state</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">determine</span> <span style="color:#7F0000;text-style:italic">which</span> <span style="color:#7F0000;text-style:italic">type</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">action</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">allowed</span>
			syncState
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Handle</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">down</span> <span style="color:#7F0000;text-style:italic">event</span>
			handleMouseUp(toImageX(MouseEvent.x), toImageY(MouseEvent.y))
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">viewer</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">viewport</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">changed</span>
			updateChartViewerIfNecessary
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> onViewPortChanged()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Handle</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ViewPortChanged</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">associated</span> <span style="color:#7F0000;text-style:italic">ChartViewer</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.updateDisplay
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> paintDisplay()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Paint</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">display</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> c <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS = <span style="color:#0000FF;font-weight: bold">Self</span>.Chart
			
			<span style="color:#0000FF;font-weight: bold">If</span> c &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				Output.ChartPicture = c.makeChartPicture
			<span style="color:#0000FF;font-weight: bold">Else</span>
				System.DebugLog <span style="color:#6500FE">&quot;No</span> <span style="color:#6500FE">chart</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">&quot;</span>+CurrentMethodName
				Output.ChartPicture = <span style="color:#0000FF;font-weight: bold">Nil</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			Output.invalidate
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setChart(c <span style="color:#0000FF;font-weight: bold">as</span> CDXYChartMBS)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">displayed</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">control</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> c &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">Self</span>.Chart = c
				
				<span style="color:#0000FF;font-weight: bold">Self</span>.updateDisplay
			<span style="color:#0000FF;font-weight: bold">Else</span>
				Break
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setViewer(v <span style="color:#0000FF;font-weight: bold">as</span> ChartViewerCanvas)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">CChartViewer</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">associated</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">control</span>
			
			<span style="color:#0000FF;font-weight: bold">Self</span>.viewer = v
			<span style="color:#0000FF;font-weight: bold">self</span>.ViewPortManager = v.ViewPortManager
			
			updateDisplay
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> syncState()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Synchronize</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">CViewPortControl</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">CChartViewer</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> viewer &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#0000FF;font-weight: bold">self</span>.setZoomScrollDirection viewer.zoomDirection, viewer.scrollDirection
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> toImageX(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">version,</span> <span style="color:#7F0000;text-style:italic">no</span> <span style="color:#7F0000;text-style:italic">conversion</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">done.</span> <span style="color:#7F0000;text-style:italic">It</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">assumed</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">control</span> <span style="color:#7F0000;text-style:italic">does</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">stretch</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">shrink</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">does</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">provide</span> <span style="color:#7F0000;text-style:italic">any</span> <span style="color:#7F0000;text-style:italic">additional</span> <span style="color:#7F0000;text-style:italic">margin</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">offset</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">image.</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> x
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> toImageY(y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">version,</span> <span style="color:#7F0000;text-style:italic">no</span> <span style="color:#7F0000;text-style:italic">conversion</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">done.</span> <span style="color:#7F0000;text-style:italic">It</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">assumed</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">control</span> <span style="color:#7F0000;text-style:italic">does</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">stretch</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">shrink</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">does</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">provide</span> <span style="color:#7F0000;text-style:italic">any</span> <span style="color:#7F0000;text-style:italic">additional</span> <span style="color:#7F0000;text-style:italic">margin</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">offset</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">image.</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> y
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> updateChartViewerIfNecessary()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">ChartViewer</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">viewport</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">changed</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> viewer = <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				Break
				<span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Self</span>.needUpdateChart <span style="color:#0000FF;font-weight: bold">Or</span> <span style="color:#0000FF;font-weight: bold">Self</span>.needUpdateImageMap) <span style="color:#0000FF;font-weight: bold">Then</span>
				viewer.updateViewPort(<span style="color:#0000FF;font-weight: bold">self</span>.needUpdateChart, <span style="color:#0000FF;font-weight: bold">self</span>.needUpdateImageMap)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> updateCursor(position <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">cursor</span>
			
			<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> position
			<span style="color:#0000FF;font-weight: bold">Case</span> CDBaseChartMBS.kLeft, CDBaseChartMBS.kRight
				output.MouseCursor = System.Cursors.ArrowEastWest
			<span style="color:#0000FF;font-weight: bold">Case</span> CDBaseChartMBS.kTop, CDBaseChartMBS.kBottom
				output.MouseCursor = System.Cursors.ArrowNorthSouth
				
			<span style="color:#0000FF;font-weight: bold">Case</span> CDBaseChartMBS.kTopLeft, CDBaseChartMBS.kBottomRight
				output.MouseCursor = System.Cursors.ArrowNorthwestSoutheast
				
			<span style="color:#0000FF;font-weight: bold">Case</span> CDBaseChartMBS.kTopRight, CDBaseChartMBS.kBottomLeft
				output.MouseCursor = System.Cursors.ArrowNortheastSouthwest
				
			<span style="color:#0000FF;font-weight: bold">else</span>
				output.MouseCursor = <span style="color:#0000FF;font-weight: bold">Nil</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> updateDisplay()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">display</span>
			
			paintViewPort
			paintDisplay
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> wheelEvent(MouseEvent <span style="color:#0000FF;font-weight: bold">as</span> MouseEvent)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">MouseWheel</span> <span style="color:#7F0000;text-style:italic">handler</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Process</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">wheel</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">over</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area</span>
			<span style="color:#0000FF;font-weight: bold">If</span> ((<span style="color:#0000FF;font-weight: bold">Nil</span> = Viewer) <span style="color:#0000FF;font-weight: bold">Or</span> (<span style="color:#0000FF;font-weight: bold">Not</span> isOnPlotArea(MouseEvent.x, MouseEvent.y))) <span style="color:#0000FF;font-weight: bold">Then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">ignore</span>
			<span style="color:#0000FF;font-weight: bold">Else</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Ask</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">CChartViewer</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">around</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">center</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> x <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Viewer.getPlotAreaLeft + Viewer.getPlotAreaWidth / <span style="color:#326598">2</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Viewer.getPlotAreaTop  + Viewer.getPlotAreaHeight / <span style="color:#326598">2</span>
				
				<span style="color:#0000FF;font-weight: bold">If</span> (<span style="color:#0000FF;font-weight: bold">Not</span> viewer.onMouseWheelZoom(x, y, MouseEvent.delta)) <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">ignore</span>
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Output <span style="color:#0000FF;font-weight: bold">As</span> ViewPortControlCanvas</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Viewer <span style="color:#0000FF;font-weight: bold">As</span> ChartViewerCanvas</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> mouseDownX <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> mouseDownY <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	FileTypes1</div>
<div class="RB_Code">		Filetype image/png</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> FileTypes1</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ViewPortManagerCanvas <span style="color:#0000FF;font-weight: bold">Inherits</span> Canvas</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor()
			<span style="color:#0000FF;font-weight: bold">self</span>.ViewPortManager = <span style="color:#0000FF;font-weight: bold">New</span> CDViewPortManagerMBS
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Calling</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">overridden</span> <span style="color:#7F0000;text-style:italic">superclass</span> <span style="color:#7F0000;text-style:italic">constructor.</span>
			<span style="color:#0000FF;font-weight: bold">Super</span>.Constructor
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> canZoomIn(zoomDirection <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> ViewPortManager.canZoomIn(zoomDirection)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> canZoomOut(zoomDirection <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> ViewPortManager.canZoomOut(zoomDirection)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> clearAllRanges()
			ViewPortManager.clearAllRanges
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> commitPendingSyncAxis(baseChart <span style="color:#0000FF;font-weight: bold">as</span> CDBaseChartMBS)
			ViewPortManager.commitPendingSyncAxis(baseChart)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> dragTo(scrollDirection <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.dragTo(scrollDirection, x, y)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getPlotAreaHeight() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.getPlotAreaHeight
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getPlotAreaLeft() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.getPlotAreaLeft
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getPlotAreaTop() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.getPlotAreaTop
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getPlotAreaWidth() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.getPlotAreaWidth
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getValueAtViewPort(id <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, ratio <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>, isLogScale <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">boolean</span> = <span style="color:#0000FF;font-weight: bold">false</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.getValueAtViewPort(id, ratio, isLogScale)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getViewPortAtValue(id <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, ratio <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>, isLogScale <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">boolean</span> = <span style="color:#0000FF;font-weight: bold">false</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.getViewPortAtValue(id, ratio, isLogScale)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getViewPortHeight() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.getViewPortHeight
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getViewPortLeft() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			<span style="color:#0000FF;font-weight: bold">return</span> ViewPortManager.getViewPortLeft
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getViewPortTop() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			<span style="color:#0000FF;font-weight: bold">return</span> ViewPortManager.getViewPortTop
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> getViewPortWidth() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			<span style="color:#0000FF;font-weight: bold">return</span> ViewPortManager.getViewPortWidth
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> inExtendedPlotArea(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.inExtendedPlotArea(x,y)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> inPlotArea(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.inPlotArea(x,y)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setChartMetrics(metrics <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>)
			ViewPortManager.setChartMetrics metrics
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setFullRange(ID <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, minValue <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>, maxValue <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>)
			ViewPortManager.setFullRange(ID, minValue, maxValue)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setPlotAreaMouseMargin(leftMargin <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, rightMargin <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, topMargin <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, bottomMargin <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			ViewPortManager.setPlotAreaMouseMargin(leftMargin, rightMargin, topMargin, bottomMargin)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setViewPortHeight(value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			<span style="color:#7F0000;text-style:italic">&#39;System.DebugLog</span> <span style="color:#7F0000;text-style:italic">CurrentMethodName</span> <span style="color:#7F0000;text-style:italic">+</span> <span style="color:#7F0000;text-style:italic">&quot;</span> <span style="color:#7F0000;text-style:italic">&quot;</span> <span style="color:#7F0000;text-style:italic">+</span> <span style="color:#7F0000;text-style:italic">Str(value)</span>
			
			ViewPortManager.setViewPortHeight(value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setViewPortLeft(value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			System.DebugLog CurrentMethodName + <span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&quot;</span> + Str(value)
			
			ViewPortManager.setViewPortLeft(value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setViewPortTop(value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			<span style="color:#7F0000;text-style:italic">&#39;System.DebugLog</span> <span style="color:#7F0000;text-style:italic">CurrentMethodName</span> <span style="color:#7F0000;text-style:italic">+</span> <span style="color:#7F0000;text-style:italic">&quot;</span> <span style="color:#7F0000;text-style:italic">&quot;</span> <span style="color:#7F0000;text-style:italic">+</span> <span style="color:#7F0000;text-style:italic">Str(value)</span>
			
			ViewPortManager.setViewPortTop(value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setViewPortWidth(value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			<span style="color:#7F0000;text-style:italic">&#39;System.DebugLog</span> <span style="color:#7F0000;text-style:italic">CurrentMethodName</span> <span style="color:#7F0000;text-style:italic">+</span> <span style="color:#7F0000;text-style:italic">&quot;</span> <span style="color:#7F0000;text-style:italic">&quot;</span> <span style="color:#7F0000;text-style:italic">+</span> <span style="color:#7F0000;text-style:italic">Str(value)</span>
			
			ViewPortManager.setViewPortWidth(value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setZoomInHeightLimit(value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			ViewPortManager.setZoomInHeightLimit(value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setZoomInWidthLimit(value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			ViewPortManager.setZoomInWidthLimit(value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setZoomOutHeightLimit(value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			System.DebugLog CurrentMethodName + <span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&quot;</span> + Str(value)
			
			ViewPortManager.setZoomOutHeightLimit(value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> setZoomOutWidthLimit(value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			System.DebugLog CurrentMethodName + <span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&quot;</span> + Str(value)
			
			ViewPortManager.setZoomOutWidthLimit(value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> startDrag()
			ViewPortManager.startDrag
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> updateFullRangeH(id <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, minValue <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>, maxValue <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>, updateType <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span>
			<span style="color:#7F0000;text-style:italic">&#39;System.DebugLog</span> <span style="color:#7F0000;text-style:italic">CurrentMethodName+&quot;</span> <span style="color:#7F0000;text-style:italic">minValue:</span> <span style="color:#7F0000;text-style:italic">&quot;+Str(minValue)+&quot;</span> <span style="color:#7F0000;text-style:italic">maxValue:</span> <span style="color:#7F0000;text-style:italic">&quot;+Str(maxValue)</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.updateFullRangeH(id, minValue, maxValue, updateType)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> updateFullRangeV(id <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, minValue <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>, maxValue <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>, updateType <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.updateFullRangeV(id, minValue, maxValue, updateType)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> validateViewPort()
			ViewPortManager.validateViewPort
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> zoomAround(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, xZoomRatio <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>, yZoomRatio <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.zoomAround(x, y, xZoomRatio, yZoomRatio)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> zoomAt(zoomDirection <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, zoomRatio <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> ViewPortManager.zoomAt(zoomDirection, x, y, zoomRatio)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> zoomTo(zoomDirection <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, x1 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y1 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, x2 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y2 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> ViewPortManager.zoomTo(zoomDirection, x1, y1, x2, y2)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;About</span> <span style="color:#6500FE">this</span> <span style="color:#6500FE">class&quot;</span>
<div class="RB_Comment">			In C++ you can have a class inherit from multiple classes
			
			In Xojo you can't.
			
			So we have this intermediate class to forward all calls to
			
			Once this code is fully debugged and running, someone may remove this intermediate class and change all calls to the methods with ViewPortManager. prefix.</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ViewPortManager <span style="color:#0000FF;font-weight: bold">As</span> CDViewPortManagerMBS</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MouseEvent</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> LeftButton = <span style="color:#326598">1</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> NoButton = <span style="color:#326598">0</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> RightButton = <span style="color:#326598">2</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(MouseX <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, MouseY <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>)
			<span style="color:#0000FF;font-weight: bold">Self</span>.x = mouseX
			<span style="color:#0000FF;font-weight: bold">Self</span>.y = MouseY
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> SetButton()
			<span style="color:#0000FF;font-weight: bold">If</span> IsContextualClick <span style="color:#0000FF;font-weight: bold">Then</span>
				button = RightButton
			<span style="color:#0000FF;font-weight: bold">Else</span>
				button = LeftButton
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> button <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> delta <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> x <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ViewPortControlCanvas <span style="color:#0000FF;font-weight: bold">Inherits</span> Canvas</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> MouseDown(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#7F0000;text-style:italic">&#39;System.DebugLog</span> <span style="color:#7F0000;text-style:italic">CurrentMethodName+&quot;</span> <span style="color:#7F0000;text-style:italic">&quot;+Str(x)+&quot;/&quot;+Str(y)</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> m <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MouseEvent(x,y)
			m.SetButton
			
			ViewPortControl.mousePressEvent(m)
			
			<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">True</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseDrag(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#7F0000;text-style:italic">&#39;System.DebugLog</span> <span style="color:#7F0000;text-style:italic">CurrentMethodName+&quot;</span> <span style="color:#7F0000;text-style:italic">&quot;+Str(x)+&quot;/&quot;+Str(y)</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> m <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MouseEvent(x,y)
			
			ViewPortControl.mouseMoveEvent m
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseMove(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#7F0000;text-style:italic">&#39;System.DebugLog</span> <span style="color:#7F0000;text-style:italic">CurrentMethodName+&quot;</span> <span style="color:#7F0000;text-style:italic">&quot;+Str(x)+&quot;/&quot;+Str(y)</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> m <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MouseEvent(x,y)
			
			ViewPortControl.mouseMoveEvent m
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseUp(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#7F0000;text-style:italic">&#39;System.DebugLog</span> <span style="color:#7F0000;text-style:italic">CurrentMethodName+&quot;</span> <span style="color:#7F0000;text-style:italic">&quot;+Str(x)+&quot;/&quot;+Str(y)</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> m <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MouseEvent(x,y)
			m.SetButton
			
			ViewPortControl.mouseReleaseEvent(m)
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> MouseWheel(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, deltaX <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, deltaY <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> m <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MouseEvent(x,y)
			m.delta = deltay
			
			ViewPortControl.wheelEvent(m)
			
			
			<span style="color:#0000FF">#Pragma</span> Unused deltaX
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Paint(g <span style="color:#0000FF;font-weight: bold">As</span> Graphics, areas() <span style="color:#0000FF;font-weight: bold">As</span> REALbasic.Rect)
			<span style="color:#7F0000;text-style:italic">&#39;System.DebugLog</span> <span style="color:#7F0000;text-style:italic">CurrentMethodName</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> ChartPicture &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				g.DrawPicture ChartPicture, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, g.Width, g.height, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, ChartPicture.Width, ChartPicture.Height
			<span style="color:#0000FF;font-weight: bold">Else</span>
				System.DebugLog <span style="color:#6500FE">&quot;No</span> <span style="color:#6500FE">chart</span> <span style="color:#6500FE">picture</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">&quot;</span>+CurrentMethodName
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			
			<span style="color:#0000FF">#Pragma</span> Unused areas
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ChartPicture <span style="color:#0000FF;font-weight: bold">As</span> Picture</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ViewPortControl <span style="color:#0000FF;font-weight: bold">As</span> ViewPortControl</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbschartdirectorplugin.html">MBS ChartDirector Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-chartdirector-realtimeviewport">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

