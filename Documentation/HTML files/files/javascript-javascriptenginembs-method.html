<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - JavaScriptEngineMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="JavaScriptEngineMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">JavaScriptEngineMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-javascriptenginembs.html">JavaScriptEngineMBS</a> class.  </p>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="1">AddFunction(Name as String, JavaScript as String, FileName as String = &quot;&quot;)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion200.shtml" class=version>20.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Adds a global function defined as a text string.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> j <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> <A href="class-javascriptenginembs.html">JavaScriptEngineMBS</A><br />j.AddFunction <span style="color: #6600FE;">&quot;adder&quot;</span>, <span style="color: #6600FE;">&quot;function (x,y) { return x+y; }&quot;</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Optional provide a file name to show in stack traces.<BR>
Function source code may contain a function name, but we use only the name parameter to register the function as global one.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-tools-javascript-javascriptengine.html">/Tools/JavaScript/JavaScript Engine</A></li>
<li><A href="example-tools-javascript-javascriptpixelediting.html">/Tools/JavaScript/JavaScript Pixel Editing</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="2">CallFunction(Name as String, ParamArray Params as Variant) as Variant</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion200.shtml" class=version>20.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Calls a global function given the name.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> j <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> <A href="class-javascriptenginembs.html">JavaScriptEngineMBS</A><br /><br /><span style="color: #800000;">// just add a function</span><br />j.AddFunction <span style="color: #6600FE;">&quot;adder&quot;</span>, <span style="color: #6600FE;">&quot;function (x,y) { return x+y; }&quot;</span><br /><br /><span style="color: #800000;">// call it</span><br /><span style="color: #0000FF;">Dim</span> r <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Variant</span> = j.CallFunction(<span style="color: #6600FE;">&quot;adder&quot;</span>, <span style="color: #336698;">2</span>, <span style="color: #336698;">3</span>)<br />Break <span style="color: #800000;">// check result in debugger</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Parameters are passed to the function.<BR>
If the function needs more parameter, undefined values are used to fill up.<BR>
If the function needs less parameters, additional ones are dropped.<BR>
<BR>
Returns the result of the function converted to a variant. <BR>
<p>See also:<ul>
<li><A href="javascript-javascriptenginembs-method.html#3">CallFunction(Name as String, Params() as Variant) as Variant</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="3">CallFunction(Name as String, Params() as Variant) as Variant</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion200.shtml" class=version>20.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Calls a global function given the name.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> j <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> <A href="class-javascriptenginembs.html">JavaScriptEngineMBS</A><br /><br /><span style="color: #800000;">// just add a function</span><br />j.AddFunction <span style="color: #6600FE;">&quot;adder&quot;</span>, <span style="color: #6600FE;">&quot;function (x,y) { return x+y; }&quot;</span><br /><br /><span style="color: #800000;">// call it</span><br /><span style="color: #0000FF;">Dim</span> Params() <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Variant</span><br />params.Append <span style="color: #336698;">3</span><br />params.Append <span style="color: #336698;">4</span><br />params.Append <span style="color: #336698;">5</span> <span style="color: #800000;">// one too much -&gt; will be ignored</span><br /><span style="color: #0000FF;">Dim</span> r <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Variant</span> = j.CallFunction(<span style="color: #6600FE;">&quot;adder&quot;</span>, params)<br />Break <span style="color: #800000;">// check result in debugger</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Parameters are passed to the function.<BR>
If the function needs more parameter, undefined values are used to fill up.<BR>
If the function needs less parameters, additional ones are dropped.<BR>
<BR>
Returns the result of the function converted to a variant. <BR>
<p>See also:<ul>
<li><A href="javascript-javascriptenginembs-method.html#2">CallFunction(Name as String, ParamArray Params as Variant) as Variant</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="4">CallFunctionMT(Name as String, ParamArray Params as Variant) as Variant</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion201.shtml" class=version>20.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Calls a global function given the name.<BR>
<B>Notes:</B> 
<BR>
Threaded version of CallFunction. If events or delegates are called on main thread, the preemptive thread waits for answer.<BR>
<BR>
Parameters are passed to the function.<BR>
If the function needs more parameter, undefined values are used to fill up.<BR>
If the function needs less parameters, additional ones are dropped.<BR>
<BR>
Returns the result of the function converted to a variant. <BR>
<BR>
The work is performed on a preemptive thread, so this function does not block the application and can yield time to other Xojo threads. Must be called in a Xojo thread to enjoy benefits. If called in main thread will block, but keep other background threads running.<BR>
<p>See also:<ul>
<li><A href="javascript-javascriptenginembs-method.html#5">CallFunctionMT(Name as String, Params() as Variant) as Variant</A></li>
</ul></p>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-tools-javascript-javascriptpixelediting.html">/Tools/JavaScript/JavaScript Pixel Editing</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="5">CallFunctionMT(Name as String, Params() as Variant) as Variant</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion201.shtml" class=version>20.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Calls a global function given the name.<BR>
<B>Notes:</B> 
<BR>
Threaded version of CallFunction. If events or delegates are called on main thread, the preemptive thread waits for answer.<BR>
<BR>
Parameters are passed to the function.<BR>
If the function needs more parameter, undefined values are used to fill up.<BR>
If the function needs less parameters, additional ones are dropped.<BR>
<BR>
Returns the result of the function converted to a variant. <BR>
<BR>
The work is performed on a preemptive thread, so this function does not block the application and can yield time to other Xojo threads. Must be called in a Xojo thread to enjoy benefits. If called in main thread will block, but keep other background threads running.<BR>
<p>See also:<ul>
<li><A href="javascript-javascriptenginembs-method.html#4">CallFunctionMT(Name as String, ParamArray Params as Variant) as Variant</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="6">DateComponentsToTime(date as <A href="class-javascriptdatecomponentsmbs.html">JavaScriptDateComponentsMBS</A>) as Double</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion201.shtml" class=version>20.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Converts date components to time.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> j <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> <A href="class-javascriptenginembs.html">JavaScriptEngineMBS</A><br /><br /><span style="color: #0000FF;">Dim</span> d <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> <A href="class-javascriptdatecomponentsmbs.html">JavaScriptDateComponentsMBS</A><br />d.Year = <span style="color: #336698;">1970</span><br />d.Month = <span style="color: #336698;">1</span><br />d.day = <span style="color: #336698;">1</span><br /><br /><span style="color: #800000;">// shows zero as that&apos;s the start point in time for unix</span><br />MsgBox <span style="color: #6600FE;">&quot;Start Time: &quot;</span>+Str(j.DateComponentsToTime(d))</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Convert components (year, month, day, etc), interpreted in UTC, into a time value. The weekday argument is ignored in the conversion. If the component values are invalid, an error is thrown.<BR>
<BR>
There are some differences to the ECMAScript Date.UTC() built-in:<BR>
<BR>
<UL><LI>
There&#39;s no special handling of two-digit years. For example, Date.UTC(99, 0, 1) gets interpreted as 1999-01-01. If time is 99, it&#39;s interpreted as the year 99.
</LI><LI>
The milliseconds component is allowed fractions (sub-millisecond resolution) so that the resulting time value may have fractions.
</LI></UL>
<BR>
Like the ECMAScript primitives, the components can exceed their natural range and are normalized. For example, specifying minute as 120 is interpreted as adding 2 hours to the time value. The components are expressed as Integers to allow large and negative values to be used.<BR>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="7">Destructor</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion200.shtml" class=version>20.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
The destructor.<BR>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="8">Evaluate(JavaScript as String) as Variant</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion200.shtml" class=version>20.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Evaluates a JavaScript expression.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> j <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> <A href="class-javascriptenginembs.html">JavaScriptEngineMBS</A><br /><br /><span style="color: #0000FF;">Dim</span> v <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Variant</span> = j.Evaluate(<span style="color: #6600FE;">&quot;2+3&quot;</span>)<br />MsgBox v.StringValue</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
This may include definition of functions and objects and using them.<BR>
Result is converted to variant and returned.<BR>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="9">EvaluateMT(JavaScript as String) as Variant</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion201.shtml" class=version>20.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Evaluates a JavaScript expression.<BR>
<B>Notes:</B> 
<BR>
Threaded version of Evaluate. If events or delegates are called on main thread, the preemptive thread waits for answer.<BR>
<BR>
This may include definition of functions and objects and using them.<BR>
Result is converted to variant and returned.<BR>
<BR>
The work is performed on a preemptive thread, so this function does not block the application and can yield time to other Xojo threads. Must be called in a Xojo thread to enjoy benefits. If called in main thread will block, but keep other background threads running.<BR>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="10">EvaluateToString(JavaScript as String) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion200.shtml" class=version>20.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Evaluates a JavaScript expression.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> j <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> <A href="class-javascriptenginembs.html">JavaScriptEngineMBS</A><br /><br /><span style="color: #0000FF;">Dim</span> s <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">String</span> = j.EvaluateToString(<span style="color: #6600FE;">&quot;2+3&quot;</span>)<br />MsgBox s</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
This may include definition of functions and objects and using them.<BR>
Result is converted to string in JavaScript and returned as Xojo string.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-tools-javascript-javascriptaes-javascriptaes.html">/Tools/JavaScript/JavaScript AES/JavaScript AES</A></li>
<li><A href="example-tools-javascript-javascriptengine.html">/Tools/JavaScript/JavaScript Engine</A></li>
<li><A href="example-tools-javascript-libphonenumber-javascriptlibphonenumber.html">/Tools/JavaScript/LibPhoneNumber/JavaScript LibPhoneNumber</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="11">GlobalMemoryBlock(PropertyName as String) as MemoryBlock</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>property</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion201.shtml" class=version>20.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Query or assign a global property to reference memoryblock.<BR>
<B>Notes:</B> 
<BR>
A normal memoryblock passed as parameter to a function or property would be copied.<BR>
This method allows you to define a buffer in JavaScript to reference the bytes in a memoryblock, so all changes are visible in Xojo directly.<BR>
<BR>
You can assign nil as value to clear a memoryblock.<BR>
(Read and Write computed property)<BR>
<h4>Some examples using this property:</h4>
<ul translate="no">
<li><A href="example-tools-javascript-javascriptpixelediting.html">/Tools/JavaScript/JavaScript Pixel Editing</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="12">GlobalProperty(PropertyName as String) as Variant</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>property</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion200.shtml" class=version>20.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Get or set a global property.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> j <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> <A href="class-javascriptenginembs.html">JavaScriptEngineMBS</A><br /><br />j.GlobalProperty(<span style="color: #6600FE;">&quot;Hello&quot;</span>) = <span style="color: #6600FE;">&quot;World&quot;</span><br />MsgBox j.GlobalProperty(<span style="color: #6600FE;">&quot;Hello&quot;</span>)</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Values are converted to/from variant.<BR>
(Read and Write computed property)<BR>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="13">GlobalPropertyJSON(PropertyName as String) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>property</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion200.shtml" class=version>20.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Get or set a global property as JSON.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> j <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> <A href="class-javascriptenginembs.html">JavaScriptEngineMBS</A><br /><br />j.GlobalProperty(<span style="color: #6600FE;">&quot;Hello&quot;</span>) = <span style="color: #6600FE;">&quot;World&quot;</span><br />MsgBox j.GlobalPropertyJSON(<span style="color: #6600FE;">&quot;Hello&quot;</span>)<br /><br />j.GlobalPropertyJSON(<span style="color: #6600FE;">&quot;test&quot;</span>) = <span style="color: #6600FE;">&quot;[1,2,3]&quot;</span><br />MsgBox j.GlobalPropertyJSON(<span style="color: #6600FE;">&quot;test&quot;</span>)</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Same as GlobalProperty, but needs JSON text.<BR>
(Read and Write computed property)<BR>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="14">InitModules</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion212.shtml" class=version>21.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Installs Duktape module loading.<BR>
<B>Notes:</B> 
<BR>
Only calls JS.InitModules once on a new instance of the JavaScript engine.<BR>
Define your own Duktape.modSearch() to provide environment specific module lookups.<BR>
After these steps, require() will be registered to the global object and the module system is ready to use.<BR>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="15">LoadFunction(Name as String, Data as Memoryblock) as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion200.shtml" class=version>20.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Loads a global function from byte code.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> j <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> <A href="class-javascriptenginembs.html">JavaScriptEngineMBS</A><br /><br /><span style="color: #800000;">// just add a function</span><br />j.AddFunction <span style="color: #6600FE;">&quot;adder&quot;</span>, <span style="color: #6600FE;">&quot;function (x,y) { return x+y; }&quot;</span><br /><br /><span style="color: #800000;">// get byte code</span><br /><span style="color: #0000FF;">Dim</span> m <span style="color: #0000FF;">As</span> MemoryBlock = j.SaveFunction(<span style="color: #6600FE;">&quot;adder&quot;</span>)<br /><br /><span style="color: #800000;">// and load back with new name</span><br /><span style="color: #0000FF;">dim</span> b <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Boolean</span> = j.LoadFunction(<span style="color: #6600FE;">&quot;adder2&quot;</span>, m)<br /><br /><span style="color: #800000;">// call it</span><br /><span style="color: #0000FF;">Dim</span> r <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Variant</span> = j.CallFunction(<span style="color: #6600FE;">&quot;adder2&quot;</span>, <span style="color: #336698;">2</span>, <span style="color: #336698;">3</span>)<br />break <span style="color: #800000;">// check result in debugger</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Load a buffer containing bytecode, recreating the original ECMAScript function (with some limitations). You must ensure that the bytecode has been dumped with a compatible Duktape version and that the bytecode has not been modified since. Loading bytecode from an untrusted source is memory unsafe and may lead to exploitable vulnerabilities.<BR>
<BR>
Returns true in case of success or false on failure.<BR>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="16">Now as Double</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion201.shtml" class=version>20.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Queries current time as double value.<BR>
<B>Notes:</B> 
<BR>
This is seconds since 1st January 1970 multiplied by 1000 and may contain fraction with microseconds.<BR>
<BR>
Get current time in POSIX milliseconds, as seen by the ECMAScript environment. The return value matches Date.now() with the reservation that sub-millisecond resolution may be available.<BR>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="17">RegisterFunction(Name as String, theDelegate as <A href="delegate-javascriptenginembs-javascriptenginedelegatembs.html">JavaScriptEngineDelegateMBS</A>, ArgCount as Integer = -1, tag as Variant = nil)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion200.shtml" class=version>20.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Registers a global function with given name to call delegate.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> j <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> <A href="class-javascriptenginembs.html">JavaScriptEngineMBS</A><br /><br />j.RegisterFunction <span style="color: #6600FE;">&quot;MyFunction&quot;</span>, <span style="color: #0000FF;">AddressOf</span> testFunction, <span style="color: #336698;">1</span>, <span style="color: #0000FF;">Nil</span><br /><br /><span style="color: #800000;">// call in JavaScript</span><br /><span style="color: #0000FF;">Dim</span> x <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Variant</span> = j.Evaluate(<span style="color: #6600FE;">&quot;MyFunction(123);&quot;</span>)<br /><br /><span style="color: #800000;">// call via plugin</span><br /><span style="color: #0000FF;">Dim</span> r <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Variant</span> = j.CallFunction(<span style="color: #6600FE;">&quot;MyFunction&quot;</span>, <span style="color: #6600FE;">&quot;Hello&quot;</span>)<br /><br />Break<br /><br /><span style="color: #800000;">&apos;Public Function testFunction(Name as String, Params() as Variant, tag as Variant) as Variant</span><br /><span style="color: #800000;">&apos;  MsgBox params(0).StringValue</span><br /><span style="color: #800000;">&apos;  Return &quot;ok&quot;</span><br /><span style="color: #800000;">&apos;End Function</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
ArgCount can be in range from -1 to 15.<BR>
If -1 is passed, we allow variable number of arguments.<BR>
Tag is passed to delegate and allows you to pass a context object to the delegate.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-tools-javascript-javascriptengine.html">/Tools/JavaScript/JavaScript Engine</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="18">SaveFunction(Name as String) as MemoryBlock</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion200.shtml" class=version>20.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Queries byte code for global JavaScript function.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> j <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> <A href="class-javascriptenginembs.html">JavaScriptEngineMBS</A><br /><br /><span style="color: #800000;">// just add a function</span><br />j.AddFunction <span style="color: #6600FE;">&quot;adder&quot;</span>, <span style="color: #6600FE;">&quot;function (x,y) { return x+y; }&quot;</span><br /><br /><span style="color: #800000;">// get byte code</span><br /><span style="color: #0000FF;">Dim</span> m <span style="color: #0000FF;">As</span> MemoryBlock = j.SaveFunction(<span style="color: #6600FE;">&quot;adder&quot;</span>)<br /><br /><span style="color: #800000;">// and load back with new name</span><br /><span style="color: #0000FF;">dim</span> b <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Boolean</span> = j.LoadFunction(<span style="color: #6600FE;">&quot;adder2&quot;</span>, m)<br /><br /><span style="color: #800000;">// call it</span><br /><span style="color: #0000FF;">Dim</span> r <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Variant</span> = j.CallFunction(<span style="color: #6600FE;">&quot;adder2&quot;</span>, <span style="color: #336698;">2</span>, <span style="color: #336698;">3</span>)<br />break <span style="color: #800000;">// check result in debugger</span></span>
</pre>
</div>
<B>Notes:</B> 
Dump an ECMAScript function at stack top into bytecode, replacing the function with a buffer containing the bytecode data. The bytecode can be loaded back using LoadFunction().<BR>
</div>
<div class="WLM">
<b><a href="class-javascriptenginembs.html">JavaScriptEngineMBS</a>.<A name="19">TimeToDateComponents(time as Double) as <A href="class-javascriptdatecomponentsmbs.html">JavaScriptDateComponentsMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-javascript.html" translate="no">JavaScript</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion201.shtml" class=version>20.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Converts time to date components.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> j <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> <A href="class-javascriptenginembs.html">JavaScriptEngineMBS</A><br /><br /><span style="color: #800000;">// get now</span><br /><span style="color: #0000FF;">Dim</span> t1 <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Double</span> = j.Now<br /><br /><span style="color: #800000;">// as compoents</span><br /><span style="color: #0000FF;">Dim</span> d1 <span style="color: #0000FF;">As</span> <A href="class-javascriptdatecomponentsmbs.html">JavaScriptDateComponentsMBS</A>   = j.TimeToDateComponents(t1)<br /><span style="color: #0000FF;">Dim</span> s1 <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">String</span> = d1.SQLDateTime<br /><span style="color: #800000;">// looks right?</span><br /><br />Break</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Convert a time value to components (year, month, day, etc) interpreted in UTC. If the time value is invalid, e.g. beyond the valid ECMAScript time range, an error is thrown.<BR>
<BR>
There are some differences to the ECMAScript Date UTC accessors like Date.prototype.getUTCMinutes():<BR>
<BR>
The time value is allowed to have fractions (sub-millisecond resolution) so that the millisecond component may also have fractions.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=javascript-javascriptenginembs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

