<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - WindowsDropTargetMBS events</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="WindowsDropTargetMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">WindowsDropTargetMBS events</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</a> class.  </p>
<div class="W">
<b><a href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</a>.<A name="1">DragEnter(dataObject as <A href="class-windataobjectmbs.html">WinDataObjectMBS</A>, keystate as Integer, x as Integer, y as Integer, byref effect as Integer) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-dragdrop.html" translate="no">Drag &amp; Drop</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
Indicates whether a drop can be accepted, and, if so, the effect of the drop.<BR>
<B>Notes:</B> 
<BR>
dataObject: This data object contains the data being transferred in the drag-and-drop operation. If the drop occurs, this data object will be incorporated into the target.<BR>
<BR>
KeyState: The current state of the keyboard modifier keys on the keyboard. Possible values can be a combination of any of the flags MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON, and MK_RBUTTON.<BR>
<BR>
x and y: A point containing the current cursor coordinates in screen coordinates.<BR>
<BR>
effect: The value of the Effect parameter of the DoDragDrop function. On return, must contain one of the DROPEFFECT flags, which indicates what the result of the drop operation would be.<BR>
<BR>
Return S_OK on success. Other possible values include the following.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Return code</TD><TD valign="top">Description</TD></TR>
<TR><TD valign="top">E_UNEXPECTED</TD><TD valign="top">An unexpected error has occurred.</TD></TR>
<TR><TD valign="top">E_INVALIDARG</TD><TD valign="top">The Effect parameter is NULL on input.</TD></TR>
<TR><TD valign="top">E_OUTOFMEMORY</TD><TD valign="top">There was insufficient memory available for this operation.</TD></TR>
</TABLE>
<BR>
You do not call DragEnter directly; instead the DoDragDrop function calls it to determine the effect of a drop the first time the user drags the mouse into the registered window of a drop target.<BR>
<BR>
To implement DragEnter, you must determine whether the target can use the data in the source data object by checking three things:<BR>
<BR>
<UL><LI>
The format and medium specified by the data object
</LI><LI>
The input value of Effect
</LI><LI>
The state of the modifier keys
</LI></UL>
<BR>
To check the format and medium, use the <A href="class-windataobjectmbs.html">WinDataObjectMBS</A> object.<BR>
<BR>
On entry to <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragEnter, the Effect parameter is set to the effects given to the OkEffect parameter of the DoDragDrop function. The <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragEnter method must choose one of these effects or disable the drop.<BR>
<BR>
The following modifier keys affect the result of the drop.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Key Combination</TD><TD valign="top">User-Visible Feedback</TD><TD valign="top">Drop Effect</TD></TR>
<TR><TD valign="top">CTRL + SHIFT</TD><TD valign="top">=</TD><TD valign="top">DROPEFFECT_LINK</TD></TR>
<TR><TD valign="top">CTRL</TD><TD valign="top">+</TD><TD valign="top">DROPEFFECT_COPY</TD></TR>
<TR><TD valign="top">No keys or SHIFT</TD><TD valign="top">None</TD><TD valign="top">DROPEFFECT_MOVE</TD></TR>
</TABLE>
<BR>
On return, the method must write the effect, one of the DROPEFFECT flags, to the Effect parameter. DoDragDrop then takes this parameter and writes it to its Effect parameter. You communicate the effect of the drop back to the source through DoDragDrop in the Effect parameter. The DoDragDrop function then calls <A href="class-windowsdragsourcembs.html">WindowsDragSourceMBS</A>.GiveFeedback so that the source application can display the appropriate visual feedback to the user through the target window.<BR>
<h4>Some examples using this event:</h4>
<ul translate="no">
<li><A href="example-win-draganddrop-attachmentdropfromoutlook.html">/Win/Drag and Drop/Attachment Drop from Outlook</A></li>
<li><A href="example-win-draganddrop-filedragmulti.html">/Win/Drag and Drop/File Drag Multi</A></li>
<li><A href="example-win-draganddrop-filedrop.html">/Win/Drag and Drop/File Drop</A></li>
<li><A href="example-win-draganddrop-picturedrop.html">/Win/Drag and Drop/Picture Drop</A></li>
<li><A href="example-win-draganddrop-picturedroponcontrol.html">/Win/Drag and Drop/Picture Drop on control</A></li>
<li><A href="example-win-draganddrop-textdrop.html">/Win/Drag and Drop/Text Drop</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</a>.<A name="2">DragLeave as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-dragdrop.html" translate="no">Drag &amp; Drop</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
Removes target feedback and releases the data object.<BR>
<B>Notes:</B> 
<BR>
Return S_OK on success. Other possible values include the following.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Return code</TD><TD valign="top">Description</TD></TR>
<TR><TD valign="top">E_OUTOFMEMORY</TD><TD valign="top">There is insufficient memory available for this operation.</TD></TR>
</TABLE>
<BR>
You do not call this method directly. The DoDragDrop function calls this method in either of the following cases:<BR>
<BR>
<UL><LI>
When the user drags the cursor out of a given target window.
</LI><LI>
When the user cancels the current drag-and-drop operation.
</LI></UL>
<BR>
To implement <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragLeave, you must remove any target feedback that is currently displayed. You must also release any references you hold to the data transfer object.<BR>
<h4>Some examples using this event:</h4>
<ul translate="no">
<li><A href="example-win-draganddrop-attachmentdropfromoutlook.html">/Win/Drag and Drop/Attachment Drop from Outlook</A></li>
<li><A href="example-win-draganddrop-filedragmulti.html">/Win/Drag and Drop/File Drag Multi</A></li>
<li><A href="example-win-draganddrop-filedrop.html">/Win/Drag and Drop/File Drop</A></li>
<li><A href="example-win-draganddrop-picturedrop.html">/Win/Drag and Drop/Picture Drop</A></li>
<li><A href="example-win-draganddrop-picturedroponcontrol.html">/Win/Drag and Drop/Picture Drop on control</A></li>
<li><A href="example-win-draganddrop-textdrop.html">/Win/Drag and Drop/Text Drop</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</a>.<A name="3">DragOver(keystate as Integer, x as Integer, y as Integer, byref effect as Integer) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-dragdrop.html" translate="no">Drag &amp; Drop</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
Provides target feedback to the user and communicates the drop&#39;s effect to the DoDragDrop function so it can communicate the effect of the drop back to the source.<BR>
<B>Notes:</B> 
<BR>
KeyState: The current state of the keyboard modifier keys on the keyboard. Valid values can be a combination of any of the flags MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON, and MK_RBUTTON.<BR>
x and y: The point containing the current cursor coordinates in screen coordinates.<BR>
Effect: On input, pointer to the value of the Effect parameter of the DoDragDrop function. On return, must contain one of the DROPEFFECT flags, which indicates what the result of the drop operation would be.<BR>
<BR>
Return S_OK on success. Other possible values include the following.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Return code</TD><TD valign="top">Description</TD></TR>
<TR><TD valign="top">E_UNEXPECTED</TD><TD valign="top">An unexpected error has occurred.</TD></TR>
<TR><TD valign="top">E_INVALIDARG</TD><TD valign="top">The Effect value is not valid.</TD></TR>
<TR><TD valign="top">E_OUTOFMEMORY</TD><TD valign="top">There was insufficient memory available for this operation.</TD></TR>
</TABLE>
<BR>
You do not call DragOver directly. The DoDragDrop function calls this method each time the user moves the mouse across a given target window. DoDragDrop exits the loop if the drag-and-drop operation is canceled, if the user drags the mouse out of the target window, or if the drop is completed.<BR>
<BR>
In implementing <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragOver, you must provide features similar to those in <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragEnter. You must determine the effect of dropping the data on the target by examining the FORMATETC defining the data object&#39;s formats and medium, along with the state of the modifier keys. The mouse position may also play a role in determining the effect of a drop. The following modifier keys affect the result of the drop.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Key Combination</TD><TD valign="top">User-Visible Feedback</TD><TD valign="top">Drop Effect</TD></TR>
<TR><TD valign="top">CTRL + SHIFT</TD><TD valign="top">=</TD><TD valign="top">DROPEFFECT_LINK</TD></TR>
<TR><TD valign="top">CTRL</TD><TD valign="top">+</TD><TD valign="top">DROPEFFECT_COPY</TD></TR>
<TR><TD valign="top">No keys or SHIFT</TD><TD valign="top">None</TD><TD valign="top">DROPEFFECT_MOVE</TD></TR>
</TABLE>
<BR>
You communicate the effect of the drop back to the source through DoDragDrop in Effect. The DoDragDrop function then calls <A href="class-windowsdragsourcembs.html">WindowsDragSourceMBS</A>.GiveFeedback so the source application can display the appropriate visual feedback to the user.<BR>
<BR>
On entry to <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragOver, the Effect parameter must be set to the allowed effects passed to the OkEffect parameter of the DoDragDrop function. The <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragOver method must be able to choose one of these effects or disable the drop.<BR>
<BR>
Upon return, Effect is set to one of the DROPEFFECT flags. This value is then passed to the Effect parameter of DoDragDrop. Reasonable values are DROPEFFECT_COPY to copy the dragged data to the target, DROPEFFECT_LINK to create a link to the source data, or DROPEFFECT_MOVE to allow the dragged data to be permanently moved from the source application to the target.<BR>
<BR>
You may also wish to provide appropriate visual feedback in the target window. There may be some target feedback already displayed from a previous call to <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragOver or from the initial <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragEnter. If this feedback is no longer appropriate, you should remove it.<BR>
<BR>
For efficiency reasons, a data object is not passed in <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragOver. The data object passed in the most recent call to <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragEnter is available and can be used.<BR>
<BR>
When <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragOver has completed its operation, the DoDragDrop function calls <A href="class-windowsdragsourcembs.html">WindowsDragSourceMBS</A>.GiveFeedback so the source application can display the appropriate visual feedback to the user.<BR>
<BR>
Notes to Implementers<BR>
<BR>
This function is called frequently during the DoDragDrop loop so it makes sense to optimize your implementation of the DragOver method as much as possible.<BR>
<h4>Some examples using this event:</h4>
<ul translate="no">
<li><A href="example-win-draganddrop-attachmentdropfromoutlook.html">/Win/Drag and Drop/Attachment Drop from Outlook</A></li>
<li><A href="example-win-draganddrop-filedragmulti.html">/Win/Drag and Drop/File Drag Multi</A></li>
<li><A href="example-win-draganddrop-filedrop.html">/Win/Drag and Drop/File Drop</A></li>
<li><A href="example-win-draganddrop-picturedrop.html">/Win/Drag and Drop/Picture Drop</A></li>
<li><A href="example-win-draganddrop-picturedroponcontrol.html">/Win/Drag and Drop/Picture Drop on control</A></li>
<li><A href="example-win-draganddrop-textdrop.html">/Win/Drag and Drop/Text Drop</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</a>.<A name="4">Drop(dataObject as <A href="class-windataobjectmbs.html">WinDataObjectMBS</A>, keystate as Integer, x as Integer, y as Integer, byref effect as Integer) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-dragdrop.html" translate="no">Drag &amp; Drop</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
Incorporates the source data into the target window, removes target feedback, and releases the data object.<BR>
<B>Notes:</B> 
<BR>
dataObject: The data object being transferred in the drag-and-drop operation.<BR>
KeyState: The current state of the keyboard modifier keys on the keyboard. Possible values can be a combination of any of the flags MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON, and MK_RBUTTON.<BR>
x and y: The point containing the current cursor coordinates in screen coordinates.<BR>
Effect: On input, the value of the Effect parameter of the DoDragDrop function. On return, must contain one of the DROPEFFECT flags, which indicates what the result of the drop operation would be.<BR>
<BR>
Return S_OK on success. Other possible values include the following.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Return code</TD><TD valign="top">Description</TD></TR>
<TR><TD valign="top">E_UNEXPECTED</TD><TD valign="top">An unexpected error has occurred.</TD></TR>
<TR><TD valign="top">E_INVALIDARG</TD><TD valign="top">The pdwEffect parameter is not valid.</TD></TR>
<TR><TD valign="top">E_OUTOFMEMORY</TD><TD valign="top">There is insufficient memory available for this operation.</TD></TR>
</TABLE>
<BR>
You do not call this method directly. The DoDragDrop function calls this method when the user completes the drag-and-drop operation.<BR>
<BR>
In implementing Drop, you must incorporate the data object into the target. Use the formats available in <A href="class-windataobjectmbs.html">WinDataObjectMBS</A>, available through dataObject, along with the current state of the modifier keys to determine how the data is to be incorporated, such as linking or embedding.<BR>
<BR>
In addition to incorporating the data, you must also clean up as you do in the <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragLeave method:<BR>
<BR>
Remove any target feedback that is currently displayed.<BR>
Release any references to the data object.<BR>
You also pass the effect of this operation back to the source application through DoDragDrop, so the source application can clean up after the drag-and-drop operation is complete:<BR>
<BR>
Remove any source feedback that is being displayed.<BR>
Make any necessary changes to the data, such as removing the data if the operation was a move.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbswinplugin.html">MBS Win Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=dragdrop-windowsdroptargetmbs-event">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

