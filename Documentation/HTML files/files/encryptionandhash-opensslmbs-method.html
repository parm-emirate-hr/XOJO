<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - OpenSSLMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="OpenSSLMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">OpenSSLMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="module-opensslmbs.html">OpenSSLMBS</a> module. </p>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="1">ErrorString(ErrorCode as Integer) as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion140.shtml" class=version>14.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Queries the human readable error string for an OpenSSL error.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;">MsgBox <A href="module-opensslmbs.html">OpenSSLMBS</A>.ErrorString(<span style="color: #336698;">336109761</span>)</span>
</pre>
</div>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="2">GeneratePrivateKey(Bits as Integer = 4096, Exp as Integer = 65537, Password as string = &quot;&quot;, Algorithm as string = &quot;&quot;) as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion162.shtml" class=version>16.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Generates a new private key.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> privateKey <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.GeneratePrivateKey<br /><span style="color: #0000FF;">dim</span> publicKey <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.GetPublicKey(privateKey)<br /><br />break <span style="color: #800000;">// got key pair</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Bit size of key should be high.<BR>
See RSA key documentation on the web about details.<BR>
<BR>
In Plugin version 16.2 and later this function yields time to other Xojo threads.<BR>
Algorithm specifies the encryption algorithm for key encryption. See <A href="class-ciphermbs.html">CipherMBS</A> for cipher names, e.g. &quot;AES-128-CBC&quot;. (new in 17.5)<BR>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="3">GetPublicKey(PrivateKey as String, PrivateKeyPassword as string = &quot;&quot;) as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion162.shtml" class=version>16.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Extracts public key from private key.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> privateKey <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.GeneratePrivateKey<br /><span style="color: #0000FF;">dim</span> publicKey <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.GetPublicKey(privateKey)<br /><br />break <span style="color: #800000;">// got key pair</span></span>
</pre>
</div>
<B>Notes:</B> 
Optionally you can define a password for private key.<BR>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="4">OpenSSLVersion as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion162.shtml" class=version>16.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Queries version of OpenSSL version.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;">MsgBox <A href="module-opensslmbs.html">OpenSSLMBS</A>.OpenSSLVersion</span>
</pre>
</div>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="5">PKCS7Sign(flags as Integer, InputData as string, SignKey as string, PrivateKey as String, PrivateKeyPassword as string, intermediaCertsData() as string, OutputBinary as boolean) as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion151.shtml" class=version>15.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Signs with SMIME.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> testPrivKey      <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = ReadFile(<span style="color: #6600FE;">&quot;passkey.pem&quot;</span>)<br /><span style="color: #0000FF;">dim</span> testCertificate  <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = ReadFile(<span style="color: #6600FE;">&quot;passcertificate.pem&quot;</span>)<br /><span style="color: #0000FF;">dim</span> data             <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = ReadFile(<span style="color: #6600FE;">&quot;test.txt&quot;</span>)<br /><span style="color: #0000FF;">dim</span> privKeyPassword  <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;12345&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> intermediateCertificates() <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span><br />intermediateCertificates.Append ReadFile(<span style="color: #6600FE;">&quot;WWDR.pem&quot;</span>)<br /><span style="color: #0000FF;">dim</span> Sign <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.PKCS7Sign(<span style="color: #336698;">0</span>, data, testCertificate, testPrivKey, privKeyPassword, intermediateCertificates, <span style="color: #0000FF;">true</span>)<br /><br /><span style="color: #800000;">// write result</span><br /><span style="color: #0000FF;">dim</span> f <span style="color: #0000FF;">as</span> FolderItem = SpecialFolder.Desktop.Child(<span style="color: #6600FE;">&quot;output&quot;</span>)<br /><span style="color: #0000FF;">dim</span> b <span style="color: #0000FF;">as</span> BinaryStream = BinaryStream.Create(f, <span style="color: #0000FF;">true</span>)<br />b.Write sign</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Returns the signature. If OutputBinary is true, we use DER output, else text based output.<BR>
intermediaCertsData array can be empty if you have no intermediate certificates.<BR>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="6">PKCS7SignData(Certificate as <A href="class-x509mbs.html">X509MBS</A>, PrivateKey as <A href="class-pkeymbs.html">PKeyMBS</A>, certs() as <A href="class-x509mbs.html">X509MBS</A> = nil, data as string, flags as Integer = 0) as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion180.shtml" class=version>18.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Signs with PKCS7.<BR>
<B>Notes:</B> 
<BR>
Returns the signature (binary format = DER). <BR>
intermediaCertsData array can be empty or nil if you have no intermediate certificates.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-dynapdf-createpdfwithcustomsignature.html">/DynaPDF/Create PDF with Custom Signature</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="7">PKCS7SignedData(DataP7M as String) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion193.shtml" class=version>19.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Reads content of signed data in PKCS7 file.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #800000;">// get a file</span><br /><span style="color: #0000FF;">Dim</span> f <span style="color: #0000FF;">As</span> FolderItem = GetFolderItem(<span style="color: #6600FE;">&quot;/Users/cs/Desktop/p7m/work.xml.p7m&quot;</span>, FolderItem.PathTypeNative)<br /><br /><span style="color: #800000;">// read</span><br /><span style="color: #0000FF;">Dim</span> b <span style="color: #0000FF;">As</span> BinaryStream = BinaryStream.Open(f)<br /><span style="color: #0000FF;">Dim</span> s <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">String</span> = b.Read(b.Length)<br /><br /><span style="color: #800000;">// decode</span><br /><span style="color: #0000FF;">Dim</span> data <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">String</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.PKCS7SignedData(s)<br /><br />Break</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Please pass content of a P7M file, so we can read signed content.<BR>
Returns data or empty string if this failed.<BR>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="8">RandomBytes(count as Integer) as MemoryBlock</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion200.shtml" class=version>20.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Generates random bytes.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> m <span style="color: #0000FF;">As</span> MemoryBlock = <A href="module-opensslmbs.html">OpenSSLMBS</A>.RandomBytes(<span style="color: #336698;">16</span>)<br />MsgBox EncodeHex(m)</span>
</pre>
</div>
<B>Notes:</B> 
Puts count cryptographically strong pseudo-random bytes into MemoryBlock.<BR>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="9">RandomBytesString(count as Integer) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion200.shtml" class=version>20.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Generates random bytes.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">Dim</span> p <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">String</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.RandomBytesString(<span style="color: #336698;">16</span>)<br />MsgBox EncodeHex(p)</span>
</pre>
</div>
<B>Notes:</B> 
Puts count cryptographically strong pseudo-random bytes into string.<BR>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="10">RSAPrivateDecrypt(data as string, PrivateKey as string, padding as Integer = 1, Password as string = &quot;&quot;) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion162.shtml" class=version>16.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Decrypts data using private key.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #800000;">// encrypt with public, decrypt with private key</span><br /><br /><span style="color: #0000FF;">dim</span> f1 <span style="color: #0000FF;">as</span> FolderItem = GetFolderItem(<span style="color: #6600FE;">&quot;test.pem&quot;</span>)<br /><span style="color: #0000FF;">dim</span> b1 <span style="color: #0000FF;">as</span> BinaryStream = BinaryStream.Open(f1)<br /><span style="color: #0000FF;">dim</span> PrivKey <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = B1.Read(b1.Length)<br /><br /><span style="color: #0000FF;">dim</span> f2 <span style="color: #0000FF;">as</span> FolderItem = GetFolderItem(<span style="color: #6600FE;">&quot;test.pub&quot;</span>)<br /><span style="color: #0000FF;">dim</span> b2 <span style="color: #0000FF;">as</span> BinaryStream = BinaryStream.Open(f2)<br /><span style="color: #0000FF;">dim</span> PubKey <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = B2.Read(b2.Length)<br /><br /><span style="color: #0000FF;">dim</span> UnencryptedData <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;Hello World. This is just a test.&quot;</span><br /><span style="color: #0000FF;">dim</span> EncryptedData <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.RSAPublicEncrypt(UnencryptedData, PubKey)<br /><span style="color: #0000FF;">dim</span> decryptedData <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.RSAPrivateDecrypt(EncryptedData, PrivKey)<br /><br />Break <span style="color: #800000;">// check in debugger</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
See kPadding constants for Padding parameter. <BR>
Password is optional for decrypting encrypted keys.<BR>
Returns empty string on failure or raises exceptions.<BR>
<BR>
RSA can only decrypt data if it&#39;s &lt;= length of key.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-encryption-publicandprivatersakeyencryption-publicandprivatersakeyencryption.html">/Encryption/Public and Private RSA Key Encryption/Public and Private RSA Key Encryption</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="11">RSAPrivateEncrypt(data as string, PrivateKey as string, padding as Integer = 1, Password as string = &quot;&quot;) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion162.shtml" class=version>16.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Encrypts data using private key.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #800000;">// encrypt with private, decrypt with public key</span><br /><br /><span style="color: #0000FF;">dim</span> f1 <span style="color: #0000FF;">as</span> FolderItem = GetFolderItem(<span style="color: #6600FE;">&quot;test.pem&quot;</span>)<br /><span style="color: #0000FF;">dim</span> b1 <span style="color: #0000FF;">as</span> BinaryStream = BinaryStream.Open(f1)<br /><span style="color: #0000FF;">dim</span> PrivKey <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = B1.Read(b1.Length)<br /><br /><span style="color: #0000FF;">dim</span> f2 <span style="color: #0000FF;">as</span> FolderItem = GetFolderItem(<span style="color: #6600FE;">&quot;test.pub&quot;</span>)<br /><span style="color: #0000FF;">dim</span> b2 <span style="color: #0000FF;">as</span> BinaryStream = BinaryStream.Open(f2)<br /><span style="color: #0000FF;">dim</span> PubKey <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = B2.Read(b2.Length)<br /><br /><span style="color: #0000FF;">dim</span> UnencryptedData <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;Hello World. This is just a test.&quot;</span><br /><span style="color: #0000FF;">dim</span> EncryptedData <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.RSAPrivateEncrypt(UnencryptedData, PrivKey)<br /><span style="color: #0000FF;">dim</span> decryptedData <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.RSAPublicDecrypt(EncryptedData, PubKey)<br /><br />Break <span style="color: #800000;">// check in debugger</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
See kPadding constants for Padding parameter. <BR>
Password is optional for decrypting encrypted keys.<BR>
Returns empty string on failure or raises exceptions.<BR>
<BR>
RSA can only encrypt data if it&#39;s &lt;= length of key.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-encryption-publicandprivatersakeyencryption-publicandprivatersakeyencryption.html">/Encryption/Public and Private RSA Key Encryption/Public and Private RSA Key Encryption</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="12">RSAPublicDecrypt(data as string, PublicKey as string, padding as Integer = 1, Password as string = &quot;&quot;) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion162.shtml" class=version>16.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Decrypts data using public key.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #800000;">// encrypt with private, decrypt with public key</span><br /><br /><span style="color: #0000FF;">dim</span> f1 <span style="color: #0000FF;">as</span> FolderItem = GetFolderItem(<span style="color: #6600FE;">&quot;test.pem&quot;</span>)<br /><span style="color: #0000FF;">dim</span> b1 <span style="color: #0000FF;">as</span> BinaryStream = BinaryStream.Open(f1)<br /><span style="color: #0000FF;">dim</span> PrivKey <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = B1.Read(b1.Length)<br /><br /><span style="color: #0000FF;">dim</span> f2 <span style="color: #0000FF;">as</span> FolderItem = GetFolderItem(<span style="color: #6600FE;">&quot;test.pub&quot;</span>)<br /><span style="color: #0000FF;">dim</span> b2 <span style="color: #0000FF;">as</span> BinaryStream = BinaryStream.Open(f2)<br /><span style="color: #0000FF;">dim</span> PubKey <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = B2.Read(b2.Length)<br /><br /><span style="color: #0000FF;">dim</span> UnencryptedData <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;Hello World. This is just a test.&quot;</span><br /><span style="color: #0000FF;">dim</span> EncryptedData <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.RSAPrivateEncrypt(UnencryptedData, PrivKey)<br /><span style="color: #0000FF;">dim</span> decryptedData <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.RSAPublicDecrypt(EncryptedData, PubKey)<br /><br />Break <span style="color: #800000;">// check in debugger</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
See kPadding constants for Padding parameter. <BR>
Password is optional for decrypting encrypted keys.<BR>
Returns empty string on failure or raises exceptions.<BR>
<BR>
RSA can only decrypt data if it&#39;s &lt;= length of key.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-encryption-publicandprivatersakeyencryption-publicandprivatersakeyencryption.html">/Encryption/Public and Private RSA Key Encryption/Public and Private RSA Key Encryption</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="13">RSAPublicEncrypt(data as string, PublicKey as string, padding as Integer = 1, Password as string = &quot;&quot;) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion162.shtml" class=version>16.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Encrypts data using public key.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #800000;">// encrypt with public, decrypt with private key</span><br /><br /><span style="color: #0000FF;">dim</span> f1 <span style="color: #0000FF;">as</span> FolderItem = GetFolderItem(<span style="color: #6600FE;">&quot;test.pem&quot;</span>)<br /><span style="color: #0000FF;">dim</span> b1 <span style="color: #0000FF;">as</span> BinaryStream = BinaryStream.Open(f1)<br /><span style="color: #0000FF;">dim</span> PrivKey <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = B1.Read(b1.Length)<br /><br /><span style="color: #0000FF;">dim</span> f2 <span style="color: #0000FF;">as</span> FolderItem = GetFolderItem(<span style="color: #6600FE;">&quot;test.pub&quot;</span>)<br /><span style="color: #0000FF;">dim</span> b2 <span style="color: #0000FF;">as</span> BinaryStream = BinaryStream.Open(f2)<br /><span style="color: #0000FF;">dim</span> PubKey <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = B2.Read(b2.Length)<br /><br /><span style="color: #0000FF;">dim</span> UnencryptedData <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;Hello World. This is just a test.&quot;</span><br /><span style="color: #0000FF;">dim</span> EncryptedData <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.RSAPublicEncrypt(UnencryptedData, PubKey)<br /><span style="color: #0000FF;">dim</span> decryptedData <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.RSAPrivateDecrypt(EncryptedData, PrivKey)<br /><br />Break <span style="color: #800000;">// check in debugger</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
See kPadding constants for Padding parameter. <BR>
Password is optional for decrypting encrypted keys.<BR>
Returns empty string on failure or raises exceptions.<BR>
<BR>
RSA can only encrypt data if it&#39;s &lt;= length of key.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-encryption-publicandprivatersakeyencryption-publicandprivatersakeyencryption.html">/Encryption/Public and Private RSA Key Encryption/Public and Private RSA Key Encryption</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="14">SignData(data as string, key as string, Password as string = &quot;&quot;) as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion134.shtml" class=version>13.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Signs a piece of data with a given private key.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> data <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> <span style="color: #800000;">// some data</span><br /><span style="color: #0000FF;">dim</span> test <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> <span style="color: #800000;">// the private key PEM file content</span><br /><span style="color: #0000FF;">dim</span> Signature <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.SignData(data, test)<br />msgbox EncodeHex(Signature)</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Returns signature. Use EncodeHex or EncodeBase64 to make a text representation.<BR>
<BR>
Internally we make a SHA1 hash of the data, open the private RSA key and do a RSA sign operation. We return the raw key as a string bytes.<BR>
On any error, we return an empty string.<BR>
Optional you can pass a password to read password protected keys.<BR>
<p>See also:<ul>
<li><A href="encryptionandhash-opensslmbs-method.html#15">SignData(data as string, key as string, Password as string = "", Algorithm as Integer) as string</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="15">SignData(data as string, key as string, Password as string = &quot;&quot;, Algorithm as Integer) as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion160.shtml" class=version>16.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Signs a piece of data with a given private key.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> test_pem         <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = ReadFile(<span style="color: #6600FE;">&quot;test.pem&quot;</span>)<br /><span style="color: #0000FF;">dim</span> test_pub         <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = ReadFile(<span style="color: #6600FE;">&quot;test.pub&quot;</span>)<br /><span style="color: #0000FF;">dim</span> data             <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = ReadFile(<span style="color: #6600FE;">&quot;Create Keys.rtf&quot;</span>) <span style="color: #800000;">// some data file</span><br /><span style="color: #0000FF;">dim</span> signature        <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span><br /><br /><span style="color: #800000;">// create signature</span><br /><br />Signature = <A href="module-opensslmbs.html">OpenSSLMBS</A>.SignData(data, test_pem, <A href="module-opensslmbs.html">OpenSSLMBS</A>.kAlgorithmSHA512)<br /><span style="color: #0000FF;">if</span> Signature = <span style="color: #6600FE;">&quot;&quot;</span> <span style="color: #0000FF;">then</span><br />  <span style="color: #800000;">// failed</span><br />  break<br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br /><br /><span style="color: #800000;">// verify with private key</span><br /><span style="color: #0000FF;">dim</span> r1 <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Boolean</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.VerifyData(data, signature, test_pem, <A href="module-opensslmbs.html">OpenSSLMBS</A>.kAlgorithmSHA256)<br /><br /><span style="color: #800000;">// verify with public key</span><br /><span style="color: #0000FF;">dim</span> r2 <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Boolean</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.VerifyData(data, signature, test_pub, <A href="module-opensslmbs.html">OpenSSLMBS</A>.kAlgorithmSHA256)</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Returns signature. Use EncodeHex or EncodeBase64 to make a text representation.<BR>
<BR>
Internally we make a hash of the data with given algorithm, open the private RSA key and do a RSA sign operation. We return the raw signature as a string bytes.<BR>
On any error, we return an empty string.<BR>
Optional you can pass a password to read password protected keys.<BR>
<p>See also:<ul>
<li><A href="encryptionandhash-opensslmbs-method.html#14">SignData(data as string, key as string, Password as string = "") as string</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="16">SMimePKCS7Decrypt(InputData as string, Certificate as <A href="class-x509mbs.html">X509MBS</A>, SignKey as <A href="class-pkeymbs.html">PKeyMBS</A>) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion184.shtml" class=version>18.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Decrypts S/Mime PKCS#7 encrypted data.<BR>
<B>Notes:</B> 
<BR>
Raises nil object exception if certificate or key is nil.<BR>
Returns empty text on error.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-encryption-smime-smimetest.html">/Encryption/SMime/SMime Test</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="17">SMimePKCS7Encrypt(InputData as string, Certificate as <A href="class-x509mbs.html">X509MBS</A>) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion184.shtml" class=version>18.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Encrypts data with S/Mime PKCS#7.<BR>
<B>Notes:</B> 
<BR>
Raises nil object exception if certificate is nil.<BR>
Returns empty text on error.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-encryption-smime-smimetest.html">/Encryption/SMime/SMime Test</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="18">SMimePKCS7Sign(InputData as string, Certificate as <A href="class-x509mbs.html">X509MBS</A>, SignKey as <A href="class-pkeymbs.html">PKeyMBS</A>) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion184.shtml" class=version>18.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Signs data with S/Mime PKCS#7.<BR>
<B>Notes:</B> 
<BR>
Raises nil object exception if certificate or key is nil.<BR>
Returns empty text on error.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-encryption-smime-smimetest.html">/Encryption/SMime/SMime Test</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="19">SMimePKCS7Verify(InputData as string, Certificate as <A href="class-x509mbs.html">X509MBS</A>) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion184.shtml" class=version>18.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Verifies S/Mime PKCS#7 signature.<BR>
<B>Notes:</B> 
<BR>
Raises nil object exception if certificate is nil.<BR>
Returns empty text on error.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-encryption-smime-smimetest.html">/Encryption/SMime/SMime Test</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="20">VerifyData(data as string, Signature as string, Key as string, Password as string = &quot;&quot;) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion134.shtml" class=version>13.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Verifies a signature with given data and public key.<BR>
<B>Notes:</B> 
<BR>
Key can be the public or private key, but of course normally you use the public key.<BR>
Data is the raw data to compare agains. A SHA1 hash is performed and verified with the signature.<BR>
Signature must be the string returned like from SignData function. If you used EncodeHex on it, you now need to do DecodeHex.<BR>
Returns true if signature is valid and false on any other error.<BR>
Optional you can pass a password to read password protected keys.<BR>
<p>See also:<ul>
<li><A href="encryptionandhash-opensslmbs-method.html#21">VerifyData(data as string, Signature as string, Key as string, Password as string = "", Algorithm as Integer) as boolean</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="module-opensslmbs.html">OpenSSLMBS</a>.<A name="21">VerifyData(data as string, Signature as string, Key as string, Password as string = &quot;&quot;, Algorithm as Integer) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-encryptionandhash.html" translate="no">Encryption and Hash</A></td>
<td class=grau><a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a></td>
<td class=grau><a href="newinversion160.shtml" class=version>16.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Verifies a signature with given data and public key.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> test_pem         <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = ReadFile(<span style="color: #6600FE;">&quot;test.pem&quot;</span>)<br /><span style="color: #0000FF;">dim</span> test_pub         <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = ReadFile(<span style="color: #6600FE;">&quot;test.pub&quot;</span>)<br /><span style="color: #0000FF;">dim</span> data             <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = ReadFile(<span style="color: #6600FE;">&quot;Create Keys.rtf&quot;</span>) <span style="color: #800000;">// some data file</span><br /><span style="color: #0000FF;">dim</span> signature        <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span><br /><br /><span style="color: #800000;">// create signature</span><br /><br />Signature = <A href="module-opensslmbs.html">OpenSSLMBS</A>.SignData(data, test_pem, <A href="module-opensslmbs.html">OpenSSLMBS</A>.kAlgorithmSHA512)<br /><span style="color: #0000FF;">if</span> Signature = <span style="color: #6600FE;">&quot;&quot;</span> <span style="color: #0000FF;">then</span><br />  <span style="color: #800000;">// failed</span><br />  break<br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br /><br /><span style="color: #800000;">// verify with private key</span><br /><span style="color: #0000FF;">dim</span> r1 <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Boolean</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.VerifyData(data, signature, test_pem, <A href="module-opensslmbs.html">OpenSSLMBS</A>.kAlgorithmSHA512)<br /><br /><span style="color: #800000;">// verify with public key</span><br /><span style="color: #0000FF;">dim</span> r2 <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Boolean</span> = <A href="module-opensslmbs.html">OpenSSLMBS</A>.VerifyData(data, signature, test_pub, <A href="module-opensslmbs.html">OpenSSLMBS</A>.kAlgorithmSHA512)</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Key can be the public or private key, but of course normally you use the public key.<BR>
Data is the raw data to compare agains. A hash is performed with given algorithm and verified with the signature.<BR>
Signature must be the string returned like from SignData function. If you used EncodeHex on it, you now need to do DecodeHex.<BR>
Returns true if signature is valid and false on any other error.<BR>
Optional you can pass a password to read password protected keys.<BR>
<p>See also:<ul>
<li><A href="encryptionandhash-opensslmbs-method.html#20">VerifyData(data as string, Signature as string, Key as string, Password as string = "") as boolean</A></li>
</ul></p>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsencryptionplugin.html">MBS Encryption Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=encryptionandhash-opensslmbs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

