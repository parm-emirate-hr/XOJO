<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - WebView2ControlMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="WebView2ControlMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">WebView2ControlMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="control-webview2controlmbs.html">WebView2ControlMBS</a> control.</p>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="1">AddScriptToExecuteOnDocumentCreated(JavaScript as String, tag as variant = nil)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Add the provided JavaScript to a list of scripts that should be executed after the global object has been created, but before the HTML document has been parsed and before any other script included by the HTML document is executed.<BR>
<B>Notes:</B> 
<BR>
This method injects a script that runs on all top-level document and child frame page navigations. This method runs asynchronously, and you must wait for the completion handler to finish before the injected script is ready to run. When this method completes, the handler&#39;s Invoke method is called with the id of the injected script. id is a string. To remove the injected script, use RemoveScriptToExecuteOnDocumentCreated.<BR>
Note that if an HTML document has sandboxing of some kind via sandbox properties or the Content-Security-Policy HTTP header this will affect the script run here. So, for example, if the &#39;allow-modals&#39; keyword is not set then calls to the alert function will be ignored.<BR>
<BR>
Calls AddScriptToExecuteOnDocumentCreatedCompleted event later when done.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="2">AddWebResourceRequestedFilter(URL as String, resourceType as Integer)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Adds a URI and resource context filter to the WebResourceRequested event.<BR>
<B>Notes:</B> 
The URI parameter can be a wildcard string (&#39;*&#39;: zero or more, &#39;?&#39;: exactly one). See kWebResourceContext constants for description of resource context filters.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="3">CanGoBack as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Returns true if the WebView can navigate to a previous page in the navigation history.<BR>
<B>Notes:</B> 
<BR>
The HistoryChanged event will fire if CanGoBack changes value.<BR>
<BR>
Returns false if the browser is not yet initialized.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="4">CanGoForward as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Returns true if the WebView can navigate to a next page in the navigation history.<BR>
<B>Notes:</B> 
<BR>
The HistoryChanged event will fire if CanGoForward changes value.<BR>
<BR>
Returns false if the browser is not yet initialized.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="5">CapturePreview(ImageFormat as Integer = 0)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Capture an image of what WebView is displaying.<BR>
<B>Notes:</B> 
<BR>
Specify the format of the image with the imageFormat parameter. The resulting image binary data is passed to the CapturePreviewCompleted event.<BR>
<BR>
Calls CapturePreviewCompleted event when done or failed.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="6">ClearSelection</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion222.shtml" class=version>22.2</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Asks webview to clear current selection.<BR>
<B>Notes:</B> 
This is the reverse for SelectAll.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="7">Copy</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion222.shtml" class=version>22.2</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Asks webview to copy current selection to clipboard.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="8">CreatePrintSettings as <A href="class-webview2printsettingsmbs.html">WebView2PrintSettingsMBS</A></A></b> &nbsp; <b style="color: #00008B"> New in 23.2 </b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion232.shtml" class=version>23.2</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Creates the <A href="class-webview2printsettingsmbs.html">WebView2PrintSettingsMBS</A> object used by the PrintToPdf method.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="9">Cut</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion222.shtml" class=version>22.2</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Asks webview to cut current selection.<BR>
<B>Notes:</B> 
May do a copy, if selection is read only.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="10">ExecuteScript(JavaScript as String, tag as variant = nil)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Execute JavaScript code from the javascript parameter in the current top level document rendered in the WebView.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> web <span style="color: #0000FF;">as</span> <A href="control-webview2controlmbs.html">WebView2ControlMBS</A> <span style="color: #800000;">// your control</span><br /><br />web.ExecuteScript <span style="color: #6600FE;">&quot;1+5&quot;</span> , <span style="color: #6600FE;">&quot;tag value&quot;</span><br /><br /><span style="color: #800000;">// triggers ExecuteScriptCompeleted later with result &quot;6&quot;</span><br /><br />web.ExecuteScript <span style="color: #6600FE;">&quot;window.chrome.webview.postMessage({&apos;Test&apos;: &apos;Hello, world!&apos;});&quot;</span><br /><br /><span style="color: #800000;">// triggers later WebMessageReceived later</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
This will execute asynchronously and when complete, if a handler is provided in the ExecuteScriptCompletedHandler parameter, its Invoke method will be called with the result of evaluating the provided JavaScript. The result value is a JSON encoded string. If the result is undefined, contains a reference cycle, or otherwise cannot be encoded into JSON, the JSON null value will be returned as the string &#39;null&#39;. Note that a function that has no explicit return value returns undefined. If the executed script throws an unhandled exception, then the result is also &#39;null&#39;. This method is applied asynchronously. If the method is called after NavigationStarting event during a navigation, the script will be executed in the new document when loading it, around the time ContentLoading is fired. ExecuteScript will work even if IsScriptEnabled is set to false.<BR>
<BR>
Calls ExecuteScriptCompleted event later.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="11">ExecuteScriptSync(JavaScript as String, byref ErrorCode as Integer) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion210.shtml" class=version>21.0</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Execute JavaScript code from the javascript parameter in the current top level document rendered in the WebView.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> web <span style="color: #0000FF;">as</span> <A href="control-webview2controlmbs.html">WebView2ControlMBS</A> <span style="color: #800000;">// your control</span><br /><br /><span style="color: #0000FF;">dim</span> errorCode <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">integer</span><br /><span style="color: #0000FF;">dim</span> s <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = web.ExecuteScriptSync(<span style="color: #6600FE;">&quot;1+2&quot;</span>, errorCode)<br /><br />Break <span style="color: #800000;">// s contains 3</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Same as ExecuteScript, but waits for event and returns result directly.<BR>
errorCode is zero on success.<BR>
Result is JSON as text, e.g. &quot;null&quot; if there is no result.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="12">GoBack</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Navigates the WebView to the previous page in the navigation history.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="13">GoForward</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Navigates the WebView to the next page in the navigation history.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="14">HTMLText as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion211.shtml" class=version>21.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Queries HTML text of the current website.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> web <span style="color: #0000FF;">as</span> <A href="control-webview2controlmbs.html">WebView2ControlMBS</A> <span style="color: #800000;">// your control</span><br /><br /><span style="color: #0000FF;">dim</span> text <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = web.plaintext<br /><span style="color: #0000FF;">dim</span> html <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = web.HTMLText<br /><br />break <span style="color: #800000;">// check in debugger</span></span>
</pre>
</div>
<B>Notes:</B> 
Please don&#39;t call directly from NavigationCompleted event since that can freeze. Better use timer.CallLater to call a method later to do this a millisecond later.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="15">LoadHTML(HTML as String)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Initiates a navigation to htmlContent as source HTML of a new document.<BR>
<B>Notes:</B> 
The htmlContent parameter may not be larger than 2 MB in total size. The origin of the new page will be about:blank.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="16">LoadURL(URL as String)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Cause a navigation of the top level document to the specified URI.<BR>
<B>Notes:</B> 
See the navigation events for more information. Note that this starts a navigation and the corresponding NavigationStarting event will fire sometime after this Navigate call completes.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="17">OpenDevToolsWindow</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Opens the DevTools window for the current document in the WebView.<BR>
<B>Notes:</B> 
Does nothing if called when the DevTools window is already open.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="18">Paste</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion222.shtml" class=version>22.2</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Asks webview to paste clipboard content into the current field.<BR>
<B>Notes:</B> 
This may do nothing if there is nothing to paste or nothing to receive (no field in focus).<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="19">PlainText as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion211.shtml" class=version>21.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Queries plain text of the current website.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> web <span style="color: #0000FF;">as</span> <A href="control-webview2controlmbs.html">WebView2ControlMBS</A> <span style="color: #800000;">// your control</span><br /><br /><span style="color: #0000FF;">dim</span> text <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = web.plaintext<br /><span style="color: #0000FF;">dim</span> html <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = web.HTMLText<br /><br />break <span style="color: #800000;">// check in debugger</span></span>
</pre>
</div>
<B>Notes:</B> 
Please don&#39;t call directly from NavigationCompleted event since that can freeze. Better use timer.CallLater to call a method later to do this a millisecond later.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="20">PostWebMessageAsJson(webMessageAsJson as String)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Post the specified webMessage to the top level document in this WebView.<BR>
<B>Notes:</B> 
<BR>
The top level document&#39;s window.chrome.webview&#39;s message event fires. JavaScript in that document may subscribe and unsubscribe to the event via the following:<BR>
<BR>
window.chrome.webview.addEventListener(&#39;message&#39;, handler)<BR>
window.chrome.webview.removeEventListener(&#39;message&#39;, handler)<BR>
<BR>
The event args is an instance of MessageEvent. The IsWebMessageEnabled setting must be true or this method will fail with E_INVALIDARG. The event arg&#39;s data property is the webMessage string parameter parsed as a JSON string into a JavaScript object. The event arg&#39;s source property is a reference to the window.chrome.webview object. See add_WebMessageReceived for information on sending messages from the HTML document in the WebView to the host. This message is sent asynchronously. If a navigation occurs before the message is posted to the page, then the message will not be sent.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="21">PostWebMessageAsString(webMessageAsString as String)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
This is a helper for posting a message that is a simple string rather than a JSON string representation of a JavaScript object..<BR>
<B>Notes:</B> 
This behaves in exactly the same manner as PostWebMessageAsJson but the window.chrome.webview message event arg&#39;s data property will be a string with the same value as webMessageAsString. Use this instead of PostWebMessageAsJson if you want to communicate via simple strings rather than JSON objects.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="22">Print</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion222.shtml" class=version>22.2</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Asks webview to show print dialog.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="23">PrintToPdf(Path as String, PrintSettings as <A href="class-webview2printsettingsmbs.html">WebView2PrintSettingsMBS</A> = nil)</A></b> &nbsp; <b style="color: #00008B"> New in 23.1 </b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion231.shtml" class=version>23.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Print the current page to PDF asynchronously with the provided settings.<BR>
<B>Notes:</B> 
<BR>
Use Path to specify the path to the PDF file. The host should provide an absolute path, including file name. If the path points to an existing file, the file will be overwritten. If the path is not valid, the method fails with E_INVALIDARG.<BR>
<BR>
The async PrintToPdf operation completes when the data has been written to the PDF file. At this time the PrintCompleted event is invoked. If the application exits before printing is complete, the file is not saved. Only one Printing operation can be in progress at a time. If PrintToPdf is called while a printing operation is in progress, the event is immediately invoked with isSuccessful set to false.<BR>
<BR>
Requires WebView2 in version 1.0.1020.30 or later.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="24">Reload</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Reload the current page.<BR>
<B>Notes:</B> 
This is similar to navigating to the URI of current top level document including all navigation events firing and respecting any entries in the HTTP cache. But, the back/forward history will not be modified.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="25">RemoveScriptToExecuteOnDocumentCreated(ID as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Remove the corresponding JavaScript added using AddScriptToExecuteOnDocumentCreated with the specified script id.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="26">RemoveWebResourceRequestedFilter(URL as String, resourceType as Integer)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Removes a matching WebResource filter that was previously added for the WebResourceRequested event.<BR>
<B>Notes:</B> 
If the same filter was added multiple times, then it will need to be removed as many times as it was added for the removal to be effective. Raises exception with E_INVALIDARG for a filter that was never added.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="27">SelectAll</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion222.shtml" class=version>22.2</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Asks webview to select all text.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="28">Stop</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Stop all navigations and pending resource fetches.<BR>
<B>Notes:</B> 
Does not stop scripts.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=webview2-webview2controlmbs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

