<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - SQLDatabaseMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="SQLDatabaseMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">SQLDatabaseMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-sqldatabasembs.html">SQLDatabaseMBS</a> class.  </p>
<p>
 
<a href="sql-sqldatabasembs-method1.html">Next items</a>
</p>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="1">BeginTransaction</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion221.shtml" class=version>22.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Begins a transaction.<BR>
<B>Notes:</B> 
<BR>
This method does nothing. Why?<BR>
Well, if auto commit is on, you don&#39;t need to call this.<BR>
If auto commit is off, we call BeginTransaction for you, so if you call this method you would call it a second time and get an error.<BR>
We have this method for compatibility to other SQL database classes from Xojo.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="2">CancelAllCommands</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion184.shtml" class=version>18.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Cancel all commands for the connection.<BR>
<B>Notes:</B> 
This loops over the list of commands associated with this connection and calls Cancel on them.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="3">Commands as <A href="class-sqlcommandmbs.html">SQLCommandMBS</A>()</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion184.shtml" class=version>18.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Queries list of all command objects related to the connection.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="4">Connect as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion93.shtml" class=version>9.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Connects to the database.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> db <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-sqldatabasembs.html">SQLDatabaseMBS</A><br /><br /><span style="color: #800000;">// where is the library?</span><br />db.SetFileOption <A href="class-sqlconnectionmbs.html">SQLConnectionMBS</A>.kOptionLibraryMySQL, SpecialFolder.UserHome.Child(<span style="color: #6600FE;">&quot;libmysqlclient.dylib&quot;</span>)<br /><br /><span style="color: #800000;">// connect to database</span><br /><span style="color: #800000;">// in this example it is MySQL,</span><br /><span style="color: #800000;">// but can also be Sybase, Informix, Oracle, DB2</span><br /><span style="color: #800000;">// SQLServer, InterBase, SQLBase and ODBC</span><br /><br />db.DatabaseName=<span style="color: #6600FE;">&quot;mysql:192.168.1.80,3306@test&quot;</span><br /><br />db.UserName=<span style="color: #6600FE;">&quot;root&quot;</span><br />db.Password=<span style="color: #6600FE;">&quot;&quot;</span><br /><br /><span style="color: #800000;">// or postgreSQL with timeout and ssl mode</span><br />db.DatabaseName=<span style="color: #6600FE;">&quot;PostgreSQL:127.0.0.1,5432@dbname=postgres connect_timeout=10 sslmode=require&quot;</span><br /><br /><span style="color: #0000FF;">if</span> db.Connect <span style="color: #0000FF;">then</span><br />  <br />  MsgBox <span style="color: #6600FE;">&quot;We are connected!&quot;</span><br />  <br />  MsgBox <span style="color: #6600FE;">&quot;Server Version: &quot;</span>+db.Connection.ServerVersionString<br />  <br />  <span style="color: #800000;">// Disconnect is optional</span><br />  <span style="color: #800000;">// autodisconnect will ocur in destructor if needed</span><br />  <br /><span style="color: #0000FF;">else</span><br />  MsgBox db.ErrorMessage<br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Returns true on success and false on failure.<BR>
<BR>
Please set the DatabaseName, UserName and Password properties. The Host property is ignored.<BR>
The database name must contain the complete information and a prefix for the kind of database.<BR>
<BR>
Use this prefixes: &quot;CubeSQL:&quot;, &quot;SQLAnywhere:&quot;, &quot;ODBC:&quot;, &quot;Oracle:&quot;, &quot;SQLServer:&quot;, &quot;Firebird:&quot;, &quot;DuckDB:&quot;, &quot;InterBase:&quot;, &quot;SQLBase:&quot;, &quot;DB2:&quot;, &quot;Informix:&quot;, &quot;Sybase:&quot;, &quot;MySQL:&quot;, &quot;PostgreSQL:&quot; or &quot;SQLite:&quot;.<BR>
Connect to Microsoft Access, FileMaker Server (or Pro), Microsoft Visual FoxPro and others via ODBC.<BR>
<BR>
For IPv6 we changed plugin to use , instead of : for the port separator. So please use , to separate port from IP or host.<BR>
<BR>
For Firebird, if you connect to a database and you have 32/64bit mismatch, you get error number 3.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="5">ConnectMT as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion154.shtml" class=version>15.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Connects to the database.<BR>
<B>Notes:</B> 
<BR>
Returns true on success and false on failure.<BR>
<BR>
Please set the DatabaseName, UserName and Password properties. The Host property is ignored.<BR>
The database name must contain the complete information and a prefix for the kind of database.<BR>
<BR>
Use this prefixes: &quot;CubeSQL:&quot;, &quot;SQLAnywhere:&quot;, &quot;ODBC:&quot;, &quot;Oracle:&quot;, &quot;SQLServer:&quot;, &quot;Firebird:&quot;, &quot;DuckDB:&quot;, &quot;InterBase:&quot;, &quot;SQLBase:&quot;, &quot;DB2:&quot;, &quot;Informix:&quot;, &quot;Sybase:&quot;, &quot;MySQL:&quot;, &quot;PostgreSQL:&quot; or &quot;SQLite:&quot;.<BR>
Connect to Microsoft Access, FileMaker Server (or Pro), Microsoft Visual FoxPro and others via ODBC.<BR>
<BR>
For IPv6 we changed plugin to use , instead of : for the port separator. So please use , to separate port from IP or host.<BR>
<BR>
Same as Connect, but if you run this on a thread, the plugin gives time to other threads so the rest of your application runs just fine.<BR>
<BR>
The MT method will not trigger WillConnect and DidConnect events.<BR>
<BR>
The work is performed on a preemptive thread, so this function does not block the application and can yield time to other Xojo threads. Must be called in a Xojo thread to enjoy benefits. If called in main thread will block, but keep other background threads running.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="6">Constructor(globals as <A href="class-sqlglobalsmbs.html">SQLGlobalsMBS</A> = nil)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion132.shtml" class=version>13.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
The constructor.<BR>
<B>Notes:</B> 
Please don&#39;t call this directly as it&#39;s called automatically with using new command.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="7">CubeSQLLastInsertID as Int64</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Returns the last auto increment value from last insert command.<BR>
<B>Notes:</B> 
Only for CubeSQL connections. May raise error if not available.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="8">CubeSQLReceiveData(byref data as String, byref IsEndChunk as Boolean) as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Receives a data chunk for file download.<BR>
<B>Notes:</B> 
<BR>
Returns true on success.<BR>
Data is set with data and IsEndChunk is set to true for last chunk.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="9">CubeSQLSendData(data as MemoryBlock)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Sends data chunk for file upload.<BR>
<B>Notes:</B> 
This is the sendchunk function in CubeSQL.<BR>
<p>See also:<ul>
<li><A href="sql-sqldatabasembs-method.html#10">CubeSQLSendData(data as String)</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="10">CubeSQLSendData(data as String)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Sends data chunk for file upload.<BR>
<B>Notes:</B> 
This is the sendchunk function in CubeSQL.<BR>
<p>See also:<ul>
<li><A href="sql-sqldatabasembs-method.html#9">CubeSQLSendData(data as MemoryBlock)</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="11">CubeSQLSendEndData</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Sends end data packet.<BR>
<B>Notes:</B> 
This is the send_enddata function in CubeSQL.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="12">InsertRecord(TableName as String, Record as Dictionary)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion183.shtml" class=version>18.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Convenience function to insert a record.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> db <span style="color: #0000FF;">as</span> <A href="class-sqldatabasembs.html">SQLDatabaseMBS</A> <span style="color: #800000;">// your database connection</span><br /><br /><span style="color: #0000FF;">dim</span> d <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> Dictionary<br /><br />d.Value(<span style="color: #6600FE;">&quot;ID&quot;</span>)=2<br />d.Value(<span style="color: #6600FE;">&quot;text&quot;</span>)=<span style="color: #6600FE;">&quot;test insert&quot;</span><br />d.Value(<span style="color: #6600FE;">&quot;other&quot;</span>)=<span style="color: #6600FE;">&quot;Just a test&quot;</span><br /><br />db.InsertRecord(<span style="color: #6600FE;">&quot;test_tbl&quot;</span>, d)<br /><br /><span style="color: #0000FF;">if</span> db.Error <span style="color: #0000FF;">then</span><br />  MsgBox db.ErrorMessage<br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
The plugin builds for you SQL statement with prepared statement and runs the insert command with values.<BR>
Lasterror is set or exception raised as with SQLExecute.<BR>
Internally this uses a prepared statement. You can check the generated statement via LastStatement property.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="13">Listen</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion151.shtml" class=version>15.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Start listening for notifications.<BR>
<B>Notes:</B> 
<BR>
Works only for PostgresSQL Client.<BR>
Please set client or connect before calling this method.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="14">MySQLInsertID as Int64</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Returns the last auto increment value from last insert command.<BR>
<B>Notes:</B> 
<BR>
Please query value right after doing Insert. This value is reset when you call commit.<BR>
<BR>
see also<BR>
<a href="http://dev.mysql.com/doc/refman/5.1/en/mysql-insert-id.html" target=_blank>http://dev.mysql.com/doc/refman/5.1/en/mysql-insert-id.html</a><BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="15">Option(name as string) as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>property</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Sets an option for the connection.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> c <span style="color: #0000FF;">as</span> <A href="class-sqldatabasembs.html">SQLDatabaseMBS</A> <span style="color: #800000;">// your database connection</span><br /><br /><span style="color: #800000;">// for Microsoft SQL use OLEDB, so you don&apos;t need native SQL drivers installed...</span><br />c.Option(<span style="color: #6600FE;">&quot;UseAPI&quot;</span>) = <span style="color: #6600FE;">&quot;OLEDB&quot;</span><br />c.Option(<span style="color: #6600FE;">&quot;SQLNCLI.LIBS&quot;</span>) = <span style="color: #6600FE;">&quot;sqlsrv32.dll&quot;</span> <span style="color: #800000;">// Library included in Windows Vista and newer</span><br /><br /><span style="color: #800000;">// for SQLite, set flag to open database file read only:</span><br />c.Option(<span style="color: #6600FE;">&quot;SQLiteVFSFlags&quot;</span>) = <span style="color: #6600FE;">&quot;1&quot;</span><br /><br /><span style="color: #800000;">// turn on auto cache</span><br />c.Option(<span style="color: #6600FE;">&quot;AutoCache&quot;</span>) = <span style="color: #6600FE;">&quot;true&quot;</span><br /><br /><span style="color: #800000;">// set connection timeout for ODBC:</span><br />c.Option(<span style="color: #6600FE;">&quot;SQL_ATTR_CONNECTION_TIMEOUT&quot;</span>) = <span style="color: #6600FE;">&quot;10&quot;</span><br /><br /><span style="color: #800000;">// cache insert statements for AddRow/InsertRecord</span><br />c.Option(<span style="color: #6600FE;">&quot;CacheInsertStatement&quot;</span>) = <span style="color: #6600FE;">&quot;true&quot;</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
We have a collection of library files here:<BR>
<a href="https://www.monkeybreadsoftware.de/xojo/download/plugin/Libs/" target=_blank>https://www.monkeybreadsoftware.de/xojo/download/plugin/Libs/</a><BR>
(Read and Write computed property)<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="16">Prepare(statement as string) as <A href="class-sqlpreparedstatementmbs.html">SQLPreparedStatementMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion164.shtml" class=version>16.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Prepares a statement.<BR>
<B>Notes:</B> 
<BR>
Returns prepared statement or nil in case of error.<BR>
Please check ErrorMessage property for errors.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="17">SetFileOption(name as string, file as folderitem)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Sets an option with passing a file path.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> db <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-sqldatabasembs.html">SQLDatabaseMBS</A><br /><br /><span style="color: #800000;">// where is the library?</span><br />db.SetFileOption <A href="class-sqlconnectionmbs.html">SQLConnectionMBS</A>.kOptionLibraryMySQL, SpecialFolder.UserHome.Child(<span style="color: #6600FE;">&quot;libmysqlclient.dylib&quot;</span>)</span>
</pre>
</div>
<B>Notes:</B> 
Makes sure the path is correct and you have a 32 or 64-bit library matching the architecture of your application.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="18">SQLExecute(ExecuteString as string, CommandType as Integer)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion132.shtml" class=version>13.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Runs the SQLExecute threaded.<BR>
<B>Notes:</B> 
Same as SQLExecute, but with additional CommandType parameter.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="19">SQLExecuteMT(ExecuteString as string, CommandType as Integer = 0)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion125.shtml" class=version>12.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Runs the SQLExecute threaded.<BR>
<B>Notes:</B> 
<BR>
Same as SQLExecute, but if you run this on a thread, the plugin gives time to other threads so the rest of your application runs just fine.<BR>
<BR>
The work is performed on a preemptive thread, so this function does not block the application and can yield time to other Xojo threads. Must be called in a Xojo thread to enjoy benefits. If called in main thread will block, but keep other background threads running.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="20">SQLiteBackupFinish(Backup as <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A>) as integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Finishes a backup run.<BR>
<B>Notes:</B> 
<BR>
When BackupStep has returned kErrorDone, or when the application wishes to abandon the backup operation, the application should destroy the <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> by passing it to BackupFinish. The BackupFinish interfaces releases all resources associated with the <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object. If BackupStep has not yet returned kErrorDone, then any active write-transaction on the destination database is rolled back. The <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object is invalid and may not be used following a call to BackupFinish.<BR>
The value returned by BackupFinish is kErrorOK if no BackupStep errors occurred, regardless or whether or not BackupStep completed. If an out-of-memory condition or IO error occurred during any prior BackupStep call on the same <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object, then BackupFinish returns the corresponding error code.<BR>
A return of kErrorBusy or kErrorLocked from BackupStep is not a permanent error and does not affect the return value of BackupFinish.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="21">SQLiteBackupInit(Dest as Variant, DestName as String, Source as Variant, SourceName as String) as <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Initializes a backup.<BR>
<B>Notes:</B> 
<BR>
The backup API copies the content of one database into another. It is useful either for creating backups of databases or for copying in-memory databases to or from persistent files. <BR>
<BR>
see also<BR>
<a href="http://www.sqlite.org/c3ref/backup_finish.html" target=_blank>http://www.sqlite.org/c3ref/backup_finish.html</a><BR>
<BR>
Exclusive access is required to the destination database for the duration of the operation. However the source database is only read-locked while it is actually being read; it is not locked continuously for the entire backup operation. Thus, the backup may be performed on a live source database without preventing other users from reading or writing to the source database while the backup is underway. <BR>
<BR>
To perform a backup operation:<BR>
<UL><LI>
BackupInit is called once to initialize the backup,
</LI><LI>
BackupStep is called one or more times to transfer the data between the two databases, and finally
</LI><LI>
BackupFinish is called to release all resources associated with the backup operation. 
</LI></UL>
There should be exactly one call to BackupFinish for each successful call to BackupInit.<BR>
<BR>
The D and N arguments to BackupInit(D,N,S,M) are the database connection associated with the destination database and the database name, respectively. The database name is &quot;main&quot; for the main database, &quot;temp&quot; for the temporary database, or the name specified after the AS keyword in an ATTACH statement for an attached database. The S and M arguments passed to BackupInit(D,N,S,M) identify the database connection and database name of the source database, respectively. The source and destination database connections (parameters S and D) must be different or else BackupInit(D,N,S,M) will file with an error.<BR>
If an error occurs within BackupInit(D,N,S,M), then nil is returned and an error code and error message are store3d in the destination database connection D. The error code and message for the failed call to BackupInit can be retrieved using the ErrCode and ErrMessage functions. A successful call to BackupInit returns a <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object. The <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object may be used with the BackupStep and BackupFinish functions to perform the specified backup operation.<BR>
<BR>
Concurrent Usage of Database Handles<BR>
The source database connection may be used by the application for other purposes while a backup operation is underway or being initialized. If SQLite is compiled and configured to support threadsafe database connections, then the source database connection may be used concurrently from within other threads.<BR>
However, the application must guarantee that the destination database connection is not passed to any other API (by any thread) after BackupInit is called and before the corresponding call to BackupFinish. SQLite does not currently check to see if the application incorrectly accesses the destination database connection and so no error code is reported, but the operations may malfunction nevertheless. Use of the destination database connection while a backup is in progress might also also cause a mutex deadlock.<BR>
If running in shared cache mode, the application must guarantee that the shared cache used by the destination database is not accessed while the backup is running. In practice this means that the application must guarantee that the disk file being backed up to is not accessed by any connection within the process, not just the specific connection that was passed to BackupInit.<BR>
The <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object itself is partially threadsafe. Multiple threads may safely make multiple concurrent calls to BackupStep. However, the BackupRemaining and BackupPageCount APIs are not strictly speaking threadsafe. If they are invoked at the same time as another thread is invoking BackupStep it is possible that they return invalid values.<BR>
<BR>
Source and Dest can be <A href="class-sqlconnectionmbs.html">SQLConnectionMBS</A> or <A href="class-sqldatabasembs.html">SQLDatabaseMBS</A>. You need to pass source and dest, even if one is self as we give you the option to decide where to pass the current database connection.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="22">SQLiteBackupPageCount(Backup as <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A>) as integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Returns the number of pages in total.<BR>
<B>Notes:</B> 
<BR>
Each call to BackupStep sets two values inside the <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object: the number of pages still to be backed up and the total number of pages in the source databae file. The BackupRemaining and BackupPageCount interfaces retrieve these two values, respectively.<BR>
The values returned by these functions are only updated by BackupStep. If the source database is modified during a backup operation, then the values are not updated to account for any extra pages that need to be updated or the size of the source database file changing.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="23">SQLiteBackupRemaining(Backup as <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A>) as integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Returns the number of pages remaining.<BR>
<B>Notes:</B> 
<BR>
Each call to BackupStep sets two values inside the <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object: the number of pages still to be backed up and the total number of pages in the source databae file. The BackupRemaining and BackupPageCount interfaces retrieve these two values, respectively.<BR>
The values returned by these functions are only updated by BackupStep. If the source database is modified during a backup operation, then the values are not updated to account for any extra pages that need to be updated or the size of the source database file changing.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="24">SQLiteBackupStep(Backup as <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A>, Pages as Integer) as integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Copies up to Pages pages between the source and destination databases specified by <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object.<BR>
<B>Notes:</B> 
<BR>
If N is negative, all remaining source pages are copied. If BackupStep(B,N) successfully copies N pages and there are still more pages to be copied, then the function resturns kErrorOK. If BackupStep(B,N) successfully finishes copying all pages from source to destination, then it returns kErrorDone. If an error occurs while running BackupStep(B,N), then an error code is returned. As well as kErrorOK and kErrorDone, a call to BackupStep may return kErrorReadOnly, kErrorNoMem, kErrorBusy, kErrorLocked, or an kErrorIOACCESS | kErrorIOXXX extended error code.<BR>
The BackupStep might return kErrorReadOnly if the destination database was opened read-only or if the destination is an in-memory database with a different page size from the source database.<BR>
If BackupStep cannot obtain a required file-system lock, then the sqlite3_busy_handler | busy-handler function is invoked (if one is specified). If the busy-handler returns non-zero before the lock is available, then kErrorBusy is returned to the caller. In this case the call to BackupStep can be retried later. If the source database connection is being used to write to the source database when BackupStep is called, then kErrorLocked is returned immediately. Again, in this case the call to BackupStep can be retried later on. (If kErrorIOACCESS | kErrorIOXXX, kErrorNoMem, or kErrorReadOnly is returned, then there is no point in retrying the call to BackupStep. These errors are considered fatal.) The application must accept that the backup operation has failed and pass the backup operation handle to the BackupFinish to release associated resources.<BR>
The first call to BackupStep obtains an exclusive lock on the destination file. The exclusive lock is not released until either BackupFinish is called or the backup operation is complete and BackupStep returns kErrorDone. Every call to BackupStep obtains a shared lock on the source database that lasts for the duration of the BackupStep call. Because the source database is not locked between calls to BackupStep, the source database may be modified mid-way through the backup process. If the source database is modified by an external process or via a database connection other than the one being used by the backup operation, then the backup will be automatically restarted by the next call to BackupStep. If the source database is modified by the using the same database connection as is used by the backup operation, then the backup database is automatically updated at the same time.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="25">SQLiteConnectionHandle as Ptr</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion222.shtml" class=version>22.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Returns the current connection reference for the database.<BR>
<B>Notes:</B> 
sqlite3 pointer for using in declares.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="26">SQLiteEnableLoadExtension(OnOff as boolean)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Enables/disables extension loading for the given connection.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="27">SQLiteLastInsertRowID as Int64</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Returns Last Insert Rowid.<BR>
<B>Notes:</B> 
<BR>
Each entry in an SQLite table has a unique 64-bit signed integer key called the ROWID. The rowid is always available as an undeclared column named ROWID, OID, or _ROWID_ as long as those names are not also used by explicitly declared columns. If the table has a column of type INTEGER PRIMARY KEY then that column is another alias for the rowid.<BR>
<BR>
This routine returns the rowid of the most recent successful INSERT into the database from the database connection in the first argument. If no successful INSERTs have ever occurred on that database connection, zero is returned.<BR>
<BR>
(If an INSERT occurs within a trigger, then the rowid of the inserted row is returned by this routine as long as the trigger is running. But once the trigger terminates, the value returned by this routine reverts to the last value inserted before the trigger fired.)<BR>
<BR>
An INSERT that fails due to a constraint violation is not a successful INSERT and does not change the value returned by this routine.  ^Thus INSERT OR FAIL, INSERT OR IGNORE, INSERT OR ROLLBACK, and INSERT OR ABORT make no changes to the return value of this routine when their insertion fails.  ^(When INSERT OR REPLACE encounters a constraint violation, it does not fail.  The INSERT continues to completion after deleting rows that caused the constraint problem so INSERT OR REPLACE will always change the return value of this interface.)^<BR>
<BR>
For the purposes of this routine, an INSERT is considered to be successful even if it is subsequently rolled back.<BR>
<BR>
This function is accessible to SQL statements via the last_insert_rowid() SQL function.<BR>
<BR>
If a separate thread performs a new INSERT on the same database connection while the LastInsertRowID function is running and thus changes the last insert rowid, then the value returned by LastInsertRowID is unpredictable and might not equal either the old or the new last insert rowid.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="28">SQLiteLibVersion as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Queries the version string of the SQLite library.<BR>
</div>
<div class="WLM">
<b><a href="class-sqldatabasembs.html">SQLDatabaseMBS</a>.<A name="29">SQLiteLoadExtension(file as FolderItem, ByRef ErrorMessage as String) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion195.shtml" class=version>19.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Loads an SQLite extension library from the named file.<BR>
<B>Notes:</B> 
<BR>
The LoadExtension interface attempts to load an SQLite extension library contained in the file.<BR>
<BR>
Returns kErrorOk on success and kErrorError if something goes wrong.<BR>
Extension loading must be enabled using EnableLoadExtension prior to calling this API, otherwise an error will be returned.<BR>
<p>See also:<ul>
<li><A href="sql-sqldatabasembs-method1.html">SQLiteLoadExtension(path as String, ByRef ErrorMessage as String) as Integer</A></li>
</ul></p>
</div>
<p>
 
<a href="sql-sqldatabasembs-method1.html">Next items</a>
</p>
<p>The items on this page are in the following plugins: <a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=sql-sqldatabasembs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

