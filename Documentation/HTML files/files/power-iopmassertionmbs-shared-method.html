<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - IOPMAssertionMBS shared methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="IOPMAssertionMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">IOPMAssertionMBS shared methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-iopmassertionmbs.html">IOPMAssertionMBS</a> class.  </p>
<div class="M">
<b><a href="class-iopmassertionmbs.html">IOPMAssertionMBS</a>.<A name="1">AssertionsByProcess as Dictionary</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-power.html" translate="no">Power</A></td>
<td class=grau><a href="plugins-mbsmacosxplugin.html">MBS MacOSX Plugin</a></td>
<td class=grau><a href="newinversion132.shtml" class=version>13.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Returns a dictionary listing all assertions, grouped by their owning process.<BR>
<B>Notes:</B> 
<BR>
Notes: One process may have multiple assertions. Several processes may have asserted the same assertion to different levels.<BR>
<BR>
On success, this returns a dictionary of assertions per process. At the top level, keys to the Dictionary are pids stored as Integer. The value associated with each pid is an array of active assertions. Each entry in the array is an assertion represented as a Dictionary. See the keys kIOPMAssertionTypeKey and kIOPMAssertionLevelKey. <BR>
</div>
<div class="M">
<b><a href="class-iopmassertionmbs.html">IOPMAssertionMBS</a>.<A name="2">AssertionsStatus as Dictionary</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-power.html" translate="no">Power</A></td>
<td class=grau><a href="plugins-mbsmacosxplugin.html">MBS MacOSX Plugin</a></td>
<td class=grau><a href="newinversion132.shtml" class=version>13.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Returns a list of available assertions and their system-wide levels.<BR>
<B>Notes:</B> 
<BR>
The system-wide level is the maximum of all individual assertions&#39; levels.<BR>
<BR>
On success, this returns a Dictionary of all assertions currently available. <BR>
The keys in the dictionary are the assertion types, and the value of each is a CFNumber that represents the aggregate level for that assertion.<BR>
</div>
<div class="M">
<b><a href="class-iopmassertionmbs.html">IOPMAssertionMBS</a>.<A name="3">CreateWithDescription(AssertionType as string, Name as string, Details as string = &quot;&quot;, HumanReadableReason as string = &quot;&quot;, LocalizationBundlePath as string = &quot;&quot;, Timeout as Double = 0, TimeoutAction as string = &quot;&quot;) as <A href="class-iopmassertionmbs.html">IOPMAssertionMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-power.html" translate="no">Power</A></td>
<td class=grau><a href="plugins-mbsmacosxplugin.html">MBS MacOSX Plugin</a></td>
<td class=grau><a href="newinversion132.shtml" class=version>13.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Creates an IOPMAssertion. <BR>
<B>Notes:</B> 
<BR>
This is the preferred API to call to create an assertion. It allows the caller to specify the Name, Details, and HumanReadableReason at creation time. There are other keys that can further describe an assertion, but most developers don&#39;t need     to use them. Use SetProperty or CreateWithProperties  if you need to specify properties that aren&#39;t available here.<BR>
<BR>
AssertionType: An assertion type constant.  Caller must specify this argument.<BR>
Name: A String value to correspond to key kIOPMAssertionNameKey. Caller must specify this argument.<BR>
Details: A String value to correspond to key kIOPMAssertionDetailsKey. Caller my pass &quot;&quot;, but it helps power users and administrators identify the reasons for this assertion.<BR>
HumanReadableReason: A String value to correspond to key kIOPMAssertionHumanReadableReasonKey. Caller may pass &quot;&quot;, but if it&#39;s specified OS X may display it to users to describe the active assertions on their system.<BR>
LocalizationBundlePath: A String value to correspond to key kIOPMAssertionLocalizationBundlePathKey. This bundle path should include a localization for the string HumanReadableReason. Caller may pass &quot;&quot;, but this argument is required if caller specifies HumanReadableReason.<BR>
Timeout: Specifies a timeout for this assertion. Pass 0 for no timeout.<BR>
TimeoutAction: Specifies a timeout action. Caller my pass &quot;&quot;. If a timeout is specified but a TimeoutAction is not, the default timeout action is kIOPMAssertionTimeoutActionTurnOff.<BR>
<BR>
On success this function returns a new assertion.<BR>
</div>
<div class="M">
<b><a href="class-iopmassertionmbs.html">IOPMAssertionMBS</a>.<A name="4">CreateWithHandle(Handle as Integer) as <A href="class-iopmassertionmbs.html">IOPMAssertionMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-power.html" translate="no">Power</A></td>
<td class=grau><a href="plugins-mbsmacosxplugin.html">MBS MacOSX Plugin</a></td>
<td class=grau><a href="newinversion132.shtml" class=version>13.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Creates a new object with retaining given handle.<BR>
</div>
<div class="M">
<b><a href="class-iopmassertionmbs.html">IOPMAssertionMBS</a>.<A name="5">CreateWithName(type as string, level as Integer, name as string) as <A href="class-iopmassertionmbs.html">IOPMAssertionMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-power.html" translate="no">Power</A></td>
<td class=grau><a href="plugins-mbsmacosxplugin.html">MBS MacOSX Plugin</a></td>
<td class=grau><a href="newinversion132.shtml" class=version>13.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Dynamically requests a system behavior from the power management system.<BR>
<B>Notes:</B> 
<BR>
Create is deprecated in favor of CreateWithProperties. Please use that version of this API instead.<BR>
<BR>
No special privileges are necessary to make this call - any process may activate a power assertion. Caller must specify an AssertionName - &quot;&quot; is not a valid input.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Type</TD><TD valign="top">The String assertion type to request from the PM system.</TD></TR>
<TR><TD valign="top">Level</TD><TD valign="top">Pass kIOPMAssertionLevelOn or kIOPMAssertionLevelOff.</TD></TR>
<TR><TD valign="top">Name</TD><TD valign="top">A string that describes the name of the caller and the activity being handled by this assertion (e.g. &quot;Mail Compacting Mailboxes&quot;). Name may be no longer than 128 characters.</TD></TR>
</TABLE>
<BR>
On success, returns an <A href="class-iopmassertionmbs.html">IOPMAssertionMBS</A> object.<BR>
</div>
<div class="M">
<b><a href="class-iopmassertionmbs.html">IOPMAssertionMBS</a>.<A name="6">CreateWithProperties(AssertionProperties as Dictionary) as <A href="class-iopmassertionmbs.html">IOPMAssertionMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-power.html" translate="no">Power</A></td>
<td class=grau><a href="plugins-mbsmacosxplugin.html">MBS MacOSX Plugin</a></td>
<td class=grau><a href="newinversion132.shtml" class=version>13.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Creates an IOPMAssertion with more flexibility than CreateWithDescription.<BR>
<B>Notes:</B> 
<BR>
AssertionProperties: Dictionary providing the properties of the assertion that need to be created.<BR>
On successful return, returns the assertion.<BR>
<BR>
Create a new PM assertion - the caller must specify the type of assertion, initial level, and its  properties as IOPMAssertionDictionaryKeys keys in the AssertionProperties dictionary. The following keys are recommend and/or required to be specified in the AssertionProperties dictionary argument.<BR>
<BR>
<UL><LI>
Required kIOPMAssertionTypeKey define the assertion type.
</LI><LI>
Required kIOPMAssertionValueKey define an inital value.
</LI><LI>
Required kIOPMAssertionNameKey Caller must describe the name for the activity that requires the change in behavior provided by the assertion. 
</LI><LI>
Optional kIOPMAssertionDetailsKey Caller may describe context-specific data about the assertion. 
</LI><LI>
Optional kIOPMAssertionHumanReadableReasonKey Caller may describe the reason for creating the assertion in a localizable String. This should be a human readable phrase that describes the actions the calling process is taking while the assertion is held, like &quot;Downloading TV episodes&quot;, or &quot;Compiling Projects&quot;
</LI><LI>
Optional kIOPMAssertionLocalizationBundlePathKey Caller may provide its bundle&#39;s path, where OS X can localize for GUI display the String specified by kIOPMAssertionHumanReadableReasonKey.
</LI><LI>
Optional kIOPMAssertionPlugInIDKey if the caller is a plugin with a different identity than the process it&#39;s loaded in.
</LI><LI>
Optional kIOPMAssertionFrameworkIDKey if the caller is a framework acting on behalf of a process.
</LI><LI>
Optional The caller may specify a timeout.
</UL>
</div>
<div class="M">
<b><a href="class-iopmassertionmbs.html">IOPMAssertionMBS</a>.<A name="7">DeclareUserActivity(AssertionName as string, userType as Integer, byref AssertionID as Integer) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-power.html" translate="no">Power</A></td>
<td class=grau><a href="plugins-mbsmacosxplugin.html">MBS MacOSX Plugin</a></td>
<td class=grau><a href="newinversion132.shtml" class=version>13.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Declares that the user is active on the system. <BR>
<B>Notes:</B> 
<BR>
This causes the display to power on and postpone display sleep up to the user&#39;s display sleep Energy Saver settings. If you prefer to hold the display awake for a longer period and you know how long you&#39;d like to hold it, consider taking assertion      kIOPMAssertionTypePreventUserIdleDisplaySleep using CreateWithDescription instead.<BR>
<BR>
No special privileges are necessary to make this call - any process may call this API. Caller must specify an AssertionName.<BR>
<BR>
AssertionName: A string that describes the name of the caller and the activity being handled by this assertion (e.g. &quot;Mail Compacting Mailboxes&quot;). Name may be no longer than 128 characters.<BR>
userType: This parameter specifies if the active user is located locally in front of the system or connected to the system over the network. Various components of the system are maintained at different power levels depending on user location.<BR>
<BR>
On Success, unique id will be returned in this parameter. Caller may call this function again with the unique id retured previously to report continous user activity. The unique id returned by this function may change on each call depending on how frequently this function call is repeated and the current display sleep timer value. If you make this call more than once, track the returned value for assertionID, and pass it in as an argument on each call.<BR>
<BR>
Returns kIOReturnSuccess (0) on success, any other return indicates PM could not successfully activate the specified assertion.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmacosxplugin.html">MBS MacOSX Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=power-iopmassertionmbs-shared-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

