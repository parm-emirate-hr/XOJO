<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - FileMappingMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="FileMappingMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">FileMappingMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-filemappingmbs.html">FileMappingMBS</a> class.  </p>
<div class="WLM">
<b><a href="class-filemappingmbs.html">FileMappingMBS</a>.<A name="1">CloseFile</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-filemappingandsharedmemory.html" translate="no">Filemapping and Shared Memory</A></td>
<td class=grau><a href="plugins-mbsutilplugin.html">MBS Util Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Closes the file you used for backstore.<BR>
<B>Notes:</B> 
Called by the destructor automatically.<BR>
</div>
<div class="WLM">
<b><a href="class-filemappingmbs.html">FileMappingMBS</a>.<A name="2">CloseFileMapping</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-filemappingandsharedmemory.html" translate="no">Filemapping and Shared Memory</A></td>
<td class=grau><a href="plugins-mbsutilplugin.html">MBS Util Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Closes the file mapping.<BR>
<B>Notes:</B> 
<BR>
Called by the destructor automatically.<BR>
You close all views, than you close the file mapping and finally the file.<BR>
</div>
<div class="WLM">
<b><a href="class-filemappingmbs.html">FileMappingMBS</a>.<A name="3">Constructor</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-filemappingandsharedmemory.html" translate="no">Filemapping and Shared Memory</A></td>
<td class=grau><a href="plugins-mbsutilplugin.html">MBS Util Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
The dummy constructor used if you create a shared memory object.<BR>
<B>Notes:</B> 
Use this constructor if you continue with OpenSharedMemory or CreateSharedMemory.<BR>
<p>See also:<ul>
<li><A href="filemappingandsharedmemory-filemappingmbs-method.html#4">Constructor(file as folderitem, write as boolean = false)</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-filemappingmbs.html">FileMappingMBS</a>.<A name="4">Constructor(file as folderitem, write as boolean = false)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-filemappingandsharedmemory.html" translate="no">Filemapping and Shared Memory</A></td>
<td class=grau><a href="plugins-mbsutilplugin.html">MBS Util Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Opens or creates a file for file mapping.<BR>
<B>Notes:</B> 
<BR>
On Windows you can pass nil for the file parameter in order to have a file mapping using the swap files for back storage.<BR>
<BR>
If write is true, the file is opened/created for write access.<BR>
<p>See also:<ul>
<li><A href="filemappingandsharedmemory-filemappingmbs-method.html#3">Constructor</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-filemappingmbs.html">FileMappingMBS</a>.<A name="5">CreateSharedMemory(name as string, Size as Int64) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-filemappingandsharedmemory.html" translate="no">Filemapping and Shared Memory</A></td>
<td class=grau><a href="plugins-mbsutilplugin.html">MBS Util Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Creates a shared memory object with the given name.<BR>
<B>Notes:</B> 
<BR>
Returns true on success and false on failure. The name must be unique on the whole PC.<BR>
<BR>
On success, you can call MapView to access memory.<BR>
isWriteable is set to true as shared memory objects are always read and write.<BR>
<BR>
Fails if the shared memory object does exist. In this case, call OpenSharedMemory.<BR>
If your application crashes, on the next run the object will still exist on Mac OS X and Linux, so you need to open or delete &amp; create it.<BR>
<BR>
The Size should be a multiply of the page size (4096).<BR>
Sets DeleteSharedMemory to true so the object is deleted by the destructor. Set it to false if you don&#39;t want that behavior.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-util-filemapping-sharedmemoryserver.html">/Util/Filemapping/Shared Memory Server</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="class-filemappingmbs.html">FileMappingMBS</a>.<A name="6">EnlargeFile(Size as Int64)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-filemappingandsharedmemory.html" translate="no">Filemapping and Shared Memory</A></td>
<td class=grau><a href="plugins-mbsutilplugin.html">MBS Util Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Resizes the file to the given size.<BR>
<B>Notes:</B> 
This is for file mappings used as temporary storage with a temporary file. You use the Constructor to create a temporary file. This file is enlarged to the size you need. Next you call OpenFileMapping and MapView. To cleanup, you close all views and the file mapping. Now before you close the file, you should call ShrinkFile. ShrinkFile reduces the file size to zero so the operation system doesn&#39;t start flushing the shared memory to the file. You can get this automatically if you set ShrinkFileOnClose to true.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-util-filemapping-hugetempstorage.html">/Util/Filemapping/Huge Temp Storage</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="class-filemappingmbs.html">FileMappingMBS</a>.<A name="7">MapView(mem as MemoryBlock, offset as Int64, Size as Integer) as <A href="class-filemappingviewmbs.html">FileMappingViewMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-filemappingandsharedmemory.html" translate="no">Filemapping and Shared Memory</A></td>
<td class=grau><a href="plugins-mbsutilplugin.html">MBS Util Plugin</a></td>
<td class=grau><a href="newinversion113.shtml" class=version>11.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Maps a portion of the file mapping or shared memory object into your application&#39;s address space.<BR>
<B>Notes:</B> 
<BR>
Returns nil on any error.<BR>
Using invalide offset/size values can lead into a bad mapping.<BR>
Here you can pass your own memoryblock for back storage.<BR>
Make sure your memory is 4 or 64 KB aligned, depending on platform.<BR>
(Windows need 64 KB, Mac only 4 KB)<BR>
<BR>
Changed Size parameter from Int32 to Integer in version 21.0.<BR>
Xojo may not handle ptr with offsets &gt; 2 GB as of version 2020r2. This is fixed in 2020r2.1.<BR>
<p>See also:<ul>
<li><A href="filemappingandsharedmemory-filemappingmbs-method.html#8">MapView(offset as Int64, Size as Integer) as FileMappingViewMBS</A></li>
</ul></p>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-util-filemapping-filemappingexample.html">/Util/Filemapping/Filemapping Example</A></li>
<li><A href="example-util-filemapping-hugetempstorage.html">/Util/Filemapping/Huge Temp Storage</A></li>
<li><A href="example-util-filemapping-sharedmemoryclient.html">/Util/Filemapping/Shared Memory Client</A></li>
<li><A href="example-util-filemapping-sharedmemoryserver.html">/Util/Filemapping/Shared Memory Server</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="class-filemappingmbs.html">FileMappingMBS</a>.<A name="8">MapView(offset as Int64, Size as Integer) as <A href="class-filemappingviewmbs.html">FileMappingViewMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-filemappingandsharedmemory.html" translate="no">Filemapping and Shared Memory</A></td>
<td class=grau><a href="plugins-mbsutilplugin.html">MBS Util Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Maps a portion of the file mapping or shared memory object into your application&#39;s address space.<BR>
<B>Notes:</B> 
<BR>
Returns nil on any error.<BR>
Using invalide offset/size values can lead into a bad mapping.<BR>
(Windows need 64 KB, Mac only 4 KB)<BR>
<BR>
Changed Size parameter from Int32 to Integer in version 21.0.<BR>
Xojo may not handle ptr with offsets &gt; 2 GB as of version 2020r2. This is fixed in 2020r2.1.<BR>
<p>See also:<ul>
<li><A href="filemappingandsharedmemory-filemappingmbs-method.html#7">MapView(mem as MemoryBlock, offset as Int64, Size as Integer) as FileMappingViewMBS</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-filemappingmbs.html">FileMappingMBS</a>.<A name="9">OpenFileMapping(MaxSize as Int64 = 0) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-filemappingandsharedmemory.html" translate="no">Filemapping and Shared Memory</A></td>
<td class=grau><a href="plugins-mbsutilplugin.html">MBS Util Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Opens a file mapping.<BR>
<B>Notes:</B> 
<BR>
If MaxSize is zero, the file size is used for creating the mapping.<BR>
The Size should be a multiply of the page size (4096).<BR>
<BR>
Returns true on success.<BR>
Do not call after using OpenSharedMemory or CreateSharedMemory as they open the file mapping for you.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-util-filemapping-filemappingexample.html">/Util/Filemapping/Filemapping Example</A></li>
<li><A href="example-util-filemapping-hugetempstorage.html">/Util/Filemapping/Huge Temp Storage</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="class-filemappingmbs.html">FileMappingMBS</a>.<A name="10">OpenSharedMemory(name as string) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-filemappingandsharedmemory.html" translate="no">Filemapping and Shared Memory</A></td>
<td class=grau><a href="plugins-mbsutilplugin.html">MBS Util Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Opens a shared memory object with the given name.<BR>
<B>Notes:</B> 
<BR>
Returns true on success and false on failure.<BR>
<BR>
On success, you can call MapView to access memory.<BR>
isWriteable is set to true as shared memory objects are always read and write.<BR>
<BR>
Fails if the shared memory object does not exist. In this case, call CreateSharedMemory.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-util-filemapping-sharedmemoryclient.html">/Util/Filemapping/Shared Memory Client</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="class-filemappingmbs.html">FileMappingMBS</a>.<A name="11">ShrinkFile</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-filemappingandsharedmemory.html" translate="no">Filemapping and Shared Memory</A></td>
<td class=grau><a href="plugins-mbsutilplugin.html">MBS Util Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Resizes the file to by empty.<BR>
<B>Notes:</B> 
Useful if you used EnlargeFile before.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsutilplugin.html">MBS Util Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=filemappingandsharedmemory-filemappingmbs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

