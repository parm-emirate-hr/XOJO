<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - MongoCollectionMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="MongoCollectionMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">MongoCollectionMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-mongocollectionmbs.html">MongoCollectionMBS</a> class.  </p>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="1">Aggregate(flags as Integer, pipelineJSON as String, OptionsJSON as String = &quot;&quot;) as <A href="class-mongocursormbs.html">MongoCursorMBS</A></A></b> &nbsp; <b style="color: #00008B"> New in 23.1 </b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion231.shtml" class=version>23.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Creates an aggregate collection.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>

<span style="color: #000000;"><span style="color: #0000FF;">dim</span> collection <span style="color: #0000FF;">as</span> <A href="class-mongocollectionmbs.html">MongoCollectionMBS</A> <span style="color: #800000;">// your collection</span><br /><span style="color: #0000FF;">Dim</span> json <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">String</span> = <span style="color: #6600FE;">&quot;[&quot;</span>+_<br />  <span style="color: #6600FE;">&quot;{ &quot;</span><span style="color: #6600FE;">&quot;$match&quot;</span><span style="color: #6600FE;">&quot; : { &quot;</span><span style="color: #6600FE;">&quot;index&quot;</span><span style="color: #6600FE;">&quot; : 123 } },&quot;</span>+_<br />  <span style="color: #6600FE;">&quot;{ &quot;</span><span style="color: #6600FE;">&quot;$sort&quot;</span><span style="color: #6600FE;">&quot; : { &quot;</span><span style="color: #6600FE;">&quot;index&quot;</span><span style="color: #6600FE;">&quot; : -1 } },&quot;</span>+_<br />  <span style="color: #6600FE;">&quot;{ &quot;</span><span style="color: #6600FE;">&quot;$limit&quot;</span><span style="color: #6600FE;">&quot; : 2 }&quot;</span>+_<br />  <span style="color: #6600FE;">&quot;]&quot;</span><br /><br />cursor = Collection.Aggregate(Collection.kFlagNone, json)<br /><span style="color: #800000;">// loop over cursor</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
This function creates a cursor which sends the aggregate command on the underlying collection upon the first call to CursorNext. For more information on building aggregation pipelines, see the MongoDB Manual entry on the aggregate command.<BR>
Returns a new cursor on success.<BR>
<BR>
Please review the documentation for MongoDB on how to build the JSON for pipeline or options.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Flag</TD><TD valign="top">Value</TD><TD valign="top">Description</TD></TR>
<TR><TD valign="top">None</TD><TD valign="top">0</TD><TD valign="top">Specify no query flags.</TD></TR>
<TR><TD valign="top">TailableCursor</TD><TD valign="top">2</TD><TD valign="top">Cursor will not be closed when the last data is retrieved. You can resume this cursor later.</TD></TR>
<TR><TD valign="top">SecondaryOk</TD><TD valign="top">4</TD><TD valign="top">Allow query of replica set secondaries.</TD></TR>
<TR><TD valign="top">NoCursorTimeout</TD><TD valign="top">16</TD><TD valign="top">The server normally times out an idle cursor after an inactivity period (10 minutes). This prevents that.</TD></TR>
<TR><TD valign="top">AwaitData</TD><TD valign="top">32</TD><TD valign="top">Use with TailableCursor. Block rather than returning no data. After a period, time out.</TD></TR>
<TR><TD valign="top">Exhaust</TD><TD valign="top">64</TD><TD valign="top">Stream the data down full blast in multiple &ldquo;reply&rdquo; packets. Faster when you are pulling down a lot of data and you know you want to retrieve it all. Only applies to cursors created from a find operation (i.e. find)</TD></TR>
<TR><TD valign="top">Partial</TD><TD valign="top">128</TD><TD valign="top">Get partial results from mongos if some shards are down (instead of throwing an error).</TD></TR>
</TABLE>
<BR>
In case of an error, raises <A href="class-mongoexceptionmbs.html">MongoExceptionMBS</A>.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="2">Command(commandJSON as String, OptionsJSON as String = &quot;&quot;) as String</A></b> &nbsp; <b style="color: #00008B"> New in 23.1 </b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion231.shtml" class=version>23.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Execute a command on the server.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>

<span style="color: #000000;"><span style="color: #0000FF;">dim</span> collection <span style="color: #0000FF;">as</span> <A href="class-mongocollectionmbs.html">MongoCollectionMBS</A> <span style="color: #800000;">// your collection</span><br /><br /><span style="color: #0000FF;">dim</span> Reply <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">String</span> = collection.Command(<span style="color: #6600FE;">&quot;{ &quot;</span><span style="color: #6600FE;">&quot;hello&quot;</span><span style="color: #6600FE;">&quot;: 1 }&quot;</span>)</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Consult the MongoDB Manual entry on Database Commands for each command&rsquo;s arguments.<BR>
<BR>
In case of an error, raises <A href="class-mongoexceptionmbs.html">MongoExceptionMBS</A>.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="3">Constructor</A></b> &nbsp; <b style="color: #8B0000"> Private </b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
The private constructor.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="4">Copy as <A href="class-mongocollectionmbs.html">MongoCollectionMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Performs a deep copy of the collection struct and its configuration.<BR>
<B>Notes:</B> 
This function does not copy the contents of the collection on the MongoDB server.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="5">DeleteMany(selectorJSON as String, OptionsJSON as String = &quot;&quot;) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Deletes many records.<BR>
<B>Notes:</B> 
<BR>
This function removes all documents in the given collection that match selector.<BR>
<BR>
To delete at most one matching document, use DeleteOne().<BR>
Returns string with JSON about errors on server.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="6">DeleteOne(selectorJSON as String, OptionsJSON as String = &quot;&quot;) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Deletes one record.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>

<span style="color: #000000;"><span style="color: #800000;">// delete record by object ID</span><br /><br /><span style="color: #0000FF;">Dim</span> oid <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> JSONItem<br />oid.Value(<span style="color: #6600FE;">&quot;$oid&quot;</span>) = <span style="color: #6600FE;">&quot;632752c4031bafedd50fbf21&quot;</span><br /><br /><span style="color: #0000FF;">Dim</span> Record <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">New</span> JSONItem<br />Record.Value(<span style="color: #6600FE;">&quot;_id&quot;</span>) = oid<br /><br /><span style="color: #0000FF;">Dim</span> Result <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">String</span> = Collection.DeleteOne(Record.toString)<br /><span style="color: #800000;">// e.g. { &quot;deletedCount&quot; : 1 }</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
This function removes at most one document in the given collection that matches selector.<BR>
<BR>
To delete all matching documents, use DeleteMany().<BR>
<BR>
Returns string with JSON about errors on server.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="7">EstimatedDocumentCount(OptionsJSON as String = &quot;&quot;) as Int64</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Executes a count query on collection.<BR>
<B>Notes:</B> 
<BR>
The count returned is not guaranteed to be accurate.<BR>
<BR>
see also<BR>
<a href="http://mongoc.org/libmongoc/current/mongoc_collection_estimated_document_count.html" target=_blank>http://mongoc.org/libmongoc/current/mongoc_collection_estimated_document_count.html</a><BR>
<p>See also:<ul>
<li><A href="mongodb-mongocollectionmbs-method.html#8">EstimatedDocumentCount(OptionsJSON as String, byref ReplyJSON as String) as Int64</A></li>
</ul></p>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-mongodb-mongodbtest.html">/MongoDB/MongoDB Test</A></li>
</ul>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="8">EstimatedDocumentCount(OptionsJSON as String, byref ReplyJSON as String) as Int64</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Executes a count query on collection.<BR>
<B>Notes:</B> 
<BR>
The count returned is not guaranteed to be accurate.<BR>
<BR>
see also<BR>
<a href="http://mongoc.org/libmongoc/current/mongoc_collection_estimated_document_count.html" target=_blank>http://mongoc.org/libmongoc/current/mongoc_collection_estimated_document_count.html</a><BR>
<p>See also:<ul>
<li><A href="mongodb-mongocollectionmbs-method.html#7">EstimatedDocumentCount(OptionsJSON as String = "") as Int64</A></li>
</ul></p>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="9">Find(FilterJSON as String, OptionsJSON as String = &quot;&quot;) as <A href="class-mongocursormbs.html">MongoCursorMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Query on collection, passing arbitrary query options to the server in opts.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>

<span style="color: #000000;"><span style="color: #0000FF;">const</span> URL = <span style="color: #6600FE;">&quot;mongodb://localhost/&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> uri <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongourimbs.html">MongoURIMBS</A>(URL)<br /><span style="color: #0000FF;">dim</span> client <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongoclientmbs.html">MongoClientMBS</A>(uri)<br /><br /><span style="color: #0000FF;">dim</span> database <span style="color: #0000FF;">as</span> <A href="class-mongodatabasembs.html">MongoDatabaseMBS</A> = client.Database(<span style="color: #6600FE;">&quot;local&quot;</span>)<br /><span style="color: #0000FF;">dim</span> Collection <span style="color: #0000FF;">as</span> <A href="class-mongocollectionmbs.html">MongoCollectionMBS</A> = database.Collection(<span style="color: #6600FE;">&quot;test&quot;</span>)<br /><br /><span style="color: #0000FF;">dim</span> Filter <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> JSONItem<br /><span style="color: #800000;">&apos;filter.Value(&quot;Hello&quot;) = &quot;World&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> sortOrder <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> JSONItem<br />sortOrder.Value(<span style="color: #6600FE;">&quot;hello&quot;</span>) = -<span style="color: #336698;">1</span> <span style="color: #800000;">// descending</span><br /><br /><span style="color: #0000FF;">dim</span> options <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> JSONItem<br />options.Value(<span style="color: #6600FE;">&quot;limit&quot;</span>) = <span style="color: #336698;">10</span><br />options.Value(<span style="color: #6600FE;">&quot;sort&quot;</span>) = sortOrder<br /><br /><span style="color: #0000FF;">dim</span> cursor <span style="color: #0000FF;">as</span> <A href="class-mongocursormbs.html">MongoCursorMBS</A> = Collection.Find(filter.toString, options.toString)<br /><span style="color: #0000FF;">dim</span> Record <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span><br /><br /><span style="color: #0000FF;">while</span> cursor.NextRecord(record)<br />  <br />  MessageBox record<br />  <br /><span style="color: #0000FF;">wend</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
See also find command documented here:<BR>
<a href="https://www.mongodb.com/docs/manual/reference/command/find/" target=_blank>https://www.mongodb.com/docs/manual/reference/command/find/</a><BR>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="10">FindIndexes(OptionsJSON as String = &quot;&quot;) as <A href="class-mongocursormbs.html">MongoCursorMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion224.shtml" class=version>22.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Fetches a cursor containing documents, each corresponding to an index on this collection.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="11">InsertMany(documentArrayJSON as String, OptionsJSON as String = &quot;&quot;) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion224.shtml" class=version>22.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Insert documents into collection.<BR>
<B>Notes:</B> 
<BR>
Please pass a JSON array as string for all documents. Each entry in the array should be a JSON object with the document data.<BR>
<BR>
For any document that does not have an &quot;_id&quot; field, a bson_oid_t will be generated locally and added to the document. If you must know the inserted document&#39;s _id, generate it in your code and include it in the document. The _id you generate can be a bson_oid_t or any other non-array BSON type.<BR>
<BR>
The reply is filled out with an &quot;insertedCount&quot; field. If there is a server error then reply may contain a &quot;writeErrors&quot; array and/or a &quot;writeConcernErrors&quot; array.<BR>
<p>See also:<ul>
<li><A href="mongodb-mongocollectionmbs-method.html#12">InsertMany(documentJSON() as String, OptionsJSON as String = "") as String</A></li>
</ul></p>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="12">InsertMany(documentJSON() as String, OptionsJSON as String = &quot;&quot;) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion224.shtml" class=version>22.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Insert documents into collection.<BR>
<B>Notes:</B> 
<BR>
Please pass an array with a JSON object in each entry as string.<BR>
<BR>
For any document that does not have an &quot;_id&quot; field, a bson_oid_t will be generated locally and added to the document. If you must know the inserted document&#39;s _id, generate it in your code and include it in the document. The _id you generate can be a bson_oid_t or any other non-array BSON type.<BR>
<BR>
The reply is filled out with an &quot;insertedCount&quot; field. If there is a server error then reply may contain a &quot;writeErrors&quot; array and/or a &quot;writeConcernErrors&quot; array.<BR>
<p>See also:<ul>
<li><A href="mongodb-mongocollectionmbs-method.html#11">InsertMany(documentArrayJSON as String, OptionsJSON as String = "") as String</A></li>
</ul></p>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="13">InsertOne(documentJSON as String, OptionsJSON as String = &quot;&quot;) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Inserts a document into collection.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>

<span style="color: #000000;"><span style="color: #0000FF;">const</span> URL = <span style="color: #6600FE;">&quot;mongodb://localhost/&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> uri <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongourimbs.html">MongoURIMBS</A>(URL)<br /><span style="color: #0000FF;">dim</span> client <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongoclientmbs.html">MongoClientMBS</A>(uri)<br /><br /><span style="color: #0000FF;">dim</span> database <span style="color: #0000FF;">as</span> <A href="class-mongodatabasembs.html">MongoDatabaseMBS</A> = client.Database(<span style="color: #6600FE;">&quot;local&quot;</span>)<br /><span style="color: #0000FF;">dim</span> Collection <span style="color: #0000FF;">as</span> <A href="class-mongocollectionmbs.html">MongoCollectionMBS</A> = database.Collection(<span style="color: #6600FE;">&quot;test&quot;</span>)<br /><br /><span style="color: #0000FF;">dim</span> j <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> JSONItem<br />j.Value(<span style="color: #6600FE;">&quot;Hello&quot;</span>) = <span style="color: #6600FE;">&quot;World&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> reply <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = Collection.InsertOne(j.ToString)<br /><br /><span style="color: #800000;">// reply is { &quot;insertedCount&quot; : 1 }</span><br /><br />Break</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
To insert an array of documents, see MongoDB.InsertMany.<BR>
<BR>
If no _id element is found in document, then an oid will be generated locally and added to the document. If you must know the inserted document&rsquo;s _id, generate it in your code and include it in the document. The _id you generate can be an old or any other non-array BSON type.<BR>
<BR>
The reply is filled out with an &ldquo;insertedCount&rdquo; field. If there is a server error then reply contains either a &ldquo;writeErrors&rdquo; array with one subdocument or a &ldquo;writeConcernErrors&rdquo; array. <BR>
<BR>
In case of an error, raises <A href="class-mongoexceptionmbs.html">MongoExceptionMBS</A>.<BR>
<BR>
OptionsJSON may be empty or a JSON document with additional command options:<BR>
<BR>
writeConcern: the write concern.<BR>
sessionId: The session ID.<BR>
validate: The validation flags.<BR>
bypassDocumentValidation: Set to true to skip server-side schema validation of the provided BSON documents.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-mongodb-mongodbblog.html">/MongoDB/MongoDB Blog</A></li>
<li><A href="example-mongodb-mongodbtest.html">/MongoDB/MongoDB Test</A></li>
</ul>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="14">Keys as String()</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Queries current collection to find all the key names.<BR>
<B>Notes:</B> 
<BR>
You may store different JSON documents in the collection with different keys.<BR>
This function scans all documents to get the root keys and returns the list.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="15">Rename(NewDatabaseName as String, NewCollectionName as String, DropTargetBeforeRename as Boolean = false, OptionsJSON as String = &quot;&quot;) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion224.shtml" class=version>22.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
This function is a helper to rename an existing collection on a MongoDB server. <BR>
<B>Notes:</B> 
<BR>
The name of the collection will also be updated internally so it is safe to continue using this collection after the rename. Additional operations will occur on renamed collection.<BR>
<BR>
NewDatabaseName: The name of the new database.<BR>
NewCollectionName: The new name for the collection.<BR>
DropTargetBeforeRename: If an existing collection matches the new name, drop it before the rename.<BR>
<BR>
Returns true if successful. Returns false and raises exception in case of an error.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="16">ReplaceOne(selectorJSON as String, replacementJSON as String, OptionsJSON as String = &quot;&quot;) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
This replaces documents in collection that match selector with replacement.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>

<span style="color: #000000;"><span style="color: #0000FF;">const</span> URL = <span style="color: #6600FE;">&quot;mongodb://localhost/&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> uri <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongourimbs.html">MongoURIMBS</A>(URL)<br /><span style="color: #0000FF;">dim</span> client <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongoclientmbs.html">MongoClientMBS</A>(uri)<br /><br /><span style="color: #0000FF;">dim</span> database <span style="color: #0000FF;">as</span> <A href="class-mongodatabasembs.html">MongoDatabaseMBS</A> = client.Database(<span style="color: #6600FE;">&quot;local&quot;</span>)<br /><span style="color: #0000FF;">dim</span> Collection <span style="color: #0000FF;">as</span> <A href="class-mongocollectionmbs.html">MongoCollectionMBS</A> = database.Collection(<span style="color: #6600FE;">&quot;test&quot;</span>)<br /><br /><span style="color: #800000;">// the conditions to match records</span><br /><span style="color: #0000FF;">dim</span> j <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> JSONItem<br />j.Value(<span style="color: #6600FE;">&quot;Hello&quot;</span>) = <span style="color: #6600FE;">&quot;World&quot;</span><br /><br /><span style="color: #800000;">// the new values</span><br /><span style="color: #0000FF;">dim</span> u <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> JSONItem<br />u.Value(<span style="color: #6600FE;">&quot;OtherField&quot;</span>) = <span style="color: #336698;">456</span><br />u.Value(<span style="color: #6600FE;">&quot;Hello&quot;</span>) =  <span style="color: #6600FE;">&quot;World&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> reply <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = Collection.ReplaceOne(j.ToString, u.ToString)<br /><br />Break</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
selectorJSON: A JSON containing the query to match the document for updating.<BR>
updateJSON: A JSON containing the replacement document.<BR>
<BR>
The reply JSON is populated with the fields matchedCount, modifiedCount, upsertedCount, and optionally upsertedId if applicable. If there is a server error then reply contains either a writeErrors array with one subdocument or a writeConcernErrors array. <BR>
<BR>
In case of an error, raises <A href="class-mongoexceptionmbs.html">MongoExceptionMBS</A>.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="17">UpdateMany(selectorJSON as String, updateJSON as String, OptionsJSON as String = &quot;&quot;) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Updates all documents in collection that match selector.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>

<span style="color: #000000;"><span style="color: #0000FF;">const</span> URL = <span style="color: #6600FE;">&quot;mongodb://localhost/&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> uri <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongourimbs.html">MongoURIMBS</A>(URL)<br /><span style="color: #0000FF;">dim</span> client <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongoclientmbs.html">MongoClientMBS</A>(uri)<br /><br /><span style="color: #0000FF;">dim</span> database <span style="color: #0000FF;">as</span> <A href="class-mongodatabasembs.html">MongoDatabaseMBS</A> = client.Database(<span style="color: #6600FE;">&quot;local&quot;</span>)<br /><span style="color: #0000FF;">dim</span> Collection <span style="color: #0000FF;">as</span> <A href="class-mongocollectionmbs.html">MongoCollectionMBS</A> = database.Collection(<span style="color: #6600FE;">&quot;test&quot;</span>)<br /><br /><span style="color: #800000;">// the conditions to match records</span><br /><span style="color: #0000FF;">dim</span> j <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> JSONItem<br />j.Value(<span style="color: #6600FE;">&quot;Hello&quot;</span>) = <span style="color: #6600FE;">&quot;World&quot;</span><br /><br /><span style="color: #800000;">// the new values</span><br /><span style="color: #0000FF;">dim</span> u <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> JSONItem<br />u.Value(<span style="color: #6600FE;">&quot;OtherField&quot;</span>) = <span style="color: #336698;">123</span><br /><br /><span style="color: #800000;">// and the update, where we define to set those values</span><br /><span style="color: #0000FF;">dim</span> s <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> JSONItem<br />s.Value(<span style="color: #6600FE;">&quot;$set&quot;</span>) = u<br /><br /><span style="color: #0000FF;">dim</span> reply <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = Collection.UpdateMany(j.ToString, s.ToString)<br /><br /><span style="color: #800000;">// reply: { &quot;modifiedCount&quot; : 1, &quot;matchedCount&quot; : 1, &quot;upsertedCount&quot; : 0 }</span><br />Break</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
In case of an error, raises <A href="class-mongoexceptionmbs.html">MongoExceptionMBS</A>.<BR>
<BR>
To update at most one document see UpdateOne().<BR>
<BR>
The result JSON is filled out with fields matchedCount, modifiedCount, and optionally upsertedId if applicable. If there is a server error then reply contains either a &ldquo;writeErrors&rdquo; array with one subdocument or a &ldquo;writeConcernErrors&rdquo; array. <BR>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="18">UpdateOne(selectorJSON as String, updateJSON as String, OptionsJSON as String = &quot;&quot;) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Updates at most one document in collection that matches selector.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>

<span style="color: #000000;"><span style="color: #0000FF;">const</span> URL = <span style="color: #6600FE;">&quot;mongodb://localhost/&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> uri <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongourimbs.html">MongoURIMBS</A>(URL)<br /><span style="color: #0000FF;">dim</span> client <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongoclientmbs.html">MongoClientMBS</A>(uri)<br /><br /><span style="color: #0000FF;">dim</span> database <span style="color: #0000FF;">as</span> <A href="class-mongodatabasembs.html">MongoDatabaseMBS</A> = client.Database(<span style="color: #6600FE;">&quot;local&quot;</span>)<br /><span style="color: #0000FF;">dim</span> Collection <span style="color: #0000FF;">as</span> <A href="class-mongocollectionmbs.html">MongoCollectionMBS</A> = database.Collection(<span style="color: #6600FE;">&quot;test&quot;</span>)<br /><br /><span style="color: #800000;">// the conditions to match records</span><br /><span style="color: #0000FF;">dim</span> j <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> JSONItem<br />j.Value(<span style="color: #6600FE;">&quot;Hello&quot;</span>) = <span style="color: #6600FE;">&quot;World&quot;</span><br /><br /><span style="color: #800000;">// the new values</span><br /><span style="color: #0000FF;">dim</span> u <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> JSONItem<br />u.Value(<span style="color: #6600FE;">&quot;OtherField&quot;</span>) = <span style="color: #336698;">123</span><br /><br /><span style="color: #800000;">// and the update, where we define to set those values</span><br /><span style="color: #0000FF;">dim</span> s <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> JSONItem<br />s.Value(<span style="color: #6600FE;">&quot;$set&quot;</span>) = u<br /><br /><span style="color: #0000FF;">dim</span> reply <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = Collection.UpdateOne(j.ToString, s.ToString)<br /><br /><span style="color: #800000;">// reply: { &quot;modifiedCount&quot; : 1, &quot;matchedCount&quot; : 1, &quot;upsertedCount&quot; : 0 }</span><br />break</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
In case of an error, raises <A href="class-mongoexceptionmbs.html">MongoExceptionMBS</A>.<BR>
<BR>
To update multiple documents see UpdateMany().<BR>
<BR>
Return is a JSON filled out with fields matchedCount, modifiedCount, and optionally upsertedId if applicable. If there is a server error then reply contains either a &ldquo;writeErrors&rdquo; array with one subdocument or a &ldquo;writeConcernErrors&rdquo; array. <BR>
<BR>
for Options you may e.g. pass {&quot;upsert&quot;:true} to create a new record if the old one doesn&#39;t exist.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongocollectionmbs.html">MongoCollectionMBS</a>.<A name="19">Watch(pipelineJSON as String, OptionsJSON as String = &quot;&quot;) as <A href="class-mongochangestreammbs.html">MongoChangeStreamMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion230.shtml" class=version>23.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Creates a change stream for a collection.<BR>
<B>Notes:</B> 
<BR>
It is preferred to call this function over using a raw aggregation to create a change stream.<BR>
<BR>
This function uses the read preference and read concern of the collection. If the change stream needs to re-establish connection, the same read preference will be used. This may happen if the change stream encounters a resumable error.<BR>
<BR>
Warning A change stream is only supported with majority read concern.<BR>
This function is considered a retryable read operation. Upon a transient error (a network error, errors due to replica set failover, etc.) the operation is safely retried once. If retryreads is false in the URI the retry behavior does not apply.<BR>
<BR>
Call this method on the collection which the change stream listens to.<BR>
<BR>
pipelineJSON: A JSON representing an aggregation pipeline appended to the change stream. This may be an empty document.<BR>
<BR>
OptionsJSON: A JSON containing change stream options. options may be &quot;&quot; or a JSON document with additional command options:<BR>
<BR>
batchSize: An integer representing number of documents requested to be returned on each call to NextChange()<BR>
<BR>
resumeAfter: A Document representing the logical starting point of the change stream. The result of StreamResumeToken() or the _id field of any change received from a change stream can be used here. This option is mutually exclusive with startAfter and startAtOperationTime.<BR>
<BR>
startAfter: A Document representing the logical starting point of the change stream. Unlike resumeAfter, this can resume notifications after an &ldquo;invalidate&rdquo; event. The result of StreamResumeToken() or the _id field of any change received from a change stream can be used here. This option is mutually exclusive with resumeAfter and startAtOperationTime.<BR>
<BR>
startAtOperationTime: A Timestamp. The change stream only provides changes that occurred at or after the specified timestamp. Any command run against the server will return an operation time that can be used here. This option is mutually exclusive with resumeAfter and startAfter.<BR>
<BR>
maxAwaitTimeMS: An int64 representing the maximum amount of time a call to StreamResumeToken() will block waiting for data<BR>
<BR>
fullDocument: An optional UTF-8 string. Set this option to &ldquo;default&rdquo;, &ldquo;updateLookup&rdquo;, &ldquo;whenAvailable&rdquo;, or &ldquo;required&rdquo;, If unset, The string &ldquo;default&rdquo; is assumed. Set this option to &ldquo;updateLookup&rdquo; to direct the change stream cursor to lookup the most current majority-committed version of the document associated to an update change stream event.<BR>
<BR>
fullDocumentBeforeChange: An optional UTF-8 string. Set this option to &ldquo;whenAvailable&rdquo;, &ldquo;required&rdquo;, or &ldquo;off&rdquo;. When unset, the default value is &ldquo;off&rdquo;. Similar to &ldquo;fullDocument&rdquo;, but returns the value of the document before the associated change.<BR>
<BR>
comment: A JSON specifying the comment to attach to this command. The comment will appear in log messages, profiler output, and currentOp output. Only string values are supported prior to MongoDB 4.4.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=mongodb-mongocollectionmbs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

