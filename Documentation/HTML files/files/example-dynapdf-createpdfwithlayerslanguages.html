<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /DynaPDF/Create PDF with Layers Languages</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /DynaPDF/Create PDF with Layers Languages</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/DynaPDF/Create PDF with Layers Languages</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS DynaPDF Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /DynaPDF/Create PDF with Layers Languages<BR>
This example is the version from Wed, 14th Sep 2021.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;Create</span> <span style="color:#6500FE">PDF</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">Layers</span> <span style="color:#6500FE">Languages.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	FileTypes</div>
<div class="RB_Code">		Filetype text</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> FileTypes</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar MenuBar1</div>
<div class="RB_Code">		MenuItem UntitledMenu1 = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		MenuItem FileMenu = <span style="color:#6500FE">&quot;&amp;File&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;Quit&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu5 = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		MenuItem EditMenu = <span style="color:#6500FE">&quot;&amp;Edit&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;&amp;Undo&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu0 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;Cu&amp;t&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;&amp;Copy&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;&amp;Paste&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;Clear&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu4 = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu3 = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		MenuItem UntitledMenu2 = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#0000FF;font-weight: bold">dim</span> pdf <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> MyDynapdfMBS
			<span style="color:#0000FF;font-weight: bold">dim</span> d <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> date
			
			<span style="color:#0000FF;font-weight: bold">dim</span> f <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = SpecialFolder.Desktop.Child(<span style="color:#6500FE">&quot;Create</span> <span style="color:#6500FE">PDF</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">Layers</span> <span style="color:#6500FE">Languages.pdf&quot;</span>)
			
			pdf.SetLicenseKey <span style="color:#6500FE">&quot;Lite&quot;</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">For</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">example</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">Lite,</span> <span style="color:#7F0000;text-style:italic">Pro</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">Enterprise</span> <span style="color:#7F0000;text-style:italic">License</span>
			
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.CreateNewPDF f
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.SetDocInfo pdf.kdiSubject, <span style="color:#6500FE">&quot;My</span> <span style="color:#6500FE">first</span> <span style="color:#6500FE">Xojo</span> <span style="color:#6500FE">output&quot;</span>
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.SetDocInfo pdf.kdiProducer, <span style="color:#6500FE">&quot;Xojo</span> <span style="color:#6500FE">test</span> <span style="color:#6500FE">application&quot;</span>
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.SetDocInfo pdf.kdiTitle, <span style="color:#6500FE">&quot;My</span> <span style="color:#6500FE">first</span> <span style="color:#6500FE">Xojo</span> <span style="color:#6500FE">output&quot;</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">We</span> <span style="color:#7F0000;text-style:italic">want</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">top-down</span> <span style="color:#7F0000;text-style:italic">coordinates</span>
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.SetPageCoords pdf.kpcTopDown
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Pass</span> <span style="color:#7F0000;text-style:italic">warnings</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">errors</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">error</span> <span style="color:#7F0000;text-style:italic">callback</span> <span style="color:#7F0000;text-style:italic">function</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> oc1 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = pdf.CreateOCG(<span style="color:#6500FE">&quot;Deutsch&quot;</span>, <span style="color:#0000FF;font-weight: bold">true</span>, <span style="color:#0000FF;font-weight: bold">false</span>, pdf.koiAll)
			<span style="color:#0000FF;font-weight: bold">dim</span> oc2 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = pdf.CreateOCG(<span style="color:#6500FE">&quot;English&quot;</span>, <span style="color:#0000FF;font-weight: bold">true</span>, <span style="color:#0000FF;font-weight: bold">true</span>, pdf.koiAll)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> bmkDE <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = pdf.AddBookmark(<span style="color:#6500FE">&quot;Deutsch&quot;</span>, -<span style="color:#326598">1</span>, <span style="color:#326598">1</span>, <span style="color:#0000FF;font-weight: bold">false</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> bmkEN <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = pdf.AddBookmark(<span style="color:#6500FE">&quot;English&quot;</span>, -<span style="color:#326598">1</span>, <span style="color:#326598">1</span>, <span style="color:#0000FF;font-weight: bold">false</span>)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> toggle(-<span style="color:#326598">1</span>), on(-<span style="color:#326598">1</span>), off(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Uint32</span>
			toggle.Append oc1
			toggle.Append oc2
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Simply</span> <span style="color:#7F0000;text-style:italic">toggle</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">state</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">On</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">Off</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">vice</span> <span style="color:#7F0000;text-style:italic">versa</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> act <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = pdf.CreateSetOCGStateAction(on, off, toggle, <span style="color:#0000FF;font-weight: bold">true</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">action</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">bookmarks</span>
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.AddActionToObj(pdf.kotBookmark, pdf.koeOnMouseUp, act, bmkDE)
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.AddActionToObj(pdf.kotBookmark, pdf.koeOnMouseUp, act, bmkEN)
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.SetPageCoords(pdf.kpcTopDown)
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.Append
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.SetFont(<span style="color:#6500FE">&quot;Arial&quot;</span>, pdf.kfsRegular + pdf.kfsItalic, <span style="color:#006532">12.0</span>, <span style="color:#0000FF;font-weight: bold">true</span>, pdf.kcpUnicode)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> text1 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = <span style="color:#6500FE">&quot;Dieses</span> <span style="color:#6500FE">Beispiel</span> <span style="color:#6500FE">zeigt</span> <span style="color:#6500FE">wie</span> <span style="color:#6500FE">ein</span> <span style="color:#6500FE">mehrsprachiges</span> <span style="color:#6500FE">Dokument</span> <span style="color:#6500FE">&quot;</span>+_
					<span style="color:#6500FE">&quot;erzeugt</span> <span style="color:#6500FE">werden</span> <span style="color:#6500FE">kann.&quot;</span>+_
					EndOfLine.UNIX+_
					EndOfLine.UNIX+_
					<span style="color:#6500FE">&quot;Zun&auml;chst</span> <span style="color:#6500FE">wird</span> <span style="color:#6500FE">beim</span> <span style="color:#6500FE">&Ouml;ffnen</span> <span style="color:#6500FE">des</span> <span style="color:#6500FE">Dokuments</span> <span style="color:#6500FE">die</span> <span style="color:#6500FE">Sprache</span> <span style="color:#6500FE">mit</span> <span style="color:#6500FE">&quot;</span>+_
					<span style="color:#6500FE">&quot;einer</span> <span style="color:#6500FE">JavaScript</span> <span style="color:#6500FE">Aktion</span> <span style="color:#6500FE">eingestellt.&quot;</span>+_
					EndOfLine.UNIX+_
					EndOfLine.UNIX+_
					<span style="color:#6500FE">&quot;Zus&auml;tzlich</span> <span style="color:#6500FE">kann</span> <span style="color:#6500FE">die</span> <span style="color:#6500FE">Sprache</span> <span style="color:#6500FE">auch</span> <span style="color:#6500FE">&uuml;ber</span> <span style="color:#6500FE">zwei</span> <span style="color:#6500FE">Lesezeichen</span> <span style="color:#6500FE">&quot;</span>+_
					<span style="color:#6500FE">&quot;ausgew&auml;hlt</span> <span style="color:#6500FE">werden.</span> <span style="color:#6500FE">Hierbei</span> <span style="color:#6500FE">wird</span> <span style="color:#6500FE">lediglich</span> <span style="color:#6500FE">ein</span> <span style="color:#6500FE">Layer</span> <span style="color:#6500FE">ein-</span> <span style="color:#6500FE">&quot;</span>+_
					<span style="color:#6500FE">&quot;bzw.</span> <span style="color:#6500FE">ausgeblendet.&quot;</span>+_
					EndOfLine.UNIX+_
					EndOfLine.UNIX+_
					<span style="color:#6500FE">&quot;Der</span> <span style="color:#6500FE">Seiteninhalt</span> <span style="color:#6500FE">muss</span> <span style="color:#6500FE">nat&uuml;rlich</span> <span style="color:#6500FE">zweimal</span> <span style="color:#6500FE">erzeugt</span> <span style="color:#6500FE">werden,</span> <span style="color:#6500FE">einmal</span> <span style="color:#6500FE">&quot;</span>+_
					<span style="color:#6500FE">&quot;in</span> <span style="color:#6500FE">Deutsch</span> <span style="color:#6500FE">und</span> <span style="color:#6500FE">einmal</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">Englisch</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">diesem</span> <span style="color:#6500FE">Beispiel,</span> <span style="color:#6500FE">jeweils</span> <span style="color:#6500FE">&quot;</span>+_
					<span style="color:#6500FE">&quot;in</span> <span style="color:#6500FE">unterschiedlichen</span> <span style="color:#6500FE">Layern.&quot;</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> text2 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = <span style="color:#6500FE">&quot;This</span> <span style="color:#6500FE">example</span> <span style="color:#6500FE">shows</span> <span style="color:#6500FE">how</span> <span style="color:#6500FE">a</span> <span style="color:#6500FE">multi-language</span> <span style="color:#6500FE">document</span> <span style="color:#6500FE">can</span> <span style="color:#6500FE">be</span> <span style="color:#6500FE">&quot;</span>+_
					<span style="color:#6500FE">&quot;created.&quot;</span>+_
					EndOfLine.UNIX+_
					EndOfLine.UNIX+_
					<span style="color:#6500FE">&quot;The</span> <span style="color:#6500FE">language</span> <span style="color:#6500FE">is</span> <span style="color:#6500FE">initially</span> <span style="color:#6500FE">selected</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">a</span> <span style="color:#6500FE">JavaScript</span> <span style="color:#6500FE">&quot;</span>+_
					<span style="color:#6500FE">&quot;Action</span> <span style="color:#6500FE">when</span> <span style="color:#6500FE">opening</span> <span style="color:#6500FE">the</span> <span style="color:#6500FE">file.&quot;</span>+_
					EndOfLine.UNIX+_
					EndOfLine.UNIX+_
					<span style="color:#6500FE">&quot;Additionally,</span> <span style="color:#6500FE">the</span> <span style="color:#6500FE">wished</span> <span style="color:#6500FE">language</span> <span style="color:#6500FE">can</span> <span style="color:#6500FE">be</span> <span style="color:#6500FE">selected</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">two</span> <span style="color:#6500FE">&quot;</span>+_
					<span style="color:#6500FE">&quot;bookmarks.</span> <span style="color:#6500FE">The</span> <span style="color:#6500FE">bookmarks</span> <span style="color:#6500FE">simply</span> <span style="color:#6500FE">hide</span> <span style="color:#6500FE">or</span> <span style="color:#6500FE">unhide</span> <span style="color:#6500FE">a</span> <span style="color:#6500FE">layer.&quot;</span>+_
					EndOfLine.UNIX+_
					EndOfLine.UNIX+_
					<span style="color:#6500FE">&quot;The</span> <span style="color:#6500FE">page</span> <span style="color:#6500FE">contents</span> <span style="color:#6500FE">must</span> <span style="color:#6500FE">of</span> <span style="color:#6500FE">course</span> <span style="color:#6500FE">be</span> <span style="color:#6500FE">created</span> <span style="color:#6500FE">twice,</span> <span style="color:#6500FE">one</span> <span style="color:#6500FE">time</span> <span style="color:#6500FE">&quot;</span>+_
					<span style="color:#6500FE">&quot;in</span> <span style="color:#6500FE">English</span> <span style="color:#6500FE">and</span> <span style="color:#6500FE">one</span> <span style="color:#6500FE">time</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">German</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">this</span> <span style="color:#6500FE">example,</span> <span style="color:#6500FE">but</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">&quot;</span>+_
					<span style="color:#6500FE">&quot;different</span> <span style="color:#6500FE">layers.&quot;</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Text</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">German</span> <span style="color:#7F0000;text-style:italic">layer</span>
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.BeginLayer(oc1)
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.WriteFTextEx(<span style="color:#006532">50.0</span>, <span style="color:#006532">50.0</span>, pdf.GetPageWidth - <span style="color:#006532">100.0</span>, pdf.GetPageHeight - <span style="color:#006532">100.0</span>, pdf.ktaLeft, text1)
			
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.EndLayer
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Text</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">English</span> <span style="color:#7F0000;text-style:italic">layer</span>
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.BeginLayer(oc2)
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.WriteFTextEx(<span style="color:#006532">50.0</span>, <span style="color:#006532">50.0</span>, pdf.GetPageWidth - <span style="color:#006532">100.0</span>, pdf.GetPageHeight - <span style="color:#006532">100.0</span>, pdf.ktaLeft, text2)
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.EndLayer
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.EndPage
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">script</span> <span style="color:#7F0000;text-style:italic">displays</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">correct</span> <span style="color:#7F0000;text-style:italic">layer</span> <span style="color:#7F0000;text-style:italic">depending</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">viewer</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">language.</span> <span style="color:#7F0000;text-style:italic">SI32</span> <span style="color:#7F0000;text-style:italic">actLang</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">pdfCreateJSAction(pdf,</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> lines(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
			
			lines.Append <span style="color:#6500FE">&quot;if</span> <span style="color:#6500FE">(app.viewerVersion</span> <span style="color:#6500FE">&gt;=</span> <span style="color:#6500FE">6.0)&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;{&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;</span>    <span style="color:#6500FE">var</span> <span style="color:#6500FE">ocgArray</span> <span style="color:#6500FE">=</span> <span style="color:#6500FE">this.getOCGs();&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;</span>    <span style="color:#6500FE">var</span> <span style="color:#6500FE">de</span> <span style="color:#6500FE">=</span> <span style="color:#6500FE">(app.language</span> <span style="color:#6500FE">==</span> <span style="color:#6500FE">&quot;</span><span style="color:#6500FE">&quot;DEU&quot;</span><span style="color:#6500FE">&quot;);&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;</span>    <span style="color:#6500FE">for</span> <span style="color:#6500FE">(var</span> <span style="color:#6500FE">i</span> <span style="color:#6500FE">=</span> <span style="color:#6500FE">0;</span> <span style="color:#6500FE">i</span> <span style="color:#6500FE">&lt;</span> <span style="color:#6500FE">ocgArray.length;</span> <span style="color:#6500FE">i++)&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;</span>       <span style="color:#6500FE">{&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;</span>       <span style="color:#6500FE">if</span> <span style="color:#6500FE">(ocgArray[i].name==&quot;</span><span style="color:#6500FE">&quot;English&quot;</span><span style="color:#6500FE">&quot;)&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;</span>          <span style="color:#6500FE">{&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;</span>          <span style="color:#6500FE">ocgArray[i].state</span> <span style="color:#6500FE">=</span> <span style="color:#6500FE">!de;&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;</span>          <span style="color:#6500FE">}&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;</span>       <span style="color:#6500FE">else&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;</span>          <span style="color:#6500FE">{&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;</span>          <span style="color:#6500FE">ocgArray[i].state</span> <span style="color:#6500FE">=</span> <span style="color:#6500FE">de;&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;</span>          <span style="color:#6500FE">}&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;</span>       <span style="color:#6500FE">}&quot;</span>
			lines.Append <span style="color:#6500FE">&quot;}&quot;</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> javascript <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = Join(lines,EndOfLine.UNIX)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> actLang <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = pdf.CreateJSAction(javascript)
			
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.AddActionToObj(pdf.kotCatalog, pdf.koeOnOpen, actLang, -<span style="color:#326598">1</span>)
			
			<span style="color:#0000FF;font-weight: bold">call</span> pdf.CloseFile
			
			f.Launch
			
			quit
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MyDynaPDFMBS <span style="color:#0000FF;font-weight: bold">Inherits</span> DynaPDFMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> Error(ErrorCode <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, ErrorMessage <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, ErrorType <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">output</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">messages</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">console:</span>
			System.DebugLog str(ErrorCode)+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+ErrorMessage
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">display</span> <span style="color:#7F0000;text-style:italic">dialog:</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> d <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">New</span> MessageDialog <span style="color:#7F0000;text-style:italic">//declare</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">MessageDialog</span> <span style="color:#7F0000;text-style:italic">object</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> b <span style="color:#0000FF;font-weight: bold">as</span> MessageDialogButton <span style="color:#7F0000;text-style:italic">//for</span> <span style="color:#7F0000;text-style:italic">handling</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">result</span>
			
			d.icon=MessageDialog.GraphicCaution <span style="color:#7F0000;text-style:italic">//display</span> <span style="color:#7F0000;text-style:italic">warning</span> <span style="color:#7F0000;text-style:italic">icon</span>
			d.ActionButton.Caption=<span style="color:#6500FE">&quot;Continue&quot;</span>
			d.CancelButton.Visible=<span style="color:#0000FF;font-weight: bold">True</span>    <span style="color:#7F0000;text-style:italic">//show</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Cancel</span> <span style="color:#7F0000;text-style:italic">button</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">warning</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">error?</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> BitAnd(ErrorType, <span style="color:#0000FF;font-weight: bold">me</span>.kE_WARNING) = <span style="color:#0000FF;font-weight: bold">me</span>.kE_WARNING <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">user</span> <span style="color:#7F0000;text-style:italic">decided</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">ignore,</span> <span style="color:#7F0000;text-style:italic">we&#39;ll</span> <span style="color:#7F0000;text-style:italic">ignore</span>
				<span style="color:#0000FF;font-weight: bold">if</span> IgnoreWarnings <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#326598">0</span>
				
				d.Message=<span style="color:#6500FE">&quot;A</span> <span style="color:#6500FE">warning</span> <span style="color:#6500FE">occurred</span> <span style="color:#6500FE">while</span> <span style="color:#6500FE">processing</span> <span style="color:#6500FE">your</span> <span style="color:#6500FE">PDF</span> <span style="color:#6500FE">code.&quot;</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">third</span> <span style="color:#7F0000;text-style:italic">button</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">display</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">warnings</span>
				d.AlternateActionButton.Caption = <span style="color:#6500FE">&quot;Ignore</span> <span style="color:#6500FE">warnings&quot;</span>
				d.AlternateActionButton.Visible = <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				d.Message=<span style="color:#6500FE">&quot;An</span> <span style="color:#6500FE">error</span> <span style="color:#6500FE">occurred</span> <span style="color:#6500FE">while</span> <span style="color:#6500FE">processing</span> <span style="color:#6500FE">your</span> <span style="color:#6500FE">PDF</span> <span style="color:#6500FE">code.&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			d.Explanation = str(ErrorCode)+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+ErrorMessage
			
			b=d.ShowModal <span style="color:#7F0000;text-style:italic">//display</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">dialog</span>
			
			<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> b <span style="color:#7F0000;text-style:italic">//determine</span> <span style="color:#7F0000;text-style:italic">which</span> <span style="color:#7F0000;text-style:italic">button</span> <span style="color:#7F0000;text-style:italic">was</span> <span style="color:#7F0000;text-style:italic">pressed.</span>
			<span style="color:#0000FF;font-weight: bold">Case</span> d.ActionButton
				<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#326598">0</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">ignore</span>
			<span style="color:#0000FF;font-weight: bold">Case</span> d.AlternateActionButton
				IgnoreWarnings = <span style="color:#0000FF;font-weight: bold">true</span>
				<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#326598">0</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">ignore</span>
			<span style="color:#0000FF;font-weight: bold">Case</span> d.CancelButton
				<span style="color:#0000FF;font-weight: bold">Return</span> -<span style="color:#326598">1</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">stop</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">select</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> IgnoreWarnings <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

<p>See also:<ul>
<li><A href="example-dynapdf-createnumberedpages.html">/DynaPDF/Create numbered pages</A></li>
<li><A href="example-dynapdf-createpdfwithannotations.html">/DynaPDF/Create PDF with Annotations</A></li>
<li><A href="example-dynapdf-createpdfwithbarcodes.html">/DynaPDF/Create PDF with Barcodes</A></li>
<li><A href="example-dynapdf-createpdfwithcircletext.html">/DynaPDF/Create PDF with Circle Text</A></li>
<li><A href="example-dynapdf-createpdfwitherrors.html">/DynaPDF/Create PDF with Errors</A></li>
<li><A href="example-dynapdf-createpdfwithgradientsoverprintanddevicencolorspace.html">/DynaPDF/Create PDF with gradients, overprint and device N colorspace</A></li>
<li><A href="example-dynapdf-createpdfwithhiddendata.html">/DynaPDF/Create PDF with hidden data</A></li>
<li><A href="example-dynapdf-createpdfwithjapanesefont.html">/DynaPDF/Create PDF with japanese font</A></li>
<li><A href="example-dynapdf-createpdfwithsumformfield.html">/DynaPDF/Create PDF with sum form field</A></li>
<li><A href="example-dynapdf-createpdfwithtextblockfonts.html">/DynaPDF/Create PDF with text block fonts</A></li>
</ul></p>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsdynapdfplugin.html">MBS DynaPDF Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-dynapdf-createpdfwithlayerslanguages">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

