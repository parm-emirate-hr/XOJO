<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /Mac64bit/Contacts/Contacts Display Person</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /Mac64bit/Contacts/Contacts Display Person</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/Mac64bit/Contacts/Contacts Display Person</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS Mac64bit Plugin, MBS MacBase Plugin, MBS MacCloud Plugin, MBS Main Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /Mac64bit/Contacts/Contacts Display Person<BR>
This example is the version from Fri, 13th May 2021.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;Contacts</span> <span style="color:#6500FE">Display</span> <span style="color:#6500FE">Person.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kEditClear = <span style="color:#6500FE">&quot;&amp;Delete&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuit = <span style="color:#6500FE">&quot;&amp;Quit&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuitShortcut = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#0000FF">#if</span> Target64Bit <span style="color:#0000FF;font-weight: bold">and</span> TargetMacOS <span style="color:#0000FF;font-weight: bold">then</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> CNContactStoreMBS.available <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">ok</span>
					
				<span style="color:#0000FF;font-weight: bold">else</span>
					MsgBox <span style="color:#6500FE">&quot;please</span> <span style="color:#6500FE">run</span> <span style="color:#6500FE">on</span> <span style="color:#6500FE">OS</span> <span style="color:#6500FE">X</span> <span style="color:#6500FE">10.11</span> <span style="color:#6500FE">or</span> <span style="color:#6500FE">newer.&quot;</span>
					quit
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
			<span style="color:#0000FF">#else</span>
				
				MsgBox <span style="color:#6500FE">&quot;Please</span> <span style="color:#6500FE">run</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">Xojo</span> <span style="color:#6500FE">as</span> <span style="color:#6500FE">64-bit</span> <span style="color:#6500FE">app</span> <span style="color:#6500FE">on</span> <span style="color:#6500FE">Mac.&quot;</span>
				quit
				
			<span style="color:#0000FF">#endif</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MainWindow <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control List <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance List <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> ExpandRow(row <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> CNContactMBS = <span style="color:#0000FF;font-weight: bold">me</span>.RowTag(row)
				
				<span style="color:#0000FF;font-weight: bold">if</span> c = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
					break
					<span style="color:#0000FF;font-weight: bold">return</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">could</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">properties</span> <span style="color:#7F0000;text-style:italic">directly</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> familyName <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = C.familyName
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">simply</span> <span style="color:#7F0000;text-style:italic">try</span> <span style="color:#7F0000;text-style:italic">generically</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">keys</span>
				showValue c, c.CNContactNamePrefixKey
				showValue c, c.CNContactGivenNameKey
				showValue c, c.CNContactMiddleNameKey
				showValue c, c.CNContactFamilyNameKey
				showValue c, c.CNContactPreviousFamilyNameKey
				showValue c, c.CNContactNameSuffixKey
				showValue c, c.CNContactNicknameKey
				showValue c, c.CNContactPhoneticGivenNameKey
				showValue c, c.CNContactPhoneticMiddleNameKey
				showValue c, c.CNContactPhoneticFamilyNameKey
				showValue c, c.CNContactOrganizationNameKey
				showValue c, c.CNContactDepartmentNameKey
				showValue c, c.CNContactJobTitleKey
				showValue c, c.CNContactBirthdayKey
				showValue c, c.CNContactNonGregorianBirthdayKey
				showValue c, c.CNContactNoteKey
				showValue c, c.CNContactImageDataKey
				showValue c, c.CNContactThumbnailImageDataKey
				showValue c, c.CNContactImageDataAvailableKey
				showValue c, c.CNContactPhoneNumbersKey
				showValue c, c.CNContactEmailAddressesKey
				showValue c, c.CNContactPostalAddressesKey
				showValue c, c.CNContactDatesKey
				showValue c, c.CNContactUrlAddressesKey
				showValue c, c.CNContactRelationsKey
				showValue c, c.CNContactSocialProfilesKey
				showValue c, c.CNContactInstantMessageAddressesKey
				showValue c, c.CNContactIdentifierKey
				showValue c, c.CNContactTypeKey
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Label1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Label1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control namefield <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance namefield <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control SearchButton <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance SearchButton <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				List.DeleteAllRows
				
				<span style="color:#0000FF;font-weight: bold">dim</span> contacts() <span style="color:#0000FF;font-weight: bold">as</span> CNContactMBS
				<span style="color:#0000FF;font-weight: bold">dim</span> predicate <span style="color:#0000FF;font-weight: bold">as</span> NSPredicateMBS
				<span style="color:#0000FF;font-weight: bold">dim</span> keysToFetch() <span style="color:#0000FF;font-weight: bold">as</span> CNKeyDescriptorMBS
				<span style="color:#0000FF;font-weight: bold">dim</span> error <span style="color:#0000FF;font-weight: bold">as</span> NSErrorMBS
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">simply</span> <span style="color:#7F0000;text-style:italic">ask</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">keys</span> <span style="color:#7F0000;text-style:italic">which</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">vcard</span> <span style="color:#7F0000;text-style:italic">would</span> <span style="color:#7F0000;text-style:italic">also</span> <span style="color:#7F0000;text-style:italic">use</span>
				keysToFetch.append CNContactVCardSerializationMBS.descriptorForRequiredKeys
				<span style="color:#7F0000;text-style:italic">&#39;keysToFetch.Append</span> <span style="color:#7F0000;text-style:italic">CNContactMBS.CNContactOrganizationNameKey</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> parts() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = split(namefield.Text, <span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&quot;</span>)
				
				<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> part <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> <span style="color:#0000FF;font-weight: bold">in</span> parts
					
					part = trim(part)
					<span style="color:#0000FF;font-weight: bold">if</span> part.len &gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#0000FF;font-weight: bold">Dim</span> p <span style="color:#0000FF;font-weight: bold">As</span> NSPredicateMBS = CNContactMBS.predicateForContactsMatchingName(part)
						<span style="color:#0000FF;font-weight: bold">If</span> p = <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
							<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">failed?</span>
						<span style="color:#0000FF;font-weight: bold">Elseif</span> predicate = <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
							<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">first</span> <span style="color:#7F0000;text-style:italic">one</span>
							predicate = p
						<span style="color:#0000FF;font-weight: bold">else</span>
							<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">combine</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">AND</span>
							predicate = NSCompoundPredicateMBS.andPredicateWithSubpredicates(<span style="color:#0000FF;font-weight: bold">array</span>(predicate, p))
						<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">next</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">true</span> <span style="color:#0000FF;font-weight: bold">then</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">1.</span> <span style="color:#7F0000;text-style:italic">unifiedContactsMatchingPredicate</span>
					contacts = m.unifiedContactsMatchingPredicate(predicate, keysToFetch, error)
					
				<span style="color:#0000FF;font-weight: bold">else</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">2.</span> <span style="color:#7F0000;text-style:italic">ContactsWithFetchRequest</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> fr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> CNContactFetchRequestMBS(keysToFetch)
					fr.predicate = predicate
					fr.mutableObjects = <span style="color:#0000FF;font-weight: bold">false</span>
					fr.unifyResults = <span style="color:#0000FF;font-weight: bold">true</span>
					
					contacts = m.ContactsWithFetchRequest(fr, error)
					
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				List.AddRow str(contacts.Ubound+<span style="color:#326598">1</span>)+<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">contacts</span> <span style="color:#6500FE">found&quot;</span>
				<span style="color:#0000FF;font-weight: bold">if</span> error &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
					List.AddRow <span style="color:#6500FE">&quot;Error:</span> <span style="color:#6500FE">&quot;</span>+error.LocalizedDescription
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> formatter <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> CNContactFormatterMBS
				
				<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> contact <span style="color:#0000FF;font-weight: bold">as</span> CNContactMBS <span style="color:#0000FF;font-weight: bold">in</span> contacts
					
					List.AddFolder formatter.stringFromContact(contact)
					List.RowTag(List.LastIndex) = contact
					
					
				<span style="color:#0000FF;font-weight: bold">next</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">exapand</span> <span style="color:#7F0000;text-style:italic">first</span> <span style="color:#7F0000;text-style:italic">one</span>
				<span style="color:#0000FF;font-weight: bold">if</span> list.listcount &gt; <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">then</span>
					List.Expanded(<span style="color:#326598">1</span>) = <span style="color:#0000FF;font-weight: bold">true</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			m = <span style="color:#0000FF;font-weight: bold">new</span> MyContactStore
			
			ShowAuthorization
			
			m.requestAccessForEntityType m.CNEntityTypeContacts
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> Address(p <span style="color:#0000FF;font-weight: bold">as</span> CNPostalAddressMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">string</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">list</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">text</span> <span style="color:#7F0000;text-style:italic">values</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">comma</span> <span style="color:#7F0000;text-style:italic">inbetween</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> texts() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> Street <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> = p.Street
			<span style="color:#0000FF;font-weight: bold">If</span> Street.Len &gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				texts.Append street
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> PostalCode <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> = p.PostalCode
			<span style="color:#0000FF;font-weight: bold">Dim</span> City <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> = p.City
			<span style="color:#0000FF;font-weight: bold">Dim</span> PostalCodeCity() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> PostalCode.Len &gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">Then</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">zip?</span>
				PostalCodeCity.Append PostalCode
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> City.Len &gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				PostalCodeCity.Append City
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">join</span> <span style="color:#7F0000;text-style:italic">zip</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">city</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">least</span> <span style="color:#7F0000;text-style:italic">one</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">them</span>
			<span style="color:#0000FF;font-weight: bold">If</span> PostalCodeCity.Ubound &gt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				texts.Append Join(PostalCodeCity, <span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&quot;</span>)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> Country <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> = p.Country
			<span style="color:#0000FF;font-weight: bold">If</span> Country.Len &gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				texts.Append Country
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			
			<span style="color:#0000FF;font-weight: bold">Return</span> Join(texts, <span style="color:#6500FE">&quot;,</span> <span style="color:#6500FE">&quot;</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Log(s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>)
			list.AddRow s
			list.ScrollPosition = list.ListCount
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> ShowAuthorization()
			<span style="color:#0000FF;font-weight: bold">dim</span> x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = m.authorizationStatusForEntityType(m.CNEntityTypeContacts)
			
			<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">case</span> x
			<span style="color:#0000FF;font-weight: bold">case</span> m.CNAuthorizationStatusAuthorized
				log <span style="color:#6500FE">&quot;Authorization</span> <span style="color:#6500FE">status:</span> <span style="color:#6500FE">Authorized&quot;</span>
				SearchButton.Enabled = <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">case</span> m.CNAuthorizationStatusDenied
				log <span style="color:#6500FE">&quot;Authorization</span> <span style="color:#6500FE">status:</span> <span style="color:#6500FE">Denied&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> m.CNAuthorizationStatusNotDetermined
				log <span style="color:#6500FE">&quot;Authorization</span> <span style="color:#6500FE">status:</span> <span style="color:#6500FE">Not</span> <span style="color:#6500FE">Determined&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> m.CNAuthorizationStatusRestricted
				log <span style="color:#6500FE">&quot;Authorization</span> <span style="color:#6500FE">status:</span> <span style="color:#6500FE">Restricted&quot;</span>
				SearchButton.Enabled = <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				log <span style="color:#6500FE">&quot;Authorization</span> <span style="color:#6500FE">status:</span> <span style="color:#6500FE">&quot;</span>+str(x)
				break
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">Select</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> showValue(c <span style="color:#0000FF;font-weight: bold">as</span> CNContactMBS, Key <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>)
			<span style="color:#0000FF;font-weight: bold">If</span> key.Len = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">Then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> c.isKeyAvailable(key) <span style="color:#0000FF;font-weight: bold">then</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> Variant = c.valueForKey(key)
				<span style="color:#0000FF;font-weight: bold">dim</span> l <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = c.localizedStringForKey(key)
				<span style="color:#0000FF;font-weight: bold">if</span> l = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
					l = key
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> type <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = v.Type
				
				<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">case</span> Type
					
				<span style="color:#0000FF;font-weight: bold">case</span> Variant.TypeNil
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">nothing</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">report</span>
					
					<span style="color:#0000FF">#if</span> RBVersion &lt; <span style="color:#326598">2013</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">case</span> Variant.TypeInteger, Variant.TypeLong
					<span style="color:#0000FF">#else</span>
					<span style="color:#0000FF;font-weight: bold">case</span> Variant.TypeInt32, Variant.TypeInt64
					<span style="color:#0000FF">#endif</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">just</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">number</span>
					List.AddRow l + <span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span> + v.StringValue
					
				<span style="color:#0000FF;font-weight: bold">case</span> Variant.TypeString
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">just</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">text</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> t <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = v.StringValue
					<span style="color:#0000FF;font-weight: bold">if</span> t &lt;&gt; <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
						List.AddRow l + <span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span> + t
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					
				<span style="color:#0000FF;font-weight: bold">case</span> Variant.TypeObject
					
					
					<span style="color:#0000FF;font-weight: bold">If</span> v <span style="color:#0000FF;font-weight: bold">IsA</span> NSDateComponentsMBS <span style="color:#0000FF;font-weight: bold">Then</span>
						
						<span style="color:#0000FF;font-weight: bold">Dim</span> n <span style="color:#0000FF;font-weight: bold">As</span> NSDateComponentsMBS = v
						List.AddRow l + <span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span> + n.description
					<span style="color:#0000FF;font-weight: bold">Elseif</span> v <span style="color:#0000FF;font-weight: bold">IsA</span> MemoryBlock <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">ignore</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">data</span>
						
					<span style="color:#0000FF;font-weight: bold">Else</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">something</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">handled?</span>
						Break
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
					
				<span style="color:#0000FF;font-weight: bold">case</span> Variant.TypeObject + Variant.TypeArray
					
					<span style="color:#0000FF;font-weight: bold">dim</span> items() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> values() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Object</span> = v
					<span style="color:#0000FF;font-weight: bold">if</span> values.Ubound &lt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">empty</span>
					
					<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> obj <span style="color:#0000FF;font-weight: bold">as</span> Variant <span style="color:#0000FF;font-weight: bold">in</span> values
						
						<span style="color:#0000FF;font-weight: bold">If</span> obj <span style="color:#0000FF;font-weight: bold">IsA</span> CNPhoneNumberMBS <span style="color:#0000FF;font-weight: bold">Then</span>
							<span style="color:#0000FF;font-weight: bold">Dim</span> p <span style="color:#0000FF;font-weight: bold">As</span> CNPhoneNumberMBS = obj
							items.Append p.stringValue
						<span style="color:#0000FF;font-weight: bold">Elseif</span> obj <span style="color:#0000FF;font-weight: bold">IsA</span> CNPostalAddressMBS <span style="color:#0000FF;font-weight: bold">Then</span>
							<span style="color:#0000FF;font-weight: bold">Dim</span> p <span style="color:#0000FF;font-weight: bold">As</span> CNPostalAddressMBS = obj
							items.Append address(p)
							
						<span style="color:#0000FF;font-weight: bold">Elseif</span> obj <span style="color:#0000FF;font-weight: bold">IsA</span> CNLabeledValueMBS <span style="color:#0000FF;font-weight: bold">Then</span>
							<span style="color:#0000FF;font-weight: bold">Dim</span> lv <span style="color:#0000FF;font-weight: bold">As</span> CNLabeledValueMBS = obj
							<span style="color:#0000FF;font-weight: bold">Dim</span> va <span style="color:#0000FF;font-weight: bold">As</span> Variant = lv.Value
							<span style="color:#0000FF;font-weight: bold">Dim</span> sa <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
							
							<span style="color:#0000FF;font-weight: bold">If</span> va <span style="color:#0000FF;font-weight: bold">IsA</span> CNPostalAddressMBS <span style="color:#0000FF;font-weight: bold">Then</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> po <span style="color:#0000FF;font-weight: bold">As</span> CNPostalAddressMBS = va
								sa = address(po)
							<span style="color:#0000FF;font-weight: bold">Elseif</span> va <span style="color:#0000FF;font-weight: bold">IsA</span> CNPhoneNumberMBS <span style="color:#0000FF;font-weight: bold">Then</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> pn <span style="color:#0000FF;font-weight: bold">As</span> CNPhoneNumberMBS = va
								sa = pn.stringValue
							<span style="color:#0000FF;font-weight: bold">Elseif</span> va <span style="color:#0000FF;font-weight: bold">IsA</span> CNInstantMessageAddressMBS <span style="color:#0000FF;font-weight: bold">Then</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> im <span style="color:#0000FF;font-weight: bold">As</span> CNInstantMessageAddressMBS = va
								sa = im.service+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+im.username
							<span style="color:#0000FF;font-weight: bold">Elseif</span> va <span style="color:#0000FF;font-weight: bold">IsA</span> CNSocialProfileMBS <span style="color:#0000FF;font-weight: bold">Then</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> sp <span style="color:#0000FF;font-weight: bold">As</span> CNSocialProfileMBS = va
								sa = sp.service+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+sp.username
							<span style="color:#0000FF;font-weight: bold">Elseif</span> va <span style="color:#0000FF;font-weight: bold">IsA</span> CNContactRelationMBS <span style="color:#0000FF;font-weight: bold">Then</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> cr <span style="color:#0000FF;font-weight: bold">As</span> CNContactRelationMBS = va
								sa = cr.Name
							<span style="color:#0000FF;font-weight: bold">Elseif</span> va <span style="color:#0000FF;font-weight: bold">IsA</span> NSDateComponentsMBS <span style="color:#0000FF;font-weight: bold">Then</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> n <span style="color:#0000FF;font-weight: bold">As</span> NSDateComponentsMBS = va
								sa = n.description
							<span style="color:#0000FF;font-weight: bold">Else</span>
								sa = va.StringValue
							<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
							
							items.Append lv.localizedStringForLabel(lv.Label)+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+sa
							
						<span style="color:#0000FF;font-weight: bold">else</span>
							
							<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">something</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">handled?</span>
							Break
							
						<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
						
					<span style="color:#0000FF;font-weight: bold">next</span>
					List.AddRow l + <span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span> + Join(items, <span style="color:#6500FE">&quot;,</span> <span style="color:#6500FE">&quot;</span>)
					
				<span style="color:#0000FF;font-weight: bold">else</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">something</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">handled?</span>
					Break
					
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">Select</span>
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> m <span style="color:#0000FF;font-weight: bold">As</span> MyContactStore</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar MainMenuBar</div>
<div class="RB_Code">		MenuItem FileMenu = <span style="color:#6500FE">&quot;&amp;File&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;#App.kFileQuit&quot;</span></div>
<div class="RB_Code">		MenuItem EditMenu = <span style="color:#6500FE">&quot;&amp;Edit&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;&amp;Undo&quot;</span></div>
<div class="RB_Code">			MenuItem EditSeparator1 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;Cu&amp;t&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;&amp;Copy&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;&amp;Paste&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;#App.kEditClear&quot;</span></div>
<div class="RB_Code">			MenuItem EditSeparator2 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditSelectAll = <span style="color:#6500FE">&quot;Select</span> <span style="color:#6500FE">&amp;All&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MyContactStore <span style="color:#0000FF;font-weight: bold">Inherits</span> CNContactStoreMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> DidChange()
			mainWindow.log <span style="color:#6500FE">&quot;Contacts</span> <span style="color:#6500FE">Changed&quot;</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> requestAccessForEntityType(granted <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">boolean</span>, error <span style="color:#0000FF;font-weight: bold">as</span> NSErrorMBS, tag <span style="color:#0000FF;font-weight: bold">as</span> Variant)
			MainWindow.log <span style="color:#6500FE">&quot;requestAccessForEntityType</span> <span style="color:#6500FE">completed&quot;</span>
			<span style="color:#0000FF;font-weight: bold">if</span> granted <span style="color:#0000FF;font-weight: bold">then</span>
				MainWindow.log <span style="color:#6500FE">&quot;permissions</span> <span style="color:#6500FE">granted&quot;</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				MainWindow.log <span style="color:#6500FE">&quot;Permissions</span> <span style="color:#6500FE">denied&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			MainWindow.ShowAuthorization
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	ExternalFile info</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> ExternalFile</div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

<p>See also:<ul>
<li><A href="example-mac64bit-contacts-contactshistory.html">/Mac64bit/Contacts/Contacts History</A></li>
<li><A href="example-mac64bit-contacts-contactstest.html">/Mac64bit/Contacts/Contacts Test</A></li>
</ul></p>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmac64bitplugin.html">MBS Mac64bit Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-mac64bit-contacts-contactsdisplayperson">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

