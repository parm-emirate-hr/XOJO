<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /ChartDirector/ChartDirector Control Retina</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /ChartDirector/ChartDirector Control Retina</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/ChartDirector/ChartDirector Control Retina</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS Main Plugin, MBS ChartDirector Plugin, MBS Images Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /ChartDirector/ChartDirector Control Retina<BR>
This example is the version from Thu, 31th Mar 2021.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;ChartDirector</span> <span style="color:#6500FE">Control</span> <span style="color:#6500FE">Retina.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kEditClear = <span style="color:#6500FE">&quot;&amp;Delete&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuit = <span style="color:#6500FE">&quot;&amp;Quit&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuitShortcut = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">register</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">plugin</span> <span style="color:#7F0000;text-style:italic">here</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">CDBaseChartMBS.Set</span> <span style="color:#7F0000;text-style:italic">License</span> <span style="color:#7F0000;text-style:italic">Code</span> <span style="color:#7F0000;text-style:italic">&quot;xxx&quot;,</span> <span style="color:#7F0000;text-style:italic">201612,</span> <span style="color:#7F0000;text-style:italic">123,</span> <span style="color:#7F0000;text-style:italic">123</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar MenuBar1</div>
<div class="RB_Code">		MenuItem FileMenu = <span style="color:#6500FE">&quot;&amp;File&quot;</span></div>
<div class="RB_Code">			MenuItem PrintA1 = <span style="color:#6500FE">&quot;Print</span> <span style="color:#6500FE">Symbolline...&quot;</span></div>
<div class="RB_Code">			MenuItem PrintA2 = <span style="color:#6500FE">&quot;Print</span> <span style="color:#6500FE">Bars...&quot;</span></div>
<div class="RB_Code">			MenuItem PrintA3 = <span style="color:#6500FE">&quot;Print</span> <span style="color:#6500FE">surface...&quot;</span></div>
<div class="RB_Code">			MenuItem PrintA4 = <span style="color:#6500FE">&quot;Print</span> <span style="color:#6500FE">Pie...&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledSeparator = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;#App.kFileQuit&quot;</span></div>
<div class="RB_Code">		MenuItem EditMenu = <span style="color:#6500FE">&quot;&amp;Edit&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;&amp;Undo&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu1 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;Cu&amp;t&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;&amp;Copy&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;&amp;Paste&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;#App.kEditClear&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu0 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditSelectAll = <span style="color:#6500FE">&quot;Select</span> <span style="color:#6500FE">&amp;All&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> PicWindow <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control a1 <span style="color:#0000FF;font-weight: bold">Inherits</span> ChartDirectorControl</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance a1 <span style="color:#0000FF;font-weight: bold">Inherits</span> ChartDirectorControl</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> ItemClicked(XLabel <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, DataSet <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, DataSetName <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, Value <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Title <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, Sector <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Label <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>)
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">switch</span> <span style="color:#7F0000;text-style:italic">symbols</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">clicked</span> <span style="color:#7F0000;text-style:italic">values</span> <span style="color:#7F0000;text-style:italic">here</span>
				
				<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">case</span> DataSet <span style="color:#0000FF;font-weight: bold">mod</span> <span style="color:#326598">3</span>
				<span style="color:#0000FF;font-weight: bold">case</span> <span style="color:#326598">0</span>
					Data0clicked(x) = <span style="color:#0000FF;font-weight: bold">not</span> Data0clicked(x)
				<span style="color:#0000FF;font-weight: bold">case</span> <span style="color:#326598">1</span>
					Data1clicked(x) = <span style="color:#0000FF;font-weight: bold">not</span> Data1clicked(x)
				<span style="color:#0000FF;font-weight: bold">case</span> <span style="color:#326598">2</span>
					Data2clicked(x) = <span style="color:#0000FF;font-weight: bold">not</span> Data2clicked(x)
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">Return</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">Select</span>
				
				a1.Redraw
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">Dim</span> P <span style="color:#0000FF;font-weight: bold">As</span> Picture
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Ghost</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">overlay</span> <span style="color:#7F0000;text-style:italic">image</span>
				P = LogoMBS(<span style="color:#326598">200</span>)
				P.Mask.Graphics.ForeColor = &amp;c<span style="color:#FF0000">DD</span><span style="color:#00FF00">DD</span><span style="color:#0000FF">DD</span>
				P.Mask.Graphics.FillRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, P.Width, P.Height)
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">overlay</span> <span style="color:#7F0000;text-style:italic">image</span>
				<span style="color:#0000FF;font-weight: bold">Me</span>.OverlayPicture = P
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> Render(ViewPort <span style="color:#0000FF;font-weight: bold">As</span> CDViewPortManagerMBS, Factor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Width <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Height <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS
				CDBaseChartMBS.ScaleFactor = <span style="color:#326598">2</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">chart</span>
				
				viewport.validateViewPort
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Create</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">XYChart</span> <span style="color:#7F0000;text-style:italic">object</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">size</span> <span style="color:#7F0000;text-style:italic">600</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">375</span> <span style="color:#7F0000;text-style:italic">pixels</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> CDXYChartMBS(width*factor, height*factor)
				
				
				
				
				<span style="color:#7F0000;text-style:italic">&#39;C.setBackground(C.kTransparent)</span>
				C.setTransparentColor(-<span style="color:#326598">1</span>)
				
				C.setClipping(<span style="color:#326598">0</span>)
				C.setAntiAlias(<span style="color:#0000FF;font-weight: bold">True</span>, C.kAntiAlias)
				
				
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">title</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">18</span> <span style="color:#7F0000;text-style:italic">pts</span> <span style="color:#7F0000;text-style:italic">Times</span> <span style="color:#7F0000;text-style:italic">Bold</span> <span style="color:#7F0000;text-style:italic">Italic</span> <span style="color:#7F0000;text-style:italic">font</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.addTitle(<span style="color:#6500FE">&quot;Product</span> <span style="color:#6500FE">Line</span> <span style="color:#6500FE">Global</span> <span style="color:#6500FE">Revenue&quot;</span>, <span style="color:#6500FE">&quot;timesbi.ttf&quot;</span>, <span style="color:#326598">18</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">plotarea</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">(50,</span> <span style="color:#7F0000;text-style:italic">55)</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">500</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">280</span> <span style="color:#7F0000;text-style:italic">pixels</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">size.</span> <span style="color:#7F0000;text-style:italic">Use</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">vertical</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">gradient</span> <span style="color:#7F0000;text-style:italic">color</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">light</span> <span style="color:#7F0000;text-style:italic">blue</span> <span style="color:#7F0000;text-style:italic">(f9f9ff)</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">sky</span> <span style="color:#7F0000;text-style:italic">blue</span> <span style="color:#7F0000;text-style:italic">(aaccff)</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">background.</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">border</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">transparent</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">grid</span> <span style="color:#7F0000;text-style:italic">lines</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">white</span> <span style="color:#7F0000;text-style:italic">(ffffff).</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.setPlotArea(<span style="color:#326598">50</span>*factor, <span style="color:#326598">55</span>*factor, (width-<span style="color:#326598">100</span>)*factor, (height-<span style="color:#326598">100</span>)*factor, c.linearGradientColor(<span style="color:#326598">0</span>, <span style="color:#326598">55</span>, <span style="color:#326598">0</span>, <span style="color:#326598">335</span>, <span style="color:#326598">&amp;hf9fcff</span>, <span style="color:#326598">&amp;haaccff</span>), -<span style="color:#326598">1</span>, c.kTransparent, <span style="color:#326598">&amp;hffffff</span>)
				<span style="color:#0000FF;font-weight: bold">call</span> c.setClipping
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">legend</span> <span style="color:#7F0000;text-style:italic">box</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">(50,</span> <span style="color:#7F0000;text-style:italic">28)</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">horizontal</span> <span style="color:#7F0000;text-style:italic">layout.</span> <span style="color:#7F0000;text-style:italic">Use</span> <span style="color:#7F0000;text-style:italic">10pts</span> <span style="color:#7F0000;text-style:italic">Arial</span> <span style="color:#7F0000;text-style:italic">Bold</span> <span style="color:#7F0000;text-style:italic">as</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">font,</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">transparent</span> <span style="color:#7F0000;text-style:italic">background.</span>
				c.addLegend(<span style="color:#326598">50</span>*factor, <span style="color:#326598">28</span>*factor, <span style="color:#0000FF;font-weight: bold">false</span>, <span style="color:#6500FE">&quot;arialbd.ttf&quot;</span>, <span style="color:#326598">10</span>*factor).setBackground(c.kTransparent)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">labels</span>
				<span style="color:#7F0000;text-style:italic">&#39;call</span> <span style="color:#7F0000;text-style:italic">c.xAxis.setLabels(labels)</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">y-axis</span> <span style="color:#7F0000;text-style:italic">tick</span> <span style="color:#7F0000;text-style:italic">density</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">30</span> <span style="color:#7F0000;text-style:italic">pixels.</span> <span style="color:#7F0000;text-style:italic">ChartDirector</span> <span style="color:#7F0000;text-style:italic">auto-scaling</span> <span style="color:#7F0000;text-style:italic">will</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">this</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">guideline</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">putting</span> <span style="color:#7F0000;text-style:italic">ticks</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">y-axis.</span>
				c.yAxis.setTickDensity(<span style="color:#326598">30</span>*factor)
				c.yAxis2.setTickDensity(<span style="color:#326598">30</span>*factor)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">style</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">8pts</span> <span style="color:#7F0000;text-style:italic">Arial</span> <span style="color:#7F0000;text-style:italic">Bold</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.xAxis.setLabelStyle(<span style="color:#6500FE">&quot;arialbd.ttf&quot;</span>, <span style="color:#326598">8</span>*factor)
				<span style="color:#0000FF;font-weight: bold">call</span> c.yAxis.setLabelStyle(<span style="color:#6500FE">&quot;arialbd.ttf&quot;</span>, <span style="color:#326598">8</span>*factor)
				<span style="color:#0000FF;font-weight: bold">call</span> c.yAxis2.setLabelStyle(<span style="color:#6500FE">&quot;arialbd.ttf&quot;</span>, <span style="color:#326598">8</span>*factor)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">2</span> <span style="color:#7F0000;text-style:italic">pixels</span>
				c.xAxis.setWidth(<span style="color:#326598">2</span>*factor)
				c.yAxis.setWidth(<span style="color:#326598">2</span>*factor)
				c.yAxis2.setWidth(<span style="color:#326598">2</span>*factor)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">title</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">10pts</span> <span style="color:#7F0000;text-style:italic">Arial</span> <span style="color:#7F0000;text-style:italic">Bold</span> <span style="color:#7F0000;text-style:italic">Italic</span> <span style="color:#7F0000;text-style:italic">font</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.yAxis.setTitle(<span style="color:#6500FE">&quot;Revenue</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">US</span> <span style="color:#6500FE">millions&quot;</span>, <span style="color:#6500FE">&quot;arialbi.ttf&quot;</span>, <span style="color:#326598">10</span>*factor)
				<span style="color:#0000FF;font-weight: bold">call</span> c.yAxis2.setTitle(<span style="color:#6500FE">&quot;Revenue</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">US</span> <span style="color:#6500FE">millions&quot;</span>, <span style="color:#6500FE">&quot;arialbi.ttf&quot;</span>, <span style="color:#326598">10</span>*factor)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">scroll</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> axisLowerLimit <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> axisUpperLimit <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>
				
				axisLowerLimit = <span style="color:#006532">100.0</span>-<span style="color:#006532">100.0</span> *(viewport.getViewPortLeft + viewport.getViewPortWidth)
				axisUpperLimit = <span style="color:#006532">100.0</span>-<span style="color:#006532">100.0</span> * viewport.getViewPortLeft
				
				c.xAxis.setLinearScale(axisLowerLimit,axisUpperLimit)
				c.xAxis.setRounding(<span style="color:#0000FF;font-weight: bold">false</span>, <span style="color:#0000FF;font-weight: bold">false</span>)
				
				axisLowerLimit =  <span style="color:#006532">100.0</span>-<span style="color:#006532">100.0</span> *(viewport.getViewPortTop + viewport.getViewPortHeight)
				axisUpperLimit =  <span style="color:#006532">100.0</span>-<span style="color:#006532">100.0</span> * viewport.getViewPortTop
				
				c.yAxis.setLinearScale(axisLowerLimit,axisUpperLimit)
				c.yAxis.setRounding(<span style="color:#0000FF;font-weight: bold">false</span>, <span style="color:#0000FF;font-weight: bold">false</span>)
				c.yAxis2.setLinearScale(axisLowerLimit,axisUpperLimit)
				c.yAxis2.setRounding(<span style="color:#0000FF;font-weight: bold">false</span>, <span style="color:#0000FF;font-weight: bold">false</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">layer</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> layer <span style="color:#0000FF;font-weight: bold">as</span> CDLineLayerMBS
				layer = c.addLineLayer
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">3</span> <span style="color:#7F0000;text-style:italic">pixels</span>
				layer.setLineWidth(<span style="color:#326598">3</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">three</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">sets</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">layer,</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">circles,</span> <span style="color:#7F0000;text-style:italic">diamands</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">X</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">shapes</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">symbols</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">lines</span> <span style="color:#7F0000;text-style:italic">only</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> d <span style="color:#0000FF;font-weight: bold">as</span> CDDataSetMBS
				d=layer.addDataSet(data0, <span style="color:#326598">&amp;hff0000</span>, <span style="color:#6500FE">&quot;Quantum</span> <span style="color:#6500FE">Computer&quot;</span>)
				<span style="color:#7F0000;text-style:italic">&#39;d.setDataSymbol(c.kCircleSymbol,</span> <span style="color:#7F0000;text-style:italic">9*factor)</span>
				d.setLineWidth(factor)
				d=layer.addDataSet(data1, <span style="color:#326598">&amp;h00ff00</span>, <span style="color:#6500FE">&quot;Atom</span> <span style="color:#6500FE">Synthesizer&quot;</span>)
				<span style="color:#7F0000;text-style:italic">&#39;d.setDataSymbol(c.kDiamondSymbol,</span> <span style="color:#7F0000;text-style:italic">11*factor)</span>
				d.setLineWidth(factor)
				d=layer.addDataSet(data2, <span style="color:#326598">&amp;hff6600</span>, <span style="color:#6500FE">&quot;Proton</span> <span style="color:#6500FE">Cannon&quot;</span>)
				d.setLineWidth(factor)
				<span style="color:#7F0000;text-style:italic">&#39;d.setDataSymbol(c.Cross2Shape,</span> <span style="color:#7F0000;text-style:italic">11*factor)</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">first</span> <span style="color:#7F0000;text-style:italic">color</span> <span style="color:#7F0000;text-style:italic">values</span>
				d=layer.addDataSet(FilterValues(data0, Data0clicked, <span style="color:#0000FF;font-weight: bold">false</span>), <span style="color:#326598">&amp;hff0000</span>)
				d.setDataSymbol(c.kCircleSymbol, <span style="color:#326598">9</span>*factor)
				d.setLineWidth(<span style="color:#326598">0</span>)
				d=layer.addDataSet(FilterValues(data1, Data1clicked, <span style="color:#0000FF;font-weight: bold">false</span>), <span style="color:#326598">&amp;h00ff00</span>)
				d.setDataSymbol(c.kDiamondSymbol, <span style="color:#326598">11</span>*factor)
				d.setLineWidth(<span style="color:#326598">0</span>)
				d=layer.addDataSet(FilterValues(data2, Data2clicked, <span style="color:#0000FF;font-weight: bold">false</span>), <span style="color:#326598">&amp;hff6600</span>)
				d.setLineWidth(<span style="color:#326598">0</span>)
				d.setDataSymbol(c.Cross2Shape, <span style="color:#326598">11</span>*factor)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">second</span> <span style="color:#7F0000;text-style:italic">color</span> <span style="color:#7F0000;text-style:italic">values</span>
				d=layer.addDataSet(FilterValues(data0, Data0clicked, <span style="color:#0000FF;font-weight: bold">true</span>), <span style="color:#326598">&amp;h00ff00</span>)
				d.setDataSymbol(c.kCircleSymbol, <span style="color:#326598">9</span>*factor)
				d.setLineWidth(<span style="color:#326598">0</span>)
				d=layer.addDataSet(FilterValues(data1, Data1clicked, <span style="color:#0000FF;font-weight: bold">true</span>), <span style="color:#326598">&amp;hff0000</span>)
				d.setDataSymbol(c.kDiamondSymbol, <span style="color:#326598">11</span>*factor)
				d.setLineWidth(<span style="color:#326598">0</span>)
				d=layer.addDataSet(FilterValues(data2, Data2clicked, <span style="color:#0000FF;font-weight: bold">true</span>), <span style="color:#326598">&amp;h0000ff</span>)
				d.setLineWidth(<span style="color:#326598">0</span>)
				d.setDataSymbol(c.Cross2Shape, <span style="color:#326598">11</span>*factor)
				
				<span style="color:#0000FF;font-weight: bold">Return</span> c
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control a2 <span style="color:#0000FF;font-weight: bold">Inherits</span> ChartDirectorControl</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance a2 <span style="color:#0000FF;font-weight: bold">Inherits</span> ChartDirectorControl</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> Render(ViewPort <span style="color:#0000FF;font-weight: bold">As</span> CDViewPortManagerMBS, Factor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Width <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Height <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS
				CDBaseChartMBS.ScaleFactor = <span style="color:#326598">2</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> f <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = factor <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">scale</span> <span style="color:#7F0000;text-style:italic">factor,</span> <span style="color:#7F0000;text-style:italic">1</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">screen</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">4</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">more</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">printing</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> data0(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = <span style="color:#0000FF;font-weight: bold">array</span>(<span style="color:#326598">6</span>, <span style="color:#006532">12.5</span>, <span style="color:#006532">18.2</span>, <span style="color:#006532">15.0</span>)
				<span style="color:#0000FF;font-weight: bold">dim</span> angles0(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = <span style="color:#0000FF;font-weight: bold">array</span>(<span style="color:#326598">45</span>, <span style="color:#326598">96</span>, <span style="color:#326598">169</span>, <span style="color:#006532">258.0</span>)
				<span style="color:#0000FF;font-weight: bold">dim</span> size0(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = <span style="color:#0000FF;font-weight: bold">array</span>(f*<span style="color:#326598">41</span>, f*<span style="color:#326598">105</span>, f*<span style="color:#326598">12</span>, f*<span style="color:#006532">20.0</span>)
				
				<span style="color:#0000FF;font-weight: bold">dim</span> data1(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = <span style="color:#0000FF;font-weight: bold">array</span>(<span style="color:#326598">18</span>, <span style="color:#326598">16</span>, <span style="color:#326598">11</span>, <span style="color:#006532">14.0</span>)
				<span style="color:#0000FF;font-weight: bold">dim</span> angles1(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = <span style="color:#0000FF;font-weight: bold">array</span>(<span style="color:#326598">30</span>, <span style="color:#326598">210</span>, <span style="color:#326598">240</span>, <span style="color:#006532">310.0</span>)
				<span style="color:#0000FF;font-weight: bold">dim</span> size1(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = <span style="color:#0000FF;font-weight: bold">array</span>(f*<span style="color:#326598">30</span>, f*<span style="color:#326598">45</span>, f*<span style="color:#326598">12</span>, f*<span style="color:#006532">90.0</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Create</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">PolarChart</span> <span style="color:#7F0000;text-style:italic">object</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">size</span> <span style="color:#7F0000;text-style:italic">460</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">460</span> <span style="color:#7F0000;text-style:italic">pixels</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> CDPolarChartMBS(f*width, f*height)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">title</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">top</span> <span style="color:#7F0000;text-style:italic">left</span> <span style="color:#7F0000;text-style:italic">corner</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">15pts</span> <span style="color:#7F0000;text-style:italic">Arial</span> <span style="color:#7F0000;text-style:italic">Bold</span> <span style="color:#7F0000;text-style:italic">Italic</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">font</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.addTitle(CDPolarChartMBS.kTopLeft, <span style="color:#6500FE">&quot;&lt;*underline=2*&gt;EM</span> <span style="color:#6500FE">Field</span> <span style="color:#6500FE">Strength&quot;</span>, <span style="color:#6500FE">&quot;arialbi.ttf&quot;</span>, f*<span style="color:#326598">15</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">center</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">plot</span> <span style="color:#7F0000;text-style:italic">area</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">(230,</span> <span style="color:#7F0000;text-style:italic">240)</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">radius</span> <span style="color:#7F0000;text-style:italic">180</span> <span style="color:#7F0000;text-style:italic">pixels</span>
				c.setPlotArea(f*width/<span style="color:#326598">2</span>, f*height/<span style="color:#326598">2</span>, f*min(width,height)*<span style="color:#006532">0.35</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Use</span> <span style="color:#7F0000;text-style:italic">alternative</span> <span style="color:#7F0000;text-style:italic">light</span> <span style="color:#7F0000;text-style:italic">grey/dark</span> <span style="color:#7F0000;text-style:italic">grey</span> <span style="color:#7F0000;text-style:italic">circular</span> <span style="color:#7F0000;text-style:italic">background</span> <span style="color:#7F0000;text-style:italic">color</span>
				c.setPlotAreaBg(<span style="color:#326598">&amp;hdddddd</span>, <span style="color:#326598">&amp;heeeeee</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">grid</span> <span style="color:#7F0000;text-style:italic">style</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">circular</span> <span style="color:#7F0000;text-style:italic">grid</span>
				c.setGridStyle(<span style="color:#0000FF;font-weight: bold">false</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">legend</span> <span style="color:#7F0000;text-style:italic">box</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">top</span> <span style="color:#7F0000;text-style:italic">right</span> <span style="color:#7F0000;text-style:italic">corner</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">9</span> <span style="color:#7F0000;text-style:italic">pts</span> <span style="color:#7F0000;text-style:italic">Arial</span> <span style="color:#7F0000;text-style:italic">Bold</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">font</span>
				c.addLegend(f*width-f*<span style="color:#326598">2</span>, f*<span style="color:#326598">0</span>, <span style="color:#0000FF;font-weight: bold">true</span>, <span style="color:#6500FE">&quot;arialbd.ttf&quot;</span>, f*<span style="color:#326598">9</span>).setAlignment(CDPolarChartMBS.kTopRight)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">angular</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">0</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">360,</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">spoke</span> <span style="color:#7F0000;text-style:italic">every</span> <span style="color:#7F0000;text-style:italic">30</span> <span style="color:#7F0000;text-style:italic">units</span>
				c.angularAxis.setLinearScale(<span style="color:#326598">0</span>, <span style="color:#326598">360</span>, <span style="color:#326598">30</span>)
				
				c.radialAxis.setLinearScale <span style="color:#326598">0</span>, <span style="color:#326598">20</span>,<span style="color:#326598">5</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">radial</span> <span style="color:#7F0000;text-style:italic">axis</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">format</span>
				c.radialAxis.setLabelFormat(<span style="color:#6500FE">&quot;{value}</span> <span style="color:#6500FE">km&quot;</span>)
				
				c.angularAxis.setLabelGap f*<span style="color:#326598">8</span>
				
				<span style="color:#0000FF;font-weight: bold">call</span> c.angularAxis.setLabelStyle <span style="color:#6500FE">&quot;&quot;</span>,<span style="color:#326598">8</span>*f
				<span style="color:#0000FF;font-weight: bold">call</span> c.radialAxis.setLabelStyle <span style="color:#6500FE">&quot;&quot;</span>,<span style="color:#326598">8</span>*f
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">blue</span> <span style="color:#7F0000;text-style:italic">(&amp;h9999ff)</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">layer</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">(data0,</span> <span style="color:#7F0000;text-style:italic">angle0)</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> layer0 <span style="color:#0000FF;font-weight: bold">as</span> CDPolarLineLayerMBS
				layer0 = c.addLineLayer(data0, <span style="color:#326598">&amp;h9999ff</span>, <span style="color:#6500FE">&quot;Cold</span> <span style="color:#6500FE">Spot&quot;</span>)
				layer0.setAngles(angles0)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Disable</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">setting</span> <span style="color:#7F0000;text-style:italic">its</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">0,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">symbols</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">visible</span>
				layer0.setLineWidth(<span style="color:#326598">0</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Use</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">circular</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">point</span> <span style="color:#7F0000;text-style:italic">symbol</span>
				layer0.setDataSymbol(CDPolarChartMBS.kCircleSymbol, f*<span style="color:#326598">11</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Modulate</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">symbol</span> <span style="color:#7F0000;text-style:italic">size</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">size0</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">produce</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">bubble</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">effect</span>
				layer0.setSymbolScale(size0)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">red</span> <span style="color:#7F0000;text-style:italic">(&amp;hff9999)</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">layer</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">(data1,</span> <span style="color:#7F0000;text-style:italic">angle1)</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> layer1 <span style="color:#0000FF;font-weight: bold">as</span> CDPolarLineLayerMBS
				layer1 = c.addLineLayer(data1,<span style="color:#326598">&amp;hff9999</span>, <span style="color:#6500FE">&quot;Hot</span> <span style="color:#6500FE">Spot&quot;</span>)
				layer1.setAngles(angles1)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Disable</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">setting</span> <span style="color:#7F0000;text-style:italic">its</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">0,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">symbols</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">visible</span>
				layer1.setLineWidth(<span style="color:#326598">0</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Use</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">circular</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">point</span> <span style="color:#7F0000;text-style:italic">symbol</span>
				layer1.setDataSymbol(CDPolarChartMBS.kCircleSymbol, f*<span style="color:#326598">11</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Modulate</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">symbol</span> <span style="color:#7F0000;text-style:italic">size</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">size1</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">produce</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">bubble</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">effect</span>
				layer1.setSymbolScale(size1)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Output</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span>
				<span style="color:#0000FF;font-weight: bold">Return</span> c
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control a4 <span style="color:#0000FF;font-weight: bold">Inherits</span> ChartDirectorControl</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance a4 <span style="color:#0000FF;font-weight: bold">Inherits</span> ChartDirectorControl</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> Render(ViewPort <span style="color:#0000FF;font-weight: bold">As</span> CDViewPortManagerMBS, Factor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Width <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Height <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS
				CDBaseChartMBS.ScaleFactor = <span style="color:#326598">2</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> f <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = factor <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">scale</span> <span style="color:#7F0000;text-style:italic">factor,</span> <span style="color:#7F0000;text-style:italic">1</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">screen</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">4</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">more</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">printing</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">pyramid</span> <span style="color:#7F0000;text-style:italic">chart</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> data(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = <span style="color:#0000FF;font-weight: bold">array</span>(<span style="color:#006532">156.0</span>, <span style="color:#326598">123</span>, <span style="color:#326598">211</span>, <span style="color:#326598">179</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">labels</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">pyramid</span> <span style="color:#7F0000;text-style:italic">chart</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> labels(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = <span style="color:#0000FF;font-weight: bold">array</span>(<span style="color:#6500FE">&quot;Funds&quot;</span>, <span style="color:#6500FE">&quot;Bonds&quot;</span>, <span style="color:#6500FE">&quot;Stocks&quot;</span>, <span style="color:#6500FE">&quot;Cash&quot;</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">semi-transparent</span> <span style="color:#7F0000;text-style:italic">colors</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">pyramid</span> <span style="color:#7F0000;text-style:italic">layers</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> colors(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>
				colors.Append <span style="color:#326598">&amp;h60000088</span>
				colors.Append <span style="color:#326598">&amp;h6066aaee</span>
				colors.Append <span style="color:#326598">&amp;h60ffbb00</span>
				colors.Append <span style="color:#326598">&amp;h60ee6622</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Create</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">PyramidChart</span> <span style="color:#7F0000;text-style:italic">object</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">size</span> <span style="color:#7F0000;text-style:italic">480</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">400</span> <span style="color:#7F0000;text-style:italic">pixels</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> CDPyramidChartMBS(f*width, f*height)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">cone</span> <span style="color:#7F0000;text-style:italic">center</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">(280,</span> <span style="color:#7F0000;text-style:italic">180),</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">height</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">150</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">300</span> <span style="color:#7F0000;text-style:italic">pixels</span>
				c.setConeSize(f*width/<span style="color:#326598">2</span>, f*height/<span style="color:#326598">2</span>, f*min(height,width)*<span style="color:#006532">0.333</span>, f*height*<span style="color:#006532">0.75</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">elevation</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">15</span> <span style="color:#7F0000;text-style:italic">degrees</span>
				c.setViewAngle(<span style="color:#326598">15</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">pyramid</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">labels</span>
				c.setData(data, labels)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">layer</span> <span style="color:#7F0000;text-style:italic">colors</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">given</span> <span style="color:#7F0000;text-style:italic">colors</span>
				c.setColors(c.kDataColor, colors)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Leave</span> <span style="color:#7F0000;text-style:italic">1%</span> <span style="color:#7F0000;text-style:italic">gaps</span> <span style="color:#7F0000;text-style:italic">between</span> <span style="color:#7F0000;text-style:italic">layers</span>
				c.setLayerGap(<span style="color:#006532">0.01</span>)
				
				c.setJoinLine(<span style="color:#326598">&amp;h000000</span>, f)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">labels</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">left</span> <span style="color:#7F0000;text-style:italic">side</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">pyramid</span> <span style="color:#7F0000;text-style:italic">layers</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">Arial</span> <span style="color:#7F0000;text-style:italic">Bold</span> <span style="color:#7F0000;text-style:italic">font.</span> <span style="color:#7F0000;text-style:italic">The</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">labels</span> <span style="color:#7F0000;text-style:italic">will</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">3</span> <span style="color:#7F0000;text-style:italic">lines</span> <span style="color:#7F0000;text-style:italic">showing</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">layer</span> <span style="color:#7F0000;text-style:italic">name,</span> <span style="color:#7F0000;text-style:italic">value</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">percentage.</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.setLeftLabel(<span style="color:#6500FE">&quot;{label}&quot;</span>+EndOfLine.unix+<span style="color:#6500FE">&quot;US</span> <span style="color:#6500FE">${value}K&quot;</span>+EndOfLine.unix+<span style="color:#6500FE">&quot;({percent}%)&quot;</span>, <span style="color:#6500FE">&quot;arialbd.ttf&quot;</span>,<span style="color:#326598">8</span>*f)
				
				
				<span style="color:#0000FF;font-weight: bold">Return</span> c
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control a3 <span style="color:#0000FF;font-weight: bold">Inherits</span> ChartDirectorControl</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance a3 <span style="color:#0000FF;font-weight: bold">Inherits</span> ChartDirectorControl</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> ItemClicked(XLabel <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, DataSet <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, DataSetName <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, Value <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Title <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, Sector <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Label <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>)
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Manage</span> <span style="color:#7F0000;text-style:italic">UI</span> <span style="color:#7F0000;text-style:italic">interaction</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">rendering</span> <span style="color:#7F0000;text-style:italic">variables</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (Sector = HighLightSector) <span style="color:#0000FF;font-weight: bold">Then</span>
					HighLightSector = -<span style="color:#326598">1</span>
				<span style="color:#0000FF;font-weight: bold">Else</span>
					HighLightSector = Sector
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				<span style="color:#0000FF;font-weight: bold">Me</span>.Redraw
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">Dim</span> P <span style="color:#0000FF;font-weight: bold">As</span> Picture
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Ghost</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">overlay</span> <span style="color:#7F0000;text-style:italic">image</span>
				P = LogoMBS(<span style="color:#326598">200</span>)
				P.Mask.Graphics.ForeColor = &amp;c<span style="color:#FF0000">DD</span><span style="color:#00FF00">DD</span><span style="color:#0000FF">DD</span>
				P.Mask.Graphics.FillRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, P.Width, P.Height)
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">overlay</span> <span style="color:#7F0000;text-style:italic">image</span>
				<span style="color:#0000FF;font-weight: bold">Me</span>.OverlayPicture = P
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> Render(ViewPort <span style="color:#0000FF;font-weight: bold">As</span> CDViewPortManagerMBS, Factor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Width <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Height <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS
				CDBaseChartMBS.ScaleFactor = <span style="color:#326598">2</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> f <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = factor <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">scale</span> <span style="color:#7F0000;text-style:italic">factor,</span> <span style="color:#7F0000;text-style:italic">1</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">screen</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">4</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">more</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">printing</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">pie</span> <span style="color:#7F0000;text-style:italic">chart</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> data(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = <span style="color:#0000FF;font-weight: bold">array</span>(<span style="color:#006532">21.0</span>, <span style="color:#326598">18</span>, <span style="color:#326598">15</span>, <span style="color:#326598">12</span>, <span style="color:#326598">8</span>, <span style="color:#326598">24</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">labels</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">pie</span> <span style="color:#7F0000;text-style:italic">chart</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> labels(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = <span style="color:#0000FF;font-weight: bold">array</span>(<span style="color:#6500FE">&quot;Labor&quot;</span>, <span style="color:#6500FE">&quot;Licenses&quot;</span>, <span style="color:#6500FE">&quot;Taxes&quot;</span>, <span style="color:#6500FE">&quot;Legal&quot;</span>, <span style="color:#6500FE">&quot;Facilities&quot;</span>, <span style="color:#6500FE">&quot;Production&quot;</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">colors</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">sectors</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> colors(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>
				
				colors.Append <span style="color:#326598">&amp;h66aaee</span>
				colors.Append <span style="color:#326598">&amp;heebb22</span>
				colors.Append <span style="color:#326598">&amp;hbbbbbb</span>
				colors.Append <span style="color:#326598">&amp;h8844ff</span>
				colors.Append <span style="color:#326598">&amp;hdd2222</span>
				colors.Append <span style="color:#326598">&amp;h009900</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Create</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">PieChart</span> <span style="color:#7F0000;text-style:italic">object</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">size</span> <span style="color:#7F0000;text-style:italic">600</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">320</span> <span style="color:#7F0000;text-style:italic">pixels.</span> <span style="color:#7F0000;text-style:italic">Use</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">vertical</span> <span style="color:#7F0000;text-style:italic">gradient</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">color</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">light</span> <span style="color:#7F0000;text-style:italic">blue</span> <span style="color:#7F0000;text-style:italic">(99ccff)</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">white</span> <span style="color:#7F0000;text-style:italic">(ffffff)</span> <span style="color:#7F0000;text-style:italic">spanning</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">top</span> <span style="color:#7F0000;text-style:italic">100</span> <span style="color:#7F0000;text-style:italic">pixels</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">background.</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">border</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">grey</span> <span style="color:#7F0000;text-style:italic">(888888).</span> <span style="color:#7F0000;text-style:italic">Use</span> <span style="color:#7F0000;text-style:italic">rounded</span> <span style="color:#7F0000;text-style:italic">corners.</span> <span style="color:#7F0000;text-style:italic">Enable</span> <span style="color:#7F0000;text-style:italic">soft</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">drop</span> <span style="color:#7F0000;text-style:italic">shadow.</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> CDPieChartMBS(f*width, f*height)
				c.setBackground(c.linearGradientColor(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, <span style="color:#326598">100</span>, <span style="color:#326598">&amp;h99ccff</span>, <span style="color:#326598">&amp;hffffff</span>),<span style="color:#326598">&amp;h888888</span>)
				c.setRoundedFrame(<span style="color:#326598">&amp;hFFFFFF</span>,<span style="color:#326598">10</span>*f)
				<span style="color:#7F0000;text-style:italic">&#39;c.setDropShadow</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> HighLightSector&gt;=<span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					c.setExplode(HighLightSector)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">title</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">18</span> <span style="color:#7F0000;text-style:italic">pts</span> <span style="color:#7F0000;text-style:italic">Times</span> <span style="color:#7F0000;text-style:italic">New</span> <span style="color:#7F0000;text-style:italic">Roman</span> <span style="color:#7F0000;text-style:italic">Bold</span> <span style="color:#7F0000;text-style:italic">Italic</span> <span style="color:#7F0000;text-style:italic">font.</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">16</span> <span style="color:#7F0000;text-style:italic">pixels</span> <span style="color:#7F0000;text-style:italic">top</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">margin</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">title.</span>
				c.addTitle(<span style="color:#6500FE">&quot;Pie</span> <span style="color:#6500FE">Chart</span> <span style="color:#6500FE">With</span> <span style="color:#6500FE">Legend</span> <span style="color:#6500FE">Demonstration&quot;</span>, <span style="color:#6500FE">&quot;timesbi.ttf&quot;</span>, f*<span style="color:#326598">18</span>).setMargin(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, f*<span style="color:#326598">16</span>, <span style="color:#326598">0</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">center</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">pie</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">(160,</span> <span style="color:#7F0000;text-style:italic">165)</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">radius</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">110</span> <span style="color:#7F0000;text-style:italic">pixels</span>
				c.setPieSize(f*width/<span style="color:#326598">4</span>, f*height/<span style="color:#326598">2</span>, f*<span style="color:#326598">110</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">pie</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">3D</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">pie</span> <span style="color:#7F0000;text-style:italic">thickness</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">25</span> <span style="color:#7F0000;text-style:italic">pixels</span>
				c.set3D(f*<span style="color:#326598">25</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">pie</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">pie</span> <span style="color:#7F0000;text-style:italic">labels</span>
				c.setData(data, labels)
				
				<span style="color:#0000FF;font-weight: bold">call</span> c.setLabelStyle
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">sector</span> <span style="color:#7F0000;text-style:italic">colors</span>
				c.setColors(CDPieChartMBS.kDataColor, colors)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Use</span> <span style="color:#7F0000;text-style:italic">local</span> <span style="color:#7F0000;text-style:italic">gradient</span> <span style="color:#7F0000;text-style:italic">shading</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">sectors</span>
				<span style="color:#7F0000;text-style:italic">&#39;c.setSectorStyle(CDPieChartMBS.kLocalGradientShading)</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Use</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">side</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">layout</span> <span style="color:#7F0000;text-style:italic">method,</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">labels</span> <span style="color:#7F0000;text-style:italic">positioned</span> <span style="color:#7F0000;text-style:italic">16</span> <span style="color:#7F0000;text-style:italic">pixels</span> <span style="color:#7F0000;text-style:italic">from</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">pie</span> <span style="color:#7F0000;text-style:italic">bounding</span> <span style="color:#7F0000;text-style:italic">box</span>
				c.setLabelLayout(CDPieChartMBS.kSideLayout, <span style="color:#326598">16</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Show</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">sector</span> <span style="color:#7F0000;text-style:italic">number</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">sector</span> <span style="color:#7F0000;text-style:italic">label</span>
				c.setLabelFormat(<span style="color:#6500FE">&quot;{={sector}+1}&quot;</span>)
				
				c.setJoinLine <span style="color:#326598">0</span>,f
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">sector</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">style</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">Arial</span> <span style="color:#7F0000;text-style:italic">Bold</span> <span style="color:#7F0000;text-style:italic">10pt,</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">dark</span> <span style="color:#7F0000;text-style:italic">grey</span> <span style="color:#7F0000;text-style:italic">(444444)</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">border</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> t <span style="color:#0000FF;font-weight: bold">as</span> CDTextBoxMBS=c.setLabelStyle(<span style="color:#6500FE">&quot;arialbd.ttf&quot;</span>, f*<span style="color:#326598">10</span>)
				t.setBackground(CDPieChartMBS.kTransparent, <span style="color:#326598">&amp;h444444</span>)
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">legend</span> <span style="color:#7F0000;text-style:italic">box,</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">center</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">left</span> <span style="color:#7F0000;text-style:italic">side</span> <span style="color:#7F0000;text-style:italic">anchored</span> <span style="color:#7F0000;text-style:italic">at</span> <span style="color:#7F0000;text-style:italic">(330,</span> <span style="color:#7F0000;text-style:italic">175),</span> <span style="color:#7F0000;text-style:italic">and</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">10</span> <span style="color:#7F0000;text-style:italic">pts</span> <span style="color:#7F0000;text-style:italic">Arial</span> <span style="color:#7F0000;text-style:italic">Bold</span> <span style="color:#7F0000;text-style:italic">Italic</span> <span style="color:#7F0000;text-style:italic">font</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> b <span style="color:#0000FF;font-weight: bold">as</span> CDLegendBoxMBS = c.addLegend(f*width/<span style="color:#326598">2</span>, f*height/<span style="color:#326598">2</span>, <span style="color:#0000FF;font-weight: bold">true</span>, <span style="color:#6500FE">&quot;arialbi.ttf&quot;</span>, f*<span style="color:#326598">10</span>)
				b.setAlignment(CDPieChartMBS.kLeft)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">legend</span> <span style="color:#7F0000;text-style:italic">box</span> <span style="color:#7F0000;text-style:italic">border</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">dark</span> <span style="color:#7F0000;text-style:italic">grey</span> <span style="color:#7F0000;text-style:italic">(444444),</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">rounded</span> <span style="color:#7F0000;text-style:italic">conerns</span>
				b.setBackground(CDPieChartMBS.kTransparent, <span style="color:#326598">&amp;h444444</span>)
				b.setRoundedCorners(f*<span style="color:#326598">10</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">legend</span> <span style="color:#7F0000;text-style:italic">box</span> <span style="color:#7F0000;text-style:italic">margin</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">16</span> <span style="color:#7F0000;text-style:italic">pixels,</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">extra</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">spacing</span> <span style="color:#7F0000;text-style:italic">between</span> <span style="color:#7F0000;text-style:italic">the</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">legend</span> <span style="color:#7F0000;text-style:italic">entries</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">5</span> <span style="color:#7F0000;text-style:italic">pixels</span>
				b.setMargin(f*<span style="color:#326598">16</span>)
				b.setKeySpacing(<span style="color:#326598">0</span>, <span style="color:#326598">5</span>*f)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">legend</span> <span style="color:#7F0000;text-style:italic">box</span> <span style="color:#7F0000;text-style:italic">icon</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">no</span> <span style="color:#7F0000;text-style:italic">border</span> <span style="color:#7F0000;text-style:italic">(border</span> <span style="color:#7F0000;text-style:italic">color</span> <span style="color:#7F0000;text-style:italic">same</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">fill</span> <span style="color:#7F0000;text-style:italic">color)</span>
				b.setKeyBorder(CDPieChartMBS.kSameAsMainColor)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">legend</span> <span style="color:#7F0000;text-style:italic">text</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">show</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">sector</span> <span style="color:#7F0000;text-style:italic">number,</span> <span style="color:#7F0000;text-style:italic">followed</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">120</span> <span style="color:#7F0000;text-style:italic">pixels</span> <span style="color:#7F0000;text-style:italic">wide</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">block</span> <span style="color:#7F0000;text-style:italic">showing</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">sector</span> <span style="color:#7F0000;text-style:italic">label,</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">40</span> <span style="color:#7F0000;text-style:italic">pixels</span> <span style="color:#7F0000;text-style:italic">wide</span> <span style="color:#7F0000;text-style:italic">block</span> <span style="color:#7F0000;text-style:italic">showing</span> <span style="color:#7F0000;text-style:italic">the</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">percentage</span>
				b.setText(<span style="color:#6500FE">&quot;&lt;*block,valign=top*&gt;{={sector}+1}.&lt;*advanceTo=&quot;</span>+_
						str(CDBaseChartMBS.ScaleFactor*f*<span style="color:#326598">22</span>)+<span style="color:#6500FE">&quot;*&gt;&lt;*block,width=&quot;</span>+_
						str(CDBaseChartMBS.ScaleFactor*f*<span style="color:#326598">120</span>)+<span style="color:#6500FE">&quot;*&gt;{label}&lt;*/*&gt;&lt;*block,width=&quot;</span>+str(CDBaseChartMBS.ScaleFactor*f*<span style="color:#326598">40</span>)+<span style="color:#6500FE">&quot;,halign=right*&gt;{percent}&lt;*/*&gt;%&quot;</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Output</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span>
				
				<span style="color:#0000FF;font-weight: bold">return</span> c
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control StaticText1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance StaticText1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Timer1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Timer</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Timer1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Timer</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				a1.UpdateMouseCursor
				a2.UpdateMouseCursor
				a3.UpdateMouseCursor
				a4.UpdateMouseCursor
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control StaticText2 <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance StaticText2 <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#0000FF;font-weight: bold">Dim</span> x0 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#326598">70</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> x1 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#326598">50</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> x2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#326598">30</span>
			
			Data0.Append(x0)
			Data1.Append(x1)
			Data2.Append(x2)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Create</span> <span style="color:#7F0000;text-style:italic">randomized</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">points</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">demo</span>
			<span style="color:#0000FF;font-weight: bold">For</span> I <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">To</span> <span style="color:#326598">100</span>
				
				x0 = x0 + Rnd() * <span style="color:#006532">5.0</span> - <span style="color:#006532">2.5</span>
				x1 = x1 + Rnd() * <span style="color:#006532">5.0</span> - <span style="color:#006532">2.5</span>
				x2 = x2 + Rnd() * <span style="color:#006532">5.0</span> - <span style="color:#006532">2.5</span>
				
				Data0.Append(x0)
				Data1.Append(x1)
				Data2.Append(x2)
				
			<span style="color:#0000FF;font-weight: bold">Next</span>
			
			<span style="color:#0000FF;font-weight: bold">redim</span> Data0clicked(UBound(data0))
			<span style="color:#0000FF;font-weight: bold">redim</span> Data1clicked(UBound(data1))
			<span style="color:#0000FF;font-weight: bold">redim</span> Data2clicked(UBound(data2))
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> PrintA1() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			a1.Print
			<span style="color:#0000FF;font-weight: bold">Return</span> (<span style="color:#0000FF;font-weight: bold">True</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> PrintA2() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			a2.Print
			<span style="color:#0000FF;font-weight: bold">Return</span> (<span style="color:#0000FF;font-weight: bold">True</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> PrintA3() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			a3.Print
			<span style="color:#0000FF;font-weight: bold">Return</span> (<span style="color:#0000FF;font-weight: bold">True</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> PrintA4() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			a4.Print
			<span style="color:#0000FF;font-weight: bold">Return</span> (<span style="color:#0000FF;font-weight: bold">True</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> FilterValues(data() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>, clicked() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>, value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>()
			<span style="color:#0000FF;font-weight: bold">dim</span> r(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> u <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = UBound(data)
			
			<span style="color:#0000FF;font-weight: bold">redim</span> r(u)
			
			<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> u
				<span style="color:#0000FF;font-weight: bold">if</span> clicked(i) = value <span style="color:#0000FF;font-weight: bold">then</span>
					r(i) = data(i)
				<span style="color:#0000FF;font-weight: bold">else</span>
					r(i) = CDBaseChartMBS.kNoValue
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">next</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> r
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Protected</span> Data0() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Data0clicked() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Protected</span> Data1() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Data1clicked() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Protected</span> Data2() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Data2clicked() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> HighLightSector <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ChartDirectorControl <span style="color:#0000FF;font-weight: bold">Inherits</span> Canvas</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kModeDefault = <span style="color:#326598">0</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kModeMove = <span style="color:#326598">1</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kModeZoomIn = <span style="color:#326598">2</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kModeZoomOut = <span style="color:#326598">3</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> ItemClicked(XLabel <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, DataSet <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, DataSetName <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, Value <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Title <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, Sector <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Label <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> ItemDoubleClicked(XLabel <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, DataSet <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, DataSetName <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, Value <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Title <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, Sector <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Label <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> Open()
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> Render(ViewPort <span style="color:#0000FF;font-weight: bold">As</span> CDViewPortManagerMBS, Factor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Width <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Height <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> DoubleClick(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			SendClickEvent <span style="color:#0000FF;font-weight: bold">true</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> MouseDown(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			isMouseDown = <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">me</span>.dragPicture = <span style="color:#0000FF;font-weight: bold">nil</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (AllowZoom = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">And</span> (Keyboard.AsyncOptionKey = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span>
				Mode = kModeZoomIn
				
				StartX = X
				StartY = Y
				StartX2 = X
				StartY2 = Y
				
			<span style="color:#0000FF;font-weight: bold">ElseIf</span> (AllowZoom = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">And</span> (Keyboard.AsyncShiftKey = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">Out</span>
				Mode = kModeZoomOut
				
				StartX = X
				StartY = Y
				StartX2 = X
				StartY2 = Y
				
			<span style="color:#0000FF;font-weight: bold">Else</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> HotSpotID <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">over</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">hotspot;</span> <span style="color:#7F0000;text-style:italic">Nil</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">prevents</span> <span style="color:#7F0000;text-style:italic">spurious</span> <span style="color:#7F0000;text-style:italic">NilObjectExceptions</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (ImageMapHandler &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span> HotSpotID = ImageMapHandler.getHotSpot(X, Y)
				
				<span style="color:#0000FF;font-weight: bold">If</span> (HotSpotID &gt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Click</span>
					Mode = kModeDefault
					
					SendClickEvent <span style="color:#0000FF;font-weight: bold">false</span>
					
				<span style="color:#0000FF;font-weight: bold">ElseIf</span> (AllowMove = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Move</span>
					Mode = kModeMove
					
					MouseCursor = System.Cursors.HandClosed
					StartX = X
					StartY = Y
					ViewPort.startDrag  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Call</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">initiate</span> <span style="color:#7F0000;text-style:italic">drag</span> <span style="color:#7F0000;text-style:italic">within</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ViewPort</span>
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			
			<span style="color:#0000FF;font-weight: bold">Return</span> (<span style="color:#0000FF;font-weight: bold">True</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseDrag(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">If</span> (Mode = kModeMove) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">been</span> <span style="color:#7F0000;text-style:italic">dragged/repositioned</span> <span style="color:#7F0000;text-style:italic">then</span> <span style="color:#7F0000;text-style:italic">complete</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ViewPort</span> <span style="color:#7F0000;text-style:italic">drag</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">refresh</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">image</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.dragTo(CDBaseChartMBS.kDirectionHorizontalVertical, StartX - X, Y - StartY) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span> Redraw
				
				<span style="color:#0000FF;font-weight: bold">me</span>.dragPicture = <span style="color:#0000FF;font-weight: bold">nil</span>
				
			<span style="color:#0000FF;font-weight: bold">ElseIf</span> (Mode = kModeZoomIn) <span style="color:#0000FF;font-weight: bold">Or</span> (Mode = kModeZoomOut) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Calculate</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">coordinates</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">scaling/drawing</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">rectangle</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> L, T, W, H <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
				
				StartX2 = X
				StartY2 = Y
				
				L = Min(StartX, StartX2)
				T = Min(StartY, StartY2)
				W = StartX2 - StartX
				H = StartY2 - StartY
				
				<span style="color:#0000FF;font-weight: bold">If</span> (W &lt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span> W = -W
				<span style="color:#0000FF;font-weight: bold">If</span> (H &lt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span> H = -H
				
				
				
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Composite</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">rectangle</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> p <span style="color:#0000FF;font-weight: bold">as</span> Picture = window.BitmapForCaching(<span style="color:#0000FF;font-weight: bold">me</span>.Width, <span style="color:#0000FF;font-weight: bold">me</span>.Height)
				
				p.Graphics.DrawPicture(LastPicture, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, <span style="color:#0000FF;font-weight: bold">me</span>.Width, <span style="color:#0000FF;font-weight: bold">me</span>.Height, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, LastPicture.Width, LastPicture.Height)
				p.Graphics.DrawPicture(RectanglePicture, L, T, W, H, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, RectanglePicture.Width, RectanglePicture.Height)
				
				<span style="color:#0000FF;font-weight: bold">me</span>.dragPicture = p
				
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#0000FF;font-weight: bold">me</span>.dragPicture = <span style="color:#0000FF;font-weight: bold">nil</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseExit()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finalize</span> <span style="color:#7F0000;text-style:italic">redraw</span>
			<span style="color:#0000FF;font-weight: bold">me</span>.dragPicture = <span style="color:#0000FF;font-weight: bold">nil</span>
			CleanUp
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseMove(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">If</span> (AllowZoom = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">And</span> (Keyboard.AsyncOptionKey = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span>
				MouseCursor = System.Cursors.MagnifyLarger
				CleanUp  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finalize</span> <span style="color:#7F0000;text-style:italic">redraw</span>
				
			<span style="color:#0000FF;font-weight: bold">ElseIf</span> (AllowZoom = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">And</span> (Keyboard.AsyncShiftKey = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">Out</span>
				MouseCursor = System.Cursors.MagnifySmaller
				CleanUp  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finalize</span> <span style="color:#7F0000;text-style:italic">redraw</span>
				
			<span style="color:#0000FF;font-weight: bold">Else</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> HotSpotID <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">over</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">hotspot;</span> <span style="color:#7F0000;text-style:italic">Nil</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">prevents</span> <span style="color:#7F0000;text-style:italic">spurious</span> <span style="color:#7F0000;text-style:italic">NilObjectExceptions</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (ImageMapHandler &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					HotSpotID = ImageMapHandler.getHotSpot(X, Y)
					System.DebugLog <span style="color:#6500FE">&quot;HotSpotID:</span> <span style="color:#6500FE">&quot;</span>+str(HotSpotID)+<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">at</span> <span style="color:#6500FE">&quot;</span> + str(x)+<span style="color:#6500FE">&quot;/&quot;</span>+str(y)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#0000FF;font-weight: bold">If</span> (HotSpotID &gt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					MouseCursor = System.Cursors.StandardPointer
					
					DrawInfoX = X
					DrawInfoY = Y
					<span style="color:#0000FF;font-weight: bold">me</span>.Invalidate
					
				<span style="color:#0000FF;font-weight: bold">ElseIf</span> (AllowMove = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					MouseCursor = System.Cursors.HandOpen
					CleanUp  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finalize</span> <span style="color:#7F0000;text-style:italic">redraw</span>
					
				<span style="color:#0000FF;font-weight: bold">Else</span>
					
					MouseCursor = System.Cursors.StandardPointer
					CleanUp  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finalize</span> <span style="color:#7F0000;text-style:italic">redraw</span>
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseUp(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			isMouseDown = <span style="color:#0000FF;font-weight: bold">false</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (Mode = kModeMove) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Move</span>
				MouseCursor=System.Cursors.HandOpen
				
			<span style="color:#0000FF;font-weight: bold">ElseIf</span> (Mode = kModeZoomIn) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">(On</span> <span style="color:#7F0000;text-style:italic">Point)</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (Abs(X - StartX) &lt; <span style="color:#326598">3</span>) <span style="color:#0000FF;font-weight: bold">And</span> (Abs(Y - StartY) &lt; <span style="color:#326598">3</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">(On</span> <span style="color:#7F0000;text-style:italic">Point)</span>
					<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.canZoomIn(CDBaseChartMBS.kDirectionHorizontalVertical) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
						<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.zoomAt(CDBaseChartMBS.kDirectionHorizontalVertical, X, Y, ZoomInRatio) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span> Redraw
					<span style="color:#0000FF;font-weight: bold">Else</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Cannot</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">in...</span>
						Redraw
						Beep
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
					
				<span style="color:#0000FF;font-weight: bold">Else</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">(On</span> <span style="color:#7F0000;text-style:italic">Rectangle)</span>
					<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.canZoomIn(CDBaseChartMBS.kDirectionHorizontalVertical) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
						<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.zoomTo(CDBaseChartMBS.kDirectionHorizontalVertical, X, Y, StartX, StartY) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span> Redraw
					<span style="color:#0000FF;font-weight: bold">Else</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Cannot</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">in...</span>
						Redraw
						Beep
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">ElseIf</span> (Mode = kModeZoomOut) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">Out</span> <span style="color:#7F0000;text-style:italic">(On</span> <span style="color:#7F0000;text-style:italic">Point)</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.canZoomOut(CDBaseChartMBS.kDirectionHorizontalVertical) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.zoomAt(CDBaseChartMBS.kDirectionHorizontalVertical, X, Y, ZoomOutRatio) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span> Redraw
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Cannot</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">out...</span>
					Redraw
					Beep
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Initialize</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ViewPort</span> <span style="color:#7F0000;text-style:italic">manager</span> <span style="color:#7F0000;text-style:italic">class</span>
			ViewPort = <span style="color:#0000FF;font-weight: bold">New</span> CDViewPortManagerMBS
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">ViewPort</span> <span style="color:#7F0000;text-style:italic">coordinant</span> <span style="color:#7F0000;text-style:italic">constraints</span>
			ViewPort.setViewPortHeight(<span style="color:#006532">1.0</span>)
			ViewPort.setViewPortTop(<span style="color:#006532">0.0</span>)
			ViewPort.setViewPortWidth(<span style="color:#006532">1.0</span>)
			ViewPort.setViewPortLeft(<span style="color:#006532">0.0</span>)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">Out</span> <span style="color:#7F0000;text-style:italic">constraints</span> <span style="color:#7F0000;text-style:italic">(if</span> <span style="color:#7F0000;text-style:italic">desired;</span> <span style="color:#7F0000;text-style:italic">otherwise</span> <span style="color:#7F0000;text-style:italic">allow</span> <span style="color:#7F0000;text-style:italic">infinite</span> <span style="color:#7F0000;text-style:italic">zoom)</span>
			<span style="color:#7F0000;text-style:italic">&#39;ViewPort.setZoomInWidthLimit(0.01)</span>
			<span style="color:#7F0000;text-style:italic">&#39;ViewPort.setZoomInHeightLimit(0.01)</span>
			<span style="color:#7F0000;text-style:italic">&#39;ViewPort.setZoomOutWidthLimit(1.0)</span>
			<span style="color:#7F0000;text-style:italic">&#39;ViewPort.setZoomOutHeightLimit(1.0)</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Initialize</span> <span style="color:#7F0000;text-style:italic">scalable</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">rendering</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">rectangle</span>
			RectanglePicture = <span style="color:#0000FF;font-weight: bold">New</span> Picture(<span style="color:#326598">32</span>, <span style="color:#326598">32</span>, <span style="color:#326598">32</span>)
			RectanglePicture.Graphics.ForeColor = &amp;c<span style="color:#FF0000">FF</span><span style="color:#00FF00">00</span><span style="color:#0000FF">00</span>
			RectanglePicture.Graphics.FillRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, <span style="color:#326598">32</span>, <span style="color:#326598">32</span>)
			RectanglePicture.Mask.Graphics.ForeColor = &amp;c<span style="color:#FF0000">CC</span><span style="color:#00FF00">CC</span><span style="color:#0000FF">CC</span>
			RectanglePicture.Mask.Graphics.FillRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, <span style="color:#326598">32</span>, <span style="color:#326598">32</span>)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">initial</span> <span style="color:#7F0000;text-style:italic">cursor</span> <span style="color:#7F0000;text-style:italic">style</span>
			MouseCursor = System.Cursors.HandOpen
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Call</span> <span style="color:#7F0000;text-style:italic">overridden</span> <span style="color:#7F0000;text-style:italic">superclass</span> <span style="color:#7F0000;text-style:italic">method</span>
			Open
			
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">fix</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">properties</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">wrong</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">IDE</span>
			
			<span style="color:#0000FF;font-weight: bold">me</span>.DoubleBuffer = <span style="color:#0000FF;font-weight: bold">false</span>
			<span style="color:#0000FF;font-weight: bold">me</span>.EraseBackground = <span style="color:#0000FF;font-weight: bold">false</span>
			
			<span style="color:#0000FF">#if</span> RBVersion &gt;= <span style="color:#006532">2013.0</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">me</span>.Transparent = <span style="color:#0000FF;font-weight: bold">False</span>
			<span style="color:#0000FF">#endif</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Paint(g <span style="color:#0000FF;font-weight: bold">As</span> Graphics, areas() <span style="color:#0000FF;font-weight: bold">As</span> REALbasic.Rect)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Handle</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">composited</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">region</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> dragPicture &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				g.DrawPicture dragPicture, <span style="color:#326598">0</span>,<span style="color:#326598">0</span>
			<span style="color:#0000FF;font-weight: bold">elseif</span> DrawInfoX &gt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
				DrawItemInfo(g, DrawInfoX, DrawInfoY)
			<span style="color:#0000FF;font-weight: bold">else</span>
				Draw(G)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> CleanUp()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finalize</span> <span style="color:#7F0000;text-style:italic">redraw</span>
			
			DrawInfoX = -<span style="color:#326598">1</span>
			DrawInfoY = -<span style="color:#326598">1</span>
			
			<span style="color:#0000FF;font-weight: bold">self</span>.Invalidate
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> CurrentPicture() <span style="color:#0000FF;font-weight: bold">As</span> Picture
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Return</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">currently</span> <span style="color:#7F0000;text-style:italic">displayed</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> (LastPicture)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> Draw(G <span style="color:#0000FF;font-weight: bold">As</span> Graphics)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Prepare</span> <span style="color:#7F0000;text-style:italic">ViewPort</span> <span style="color:#7F0000;text-style:italic">coordinates</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">rendering</span>
			ViewPort.validateViewPort
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Trigger</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">rendering</span> <span style="color:#7F0000;text-style:italic">(actual</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">configuration</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">plotting)</span>
			
			Current = Render(ViewPort, <span style="color:#326598">1</span>, G.Width, G.Height)
			
			<span style="color:#0000FF;font-weight: bold">If</span> (Current = <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">there</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">no</span> <span style="color:#7F0000;text-style:italic">valid</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">object</span> <span style="color:#7F0000;text-style:italic">returned,</span> <span style="color:#7F0000;text-style:italic">clear</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">region</span>
				G.ClearRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, G.Width, G.Height)
				
				
			<span style="color:#0000FF;font-weight: bold">Else</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> RenderWithTransparency <span style="color:#0000FF;font-weight: bold">then</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">in-memory</span> <span style="color:#7F0000;text-style:italic">version</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">PNG</span> <span style="color:#7F0000;text-style:italic">format</span> <span style="color:#7F0000;text-style:italic">(supports</span> <span style="color:#7F0000;text-style:italic">transparency)</span>
					<span style="color:#0000FF;font-weight: bold">Dim</span> S <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
					S = Current.makeChart(CDBaseChartMBS.kPNG)
					
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Error</span> <span style="color:#7F0000;text-style:italic">check</span>
					<span style="color:#0000FF;font-weight: bold">If</span> (S = <span style="color:#6500FE">&quot;&quot;</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
						G.ClearRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, G.Width, G.Height)
						<span style="color:#0000FF;font-weight: bold">Return</span>
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
					
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Generate</span> <span style="color:#7F0000;text-style:italic">RB</span> <span style="color:#7F0000;text-style:italic">Picture</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">data</span>
					LastPicture = PNGStringToPictureMBS(S, <span style="color:#326598">0</span>)
				<span style="color:#0000FF;font-weight: bold">else</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">based</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">returned</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">object</span>
					LastPicture = Current.makeChartPicture
					
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Support</span> <span style="color:#7F0000;text-style:italic">overlay</span> <span style="color:#7F0000;text-style:italic">picture</span> <span style="color:#7F0000;text-style:italic">drawing</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (OverlayPicture &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> ow <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = OverlayPicture.Width  * <span style="color:#326598">2</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> oh <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = OverlayPicture.Height * <span style="color:#326598">2</span>
					LastPicture.Graphics.DrawPicture(OverlayPicture, (LastPicture.Width - ow) / <span style="color:#326598">2</span>, (LastPicture.Height - oh) / <span style="color:#326598">2</span>, ow, oh, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, OverlayPicture.Width, OverlayPicture.Height)
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Support</span> <span style="color:#7F0000;text-style:italic">control</span> <span style="color:#7F0000;text-style:italic">border</span> <span style="color:#7F0000;text-style:italic">drawing</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (Border = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					LastPicture.Graphics.PenHeight = <span style="color:#326598">1</span>
					LastPicture.Graphics.PenWidth = <span style="color:#326598">1</span>
					LastPicture.Graphics.ForeColor = &amp;c<span style="color:#FF0000">00</span><span style="color:#00FF00">00</span><span style="color:#0000FF">00</span>
					LastPicture.Graphics.DrawRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, LastPicture.Width, LastPicture.Height)
					
					LastPicture.Mask.Graphics.PenHeight = <span style="color:#326598">1</span>
					LastPicture.Mask.Graphics.PenWidth = <span style="color:#326598">1</span>
					LastPicture.Mask.Graphics.ForeColor = &amp;c<span style="color:#FF0000">00</span><span style="color:#00FF00">00</span><span style="color:#0000FF">00</span>
					LastPicture.Mask.Graphics.DrawRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, LastPicture.Width, LastPicture.Height)
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> CleanGraphicsBeforeDrawing <span style="color:#0000FF;font-weight: bold">then</span>
					g.ClearRect <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, g.Width, g.Height
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">composited</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> LastPicture&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
					G.DrawPicture(LastPicture, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, g.Width, g.Height, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, LastPicture.Width, LastPicture.Height)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">ViewPort</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">coordinants</span>
				ViewPort.setChartMetrics(Current.getChartMetrics)
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Process</span> <span style="color:#7F0000;text-style:italic">ImageMap</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">support</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">point</span> <span style="color:#7F0000;text-style:italic">rollovers,</span> <span style="color:#7F0000;text-style:italic">etc.</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> ImageMapString <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
				
				ImageMapString = Current.getHTMLImageMap(<span style="color:#6500FE">&quot;myurl&quot;</span> )
				ImageMapHandler = <span style="color:#0000FF;font-weight: bold">New</span> CDImageMapHandlerMBS(ImageMapString)
				
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> DrawItemInfo(destGraphics <span style="color:#0000FF;font-weight: bold">as</span> graphics, X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">Dim</span> Index <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Key, KeyValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> XLabel <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> XValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> DataSet <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> DataSetName <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Value <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Title <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Sector <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Label <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Error</span> <span style="color:#7F0000;text-style:italic">check</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (ImageMapHandler = <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Do</span> <span style="color:#7F0000;text-style:italic">key/value</span> <span style="color:#7F0000;text-style:italic">pair</span> <span style="color:#7F0000;text-style:italic">priming</span> <span style="color:#7F0000;text-style:italic">calls</span>
			Index = <span style="color:#326598">0</span>
			Key = ImageMapHandler.getKey(Index)
			KeyValue = ImageMapHandler.getValue(Index)
			
			
			<span style="color:#0000FF;font-weight: bold">Do</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">NOTE:</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">complete</span> <span style="color:#7F0000;text-style:italic">supported</span> <span style="color:#7F0000;text-style:italic">list</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">parameters;</span> <span style="color:#7F0000;text-style:italic">Refer</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">ChartDirector</span> <span style="color:#7F0000;text-style:italic">documentation</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">&#39;Parameter</span> <span style="color:#7F0000;text-style:italic">Substitution</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">Formatting&#39;</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">additional</span> <span style="color:#7F0000;text-style:italic">parameters</span>
				<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> Key
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;xlabel&quot;</span>
					XLabel = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;x&quot;</span>
					XValue = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;dataset&quot;</span>
					DataSet = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;datasetname&quot;</span>
					DataSetName = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;value&quot;</span>
					Value = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;title&quot;</span>
					Title = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;sector&quot;</span>
					Sector = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;label&quot;</span>
					Label = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
				
				Index = Index + <span style="color:#326598">1</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">next</span> <span style="color:#7F0000;text-style:italic">key/value</span> <span style="color:#7F0000;text-style:italic">pair</span>
				Key = ImageMapHandler.getKey(Index)
				KeyValue = ImageMapHandler.getValue(Index)
				
			<span style="color:#0000FF;font-weight: bold">Loop</span> <span style="color:#0000FF;font-weight: bold">Until</span> Key.Len = <span style="color:#326598">0</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Compose</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">graphic</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (Label &lt;&gt; <span style="color:#6500FE">&quot;&quot;</span>) <span style="color:#0000FF;font-weight: bold">Then</span> Value = Label + <span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span> + Value
			
			<span style="color:#0000FF;font-weight: bold">const</span> f = <span style="color:#326598">2</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">draw</span> <span style="color:#7F0000;text-style:italic">2x</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> B <span style="color:#0000FF;font-weight: bold">As</span> Picture = <span style="color:#0000FF;font-weight: bold">new</span> Picture(LastPicture.Width,LastPicture.Height, <span style="color:#326598">32</span>)
			<span style="color:#0000FF;font-weight: bold">Dim</span> BG <span style="color:#0000FF;font-weight: bold">As</span> Graphics = B.Graphics
			
			bg.TextSize = <span style="color:#326598">12</span> * f
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> W <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">6</span>*f + BG.StringWidth(Value)
			<span style="color:#0000FF;font-weight: bold">Dim</span> H <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">20</span>*f
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">space</span> <span style="color:#7F0000;text-style:italic">between</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">cursor</span> <span style="color:#7F0000;text-style:italic">position</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">initial</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">position</span>
			X = X*f + <span style="color:#326598">10</span>*f
			Y = Y*f + <span style="color:#326598">10</span>*f
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">too</span> <span style="color:#7F0000;text-style:italic">close</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">right,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">move</span> <span style="color:#7F0000;text-style:italic">our</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">position</span> <span style="color:#7F0000;text-style:italic">left</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (X + W &gt; <span style="color:#0000FF;font-weight: bold">me</span>.Width*F) <span style="color:#0000FF;font-weight: bold">Then</span> X = X - <span style="color:#326598">20</span>*F - W
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">too</span> <span style="color:#7F0000;text-style:italic">close</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">bottom,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">move</span> <span style="color:#7F0000;text-style:italic">our</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">position</span> <span style="color:#7F0000;text-style:italic">up</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (Y + H &gt; <span style="color:#0000FF;font-weight: bold">me</span>.Height*F) <span style="color:#0000FF;font-weight: bold">Then</span> Y = Y - <span style="color:#326598">20</span>*F - H
			
			System.DebugLog <span style="color:#6500FE">&quot;rect:</span> <span style="color:#6500FE">&quot;</span>+str(X)+<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&quot;</span>+str(y)+<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&quot;</span>+str(w)+<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&quot;</span>+str(h)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">composited</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span>
			B.     Graphics.DrawPicture(LastPicture,      <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, bg.Width, bg.Height, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, LastPicture.Width, LastPicture.Height)
			B.Mask.Graphics.DrawPicture(LastPicture.Mask, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, bg.Width, bg.Height, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, LastPicture.Width, LastPicture.Height)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">graphic</span>
			BG.ForeColor = &amp;c<span style="color:#FF0000">CC</span><span style="color:#00FF00">CC</span><span style="color:#0000FF">00</span>
			BG.FillRect(X, Y, W, H)
			BG.ForeColor = &amp;c<span style="color:#FF0000">00</span><span style="color:#00FF00">00</span><span style="color:#0000FF">00</span>
			BG.DrawString(Value, X + <span style="color:#326598">3</span>*f, Y + <span style="color:#326598">15</span>*f)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">composited</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span>
			destGraphics.DrawPicture(B, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, destGraphics.Width, destGraphics.Height, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, LastPicture.Width, LastPicture.Height)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Print()
			<span style="color:#0000FF;font-weight: bold">Dim</span> PS <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> PrinterSetup
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">landscape</span> <span style="color:#7F0000;text-style:italic">orientation</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">appropriate</span>
			PS.Landscape = Width &gt; Height
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Initialize</span> <span style="color:#7F0000;text-style:italic">graphics</span> <span style="color:#7F0000;text-style:italic">region</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">printing</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> G <span style="color:#0000FF;font-weight: bold">As</span> Graphics = OpenPrinterDialog(PS)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Bail</span> <span style="color:#7F0000;text-style:italic">out...</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (G = <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Render</span> <span style="color:#7F0000;text-style:italic">printed</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">(use</span> <span style="color:#7F0000;text-style:italic">page</span> <span style="color:#7F0000;text-style:italic">size)</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">NOTE:</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">uses</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">factor</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">4x</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">resolution</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">printed</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">(approximately</span> <span style="color:#7F0000;text-style:italic">300</span> <span style="color:#7F0000;text-style:italic">dpi)</span>
			<span style="color:#7F0000;text-style:italic">&#39;Dim</span> <span style="color:#7F0000;text-style:italic">P</span> <span style="color:#7F0000;text-style:italic">As</span> <span style="color:#7F0000;text-style:italic">Picture</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">RenderPicture(4,</span> <span style="color:#7F0000;text-style:italic">G.Width,</span> <span style="color:#7F0000;text-style:italic">G.Height)</span>
			<span style="color:#7F0000;text-style:italic">&#39;G.DrawPicture(P,</span> <span style="color:#7F0000;text-style:italic">0,</span> <span style="color:#7F0000;text-style:italic">0,</span> <span style="color:#7F0000;text-style:italic">G.Width,</span> <span style="color:#7F0000;text-style:italic">G.Height,</span> <span style="color:#7F0000;text-style:italic">0,</span> <span style="color:#7F0000;text-style:italic">0,</span> <span style="color:#7F0000;text-style:italic">G.Width</span> <span style="color:#7F0000;text-style:italic">*</span> <span style="color:#7F0000;text-style:italic">4,</span> <span style="color:#7F0000;text-style:italic">G.Height</span> <span style="color:#7F0000;text-style:italic">*</span> <span style="color:#7F0000;text-style:italic">4)</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Render</span> <span style="color:#7F0000;text-style:italic">printed</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">(use</span> <span style="color:#7F0000;text-style:italic">control</span> <span style="color:#7F0000;text-style:italic">size)</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">NOTE:</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">uses</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">factor</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">4x</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">resolution</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">printed</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">(approximately</span> <span style="color:#7F0000;text-style:italic">300</span> <span style="color:#7F0000;text-style:italic">dpi)</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> P <span style="color:#0000FF;font-weight: bold">As</span> Picture = RenderPicture(<span style="color:#326598">2</span>, Width, Height)
			G.DrawPicture(P, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, Width, Height, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, p.Width, p.Height)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Redraw()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Method</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">directly</span> <span style="color:#7F0000;text-style:italic">trigger</span> <span style="color:#7F0000;text-style:italic">internal</span> <span style="color:#7F0000;text-style:italic">redraw</span>
			
			<span style="color:#0000FF;font-weight: bold">me</span>.Invalidate
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> RenderPicture(Factor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Width <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Height <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> Picture
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Prepare</span> <span style="color:#7F0000;text-style:italic">ViewPort</span> <span style="color:#7F0000;text-style:italic">coordinates</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">rendering</span>
			ViewPort.validateViewPort
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Handle</span> <span style="color:#7F0000;text-style:italic">scaled</span> <span style="color:#7F0000;text-style:italic">redraw</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">printing</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> C <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS = Render(ViewPort, Factor, Width, Height)
			<span style="color:#7F0000;text-style:italic">&#39;If</span> <span style="color:#7F0000;text-style:italic">(C</span> <span style="color:#7F0000;text-style:italic">&lt;&gt;</span> <span style="color:#7F0000;text-style:italic">Nil)</span> <span style="color:#7F0000;text-style:italic">Then</span> <span style="color:#7F0000;text-style:italic">Return</span> <span style="color:#7F0000;text-style:italic">(C.makeChartPicture)</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Error</span> <span style="color:#7F0000;text-style:italic">check</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (C = <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span> <span style="color:#0000FF;font-weight: bold">Return</span> (<span style="color:#0000FF;font-weight: bold">Nil</span>)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">in-memory</span> <span style="color:#7F0000;text-style:italic">version</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">PNG</span> <span style="color:#7F0000;text-style:italic">format</span> <span style="color:#7F0000;text-style:italic">(supports</span> <span style="color:#7F0000;text-style:italic">transparency)</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> S <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			S = C.makeChart(C.kPNG)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Error</span> <span style="color:#7F0000;text-style:italic">check</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (S = <span style="color:#6500FE">&quot;&quot;</span>) <span style="color:#0000FF;font-weight: bold">Then</span> <span style="color:#0000FF;font-weight: bold">Return</span> (<span style="color:#0000FF;font-weight: bold">Nil</span>)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Generate</span> <span style="color:#7F0000;text-style:italic">RB</span> <span style="color:#7F0000;text-style:italic">Picture</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">data</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> P <span style="color:#0000FF;font-weight: bold">As</span> Picture
			P = PNGStringToPictureMBS(S, <span style="color:#326598">0</span>)
			
			
			<span style="color:#0000FF;font-weight: bold">Return</span> (P)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> SendClickEvent(isDoubleClick <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)
			<span style="color:#0000FF;font-weight: bold">Dim</span> Index <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Key, KeyValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> XLabel <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> XValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> DataSet <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> DataSetName <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Value <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Title <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Sector <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Label <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Error</span> <span style="color:#7F0000;text-style:italic">check</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (ImageMapHandler = <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Do</span> <span style="color:#7F0000;text-style:italic">key/value</span> <span style="color:#7F0000;text-style:italic">pair</span> <span style="color:#7F0000;text-style:italic">priming</span> <span style="color:#7F0000;text-style:italic">calls</span>
			Index = <span style="color:#326598">0</span>
			Key = ImageMapHandler.getKey(Index)
			KeyValue = ImageMapHandler.getValue(Index)
			
			
			<span style="color:#0000FF;font-weight: bold">Do</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">NOTE:</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">complete</span> <span style="color:#7F0000;text-style:italic">supported</span> <span style="color:#7F0000;text-style:italic">list</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">parameters;</span> <span style="color:#7F0000;text-style:italic">Refer</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">ChartDirector</span> <span style="color:#7F0000;text-style:italic">documentation</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">&#39;Parameter</span> <span style="color:#7F0000;text-style:italic">Substitution</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">Formatting&#39;</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">additional</span> <span style="color:#7F0000;text-style:italic">parameters</span>
				<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> Key
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;xlabel&quot;</span>
					XLabel = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;x&quot;</span>
					XValue = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;dataset&quot;</span>
					DataSet = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;datasetname&quot;</span>
					DataSetName = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;value&quot;</span>
					Value = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;title&quot;</span>
					Title = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;sector&quot;</span>
					Sector = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;label&quot;</span>
					Label = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
				
				Index = Index + <span style="color:#326598">1</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">next</span> <span style="color:#7F0000;text-style:italic">key/value</span> <span style="color:#7F0000;text-style:italic">pair</span>
				Key = ImageMapHandler.getKey(Index)
				KeyValue = ImageMapHandler.getValue(Index)
				
			<span style="color:#0000FF;font-weight: bold">Loop</span> <span style="color:#0000FF;font-weight: bold">Until</span> Key.Len = <span style="color:#326598">0</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Trigger</span> <span style="color:#7F0000;text-style:italic">click</span> <span style="color:#7F0000;text-style:italic">event</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> isDoubleClick <span style="color:#0000FF;font-weight: bold">then</span>
				ItemDoubleClicked(XLabel, Val(XValue), Val(DataSet), DataSetName, Val(Value), Title, Val(Sector), Label)
			<span style="color:#0000FF;font-weight: bold">else</span>
				ItemClicked(XLabel, Val(XValue), Val(DataSet), DataSetName, Val(Value), Title, Val(Sector), Label)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> UpdateMouseCursor()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">call</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">timer</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">your</span> <span style="color:#7F0000;text-style:italic">window</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">keep</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">cursor</span> <span style="color:#7F0000;text-style:italic">change</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">pressing</span> <span style="color:#7F0000;text-style:italic">alt</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">shift</span> <span style="color:#7F0000;text-style:italic">keys.</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">allowed?</span>
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> AllowZoom <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">if</span> isMouseDown <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#0000FF;font-weight: bold">me</span>.MouseX
			<span style="color:#0000FF;font-weight: bold">dim</span> y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#0000FF;font-weight: bold">me</span>.MouseY
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">inside</span>
			<span style="color:#0000FF;font-weight: bold">if</span> X&lt;<span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">if</span> Y&lt;<span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">if</span> X&gt;<span style="color:#0000FF;font-weight: bold">me</span>.Width <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">if</span> Y&gt;<span style="color:#0000FF;font-weight: bold">me</span>.Height <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">now</span> <span style="color:#7F0000;text-style:italic">update</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> Keyboard.AsyncOptionKey <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span>
				MouseCursor = System.Cursors.MagnifyLarger
				
			<span style="color:#0000FF;font-weight: bold">ElseIf</span> Keyboard.AsyncShiftKey <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">Out</span>
				MouseCursor = System.Cursors.MagnifySmaller
				
			<span style="color:#0000FF;font-weight: bold">Else</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> HotSpotID <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">over</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">hotspot;</span> <span style="color:#7F0000;text-style:italic">Nil</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">prevents</span> <span style="color:#7F0000;text-style:italic">spurious</span> <span style="color:#7F0000;text-style:italic">NilObjectExceptions</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (ImageMapHandler &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span> HotSpotID = ImageMapHandler.getHotSpot(X, Y)
				
				<span style="color:#0000FF;font-weight: bold">If</span> (HotSpotID &gt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					MouseCursor = System.Cursors.StandardPointer
					
					
					
				<span style="color:#0000FF;font-weight: bold">ElseIf</span> (AllowMove = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					MouseCursor = System.Cursors.HandOpen
					
				<span style="color:#0000FF;font-weight: bold">Else</span>
					
					MouseCursor = System.Cursors.StandardPointer
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;About</span> <span style="color:#6500FE">Properties&quot;</span>
<div class="RB_Comment">			AllowMove and AllowZoom must be enabled if you want to zoom and move. 
			You need to use the viewport in your render code.
			
			If Border is true, a black line is drawn around the chart.
			
			If CleanGraphicsBeforeDrawing is true then the graphics object is cleared 
			before something is drawn
			
			The OverlayPicture defines a picture which is drawn on top of the chart 
			as a watermark.
			
			RenderWithTransparency will do redraws slower. The chart is rendered as 
			PNG with mask and for every redraw we refresh the whole control. 
			This may look bad on Windows.
			
			ZoomInRatio and ZoomOutRatio are used for zooming. 
			This is how much we zoom on each click.</div>
</div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;Notes</span> <span style="color:#6500FE">for</span> <span style="color:#6500FE">Render</span> <span style="color:#6500FE">Event&quot;</span>
<div class="RB_Comment">			Use the Width and Height you get and not the control's.
			Use the Factor to multiply all values so you get it properly scaled for printing.
			Use the ViewPort for zooming and moving.</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> AllowMove <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> AllowZoom <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Border <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> CleanGraphicsBeforeDrawing <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> Current <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> DrawInfoX <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = -<span style="color:#326598">1</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> DrawInfoY <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> ImageMapHandler <span style="color:#0000FF;font-weight: bold">As</span> CDImageMapHandlerMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> LastPicture <span style="color:#0000FF;font-weight: bold">As</span> Picture</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> MaxValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> MinValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> Mode <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> OverlayPicture <span style="color:#0000FF;font-weight: bold">As</span> Picture</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> RectanglePicture <span style="color:#0000FF;font-weight: bold">As</span> Picture</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> RenderWithTransparency <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> StartX <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> StartX2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> StartY <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> StartY2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> ViewPort <span style="color:#0000FF;font-weight: bold">As</span> CDViewPortManagerMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ZoomInRatio <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#006532">1.25</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ZoomOutRatio <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#006532">0.75</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> dragPicture <span style="color:#0000FF;font-weight: bold">As</span> Picture</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> isMouseDown <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	SetRetina</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> SetRetina</div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

<p>See also:<ul>
<li><A href="example-chartdirector-chartdirectorcontrol.html">/ChartDirector/ChartDirector Control</A></li>
<li><A href="example-chartdirector-chartdirectorcontrolforweb.html">/ChartDirector/ChartDirector Control for Web</A></li>
</ul></p>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbschartdirectorplugin.html">MBS ChartDirector Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-chartdirector-chartdirectorcontrolretina">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

