<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - NSTaskMBS class</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="NSTaskMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">NSTaskMBS class</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<H3>NSTaskMBS class</H3>
<div class="M">

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>class</td>
<td class=grau><A href="topic-cocoatasks.html" translate="no">Cocoa Tasks</A></td>
<td class=grau><a href="plugins-mbsmaccocoaplugin.html">MBS MacCocoa Plugin</a></td>
<td class=grau><a href="newinversion97.shtml" class=version>9.7</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Using the NSTask class, your program can run another program as a subprocess and can monitor that program&#39;s execution. <BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #800000;">// Launch &quot;ls -l -a -t&quot; in the current directory, and then read the result into a string:</span><br /><br /><span style="color: #0000FF;">dim</span> task <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> NSTaskMBS<br /><br />task.launchPath = <span style="color: #6600FE;">&quot;/bin/ls&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> arguments(-<span style="color: #336698;">1</span>) <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #0000FF;">array</span>(<span style="color: #6600FE;">&quot;-l&quot;</span>, <span style="color: #6600FE;">&quot;-a&quot;</span>, <span style="color: #6600FE;">&quot;-t&quot;</span>)<br /><br />task.setArguments arguments<br /><br /><span style="color: #0000FF;">dim</span> pipe <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-nspipembs.html">NSPipeMBS</A><br /><br />task.setStandardOutput pipe<br /><br /><span style="color: #0000FF;">dim</span> file <span style="color: #0000FF;">as</span> <A href="class-nsfilehandlembs.html">NSFileHandleMBS</A> = pipe.fileHandleForReading<br /><br />task.launch<br /><br /><span style="color: #0000FF;">dim</span> data <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = file.readDataToEndOfFile<br /><span style="color: #0000FF;">dim</span> text <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = DefineEncoding(data, encodings.UTF8)<br /><br />MsgBox text</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
An NSTask object creates a separate executable entity; it differs from NSThread in that it does not share memory space with the process that creates it.<BR>
A task operates within an environment defined by the current values for several items: the current directory, standard input, standard output, standard error, and the values of any environment variables. By default, an NSTask object inherits its environment from the process that launches it. If there are any values that should be different for the task, for example, if the current directory should change, you must change the value before you launch the task. A task&#39;s environment cannot be changed while it is running.<BR>
An NSTask object can only be run once. Subsequent attempts to run the task raise an error.<BR>
<BR>
This class is comparable to the shell classe built into Xojo.<BR>
See also <A href="class-windowsprocessmbs.html">WindowsProcessMBS</A> and <A href="global-windowsshellexecutembs.html">WindowsShellExecuteMBS</A> (Windows only), <A href="global-consoleexecutembs.html#2">ConsoleExecuteMBS</A> and <A href="class-shellmbs.html">ShellMBS</A> (cross platform).<BR>
</div>
<ul>
<li class="M">event <A href="cocoatasks-nstaskmbs-event.html">Terminated</A></li>
<LI>9 properties<UL>
<li class="M">property <A href="cocoatasks-nstaskmbs-property.html">currentDirectoryPath</A> as string</li>
<li class="M">property <A href="cocoatasks-nstaskmbs-property.html#2">Handle</A> as Integer</li>
<li class="M">property <A href="cocoatasks-nstaskmbs-property.html#3">isRunning</A> as boolean</li>
<li class="M">property <A href="cocoatasks-nstaskmbs-property.html#4">launchPath</A> as string</li>
<li class="M">property <A href="cocoatasks-nstaskmbs-property.html#5">processIdentifier</A> as Integer</li>
<li class="M">property <A href="cocoatasks-nstaskmbs-property.html#6">qualityOfService</A> as Integer</li>
<li class="M">property <A href="cocoatasks-nstaskmbs-property.html#7">terminationReason</A> as Integer</li>
<li class="M">property <A href="cocoatasks-nstaskmbs-property.html#8">terminationStatus</A> as Integer</li>
<li class="M">property <A href="cocoatasks-nstaskmbs-method.html#4">environment</A> as dictionary</li>
</UL></LI>
<LI>19 methods<UL>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html">arguments</A> as string()</li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#2">Constructor</A></li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#3">Destructor</A></li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#5">interrupt</A></li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#6">launch</A></li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#7">resume</A> as boolean</li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#8">setArguments</A>(arguments() as string)</li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#9">setStandardError</A>(p as <A href="class-nsfilehandlembs.html">NSFileHandleMBS</A>)</li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#10">setStandardError</A>(p as <A href="class-nspipembs.html">NSPipeMBS</A>)</li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#11">setStandardInput</A>(p as <A href="class-nsfilehandlembs.html">NSFileHandleMBS</A>)</li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#12">setStandardInput</A>(p as <A href="class-nspipembs.html">NSPipeMBS</A>)</li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#13">setStandardOutput</A>(p as <A href="class-nsfilehandlembs.html">NSFileHandleMBS</A>)</li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#14">setStandardOutput</A>(p as <A href="class-nspipembs.html">NSPipeMBS</A>)</li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#15">standardError</A> as Variant</li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#16">standardInput</A> as Variant</li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#17">standardOutput</A> as Variant</li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#18">suspend</A> as boolean</li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#19">terminate</A></li>
<li class="M">method <A href="cocoatasks-nstaskmbs-method.html#20">waitUntilExit</A></li>
</UL></LI>
<LI>2 shared methods<UL>
<li class="M">shared method <A href="cocoatasks-nstaskmbs-shared-method.html">launchedTaskWithLaunchPath</A>(path as string, arguments() as string) as NSTaskMBS</li>
<li class="M">shared method <A href="cocoatasks-nstaskmbs-shared-method.html#2">NSTaskDidTerminateNotification</A> as string</li>
</UL></LI>
<LI>7 constants<UL>
<li class="M">const <A href="cocoatasks-nstaskmbs-const.html#6">NSTaskTerminationReasonExit</A> = 1</li>
<li class="M">const <A href="cocoatasks-nstaskmbs-const.html#7">NSTaskTerminationReasonUncaughtSignal</A> = 2</li>
</UL></LI>
</ul>
<h3 lang="en">Quality of Service Constants</h3>
<table cellpadding=2 cellspacing=2>
<tr>
<th bgcolor="#DDDDDD">Constant</th>
<th bgcolor="#DDDDDD">Value</th>
<th bgcolor="#DDDDDD">Description</th>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="cocoatasks-nstaskmbs-const.html">NSQualityOfServiceBackground </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h09</td>
<td bgcolor="#DDDDDD" valign=top>
Background QoS is used for work that is not user initiated or visible.  In general, a user is unaware that this work is even happening and it will run in the most efficient manner while giving the most deference to higher QoS work.  For example, pre-fetching content, search indexing, backups, and syncing of data with external systems. <BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="cocoatasks-nstaskmbs-const.html#2">NSQualityOfServiceDefault </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> -1</td>
<td bgcolor="#DDDDDD" valign=top>
Default QoS indicates the absence of QoS information.  Whenever possible QoS information will be inferred from other sources.  If such inference is not possible, a QoS between UserInitiated and Utility will be used.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="cocoatasks-nstaskmbs-const.html#3">NSQualityOfServiceUserInitiated </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h19</td>
<td bgcolor="#DDDDDD" valign=top>
UserInitiated QoS is used for performing work that has been explicitly requested by the user and for which results must be immediately presented in order to allow for further user interaction.  For example, loading an email after a user has selected it in a message list.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="cocoatasks-nstaskmbs-const.html#4">NSQualityOfServiceUserInteractive </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h21</td>
<td bgcolor="#DDDDDD" valign=top>
UserInteractive QoS is used for work directly involved in providing an interactive UI such as processing events or drawing to the screen.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="cocoatasks-nstaskmbs-const.html#5">NSQualityOfServiceUtility </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h11</td>
<td bgcolor="#DDDDDD" valign=top>
Utility QoS is used for performing work which the user is unlikely to be immediately waiting for the results.  This work may have been requested by the user or initiated automatically, does not prevent the user from further interaction, often operates at user-visible timescales and may have its progress indicated to the user by a non-modal progress indicator.  This work will run in an energy-efficient manner, in deference to higher QoS work when resources are constrained.  For example, periodic content updates or bulk file operations such as media import.<BR>
</td>
</tr>
</table>
<p>This class has no sub classes.</p>
<h4>Some examples using this class:</h4>
<ul translate="no">
<li class=""><A href="example-maccocoa-nstask-nstask.html">/MacCocoa/NSTask/NSTask</A></li>
<li class=""><A href="example-maccocoa-nstask-nstaskliveoutput.html">/MacCocoa/NSTask/NSTask live output</A></li>
<li class=""><A href="example-maccocoa-nstask-nstasktraceroute.html">/MacCocoa/NSTask/NSTask traceroute</A></li>
<li class=""><A href="example-maccocoa-nstask-nstaskwitharguments.html">/MacCocoa/NSTask/NSTask with Arguments</A></li>
<li class=""><A href="example-maccocoa-readtoendoffileinbackgroundandnotifytest.html">/MacCocoa/readToEndOfFileInBackgroundAndNotify Test</A></li>
</ul>
<h4>Blog Entries</h4>
<ul>
<li><a href="https://www.mbsplugins.de/archive/2015-08-26/MBS_Xojo__Real_Studio_Plugins_/monkeybreadsoftware_blog_xojo">MBS Xojo / Real Studio Plugins, version 15.3pr1</a></li>
</ul>
<BR>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmaccocoaplugin.html">MBS MacCocoa Plugin</a>.</p>
<br clear=all><p>
<a href="class-nstabviewmbs.html">NSTabViewMBS</a>
 &nbsp; - &nbsp; 
<a href="class-nstextattachmentmbs.html">NSTextAttachmentMBS</a>
</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=class-nstaskmbs">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

