<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - AuthorizationMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="AuthorizationMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">AuthorizationMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-authorizationmbs.html">AuthorizationMBS</a> class.  </p>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="1">Authorize(rights as <A href="class-authorizationitemsetmbs.html">AuthorizationItemSetMBS</A>, flags as Integer)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion31.shtml" class=version>3.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Short for Authorize without the resulting rights set.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> a <span style="color: #0000FF;">as</span> <A href="class-authorizationmbs.html">AuthorizationMBS</A><br /><span style="color: #0000FF;">dim</span> s <span style="color: #0000FF;">as</span> <A href="class-authorizationitemsetmbs.html">AuthorizationItemSetMBS</A><br /><span style="color: #0000FF;">dim</span> i <span style="color: #0000FF;">as</span> <A href="class-authorizationitemmbs.html">AuthorizationItemMBS</A><br /><span style="color: #0000FF;">dim</span> Flags <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Integer</span><br /><br /><span style="color: #800000;">// check whether use is admin</span><br /><br />a=new <A href="class-authorizationmbs.html">AuthorizationMBS</A><br /><br />s=new <A href="class-authorizationitemsetmbs.html">AuthorizationItemSetMBS</A><br />i=new <A href="class-authorizationitemmbs.html">AuthorizationItemMBS</A><br />i.Name=<span style="color: #6600FE;">&quot;com.mycompany.myapplication.command1&quot;</span><br />s.Append i<br /><br /><span style="color: #0000FF;">if</span> a.NewAuthorization(<span style="color: #0000FF;">nil</span>,a.kAuthorizationFlagDefaults) <span style="color: #0000FF;">then</span> <span style="color: #800000;">// create</span><br />  Flags=BitwiseOr(a.kAuthorizationFlagExtendRights,a.kAuthorizationFlagInteractionAllowed)<br />  <br />  a.Authorize(s,flags)<br />  MsgBox str(a.LastError)<br />  <span style="color: #800000;">// -60006 for cancel = no admin</span><br />  <span style="color: #800000;">// 0 on success</span><br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span></span>
</pre>
</div>
<p>See also:<ul>
<li><A href="authorization-authorizationmbs-method.html#2">Authorize(rights as AuthorizationItemSetMBS, flags as Integer, byref outrights as AuthorizationItemSetMBS)</A></li>
</ul></p>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="2">Authorize(rights as <A href="class-authorizationitemsetmbs.html">AuthorizationItemSetMBS</A>, flags as Integer, byref outrights as <A href="class-authorizationitemsetmbs.html">AuthorizationItemSetMBS</A>)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion31.shtml" class=version>3.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Tries to extend authorization to have root rights.<BR>
<B>Notes:</B> 
<BR>
The Authorizated property is set if this function was successfull.<BR>
Lasterror is set.<BR>
outrights is on return a list of the rights which are authorized.<BR>
<BR>
Extends the rights of the class.<BR>
<BR>
When the kAuthorizationFlagInteractionAllowed flag is set, user interaction will happen when required.  Failing to set this flag will result in this call failing with a errAuthorizationInteractionNotAllowed status when interaction is required.<BR>
<BR>
Setting the kAuthorizationFlagExtendRights flag will extend the currently available rights.<BR>
<BR>
Setting the kAuthorizationFlagPartialRights flag will cause this call to succeed if only some of the requested rights are being granted by the system. Unless this flag is set this API will fail if not all the requested rights could be obtained.<BR>
<BR>
Setting the kAuthorizationFlagDestroyRights flag will prevent any additional rights obtained during this call from being preserved after returning from this API.<BR>
<BR>
Setting the kAuthorizationFlagPreAuthorize flag will pre authorize the requested rights so that at a later time -- by calling GetExternalForm() follow by NewAuthorizationFromExternalForm() -- the obtained rights can be used in a different process.  Rights that can&#39;t be preauthorized will be treated as if they were authorized for the sake of returning an error (in other words if all rights are either authorized or could not be preauthorized this call will still succeed).<BR>
<BR>
The rights which could not be preauthorized are not currently authorized and may fail to authorize when a later call to Authorize() is made, unless the kAuthorizationFlagExtendRights and kAuthorizationFlagInteractionAllowed flags are set.  Even then they might still fail if the user does not supply the correct credentials.<BR>
<BR>
The reason for passing in this flag is to provide correct audit trail information and to avoid unnecessary user interaction.<BR>
<BR>
Error codes:<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">errAuthorizationSuccess</TD><TD valign="top">0</TD><TD valign="top">No error.</TD></TR>
<TR><TD valign="top">errAuthorizationInvalidRef</TD><TD valign="top">-60002</TD><TD valign="top">The authorization parameter is invalid.</TD></TR>
<TR><TD valign="top">errAuthorizationInvalidSet</TD><TD valign="top">-60001</TD><TD valign="top">The rights parameter is invalid.</TD></TR>
<TR><TD valign="top">errAuthorizationInvalidPointer</TD><TD valign="top">-60004</TD><TD valign="top">The authorizedRights parameter is invalid.</TD></TR>
</TABLE>
<p>See also:<ul>
<li><A href="authorization-authorizationmbs-method.html">Authorize(rights as AuthorizationItemSetMBS, flags as Integer)</A></li>
</ul></p>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="3">Available as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion28.shtml" class=version>2.8</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Returns true if the Authorization Framework was loaded correctly.<BR>
<B>Notes:</B> 
Returns false on any error.<BR>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="4">close</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion28.shtml" class=version>2.8</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
The destructor.<BR>
<B>Notes:</B> 
<BR>
Strings made with the ExternalForm function will become invalid!<BR>
<BR>
There is no need to call this method except you want to free all resources used by this object now without waiting for Xojo to do it for you.<BR>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="5">closeStream</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion31.shtml" class=version>3.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Closes the stream.<BR>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="6">EOFStream as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion31.shtml" class=version>3.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Returns true if the Stream is at the end.<BR>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="7">Execute(toolpath as string, parameters() as string)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion28.shtml" class=version>2.8</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Executes a command line application in the background.<BR>
<B>Notes:</B> 
<BR>
You may make some small shell script which you launch in background. This script can change some other utility to run as root (Setuid), so you can do admin stuff using the normal shell class.<BR>
Lasterror is set.<BR>
Currently this function is not available to RB versions before 3.5.<BR>
Note that the parameters parameter is an array of strings and not just one.<BR>
toolpath should use an absolute path in unix style.<BR>
<BR>
Lasterror is set to -1 if the path is empty or you are not using Mac OS X.<BR>
<p>See also:<ul>
<li><A href="authorization-authorizationmbs-method.html#8">Execute(toolpath as string, parameters() as string, openstream as boolean)</A></li>
</ul></p>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="8">Execute(toolpath as string, parameters() as string, openstream as boolean)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion31.shtml" class=version>3.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Same as Execute, but you can specify if the stream to the command line application should be opened.<BR>
<B>Notes:</B> 
<BR>
Currently this function is not available to RB versions before 3.5.<BR>
Note that the parameters parameter is an array of strings and not just one.<BR>
toolpath should use an absolute path in unix style.<BR>
<BR>
Lasterror is set to -1 if the path is empty or you are not using Mac OS X.<BR>
<p>See also:<ul>
<li><A href="authorization-authorizationmbs-method.html#7">Execute(toolpath as string, parameters() as string)</A></li>
</ul></p>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="9">ExternalForm as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion28.shtml" class=version>2.8</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Returns a string with binary data about this Authorization object.<BR>
<B>Notes:</B> 
<BR>
This external representation depends on your process. You can&#39;t save it to disk or keep it longer than the Authorization object exists.<BR>
If the Authorization object is destroyed, your application quits or the authorization times out, this external form becomes invalid.<BR>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="10">FlushStream</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion31.shtml" class=version>3.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Flushs the stream to the background application.<BR>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="11">Info as <A href="class-authorizationitemsetmbs.html">AuthorizationItemSetMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion31.shtml" class=version>3.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Returns the list of currently authorized rights.<BR>
<B>Notes:</B> 
Returns nil on any error.<BR>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="12">MakeStreamAsyncron</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion63.shtml" class=version>6.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Modifies the Stream created in the Execute method to run non blocking.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-maccf-authorization-authorizationwithstreamasync.html">/MacCF/Authorization/Authorization with Stream Async</A></li>
</ul>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="13">NewAuthorization(rights as <A href="class-authorizationitemsetmbs.html">AuthorizationItemSetMBS</A>, flags as Integer) as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion28.shtml" class=version>2.8</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Creates a new Authorization object.<BR>
<B>Notes:</B> 
<BR>
Lasterror is set. Returns true if successfull.<BR>
<BR>
Create a new autorization object which can be used in other authorization calls. <BR>
<BR>
When the kAuthorizationFlagInteractionAllowed flag is set, user interaction will happen when required.  Failing to set this flag will result in this call failing with a errAuthorizationInteractionNotAllowed status in the lasterror property when interaction is required.<BR>
<BR>
Setting the kAuthorizationFlagExtendRights flag will extend the currently available rights. If this flag is set the class will grant all the rights requested when errAuthorizationSuccess is returned in the lasterror property. If this flag is not set the operation will almost certainly succeed, but no attempt will be made to make the requested rights availible.<BR>
<BR>
Call the Info function to figure out which of the requested rights are granted by the system.<BR>
<BR>
Setting the kAuthorizationFlagPartialRights flag will cause this call to succeed if only some of the requested rights are being granted by the system. Unless this flag is set this API will fail if not all the requested rights could be obtained.<BR>
<BR>
Setting the kAuthorizationFlagPreAuthorize flag will pre authorize the requested rights so that at a later time -- by calling GetExternalForm() follow by NewAuthorizationFromExternalForm() in a different object -- the obtained rights can be used in a different process.  Rights that can&#39;t be preauthorized will be treated as if they were authorized for the sake of returning an error (in other words if all rights are either authorized or could not be preauthorized this call will still succeed).<BR>
<BR>
The rights which could not be preauthorized are not currently authorized and may fail to authorize when a later call to Authorize() is made, unless the kAuthorizationFlagExtendRights and kAuthorizationFlagInteractionAllowed flags are set.  Even then they might still fail if the user does not supply the correct credentials.<BR>
<BR>
The reason for passing in this flag is to provide correct audit trail information and to avoid unnecessary user interaction.<BR>
<BR>
rights (input/optional):<BR>
An AuthorizationItemSet containing rights for which authorization is being requested.  If nil are specified the class will authorize nothing at all.<BR>
<BR>
flags (input) options specified using the different constants from this class.<BR>
<BR>
Error codes:<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">errAuthorizationSuccess</TD><TD valign="top">0</TD><TD valign="top">Authorization or all requested rights succeeded.</TD></TR>
<TR><TD valign="top">errAuthorizationDenied</TD><TD valign="top">-60005</TD><TD valign="top">The authorization for one or more of the requested rights was denied.</TD></TR>
<TR><TD valign="top">errAuthorizationCanceled</TD><TD valign="top">-60006</TD><TD valign="top">The authorization was cancled by the user.</TD></TR>
<TR><TD valign="top">errAuthorizationInteractionNotAllowed</TD><TD valign="top">-60007</TD><TD valign="top">The authorization was denied since no interaction with the user was allowed.</TD></TR>
</TABLE>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="14">NewAuthorizationFromExternalForm(s as string) as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion28.shtml" class=version>2.8</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Creates a new Authorization object from data inside a string.<BR>
<B>Notes:</B> 
<BR>
You can store an authorization in a string for use in a subprocess. For example your application can ask the user for Root rights and you pass this string to a launched terminal application which will use it without having it&#39;s own interface.<BR>
Lasterror is set. Returns true if successfull.<BR>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="15">ReadStream(count as Integer) as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion31.shtml" class=version>3.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Reads bytes from the output stream of the executing app.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> s(<span style="color: #336698;">0</span>) <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">String</span><br /><span style="color: #0000FF;">dim</span> a <span style="color: #0000FF;">as</span> <A href="class-authorizationmbs.html">AuthorizationMBS</A><br /><span style="color: #0000FF;">dim</span> e <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Integer</span><br /><br />s(<span style="color: #336698;">0</span>)=<span style="color: #6600FE;">&quot;-show&quot;</span><br /><br />a=new <A href="class-authorizationmbs.html">AuthorizationMBS</A><br /><br /><span style="color: #0000FF;">if</span> a.SimpleNewAuthorization <span style="color: #0000FF;">then</span> <span style="color: #800000;">// create</span><br />  <br />  a.Execute(<span style="color: #6600FE;">&quot;/usr/sbin/dsconfigad&quot;</span>,s,<span style="color: #0000FF;">true</span>) <span style="color: #800000;">// and run it</span><br />  <br />  <span style="color: #0000FF;">if</span> a.LastError&lt;&gt;0 <span style="color: #0000FF;">then</span><br />    MsgBox <span style="color: #6600FE;">&quot;Lasterror on Execute: &quot;</span>+str(a.LastError)<br />  <span style="color: #0000FF;">else</span><br />    e=a.Wait <span style="color: #800000;">// wait for process to terminate. Returns PID</span><br />    <span style="color: #0000FF;">if</span> a.LastError&lt;&gt;0 <span style="color: #0000FF;">then</span><br />      MsgBox <span style="color: #6600FE;">&quot;Lasterror on Wait: &quot;</span>+str(a.LastError)<br />    <span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br />  <span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br />  msgbox a.ReadStream(<span style="color: #336698;">1024</span>)<br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Tries to read count bytes.<BR>
<BR>
Lasterror is set.<BR>
The returned string will be as long as the number of strings read.<BR>
<BR>
Lasterror is set to -1 by the plugin if the stream is not open, or you are not using Mac OS X or the memory allocation failed.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-maccf-authorization-authorizationwithstream.html">/MacCF/Authorization/Authorization with Stream</A></li>
<li><A href="example-maccf-authorization-authorizationwithstreamasync.html">/MacCF/Authorization/Authorization with Stream Async</A></li>
</ul>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="16">SimpleAuthorize</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion31.shtml" class=version>3.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Just asks for the Authorization.<BR>
<B>Notes:</B> 
This is the function from MBS Plugin 3.0.<BR>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="17">SimpleNewAuthorization as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion31.shtml" class=version>3.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Creates a new authorization handle.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #800000;">// uses chmod on test.pdf on the desktop to make</span><br /><span style="color: #800000;">// it read-, write- and executeable by everyone.</span><br /><br /><span style="color: #0000FF;">dim</span> s(<span style="color: #336698;">1</span>) <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">String</span><br /><span style="color: #0000FF;">dim</span> a <span style="color: #0000FF;">as</span> <A href="class-authorizationmbs.html">AuthorizationMBS</A><br /><br />a=new <A href="class-authorizationmbs.html">AuthorizationMBS</A><br /><br /><span style="color: #0000FF;">if</span> a.SimpleNewAuthorization <span style="color: #0000FF;">then</span><br />  s(<span style="color: #336698;">0</span>)=<span style="color: #6600FE;">&quot;777&quot;</span><br />  s(<span style="color: #336698;">1</span>)=SpecialFolder.Desktop.Child(<span style="color: #6600FE;">&quot;test.pdf&quot;</span>).NativePath<br />  <br />  MsgBox s(<span style="color: #336698;">1</span>)<br />  a.execute(<span style="color: #6600FE;">&quot;/bin/chmod&quot;</span>,s)<br />  msgbox <span style="color: #6600FE;">&quot;Executed:&quot;</span>+str(a.lasterror)<br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span></span>
</pre>
</div>
<B>Notes:</B> 
This is the function from MBS Plugin 3.0.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-maccf-authorization-authorizationwithstream.html">/MacCF/Authorization/Authorization with Stream</A></li>
<li><A href="example-maccf-authorization-authorizationwithstreamasync.html">/MacCF/Authorization/Authorization with Stream Async</A></li>
</ul>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="18">Wait as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion31.shtml" class=version>3.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Waits till the background application is done.<BR>
<B>Notes:</B> 
<BR>
Returns the Process ID or -1 on an error.<BR>
Lasterror is set.<BR>
</div>
<div class="M">
<b><a href="class-authorizationmbs.html">AuthorizationMBS</a>.<A name="19">WriteStream(s as string) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-authorization.html" translate="no">Authorization</A></td>
<td class=grau><a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a></td>
<td class=grau><a href="newinversion31.shtml" class=version>3.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Writes the given bytes in the string to the stream.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmaccfplugin.html">MBS MacCF Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=authorization-authorizationmbs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

