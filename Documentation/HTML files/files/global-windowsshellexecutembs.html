<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Windows: WindowsShellExecuteMBS</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Windows">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Windows: WindowsShellExecuteMBS</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="W">
<b><A name="1">WindowsShellExecuteMBS(ParentWindowHandle as Integer, Operation as string, File as string, Parameters as string = &quot;&quot;, Directory as string = &quot;&quot;, ShowCmd as Integer = 5) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>global method</td>
<td class=grau><A href="topic-windows.html" translate="no">Windows</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion102.shtml" class=version>10.2</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Performs an operation on a specified file.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> e <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Integer</span><br /><span style="color: #0000FF;">dim</span> f <span style="color: #0000FF;">as</span> FolderItem<br /><br /><span style="color: #800000;">// show documents folder</span><br /><br />f = SpecialFolder.Documents<br />e = WindowsShellExecuteMBS(<span style="color: #336698;">0</span>, <span style="color: #6600FE;">&quot;explore&quot;</span>, f.NativePath, <span style="color: #6600FE;">&quot;&quot;</span>, <span style="color: #6600FE;">&quot;&quot;</span>, <span style="color: #336698;">10</span>)<br /><br /><span style="color: #800000;">// Launch Notepad application</span><br /><br />e = WindowsShellExecuteMBS(<span style="color: #336698;">0</span>, <span style="color: #6600FE;">&quot;&quot;</span>, <span style="color: #6600FE;">&quot;notepad.exe&quot;</span>, <span style="color: #6600FE;">&quot;&quot;</span>, <span style="color: #6600FE;">&quot;&quot;</span>, <span style="color: #336698;">10</span>)<br /><br /><span style="color: #800000;">// launch file, folder or application</span><br /><br />f = SpecialFolder.Desktop.Child(<span style="color: #6600FE;">&quot;Auto1.JPG&quot;</span>)<br />e = WindowsShellExecuteMBS(<span style="color: #336698;">0</span>, <span style="color: #6600FE;">&quot;&quot;</span>, f.NativePath, <span style="color: #6600FE;">&quot;&quot;</span>, <span style="color: #6600FE;">&quot;&quot;</span>, <span style="color: #336698;">10</span>)</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Use <A href="global-consoleexecutembs.html#2">ConsoleExecuteMBS</A> on Mac OS X and Linux.<BR>
<BR>
ParentWindowHandle: <BR>
A handle to the owner window used for displaying a UI or error messages. This value can be 0 if the operation is not associated with a window. You can pass window.handle from a Xojo window.<BR>
<BR>
Operation: <BR>
A string, referred to in this case as a verb, that specifies the action to be performed. The set of available verbs depends on the particular file or folder. Generally, the actions available from an object&#39;s shortcut menu are available verbs. The following verbs are commonly used:<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">edit</TD><TD valign="top">Launches an editor and opens the document for editing. If File is not a document file, the function will fail.</TD></TR>
<TR><TD valign="top">explore</TD><TD valign="top">Explores a folder specified by File.</TD></TR>
<TR><TD valign="top">find</TD><TD valign="top">Initiates a search beginning in the directory specified by Directory.</TD></TR>
<TR><TD valign="top">open</TD><TD valign="top">Opens the item specified by the File parameter. The item can be a file or folder.</TD></TR>
<TR><TD valign="top">print</TD><TD valign="top">Prints the file specified by File. If File is not a document file, the function fails.</TD></TR>
<TR><TD valign="top">&quot;&quot;</TD><TD valign="top">In systems prior to Windows 2000, the default verb is used if it is valid and available in the registry. If not, the &quot;open&quot; verb is used. In Windows 2000 and later, the default verb is used if available. If not, the &quot;open&quot; verb is used. If neither verb is available, the system uses the first verb listed in the registry.</TD></TR>
</TABLE>
<BR>
File:<BR>
A string that specifies the file or object on which to execute the specified verb. To specify a Shell namespace object, pass the fully qualified parse name. Note that not all verbs are supported on all objects. For example, not all document types support the &quot;print&quot; verb. If a relative path is used for the Directory parameter do not use a relative path for File.<BR>
<BR>
Parameters:<BR>
If File specifies an executable file, this parameter is a string that specifies the parameters to be passed to the application. The format of this string is determined by the verb that is to be invoked. If File specifies a document file, Parameters should be &quot;&quot;.<BR>
<BR>
Directory:<BR>
A string that specifies the default (working) directory for the action. If this value is NULL, the current working directory is used. If a relative path is provided at File, do not use a relative path for Directory.<BR>
<BR>
ShowCmd:<BR>
The flags that specify how an application is to be displayed when it is opened. If File specifies a document file, the flag is simply passed to the associated application. It is up to the application to decide how to handle it.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">SW_HIDE</TD><TD valign="top">0</TD><TD valign="top">Hides the window and activates another window.</TD></TR>
<TR><TD valign="top">SW_MAXIMIZE</TD><TD valign="top">3</TD><TD valign="top">Maximizes the specified window.</TD></TR>
<TR><TD valign="top">SW_MINIMIZE</TD><TD valign="top">6</TD><TD valign="top">Minimizes the specified window and activates the next top-level window in the z-order.</TD></TR>
<TR><TD valign="top">SW_RESTORE</TD><TD valign="top">9</TD><TD valign="top">Activates and displays the window. If the window is minimized or maximized, Windows restores it to its original size and position. An application should specify this flag when restoring a minimized window.</TD></TR>
<TR><TD valign="top">SW_SHOW</TD><TD valign="top">5</TD><TD valign="top">Activates the window and displays it in its current size and position.</TD></TR>
<TR><TD valign="top">SW_SHOWDEFAULT</TD><TD valign="top">10</TD><TD valign="top">Sets the show state based on the SW_ flag specified in the STARTUPINFO structure passed to the CreateProcess function by the program that started the application. An application should call ShowWindow with this flag to set the initial show state of its main window.</TD></TR>
<TR><TD valign="top">SW_SHOWMAXIMIZED</TD><TD valign="top">3</TD><TD valign="top">Activates the window and displays it as a maximized window.</TD></TR>
<TR><TD valign="top">SW_SHOWMINIMIZED</TD><TD valign="top">2</TD><TD valign="top">Activates the window and displays it as a minimized window.</TD></TR>
<TR><TD valign="top">SW_SHOWMINNOACTIVE</TD><TD valign="top">7</TD><TD valign="top">Displays the window as a minimized window. The active window remains active.</TD></TR>
<TR><TD valign="top">SW_SHOWNA</TD><TD valign="top">8</TD><TD valign="top">Displays the window in its current state. The active window remains active.</TD></TR>
<TR><TD valign="top">SW_SHOWNOACTIVATE</TD><TD valign="top">4</TD><TD valign="top">Displays a window in its most recent size and position. The active window remains active.</TD></TR>
<TR><TD valign="top">SW_SHOWNORMAL</TD><TD valign="top">1</TD><TD valign="top">Activates and displays a window. If the window is minimized or maximized, Windows restores it to its original size and position. An application should specify this flag when displaying the window for the first time.</TD></TR>
</TABLE>
<BR>
Return Value:<BR>
If the function succeeds, it returns a value greater than 32. If the function fails, it returns an error value that indicates the cause of the failure. The return value is cast as an HINSTANCE for backward compatibility with 16-bit Windows applications.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Return code</TD><TD valign="top">Description</TD></TR>
<TR><TD valign="top">0</TD><TD valign="top">The operating system is out of memory or resources.</TD></TR>
<TR><TD valign="top">ERROR_FILE_NOT_FOUND = 2</TD><TD valign="top">The specified file was not found.</TD></TR>
<TR><TD valign="top">ERROR_PATH_NOT_FOUND = 3</TD><TD valign="top">The specified path was not found.</TD></TR>
<TR><TD valign="top">ERROR_BAD_FORMAT = 11</TD><TD valign="top">The .exe file is invalid (non-Win32 .exe or error in .exe image).</TD></TR>
<TR><TD valign="top">SE_ERR_ACCESSDENIED = 5</TD><TD valign="top">The operating system denied access to the specified file.</TD></TR>
<TR><TD valign="top">SE_ERR_ASSOCINCOMPLETE = 27</TD><TD valign="top">The file name association is incomplete or invalid.</TD></TR>
<TR><TD valign="top">SE_ERR_DDEBUSY = 30</TD><TD valign="top">The DDE transaction could not be completed because other DDE transactions were being processed.</TD></TR>
<TR><TD valign="top">SE_ERR_DDEFAIL = 29</TD><TD valign="top">The DDE transaction failed.</TD></TR>
<TR><TD valign="top">SE_ERR_DDETIMEOUT = 28</TD><TD valign="top">The DDE transaction could not be completed because the request timed out.</TD></TR>
<TR><TD valign="top">SE_ERR_DLLNOTFOUND = 32</TD><TD valign="top">The specified DLL was not found.</TD></TR>
<TR><TD valign="top">SE_ERR_FNF = 2</TD><TD valign="top">The specified file was not found.</TD></TR>
<TR><TD valign="top">SE_ERR_NOASSOC = 31</TD><TD valign="top">There is no application associated with the given file name extension. This error will also be returned if you attempt to print a file that is not printable.</TD></TR>
<TR><TD valign="top">SE_ERR_OOM = 8</TD><TD valign="top">There was not enough memory to complete the operation.</TD></TR>
<TR><TD valign="top">SE_ERR_PNF = 3</TD><TD valign="top">The specified path was not found.</TD></TR>
<TR><TD valign="top">SE_ERR_SHARE = 26</TD><TD valign="top">A sharing violation occurred.</TD></TR>
</TABLE>
<BR>
This method allows you to execute any commands in a folder&#39;s shortcut menu or stored in the registry.<BR>
To open a folder, use either of the following calls:<BR>
<BR>
WindowsShellExecuteMBS(handle, &quot;&quot;, &lt;fully_qualified_path_to_folder&gt;, &quot;&quot;, &quot;&quot;, SW_SHOWNORMAL);<BR>
or<BR>
WindowsShellExecuteMBS(handle, &quot;open&quot;, &lt;fully_qualified_path_to_folder&gt;, &quot;&quot;, &quot;&quot;, SW_SHOWNORMAL);<BR>
<BR>
To explore a folder, use the following call:<BR>
WindowsShellExecuteMBS(handle, &quot;explore&quot;, &lt;fully_qualified_path_to_folder&gt;, &quot;&quot;, &quot;&quot;, SW_SHOWNORMAL);<BR>
To launch the Shell&#39;s Find utility for a directory, use the following call.<BR>
<BR>
WindowsShellExecuteMBS(handle, &quot;find&quot;, &lt;fully_qualified_path_to_folder&gt;, &quot;&quot;, &quot;&quot;, 0);<BR>
<BR>
If Operation is empty, the function opens the file specified by File. If Operation is &quot;open&quot; or &quot;explore&quot;, the function attempts to open or explore the folder.<BR>
<BR>
Note  The Launch folder windows in a separate process setting in Folder Options affects ShellExecute. If that option is disabled (the default setting), ShellExecute uses an open Explorer window rather than launch a new one. If no Explorer window is open, ShellExecute launches a new one.<BR>
<BR>
See also <A href="global-consoleexecutembs.html#2">ConsoleExecuteMBS</A>, <A href="global-windowsshellexecuteasadminmbs.html">WindowsShellExecuteAsAdminMBS</A>, <A href="class-windowsprocessmbs.html">WindowsProcessMBS</A> (Windows only), NSTask (Mac only) and <A href="class-shellmbs.html">ShellMBS</A> (cross platform).<BR>
<h4>Some FAQ entries about this method:</h4>
<ul>
<li><A href="faq-howtoopenpdfinacrobatreader.html">How to open PDF in acrobat reader?</A></li>
</ul>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbswinplugin.html">MBS Win Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=global-windowsshellexecutembs">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

