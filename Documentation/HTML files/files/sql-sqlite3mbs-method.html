<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - SQLite3MBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="SQLite3MBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">SQLite3MBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-sqlite3mbs.html">SQLite3MBS</a> class.  </p>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="1">BackupFinish(Backup as <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A>) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion124.shtml" class=version>12.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Finishes a backup run.<BR>
<B>Notes:</B> 
<BR>
When BackupStep has returned kErrorDone, or when the application wishes to abandon the backup operation, the application should destroy the <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> by passing it to BackupFinish. The BackupFinish interfaces releases all resources associated with the <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object. If BackupStep has not yet returned kErrorDone, then any active write-transaction on the destination database is rolled back. The <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object is invalid and may not be used following a call to BackupFinish.<BR>
The value returned by BackupFinish is kErrorOK if no BackupStep errors occurred, regardless or whether or not BackupStep completed. If an out-of-memory condition or IO error occurred during any prior BackupStep call on the same <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object, then BackupFinish returns the corresponding error code.<BR>
A return of kErrorBusy or kErrorLocked from BackupStep is not a permanent error and does not affect the return value of BackupFinish.<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="2">BackupInit(Dest as Variant, DestName as String, Source as Variant, SourceName as String) as <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion124.shtml" class=version>12.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Initializes a backup.<BR>
<B>Notes:</B> 
<BR>
The backup API copies the content of one database into another. It is useful either for creating backups of databases or for copying in-memory databases to or from persistent files. <BR>
<BR>
see also<BR>
<a href="http://www.sqlite.org/c3ref/backup_finish.html" target=_blank>http://www.sqlite.org/c3ref/backup_finish.html</a><BR>
<BR>
Exclusive access is required to the destination database for the duration of the operation. However the source database is only read-locked while it is actually being read; it is not locked continuously for the entire backup operation. Thus, the backup may be performed on a live source database without preventing other users from reading or writing to the source database while the backup is underway. <BR>
<BR>
To perform a backup operation:<BR>
<UL><LI>
BackupInit is called once to initialize the backup,
</LI><LI>
BackupStep is called one or more times to transfer the data between the two databases, and finally
</LI><LI>
BackupFinish is called to release all resources associated with the backup operation. 
</LI></UL>
There should be exactly one call to BackupFinish for each successful call to BackupInit.<BR>
<BR>
The D and N arguments to BackupInit(D,N,S,M) are the database connection associated with the destination database and the database name, respectively. The database name is &quot;main&quot; for the main database, &quot;temp&quot; for the temporary database, or the name specified after the AS keyword in an ATTACH statement for an attached database. The S and M arguments passed to BackupInit(D,N,S,M) identify the database connection and database name of the source database, respectively. The source and destination database connections (parameters S and D) must be different or else BackupInit(D,N,S,M) will file with an error.<BR>
If an error occurs within BackupInit(D,N,S,M), then nil is returned and an error code and error message are store3d in the destination database connection D. The error code and message for the failed call to BackupInit can be retrieved using the ErrCode and ErrMessage functions. A successful call to BackupInit returns a <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object. The <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object may be used with the BackupStep and BackupFinish functions to perform the specified backup operation.<BR>
<BR>
Concurrent Usage of Database Handles<BR>
The source database connection may be used by the application for other purposes while a backup operation is underway or being initialized. If SQLite is compiled and configured to support threadsafe database connections, then the source database connection may be used concurrently from within other threads.<BR>
However, the application must guarantee that the destination database connection is not passed to any other API (by any thread) after BackupInit is called and before the corresponding call to BackupFinish. SQLite does not currently check to see if the application incorrectly accesses the destination database connection and so no error code is reported, but the operations may malfunction nevertheless. Use of the destination database connection while a backup is in progress might also also cause a mutex deadlock.<BR>
If running in shared cache mode, the application must guarantee that the shared cache used by the destination database is not accessed while the backup is running. In practice this means that the application must guarantee that the disk file being backed up to is not accessed by any connection within the process, not just the specific connection that was passed to BackupInit.<BR>
The <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object itself is partially threadsafe. Multiple threads may safely make multiple concurrent calls to BackupStep. However, the BackupRemaining and BackupPageCount APIs are not strictly speaking threadsafe. If they are invoked at the same time as another thread is invoking BackupStep it is possible that they return invalid values.<BR>
<BR>
Source and Dest can be <A href="class-sqlconnectionmbs.html">SQLConnectionMBS</A> or <A href="class-sqldatabasembs.html">SQLDatabaseMBS</A>. You need to pass source and dest, even if one is self as we give you the option to decide where to pass the current database connection.<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="3">BackupPageCount(Backup as <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A>) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion124.shtml" class=version>12.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Returns the number of pages in total.<BR>
<B>Notes:</B> 
<BR>
Each call to BackupStep sets two values inside the <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object: the number of pages still to be backed up and the total number of pages in the source databae file. The BackupRemaining and BackupPageCount interfaces retrieve these two values, respectively.<BR>
The values returned by these functions are only updated by BackupStep. If the source database is modified during a backup operation, then the values are not updated to account for any extra pages that need to be updated or the size of the source database file changing.<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="4">BackupRemaining(Backup as <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A>) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion124.shtml" class=version>12.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Returns the number of pages remaining.<BR>
<B>Notes:</B> 
<BR>
Each call to BackupStep sets two values inside the <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object: the number of pages still to be backed up and the total number of pages in the source databae file. The BackupRemaining and BackupPageCount interfaces retrieve these two values, respectively.<BR>
The values returned by these functions are only updated by BackupStep. If the source database is modified during a backup operation, then the values are not updated to account for any extra pages that need to be updated or the size of the source database file changing.<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="5">BackupStep(Backup as <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A>, Pages as Integer) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion124.shtml" class=version>12.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Copies up to Pages pages between the source and destination databases specified by <A href="class-sqlite3backupmbs.html">SQLite3BackupMBS</A> object.<BR>
<B>Notes:</B> 
<BR>
If N is negative, all remaining source pages are copied. If BackupStep(B,N) successfully copies N pages and there are still more pages to be copied, then the function resturns kErrorOK. If BackupStep(B,N) successfully finishes copying all pages from source to destination, then it returns kErrorDone. If an error occurs while running BackupStep(B,N), then an error code is returned. As well as kErrorOK and kErrorDone, a call to BackupStep may return kErrorReadOnly, kErrorNoMem, kErrorBusy, kErrorLocked, or an kErrorIOACCESS | kErrorIOXXX extended error code.<BR>
The BackupStep might return kErrorReadOnly if the destination database was opened read-only or if the destination is an in-memory database with a different page size from the source database.<BR>
If BackupStep cannot obtain a required file-system lock, then the sqlite3_busy_handler | busy-handler function is invoked (if one is specified). If the busy-handler returns non-zero before the lock is available, then kErrorBusy is returned to the caller. In this case the call to BackupStep can be retried later. If the source database connection is being used to write to the source database when BackupStep is called, then kErrorLocked is returned immediately. Again, in this case the call to BackupStep can be retried later on. (If kErrorIOACCESS | kErrorIOXXX, kErrorNoMem, or kErrorReadOnly is returned, then there is no point in retrying the call to BackupStep. These errors are considered fatal.) The application must accept that the backup operation has failed and pass the backup operation handle to the BackupFinish to release associated resources.<BR>
The first call to BackupStep obtains an exclusive lock on the destination file. The exclusive lock is not released until either BackupFinish is called or the backup operation is complete and BackupStep returns kErrorDone. Every call to BackupStep obtains a shared lock on the source database that lasts for the duration of the BackupStep call. Because the source database is not locked between calls to BackupStep, the source database may be modified mid-way through the backup process. If the source database is modified by an external process or via a database connection other than the one being used by the backup operation, then the backup will be automatically restarted by the next call to BackupStep. If the source database is modified by the using the same database connection as is used by the backup operation, then the backup database is automatically updated at the same time.<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="6">EnableLoadExtension(OnOff as boolean)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion144.shtml" class=version>14.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Enables/disables extension loading for the given connection.<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="7">ErrCode as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion124.shtml" class=version>12.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
The ErrCode function returns the numeric result code or extended result code for the most recent failed sqlite3 API call associated with a database connection.<BR>
<B>Notes:</B> 
If a prior API call failed but the most recent API call succeeded, the return value from ErrCode is undefined.<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="8">ErrMessage as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion124.shtml" class=version>12.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Returns the most recent error message in english for the given connection.<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="9">LastInsertRowID as Int64</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion124.shtml" class=version>12.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Returns Last Insert Rowid.<BR>
<B>Notes:</B> 
<BR>
Each entry in an SQLite table has a unique 64-bit signed integer key called the ROWID. The rowid is always available as an undeclared column named ROWID, OID, or _ROWID_ as long as those names are not also used by explicitly declared columns. If the table has a column of type INTEGER PRIMARY KEY then that column is another alias for the rowid.<BR>
<BR>
This routine returns the rowid of the most recent successful INSERT into the database from the database connection in the first argument. If no successful INSERTs have ever occurred on that database connection, zero is returned.<BR>
<BR>
(If an INSERT occurs within a trigger, then the rowid of the inserted row is returned by this routine as long as the trigger is running. But once the trigger terminates, the value returned by this routine reverts to the last value inserted before the trigger fired.)<BR>
<BR>
An INSERT that fails due to a constraint violation is not a successful INSERT and does not change the value returned by this routine.  ^Thus INSERT OR FAIL, INSERT OR IGNORE, INSERT OR ROLLBACK, and INSERT OR ABORT make no changes to the return value of this routine when their insertion fails.  ^(When INSERT OR REPLACE encounters a constraint violation, it does not fail.  The INSERT continues to completion after deleting rows that caused the constraint problem so INSERT OR REPLACE will always change the return value of this interface.)^<BR>
<BR>
For the purposes of this routine, an INSERT is considered to be successful even if it is subsequently rolled back.<BR>
<BR>
This function is accessible to SQL statements via the last_insert_rowid() SQL function.<BR>
<BR>
If a separate thread performs a new INSERT on the same database connection while the LastInsertRowID function is running and thus changes the last insert rowid, then the value returned by LastInsertRowID is unpredictable and might not equal either the old or the new last insert rowid.<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="10">LoadExtension(file as FolderItem, ByRef ErrorMessage as String) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion164.shtml" class=version>16.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Loads an SQLite extension library from the named file.<BR>
<B>Notes:</B> 
<BR>
The LoadExtension interface attempts to load an SQLite extension library contained in the file.<BR>
<BR>
Returns kErrorOk on success and kErrorError if something goes wrong.<BR>
Extension loading must be enabled using EnableLoadExtension prior to calling this API, otherwise an error will be returned.<BR>
<p>See also:<ul>
<li><A href="sql-sqlite3mbs-method.html#11">LoadExtension(path as String, ByRef ErrorMessage as String) as Integer</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="11">LoadExtension(path as String, ByRef ErrorMessage as String) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion164.shtml" class=version>16.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Loads an SQLite extension library from the named file.<BR>
<B>Notes:</B> 
<BR>
The LoadExtension interface attempts to load an SQLite extension library contained in the file.<BR>
<BR>
Returns kErrorOk on success and kErrorError if something goes wrong.<BR>
Extension loading must be enabled using EnableLoadExtension prior to calling this API, otherwise an error will be returned.<BR>
<p>See also:<ul>
<li><A href="sql-sqlite3mbs-method.html#10">LoadExtension(file as FolderItem, ByRef ErrorMessage as String) as Integer</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="12">MemoryHighwater(reset as boolean) as Int64</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion174.shtml" class=version>17.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Queries maximum memory usage so far.<BR>
<B>Notes:</B> 
Can be reset with reset parameter being true.<BR>
<p>See also:<ul>
<li><A href="sql-sqlite3mbs-property.html#2">MemoryHighwater as Int64</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="13">ReKey(Key as String) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion153.shtml" class=version>15.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
You can change the key on a database using the Rekey Function.<BR>
<B>Notes:</B> 
<BR>
An empty key decrypts the database.<BR>
<BR>
Rekeying requires that every page of the database file be read, decrypted, reencrypted with the new key, then written out again. Consequently, rekeying can take a long time on a larger database.<BR>
<BR>
Most SEE variants allow you to encrypt an existing database that was created using the public domain version of SQLite. This is not possible when using the authenticating version of the encryption extension in see-aes128-ccm. If you do encrypt a database that was created with the public domain version of SQLite, no nonce will be used and the file will be vulnerable to a chosen-plaintext attach. If you call SetKey() immediately after Open when you are first creating the database, space will be reserved in the database for a nonce and the encryption will be much stronger. If you do not want to encrypt right away, call SetKey() anyway, with an empty key, and the space for the nonce will be reserved in the database even though no encryption is done initially.<BR>
<BR>
A public domain version of the SQLite library can read and write an encrypted database with an empty key. You only need the encryption extension if the key is non-empty.<BR>
<BR>
Returns a SQLite error code.<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="14">SetBusyHandler(MaxAttempts as Integer = 5)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion161.shtml" class=version>16.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Installs busy handler for this connection.<BR>
<B>Notes:</B> 
<BR>
This routine sets a callback function that might be invoked whenever an attempt is made to open a database table that another thread or process has locked.<BR>
<BR>
The plugin has an busy handler which will wait up to MaxAttemps and yield to other Xojo threads while waiting.<BR>
Passing 5 should wait up to 100ms.<BR>
<BR>
There can only be a single busy handler defined for each [database connection].  Setting a new busy handler clears any previously set handler.)  Note that calling SetBusyTimeout will also set or clear the busy handler.<BR>
<BR>
The busy callback should not take any actions which modify the database connection that invoked the busy handler.  Any such actions result in undefined behavior.<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="15">SetBusyTimeout(TimeOutMS as Integer = 20)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion161.shtml" class=version>16.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
This routine sets a busy handler that sleeps for a specified amount of time when a table is locked. <BR>
<B>Notes:</B> 
<BR>
The handler will sleep multiple times until at least &quot;ms&quot; milliseconds of sleeping have accumulated.  ^After at least &quot;ms&quot; milliseconds of sleeping, the handler returns 0 which causes SQLite query to return SQLite Busy or IO Blocked error.<BR>
<BR>
Calling this routine with an argument less than or equal to zero turns off all busy handlers.<BR>
<BR>
(There can only be a single busy handler for a particular database connection any any given moment.  If another busy handler was defined  (using SetBusyHandler prior to calling this routine, that other busy handler is cleared.)<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="16">SetKey(Key as String) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion153.shtml" class=version>15.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Applies encryption to a database connection.<BR>
<B>Notes:</B> 
<BR>
Returns a SQLite error code.<BR>
<BR>
The amount of key material actually used by the encryption extension depends on which variant of SEE you are using. With RC4, the first 256 byte of key are used. With the AES128, the first 16 bytes of the key are used. With AES256, the first 32 bytes of key are used.<BR>
<BR>
If you specify a key that is shorter than the maximum key length, then the key material is repeated as many times as necessary to complete the key. If you specify a key that is larger than the maximum key length, then the excess key material is silently ignored.<BR>
<BR>
The key must begin with an ASCII prefix to specify which algorithm to use. The prefix must be one of &quot;rc4:&quot;, &quot;aes128:&quot;, or &quot;aes256:&quot;. The prefix is not used as part of the key sent into the encryption algorithm. So the real key should begin on the first byte after the prefix.<BR>
<BR>
The string provided to the plugin is used with it&#39;s current encoding. So be sure you use right text encoding for what you want. e.g. using &quot;M&uuml;ller&quot; as key in text encoding Windows ANSI will not open a database which used that key in UTF-8 encoding.<BR>
<BR>
The Xojo database encryption in SQLiteDatabase class uses AES-128 OFB.<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="17">TableColumnMetaData(DBName as string, TableName as string, ColumnName as string, byref DataType as string, byref CollationSequence as string, byref NotNull as boolean, byref PrimaryKey as boolean, byref AutoIncrement as Boolean) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion124.shtml" class=version>12.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Extract Metadata About A Column Of A Table<BR>
<B>Notes:</B> 
<BR>
Not available in all sqlite libraries!<BR>
<BR>
This routine returns metadata about a specific column of a specific database table accessible using the database connection handle passed as the first function argument.<BR>
The column is identified by the second, third and fourth parameters to this function. The second parameter is either the name of the database (i.e. &quot;main&quot;, &quot;temp&quot;, or an attached database) containing the specified table or NULL. If it is NULL, then all attached databases are searched for the table using the same algorithm used by the database engine to resolve unqualified table references.<BR>
The third and fourth parameters to this function are the table and column name of the desired column, respectively. Neither of these parameters may be NULL.<BR>
Metadata is returned by writing to the memory locations passed as the 5th and subsequent parameters to this function. Any of these arguments may be NULL, in which case the corresponding element of metadata is omitted.<BR>
<BR>
CollationSequence is assigned the Name of default collation sequence. NotNull is set to true if column has a NOT NULL constraint. PrimaryKey is set to true if column is part of the PRIMARY KEY and AutoIncrement is set to true if column is AUTOINCREMENT.<BR>
<BR>
If the specified table is actually a view, an error code is returned.<BR>
<BR>
If the specified column is &quot;rowid&quot;, &quot;oid&quot; or &quot;_rowid_&quot; and an INTEGER PRIMARY KEY column has been explicitly declared, then the output parameters are set for the explicitly declared column. (If there is no explicitly declared INTEGER PRIMARY KEY column, then the output parameters are set as follows:<BR>
<BR>
data type: &quot;INTEGER&quot;<BR>
collation sequence: &quot;BINARY&quot;<BR>
not null: false<BR>
primary key: true<BR>
auto increment: false<BR>
<BR>
(This function may load one or more schemas from database files. If an error occurs during this process, or if the requested table or column cannot be found, an error code is returned and an error message left in the database connection (to be retrieved using ErrMessage).)<BR>
<BR>
This API is only available if the library was compiled with the SQLITE_ENABLE_COLUMN_METADATA C-preprocessor symbol defined.<BR>
</div>
<div class="WLM">
<b><a href="class-sqlite3mbs.html">SQLite3MBS</a>.<A name="18">Threadsafe as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-sql.html" translate="no">SQL</A></td>
<td class=grau><a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a></td>
<td class=grau><a href="newinversion124.shtml" class=version>12.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Test To See If The Library Is Threadsafe.<BR>
<B>Notes:</B> 
<BR>
The threadsafe() function returns zero if and only if SQLite was compiled mutexing code omitted due to the SQLITE_THREADSAFE compile-time option being set to 0.<BR>
<BR>
SQLite can be compiled with or without mutexes.  When the SQLITE_THREADSAFE C preprocessor macro is 1 or 2, mutexes are enabled and SQLite is threadsafe.  When the SQLITE_THREADSAFE macro is 0, the mutexes are omitted.  Without the mutexes, it is not safe  to use SQLite concurrently from more than one thread.<BR>
<BR>
Enabling mutexes incurs a measurable performance penalty. So if speed is of utmost importance, it makes sense to disable the mutexes.  But for maximum safety, mutexes should be enabled. The default behavior is for mutexes to be enabled.<BR>
<BR>
This interface can be used by an application to make sure that the version of SQLite that it is linking against was compiled with the desired setting of the SQLITE_THREADSAFE macro.<BR>
<BR>
This interface only reports on the compile-time mutex setting of the SQLITE_THREADSAFE flag.  If SQLite is compiled with SQLITE_THREADSAFE=1 or =2 then mutexes are enabled by default but can be fully or partially disabled using a call to sqlite3_config() with the verbs SQLITE_CONFIG_SINGLETHREAD, SQLITE_CONFIG_MULTITHREAD, or SQLITE_CONFIG_MUTEX.  ^(The return value of the sqlite3_threadsafe() function shows only the compile-time setting of thread safety, not any run-time changes to that setting made by sqlite3_config(). In other words, the return value from sqlite3_threadsafe() is unchanged by calls to sqlite3_config().)^<BR>
<BR>
See the threading mode documentation for additional information.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbssqlplugin.html">MBS SQL Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=sql-sqlite3mbs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

