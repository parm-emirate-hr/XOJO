<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /ChartDirector/finance with ChartDirector Control</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /ChartDirector/finance with ChartDirector Control</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/ChartDirector/finance with ChartDirector Control</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS ChartDirector Plugin, MBS Images Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /ChartDirector/finance with ChartDirector Control<BR>
This example is the version from Mon, 12th Jan 2020.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;finance</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">ChartDirector</span> <span style="color:#6500FE">Control.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kEditClear = <span style="color:#6500FE">&quot;&amp;L&ouml;schen&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuit = <span style="color:#6500FE">&quot;Beenden&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuitShortcut = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> PicWindow <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control ChartDirectorControl1 <span style="color:#0000FF;font-weight: bold">Inherits</span> ChartDirectorControl</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance ChartDirectorControl1 <span style="color:#0000FF;font-weight: bold">Inherits</span> ChartDirectorControl</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> Render(ViewPort <span style="color:#0000FF;font-weight: bold">As</span> CDViewPortManagerMBS, Factor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Width <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Height <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Create</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">finance</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">demo</span> <span style="color:#7F0000;text-style:italic">containing</span> <span style="color:#7F0000;text-style:italic">100</span> <span style="color:#7F0000;text-style:italic">days</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">data</span>
				<span style="color:#0000FF;font-weight: bold">const</span> noOfDays = <span style="color:#326598">100</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">To</span> <span style="color:#7F0000;text-style:italic">compute</span> <span style="color:#7F0000;text-style:italic">moving</span> <span style="color:#7F0000;text-style:italic">averages</span> <span style="color:#7F0000;text-style:italic">starting</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">first</span> <span style="color:#7F0000;text-style:italic">day,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">extra</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">points</span> <span style="color:#7F0000;text-style:italic">before</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">first</span> <span style="color:#7F0000;text-style:italic">day</span>
				<span style="color:#0000FF;font-weight: bold">const</span> extraDays = <span style="color:#326598">30</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">exammple,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">random</span> <span style="color:#7F0000;text-style:italic">number</span> <span style="color:#7F0000;text-style:italic">generator</span> <span style="color:#7F0000;text-style:italic">utility</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">simulate</span> <span style="color:#7F0000;text-style:italic">the</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">data.</span> <span style="color:#7F0000;text-style:italic">We</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">random</span> <span style="color:#7F0000;text-style:italic">table</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">6</span> <span style="color:#7F0000;text-style:italic">cols</span> <span style="color:#7F0000;text-style:italic">x</span> <span style="color:#7F0000;text-style:italic">(noOfDays</span> <span style="color:#7F0000;text-style:italic">+</span> <span style="color:#7F0000;text-style:italic">extraDays)</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">rows,</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">9</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">seed.</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> rantable <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> CDRanTableMBS(<span style="color:#326598">9</span>, <span style="color:#326598">6</span>, noOfDays + extraDays)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">1st</span> <span style="color:#7F0000;text-style:italic">col</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">timeStamp,</span> <span style="color:#7F0000;text-style:italic">starting</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">Sep</span> <span style="color:#7F0000;text-style:italic">4,</span> <span style="color:#7F0000;text-style:italic">2002,</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">each</span> <span style="color:#7F0000;text-style:italic">row</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">representing</span> <span style="color:#7F0000;text-style:italic">one</span> <span style="color:#7F0000;text-style:italic">day,</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">counting</span> <span style="color:#7F0000;text-style:italic">week</span> <span style="color:#7F0000;text-style:italic">days</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">(jump</span> <span style="color:#7F0000;text-style:italic">over</span> <span style="color:#7F0000;text-style:italic">Sat</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">Sun)</span>
				rantable.setDateCol(<span style="color:#326598">0</span>, CDFinanceChartMBS.chartTime(<span style="color:#326598">2002</span>, <span style="color:#326598">9</span>, <span style="color:#326598">4</span>), <span style="color:#326598">86400</span>, <span style="color:#0000FF;font-weight: bold">true</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">2nd,</span> <span style="color:#7F0000;text-style:italic">3rd,</span> <span style="color:#7F0000;text-style:italic">4th</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">5th</span> <span style="color:#7F0000;text-style:italic">columns</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">high,</span> <span style="color:#7F0000;text-style:italic">low,</span> <span style="color:#7F0000;text-style:italic">open</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">close</span> <span style="color:#7F0000;text-style:italic">data.</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">open</span> <span style="color:#7F0000;text-style:italic">value</span> <span style="color:#7F0000;text-style:italic">starts</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">100,</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">daily</span> <span style="color:#7F0000;text-style:italic">change</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">random</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">-5</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">5.</span>
				rantable.setHLOCCols(<span style="color:#326598">1</span>, <span style="color:#326598">100</span>, -<span style="color:#326598">5</span>, <span style="color:#326598">5</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">6th</span> <span style="color:#7F0000;text-style:italic">column</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">vol</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">5</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">25</span> <span style="color:#7F0000;text-style:italic">million</span>
				rantable.setCol(<span style="color:#326598">5</span>, <span style="color:#326598">50000000</span>, <span style="color:#326598">250000000</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Now</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">read</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">table</span> <span style="color:#7F0000;text-style:italic">into</span> <span style="color:#7F0000;text-style:italic">arrays</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> timeStamps(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = rantable.getCol(<span style="color:#326598">0</span>).Values
				<span style="color:#0000FF;font-weight: bold">dim</span> highData(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = rantable.getCol(<span style="color:#326598">1</span>).Values
				<span style="color:#0000FF;font-weight: bold">dim</span> lowData(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = rantable.getCol(<span style="color:#326598">2</span>).Values
				<span style="color:#0000FF;font-weight: bold">dim</span> openData(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = rantable.getCol(<span style="color:#326598">3</span>).Values
				<span style="color:#0000FF;font-weight: bold">dim</span> closeData(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = rantable.getCol(<span style="color:#326598">4</span>).Values
				<span style="color:#0000FF;font-weight: bold">dim</span> volData(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = rantable.getCol(<span style="color:#326598">5</span>).Values
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Create</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">FinanceChart</span> <span style="color:#7F0000;text-style:italic">object</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">640</span> <span style="color:#7F0000;text-style:italic">pixels</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> CDFinanceChartMBS(<span style="color:#326598">640</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">title</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.addTitle(<span style="color:#6500FE">&quot;Finance</span> <span style="color:#6500FE">Chart</span> <span style="color:#6500FE">Demonstration&quot;</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">into</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">finance</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">object</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.setData(timeStamps, highData, lowData, openData, closeData, volData, extraDays)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">main</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">240</span> <span style="color:#7F0000;text-style:italic">pixels</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">height</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.addMainChart(<span style="color:#326598">240</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">5</span> <span style="color:#7F0000;text-style:italic">period</span> <span style="color:#7F0000;text-style:italic">simple</span> <span style="color:#7F0000;text-style:italic">moving</span> <span style="color:#7F0000;text-style:italic">average</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">main</span> <span style="color:#7F0000;text-style:italic">chart,</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">brown</span> <span style="color:#7F0000;text-style:italic">color</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.addSimpleMovingAvg(<span style="color:#326598">5</span>, <span style="color:#326598">&amp;h663300</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">20</span> <span style="color:#7F0000;text-style:italic">period</span> <span style="color:#7F0000;text-style:italic">simple</span> <span style="color:#7F0000;text-style:italic">moving</span> <span style="color:#7F0000;text-style:italic">average</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">main</span> <span style="color:#7F0000;text-style:italic">chart,</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">purple</span> <span style="color:#7F0000;text-style:italic">color</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.addSimpleMovingAvg(<span style="color:#326598">20</span>, <span style="color:#326598">&amp;h9900ff</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">HLOC</span> <span style="color:#7F0000;text-style:italic">symbols</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">main</span> <span style="color:#7F0000;text-style:italic">chart,</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">green/red</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">up/down</span> <span style="color:#7F0000;text-style:italic">days</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.addHLOC(<span style="color:#326598">&amp;h008000</span>, <span style="color:#326598">&amp;hcc0000</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">20</span> <span style="color:#7F0000;text-style:italic">days</span> <span style="color:#7F0000;text-style:italic">bollinger</span> <span style="color:#7F0000;text-style:italic">band</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">main</span> <span style="color:#7F0000;text-style:italic">chart,</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">light</span> <span style="color:#7F0000;text-style:italic">blue</span> <span style="color:#7F0000;text-style:italic">(9999ff)</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">the</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">border</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">semi-transparent</span> <span style="color:#7F0000;text-style:italic">blue</span> <span style="color:#7F0000;text-style:italic">(c06666ff)</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">fill</span> <span style="color:#7F0000;text-style:italic">color</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.addBollingerBand(<span style="color:#326598">20</span>, <span style="color:#326598">2</span>, <span style="color:#326598">&amp;h9999ff</span>, <span style="color:#326598">&amp;hc06666ff</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">75</span> <span style="color:#7F0000;text-style:italic">pixels</span> <span style="color:#7F0000;text-style:italic">volume</span> <span style="color:#7F0000;text-style:italic">bars</span> <span style="color:#7F0000;text-style:italic">sub-chart</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">bottom</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">main</span> <span style="color:#7F0000;text-style:italic">chart,</span> <span style="color:#7F0000;text-style:italic">using</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">green/red/grey</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">up/down/flat</span> <span style="color:#7F0000;text-style:italic">days</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.addVolBars(<span style="color:#326598">75</span>, <span style="color:#326598">&amp;h99ff99</span>, <span style="color:#326598">&amp;hff9999</span>, <span style="color:#326598">&amp;h808080</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Append</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">14-days</span> <span style="color:#7F0000;text-style:italic">RSI</span> <span style="color:#7F0000;text-style:italic">indicator</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">(75</span> <span style="color:#7F0000;text-style:italic">pixels</span> <span style="color:#7F0000;text-style:italic">high)</span> <span style="color:#7F0000;text-style:italic">after</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">main</span> <span style="color:#7F0000;text-style:italic">chart.</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">main</span> <span style="color:#7F0000;text-style:italic">RSI</span> <span style="color:#7F0000;text-style:italic">line</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">purple</span> <span style="color:#7F0000;text-style:italic">(800080).</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">threshold</span> <span style="color:#7F0000;text-style:italic">region</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">+/-</span> <span style="color:#7F0000;text-style:italic">20</span> <span style="color:#7F0000;text-style:italic">(that</span> <span style="color:#7F0000;text-style:italic">is,</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">RSI</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">50</span> <span style="color:#7F0000;text-style:italic">+/-</span> <span style="color:#7F0000;text-style:italic">25).</span> <span style="color:#7F0000;text-style:italic">The</span> <span style="color:#7F0000;text-style:italic">upper/lower</span> <span style="color:#7F0000;text-style:italic">threshold</span> <span style="color:#7F0000;text-style:italic">regions</span> <span style="color:#7F0000;text-style:italic">will</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">filled</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">red</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">(ff0000)/blue</span> <span style="color:#7F0000;text-style:italic">(0000ff).</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.addRSI(<span style="color:#326598">75</span>, <span style="color:#326598">14</span>, <span style="color:#326598">&amp;h800080</span>, <span style="color:#326598">20</span>, <span style="color:#326598">&amp;hff0000</span>, <span style="color:#326598">&amp;h0000ff</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Append</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">12-days</span> <span style="color:#7F0000;text-style:italic">momentum</span> <span style="color:#7F0000;text-style:italic">indicator</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">(75</span> <span style="color:#7F0000;text-style:italic">pixels</span> <span style="color:#7F0000;text-style:italic">high)</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">blue</span> <span style="color:#7F0000;text-style:italic">(0000ff)</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">color.</span>
				<span style="color:#0000FF;font-weight: bold">call</span> c.addMomentum(<span style="color:#326598">75</span>, <span style="color:#326598">12</span>, <span style="color:#326598">&amp;h0000ff</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Output</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span>
				
				<span style="color:#0000FF;font-weight: bold">Return</span> c
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar MenuBar1</div>
<div class="RB_Code">		MenuItem FileMenu = <span style="color:#6500FE">&quot;&amp;Ablage&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;#App.kFileQuit&quot;</span></div>
<div class="RB_Code">		MenuItem EditMenu = <span style="color:#6500FE">&quot;&amp;Bearbeiten&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;&amp;R&uuml;ckg&auml;ngig&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu1 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;&amp;Ausschneiden&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;&amp;Kopieren&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;&amp;Einf&uuml;gen&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;#App.kEditClear&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu0 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditSelectAll = <span style="color:#6500FE">&quot;&amp;Alles</span> <span style="color:#6500FE">ausw&auml;hlen&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ChartDirectorControl <span style="color:#0000FF;font-weight: bold">Inherits</span> Canvas</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kModeDefault = <span style="color:#326598">0</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kModeMove = <span style="color:#326598">1</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kModeZoomIn = <span style="color:#326598">2</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kModeZoomOut = <span style="color:#326598">3</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> ItemClicked(XLabel <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, DataSet <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, DataSetName <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, Value <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Title <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>, Sector <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Label <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> Open()
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> Render(ViewPort <span style="color:#0000FF;font-weight: bold">As</span> CDViewPortManagerMBS, Factor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Width <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Height <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> MouseDown(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			isMouseDown = <span style="color:#0000FF;font-weight: bold">true</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (AllowZoom = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">And</span> (Keyboard.AsyncOptionKey = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span>
				Mode = kModeZoomIn
				
				StartX = X
				StartY = Y
				StartX2 = X
				StartY2 = Y
				
			<span style="color:#0000FF;font-weight: bold">ElseIf</span> (AllowZoom = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">And</span> (Keyboard.AsyncShiftKey = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">Out</span>
				Mode = kModeZoomOut
				
				StartX = X
				StartY = Y
				StartX2 = X
				StartY2 = Y
				
			<span style="color:#0000FF;font-weight: bold">Else</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> HotSpotID <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">over</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">hotspot;</span> <span style="color:#7F0000;text-style:italic">Nil</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">prevents</span> <span style="color:#7F0000;text-style:italic">spurious</span> <span style="color:#7F0000;text-style:italic">NilObjectExceptions</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (ImageMapHandler &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span> HotSpotID = ImageMapHandler.getHotSpot(X, Y)
				
				<span style="color:#0000FF;font-weight: bold">If</span> (HotSpotID &gt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Click</span>
					Mode = kModeDefault
					
					SendClickEvent
					
				<span style="color:#0000FF;font-weight: bold">ElseIf</span> (AllowMove = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Move</span>
					Mode = kModeMove
					
					MouseCursor = System.Cursors.HandClosed
					StartX = X
					StartY = Y
					ViewPort.startDrag  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Call</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">initiate</span> <span style="color:#7F0000;text-style:italic">drag</span> <span style="color:#7F0000;text-style:italic">within</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ViewPort</span>
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			
			<span style="color:#0000FF;font-weight: bold">Return</span> (<span style="color:#0000FF;font-weight: bold">True</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseDrag(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">If</span> (Mode = kModeMove) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">been</span> <span style="color:#7F0000;text-style:italic">dragged/repositioned</span> <span style="color:#7F0000;text-style:italic">then</span> <span style="color:#7F0000;text-style:italic">complete</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ViewPort</span> <span style="color:#7F0000;text-style:italic">drag</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">refresh</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">image</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.dragTo(CDBaseChartMBS.kDirectionHorizontalVertical, StartX - X, Y - StartY) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span> Redraw
				
				
			<span style="color:#0000FF;font-weight: bold">ElseIf</span> (Mode = kModeZoomIn) <span style="color:#0000FF;font-weight: bold">Or</span> (Mode = kModeZoomOut) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Calculate</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">coordinates</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">scaling/drawing</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">rectangle</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> L, T, W, H <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
				
				StartX2 = X
				StartY2 = Y
				
				L = Min(StartX, StartX2)
				T = Min(StartY, StartY2)
				W = StartX2 - StartX
				H = StartY2 - StartY
				
				<span style="color:#0000FF;font-weight: bold">If</span> (W &lt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span> W = -W
				<span style="color:#0000FF;font-weight: bold">If</span> (H &lt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span> H = -H
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Composite</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">rectangle</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">trigger</span> <span style="color:#7F0000;text-style:italic">refresh</span>
				RectangleTop = t
				rectangleLeft = l
				rectangleWidth = w
				rectangleHeight = h
				<span style="color:#0000FF;font-weight: bold">me</span>.Invalidate
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseExit()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finalize</span> <span style="color:#7F0000;text-style:italic">redraw</span>
			CleanUp
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseMove(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">If</span> (AllowZoom = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">And</span> (Keyboard.AsyncOptionKey = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span>
				MouseCursor = System.Cursors.MagnifyLarger
				CleanUp  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finalize</span> <span style="color:#7F0000;text-style:italic">redraw</span>
				
			<span style="color:#0000FF;font-weight: bold">ElseIf</span> (AllowZoom = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">And</span> (Keyboard.AsyncShiftKey = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">Out</span>
				MouseCursor = System.Cursors.MagnifySmaller
				CleanUp  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finalize</span> <span style="color:#7F0000;text-style:italic">redraw</span>
				
			<span style="color:#0000FF;font-weight: bold">Else</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> HotSpotID <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">over</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">hotspot;</span> <span style="color:#7F0000;text-style:italic">Nil</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">prevents</span> <span style="color:#7F0000;text-style:italic">spurious</span> <span style="color:#7F0000;text-style:italic">NilObjectExceptions</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (ImageMapHandler &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span> HotSpotID = ImageMapHandler.getHotSpot(X, Y)
				
				<span style="color:#0000FF;font-weight: bold">If</span> (HotSpotID &gt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					MouseCursor = System.Cursors.StandardPointer
					
					DrawItemInfo(X, Y)
					
				<span style="color:#0000FF;font-weight: bold">ElseIf</span> (AllowMove = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					MouseCursor = System.Cursors.HandOpen
					CleanUp  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finalize</span> <span style="color:#7F0000;text-style:italic">redraw</span>
					
				<span style="color:#0000FF;font-weight: bold">Else</span>
					
					MouseCursor = System.Cursors.StandardPointer
					CleanUp  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finalize</span> <span style="color:#7F0000;text-style:italic">redraw</span>
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MouseUp(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			isMouseDown = <span style="color:#0000FF;font-weight: bold">false</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> (Mode = kModeMove) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Move</span>
				MouseCursor=System.Cursors.HandOpen
				
			<span style="color:#0000FF;font-weight: bold">ElseIf</span> (Mode = kModeZoomIn) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">(On</span> <span style="color:#7F0000;text-style:italic">Point)</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (Abs(X - StartX) &lt; <span style="color:#326598">3</span>) <span style="color:#0000FF;font-weight: bold">And</span> (Abs(Y - StartY) &lt; <span style="color:#326598">3</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">(On</span> <span style="color:#7F0000;text-style:italic">Point)</span>
					<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.canZoomIn(CDBaseChartMBS.kDirectionHorizontalVertical) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
						<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.zoomAt(CDBaseChartMBS.kDirectionHorizontalVertical, X, Y, ZoomInRatio) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span> Redraw
					<span style="color:#0000FF;font-weight: bold">Else</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Cannot</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">in...</span>
						Redraw
						Beep
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
					
				<span style="color:#0000FF;font-weight: bold">Else</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">(On</span> <span style="color:#7F0000;text-style:italic">Rectangle)</span>
					<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.canZoomIn(CDBaseChartMBS.kDirectionHorizontalVertical) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
						<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.zoomTo(CDBaseChartMBS.kDirectionHorizontalVertical, X, Y, StartX, StartY) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span> Redraw
					<span style="color:#0000FF;font-weight: bold">Else</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Cannot</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">in...</span>
						Redraw
						Beep
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">ElseIf</span> (Mode = kModeZoomOut) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">Out</span> <span style="color:#7F0000;text-style:italic">(On</span> <span style="color:#7F0000;text-style:italic">Point)</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.canZoomOut(CDBaseChartMBS.kDirectionHorizontalVertical) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					<span style="color:#0000FF;font-weight: bold">If</span> (ViewPort.zoomAt(CDBaseChartMBS.kDirectionHorizontalVertical, X, Y, ZoomOutRatio) = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span> Redraw
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Cannot</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">out...</span>
					Redraw
					Beep
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Initialize</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ViewPort</span> <span style="color:#7F0000;text-style:italic">manager</span> <span style="color:#7F0000;text-style:italic">class</span>
			ViewPort = <span style="color:#0000FF;font-weight: bold">New</span> CDViewPortManagerMBS
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">ViewPort</span> <span style="color:#7F0000;text-style:italic">coordinant</span> <span style="color:#7F0000;text-style:italic">constraints</span>
			ViewPort.setViewPortHeight(<span style="color:#006532">1.0</span>)
			ViewPort.setViewPortTop(<span style="color:#006532">0.0</span>)
			ViewPort.setViewPortWidth(<span style="color:#006532">1.0</span>)
			ViewPort.setViewPortLeft(<span style="color:#006532">0.0</span>)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">Out</span> <span style="color:#7F0000;text-style:italic">constraints</span> <span style="color:#7F0000;text-style:italic">(if</span> <span style="color:#7F0000;text-style:italic">desired;</span> <span style="color:#7F0000;text-style:italic">otherwise</span> <span style="color:#7F0000;text-style:italic">allow</span> <span style="color:#7F0000;text-style:italic">infinite</span> <span style="color:#7F0000;text-style:italic">zoom)</span>
			<span style="color:#7F0000;text-style:italic">&#39;ViewPort.setZoomInWidthLimit(0.01)</span>
			<span style="color:#7F0000;text-style:italic">&#39;ViewPort.setZoomInHeightLimit(0.01)</span>
			<span style="color:#7F0000;text-style:italic">&#39;ViewPort.setZoomOutWidthLimit(1.0)</span>
			<span style="color:#7F0000;text-style:italic">&#39;ViewPort.setZoomOutHeightLimit(1.0)</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Initialize</span> <span style="color:#7F0000;text-style:italic">scalable</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">rendering</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">rectangle</span>
			RectanglePicture = <span style="color:#0000FF;font-weight: bold">New</span> Picture(<span style="color:#326598">32</span>, <span style="color:#326598">32</span>, <span style="color:#326598">32</span>)
			RectanglePicture.Graphics.ForeColor = &amp;c<span style="color:#FF0000">FF</span><span style="color:#00FF00">00</span><span style="color:#0000FF">00</span>
			RectanglePicture.Graphics.FillRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, <span style="color:#326598">32</span>, <span style="color:#326598">32</span>)
			RectanglePicture.Mask.Graphics.ForeColor = &amp;c<span style="color:#FF0000">CC</span><span style="color:#00FF00">CC</span><span style="color:#0000FF">CC</span>
			RectanglePicture.Mask.Graphics.FillRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, <span style="color:#326598">32</span>, <span style="color:#326598">32</span>)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">initial</span> <span style="color:#7F0000;text-style:italic">cursor</span> <span style="color:#7F0000;text-style:italic">style</span>
			MouseCursor = System.Cursors.HandOpen
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Call</span> <span style="color:#7F0000;text-style:italic">overridden</span> <span style="color:#7F0000;text-style:italic">superclass</span> <span style="color:#7F0000;text-style:italic">method</span>
			Open
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">fix</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">properties</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">wrong</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">IDE</span>
			
			<span style="color:#0000FF;font-weight: bold">me</span>.DoubleBuffer = <span style="color:#0000FF;font-weight: bold">false</span>
			<span style="color:#0000FF;font-weight: bold">me</span>.EraseBackground = <span style="color:#0000FF;font-weight: bold">false</span>
			
			<span style="color:#0000FF">#if</span> RBVersion &gt;= <span style="color:#006532">2013.0</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">me</span>.Transparent = <span style="color:#0000FF;font-weight: bold">False</span>
			<span style="color:#0000FF">#endif</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Paint(g <span style="color:#0000FF;font-weight: bold">As</span> Graphics, areas() <span style="color:#0000FF;font-weight: bold">As</span> REALbasic.Rect)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Handle</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">composited</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">region</span>
			<span style="color:#0000FF;font-weight: bold">If</span> overlay &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				g.DrawPicture overlay,<span style="color:#326598">0</span>,<span style="color:#326598">0</span>
			<span style="color:#0000FF;font-weight: bold">Else</span>
				Draw(G)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> CleanUp()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finalize</span> <span style="color:#7F0000;text-style:italic">redraw</span>
			<span style="color:#0000FF;font-weight: bold">Me</span>.rectangleWidth = <span style="color:#326598">0</span>
			<span style="color:#0000FF;font-weight: bold">Me</span>.Invalidate
			<span style="color:#0000FF;font-weight: bold">Me</span>.NeedClear = <span style="color:#0000FF;font-weight: bold">False</span>
			<span style="color:#0000FF;font-weight: bold">Me</span>.Overlay = <span style="color:#0000FF;font-weight: bold">Nil</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> CurrentPicture() <span style="color:#0000FF;font-weight: bold">As</span> Picture
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Return</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">currently</span> <span style="color:#7F0000;text-style:italic">displayed</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span>
			<span style="color:#0000FF;font-weight: bold">Return</span> (LastPicture)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> Draw(G <span style="color:#0000FF;font-weight: bold">As</span> Graphics)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Prepare</span> <span style="color:#7F0000;text-style:italic">ViewPort</span> <span style="color:#7F0000;text-style:italic">coordinates</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">rendering</span>
			ViewPort.validateViewPort
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Trigger</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">rendering</span> <span style="color:#7F0000;text-style:italic">(actual</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">configuration</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">plotting)</span>
			Current = Render(ViewPort, <span style="color:#006532">1.0</span>, G.Width, G.Height)
			
			
			<span style="color:#0000FF;font-weight: bold">If</span> (Current = <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">there</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">no</span> <span style="color:#7F0000;text-style:italic">valid</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">object</span> <span style="color:#7F0000;text-style:italic">returned,</span> <span style="color:#7F0000;text-style:italic">clear</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">region</span>
				G.ClearRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, G.Width, G.Height)
				
				
			<span style="color:#0000FF;font-weight: bold">Else</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> RenderWithTransparency <span style="color:#0000FF;font-weight: bold">then</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">in-memory</span> <span style="color:#7F0000;text-style:italic">version</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">PNG</span> <span style="color:#7F0000;text-style:italic">format</span> <span style="color:#7F0000;text-style:italic">(supports</span> <span style="color:#7F0000;text-style:italic">transparency)</span>
					<span style="color:#0000FF;font-weight: bold">Dim</span> S <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
					S = Current.makeChart(CDBaseChartMBS.kPNG)
					
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Error</span> <span style="color:#7F0000;text-style:italic">check</span>
					<span style="color:#0000FF;font-weight: bold">If</span> (S = <span style="color:#6500FE">&quot;&quot;</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
						G.ClearRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, G.Width, G.Height)
						<span style="color:#0000FF;font-weight: bold">Return</span>
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
					
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Generate</span> <span style="color:#7F0000;text-style:italic">RB</span> <span style="color:#7F0000;text-style:italic">Picture</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">data</span>
					LastPicture = PNGStringToPictureMBS(S, <span style="color:#326598">0</span>)
				<span style="color:#0000FF;font-weight: bold">else</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">based</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">returned</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">object</span>
					LastPicture = Current.makeChartPicture
					
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Support</span> <span style="color:#7F0000;text-style:italic">overlay</span> <span style="color:#7F0000;text-style:italic">picture</span> <span style="color:#7F0000;text-style:italic">drawing</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (OverlayPicture &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					LastPicture.Graphics.DrawPicture(OverlayPicture, (G.Width - OverlayPicture.Width) / <span style="color:#326598">2</span>, (G.Height - OverlayPicture.Height) / <span style="color:#326598">2</span>)
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Support</span> <span style="color:#7F0000;text-style:italic">control</span> <span style="color:#7F0000;text-style:italic">border</span> <span style="color:#7F0000;text-style:italic">drawing</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (Border = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					LastPicture.Graphics.PenHeight = <span style="color:#326598">1</span>
					LastPicture.Graphics.PenWidth = <span style="color:#326598">1</span>
					LastPicture.Graphics.ForeColor = &amp;c<span style="color:#FF0000">00</span><span style="color:#00FF00">00</span><span style="color:#0000FF">00</span>
					LastPicture.Graphics.DrawRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, G.Width, G.Height)
					
					LastPicture.Mask.Graphics.PenHeight = <span style="color:#326598">1</span>
					LastPicture.Mask.Graphics.PenWidth = <span style="color:#326598">1</span>
					LastPicture.Mask.Graphics.ForeColor = &amp;c<span style="color:#FF0000">00</span><span style="color:#00FF00">00</span><span style="color:#0000FF">00</span>
					LastPicture.Mask.Graphics.DrawRect(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, G.Width, G.Height)
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> CleanGraphicsBeforeDrawing <span style="color:#0000FF;font-weight: bold">then</span>
					g.ClearRect <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, g.Width, g.Height
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">composited</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span>
				G.DrawPicture(LastPicture, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>)
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">ViewPort</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">coordinants</span>
				ViewPort.setChartMetrics(Current.getChartMetrics)
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Process</span> <span style="color:#7F0000;text-style:italic">ImageMap</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">support</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">point</span> <span style="color:#7F0000;text-style:italic">rollovers,</span> <span style="color:#7F0000;text-style:italic">etc.</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> ImageMapString <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
				
				ImageMapString = Current.getHTMLImageMap(<span style="color:#6500FE">&quot;myurl&quot;</span> )
				ImageMapHandler = <span style="color:#0000FF;font-weight: bold">New</span> CDImageMapHandlerMBS(ImageMapString)
				
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> DrawItemInfo(X <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">Dim</span> Index <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Key, KeyValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> XLabel <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> XValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> DataSet <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> DataSetName <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Value <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Title <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Sector <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Label <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Error</span> <span style="color:#7F0000;text-style:italic">check</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (ImageMapHandler = <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Do</span> <span style="color:#7F0000;text-style:italic">key/value</span> <span style="color:#7F0000;text-style:italic">pair</span> <span style="color:#7F0000;text-style:italic">priming</span> <span style="color:#7F0000;text-style:italic">calls</span>
			Index = <span style="color:#326598">0</span>
			Key = ImageMapHandler.getKey(Index)
			KeyValue = ImageMapHandler.getValue(Index)
			
			
			<span style="color:#0000FF;font-weight: bold">Do</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">NOTE:</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">complete</span> <span style="color:#7F0000;text-style:italic">supported</span> <span style="color:#7F0000;text-style:italic">list</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">parameters;</span> <span style="color:#7F0000;text-style:italic">Refer</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">ChartDirector</span> <span style="color:#7F0000;text-style:italic">documentation</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">&#39;Parameter</span> <span style="color:#7F0000;text-style:italic">Substitution</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">Formatting&#39;</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">additional</span> <span style="color:#7F0000;text-style:italic">parameters</span>
				<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> Key
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;xlabel&quot;</span>
					XLabel = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;x&quot;</span>
					XValue = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;dataset&quot;</span>
					DataSet = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;datasetname&quot;</span>
					DataSetName = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;value&quot;</span>
					Value = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;title&quot;</span>
					Title = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;sector&quot;</span>
					Sector = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;label&quot;</span>
					Label = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
				
				Index = Index + <span style="color:#326598">1</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">next</span> <span style="color:#7F0000;text-style:italic">key/value</span> <span style="color:#7F0000;text-style:italic">pair</span>
				Key = ImageMapHandler.getKey(Index)
				KeyValue = ImageMapHandler.getValue(Index)
				
			<span style="color:#0000FF;font-weight: bold">Loop</span> <span style="color:#0000FF;font-weight: bold">Until</span> Key.Len = <span style="color:#326598">0</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Compose</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">graphic</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (Label &lt;&gt; <span style="color:#6500FE">&quot;&quot;</span>) <span style="color:#0000FF;font-weight: bold">Then</span> Value = Label + <span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span> + Value
			
			<span style="color:#0000FF;font-weight: bold">if</span> value = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span> value = Title
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> B <span style="color:#0000FF;font-weight: bold">As</span> Picture = <span style="color:#0000FF;font-weight: bold">New</span> Picture(Width, Height, <span style="color:#326598">32</span>)
			<span style="color:#0000FF;font-weight: bold">Dim</span> G <span style="color:#0000FF;font-weight: bold">As</span> Graphics = B.Graphics
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> W <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">6</span> + G.StringWidth(Value)
			<span style="color:#0000FF;font-weight: bold">Dim</span> H <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">20</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">space</span> <span style="color:#7F0000;text-style:italic">between</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">cursor</span> <span style="color:#7F0000;text-style:italic">position</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">initial</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">position</span>
			X = X + <span style="color:#326598">10</span>
			Y = Y + <span style="color:#326598">10</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">too</span> <span style="color:#7F0000;text-style:italic">close</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">right,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">move</span> <span style="color:#7F0000;text-style:italic">our</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">position</span> <span style="color:#7F0000;text-style:italic">left</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (X + W &gt; G.Width) <span style="color:#0000FF;font-weight: bold">Then</span> X = X - <span style="color:#326598">20</span> - W
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">too</span> <span style="color:#7F0000;text-style:italic">close</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">bottom,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">move</span> <span style="color:#7F0000;text-style:italic">our</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">position</span> <span style="color:#7F0000;text-style:italic">up</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (Y + H &gt; G.Height) <span style="color:#0000FF;font-weight: bold">Then</span> Y = Y - <span style="color:#326598">20</span> - H
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">composited</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span>
			B.Graphics.DrawPicture(LastPicture, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>)
			B.Mask.Graphics.DrawPicture(LastPicture.Mask, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">label</span> <span style="color:#7F0000;text-style:italic">graphic</span>
			G.ForeColor = &amp;c<span style="color:#FF0000">CC</span><span style="color:#00FF00">CC</span><span style="color:#0000FF">00</span>
			G.FillRect(X, Y, W, H)
			G.ForeColor = &amp;c<span style="color:#FF0000">00</span><span style="color:#00FF00">00</span><span style="color:#0000FF">00</span>
			G.DrawString(Value, X + <span style="color:#326598">3</span>, Y + <span style="color:#326598">15</span>)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">composited</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span>
			Overlay = b
			<span style="color:#0000FF;font-weight: bold">Me</span>.Invalidate
			NeedClear = <span style="color:#0000FF;font-weight: bold">True</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Print()
			<span style="color:#0000FF;font-weight: bold">Dim</span> PS <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> PrinterSetup
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">landscape</span> <span style="color:#7F0000;text-style:italic">orientation</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">appropriate</span>
			PS.Landscape = Width &gt; Height
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Initialize</span> <span style="color:#7F0000;text-style:italic">graphics</span> <span style="color:#7F0000;text-style:italic">region</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">printing</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> G <span style="color:#0000FF;font-weight: bold">As</span> Graphics = OpenPrinterDialog(PS)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Bail</span> <span style="color:#7F0000;text-style:italic">out...</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (G = <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Render</span> <span style="color:#7F0000;text-style:italic">printed</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">(use</span> <span style="color:#7F0000;text-style:italic">page</span> <span style="color:#7F0000;text-style:italic">size)</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">NOTE:</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">uses</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">factor</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">4x</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">resolution</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">printed</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">(approximately</span> <span style="color:#7F0000;text-style:italic">300</span> <span style="color:#7F0000;text-style:italic">dpi)</span>
			<span style="color:#7F0000;text-style:italic">&#39;Dim</span> <span style="color:#7F0000;text-style:italic">P</span> <span style="color:#7F0000;text-style:italic">As</span> <span style="color:#7F0000;text-style:italic">Picture</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">RenderPicture(4,</span> <span style="color:#7F0000;text-style:italic">G.Width,</span> <span style="color:#7F0000;text-style:italic">G.Height)</span>
			<span style="color:#7F0000;text-style:italic">&#39;G.DrawPicture(P,</span> <span style="color:#7F0000;text-style:italic">0,</span> <span style="color:#7F0000;text-style:italic">0,</span> <span style="color:#7F0000;text-style:italic">G.Width,</span> <span style="color:#7F0000;text-style:italic">G.Height,</span> <span style="color:#7F0000;text-style:italic">0,</span> <span style="color:#7F0000;text-style:italic">0,</span> <span style="color:#7F0000;text-style:italic">G.Width</span> <span style="color:#7F0000;text-style:italic">*</span> <span style="color:#7F0000;text-style:italic">4,</span> <span style="color:#7F0000;text-style:italic">G.Height</span> <span style="color:#7F0000;text-style:italic">*</span> <span style="color:#7F0000;text-style:italic">4)</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Render</span> <span style="color:#7F0000;text-style:italic">printed</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">(use</span> <span style="color:#7F0000;text-style:italic">control</span> <span style="color:#7F0000;text-style:italic">size)</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">NOTE:</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">uses</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">factor</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">4x</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">resolution</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">printed</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">(approximately</span> <span style="color:#7F0000;text-style:italic">300</span> <span style="color:#7F0000;text-style:italic">dpi)</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> P <span style="color:#0000FF;font-weight: bold">As</span> Picture = RenderPicture(<span style="color:#326598">4</span>, Width, Height)
			G.DrawPicture(P, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, Width, Height, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, Width * <span style="color:#326598">4</span>, Height * <span style="color:#326598">4</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Redraw()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Method</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">directly</span> <span style="color:#7F0000;text-style:italic">trigger</span> <span style="color:#7F0000;text-style:italic">internal</span> <span style="color:#7F0000;text-style:italic">redraw</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> RenderWithTransparency <span style="color:#0000FF;font-weight: bold">then</span>
				Refresh(<span style="color:#0000FF;font-weight: bold">true</span>)
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#0000FF;font-weight: bold">me</span>.Invalidate
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> RenderPicture(Factor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>, Width <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Height <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> Picture
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Prepare</span> <span style="color:#7F0000;text-style:italic">ViewPort</span> <span style="color:#7F0000;text-style:italic">coordinates</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">rendering</span>
			ViewPort.validateViewPort
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Handle</span> <span style="color:#7F0000;text-style:italic">scaled</span> <span style="color:#7F0000;text-style:italic">redraw</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">printing</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> C <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS = Render(ViewPort, Factor, Width, Height)
			<span style="color:#7F0000;text-style:italic">&#39;If</span> <span style="color:#7F0000;text-style:italic">(C</span> <span style="color:#7F0000;text-style:italic">&lt;&gt;</span> <span style="color:#7F0000;text-style:italic">Nil)</span> <span style="color:#7F0000;text-style:italic">Then</span> <span style="color:#7F0000;text-style:italic">Return</span> <span style="color:#7F0000;text-style:italic">(C.makeChartPicture)</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Error</span> <span style="color:#7F0000;text-style:italic">check</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (C = <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span> <span style="color:#0000FF;font-weight: bold">Return</span> (<span style="color:#0000FF;font-weight: bold">Nil</span>)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">in-memory</span> <span style="color:#7F0000;text-style:italic">version</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">PNG</span> <span style="color:#7F0000;text-style:italic">format</span> <span style="color:#7F0000;text-style:italic">(supports</span> <span style="color:#7F0000;text-style:italic">transparency)</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> S <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			S = C.makeChart(C.kPNG)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Error</span> <span style="color:#7F0000;text-style:italic">check</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (S = <span style="color:#6500FE">&quot;&quot;</span>) <span style="color:#0000FF;font-weight: bold">Then</span> <span style="color:#0000FF;font-weight: bold">Return</span> (<span style="color:#0000FF;font-weight: bold">Nil</span>)
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Generate</span> <span style="color:#7F0000;text-style:italic">RB</span> <span style="color:#7F0000;text-style:italic">Picture</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">chart</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">data</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> P <span style="color:#0000FF;font-weight: bold">As</span> Picture
			P = PNGStringToPictureMBS(S, <span style="color:#326598">0</span>)
			
			
			<span style="color:#0000FF;font-weight: bold">Return</span> (P)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> SendClickEvent()
			<span style="color:#0000FF;font-weight: bold">Dim</span> Index <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Key, KeyValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> XLabel <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> XValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> DataSet <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> DataSetName <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Value <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Title <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Sector <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> Label <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Error</span> <span style="color:#7F0000;text-style:italic">check</span>
			<span style="color:#0000FF;font-weight: bold">If</span> (ImageMapHandler = <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Do</span> <span style="color:#7F0000;text-style:italic">key/value</span> <span style="color:#7F0000;text-style:italic">pair</span> <span style="color:#7F0000;text-style:italic">priming</span> <span style="color:#7F0000;text-style:italic">calls</span>
			Index = <span style="color:#326598">0</span>
			Key = ImageMapHandler.getKey(Index)
			KeyValue = ImageMapHandler.getValue(Index)
			
			
			<span style="color:#0000FF;font-weight: bold">Do</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">NOTE:</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">complete</span> <span style="color:#7F0000;text-style:italic">supported</span> <span style="color:#7F0000;text-style:italic">list</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">parameters;</span> <span style="color:#7F0000;text-style:italic">Refer</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">ChartDirector</span> <span style="color:#7F0000;text-style:italic">documentation</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">&#39;Parameter</span> <span style="color:#7F0000;text-style:italic">Substitution</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">Formatting&#39;</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">additional</span> <span style="color:#7F0000;text-style:italic">parameters</span>
				<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> Key
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;xlabel&quot;</span>
					XLabel = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;x&quot;</span>
					XValue = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;dataset&quot;</span>
					DataSet = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;datasetname&quot;</span>
					DataSetName = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;value&quot;</span>
					Value = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;title&quot;</span>
					Title = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;sector&quot;</span>
					Sector = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;label&quot;</span>
					Label = KeyValue
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
				
				Index = Index + <span style="color:#326598">1</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Get</span> <span style="color:#7F0000;text-style:italic">next</span> <span style="color:#7F0000;text-style:italic">key/value</span> <span style="color:#7F0000;text-style:italic">pair</span>
				Key = ImageMapHandler.getKey(Index)
				KeyValue = ImageMapHandler.getValue(Index)
				
			<span style="color:#0000FF;font-weight: bold">Loop</span> <span style="color:#0000FF;font-weight: bold">Until</span> Key.Len = <span style="color:#326598">0</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Trigger</span> <span style="color:#7F0000;text-style:italic">click</span> <span style="color:#7F0000;text-style:italic">event</span>
			ItemClicked(XLabel, Val(XValue), Val(DataSet), DataSetName, Val(Value), Title, Val(Sector), Label)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> UpdateMouseCursor()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">call</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">timer</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">your</span> <span style="color:#7F0000;text-style:italic">window</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">keep</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">cursor</span> <span style="color:#7F0000;text-style:italic">change</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">pressing</span> <span style="color:#7F0000;text-style:italic">alt</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">shift</span> <span style="color:#7F0000;text-style:italic">keys.</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">allowed?</span>
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> AllowZoom <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">if</span> isMouseDown <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#0000FF;font-weight: bold">me</span>.MouseX
			<span style="color:#0000FF;font-weight: bold">dim</span> y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#0000FF;font-weight: bold">me</span>.MouseY
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">mouse</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">inside</span>
			<span style="color:#0000FF;font-weight: bold">if</span> X&lt;<span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">if</span> Y&lt;<span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">if</span> X&gt;<span style="color:#0000FF;font-weight: bold">me</span>.Width <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">if</span> Y&gt;<span style="color:#0000FF;font-weight: bold">me</span>.Height <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">now</span> <span style="color:#7F0000;text-style:italic">update</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> Keyboard.AsyncOptionKey <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">In</span>
				MouseCursor = System.Cursors.MagnifyLarger
				
			<span style="color:#0000FF;font-weight: bold">ElseIf</span> Keyboard.AsyncShiftKey <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Zoom</span> <span style="color:#7F0000;text-style:italic">Out</span>
				MouseCursor = System.Cursors.MagnifySmaller
				
			<span style="color:#0000FF;font-weight: bold">Else</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> HotSpotID <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Check</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">over</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">hotspot;</span> <span style="color:#7F0000;text-style:italic">Nil</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">prevents</span> <span style="color:#7F0000;text-style:italic">spurious</span> <span style="color:#7F0000;text-style:italic">NilObjectExceptions</span>
				<span style="color:#0000FF;font-weight: bold">If</span> (ImageMapHandler &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span>) <span style="color:#0000FF;font-weight: bold">Then</span> HotSpotID = ImageMapHandler.getHotSpot(X, Y)
				
				<span style="color:#0000FF;font-weight: bold">If</span> (HotSpotID &gt; <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					MouseCursor = System.Cursors.StandardPointer
					
					
					
				<span style="color:#0000FF;font-weight: bold">ElseIf</span> (AllowMove = <span style="color:#0000FF;font-weight: bold">True</span>) <span style="color:#0000FF;font-weight: bold">Then</span>
					
					MouseCursor = System.Cursors.HandOpen
					
				<span style="color:#0000FF;font-weight: bold">Else</span>
					
					MouseCursor = System.Cursors.StandardPointer
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;About</span> <span style="color:#6500FE">Properties&quot;</span>
<div class="RB_Comment">			AllowMove and AllowZoom must be enabled if you want to zoom and move. 
			You need to use the viewport in your render code.
			
			If Border is true, a black line is drawn around the chart.
			
			If CleanGraphicsBeforeDrawing is true then the graphics object is cleared 
			before something is drawn
			
			The OverlayPicture defines a picture which is drawn on top of the chart 
			as a watermark.
			
			RenderWithTransparency will do redraws slower. The chart is rendered as 
			PNG with mask and for every redraw we refresh the whole control. 
			This may look bad on Windows.
			
			ZoomInRatio and ZoomOutRatio are used for zooming. 
			This is how much we zoom on each click.</div>
</div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;Notes</span> <span style="color:#6500FE">for</span> <span style="color:#6500FE">Render</span> <span style="color:#6500FE">Event&quot;</span>
<div class="RB_Comment">			Use the Width and Height you get and not the control's.
			Use the Factor to multiply all values so you get it properly scaled for printing.
			Use the ViewPort for zooming and moving.</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> AllowMove <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> AllowZoom <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Border <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> CleanGraphicsBeforeDrawing <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> Current <span style="color:#0000FF;font-weight: bold">As</span> CDBaseChartMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> ImageMapHandler <span style="color:#0000FF;font-weight: bold">As</span> CDImageMapHandlerMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> LastPicture <span style="color:#0000FF;font-weight: bold">As</span> Picture</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> MaxValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> MinValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> Mode <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> NeedClear <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Overlay <span style="color:#0000FF;font-weight: bold">As</span> Picture</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> OverlayPicture <span style="color:#0000FF;font-weight: bold">As</span> Picture</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> RectangleHeight <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> RectangleLeft <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> RectanglePicture <span style="color:#0000FF;font-weight: bold">As</span> Picture</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> RectangleTop <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> RectangleWidth <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> RenderWithTransparency <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> StartX <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> StartX2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> StartY <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> StartY2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> ViewPort <span style="color:#0000FF;font-weight: bold">As</span> CDViewPortManagerMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ZoomInRatio <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#006532">1.25</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ZoomOutRatio <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#006532">0.75</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> isMouseDown <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

<p>See also:<ul>
<li><A href="example-chartdirector-finance.html">/ChartDirector/finance</A></li>
<li><A href="example-chartdirector-financeanimated.html">/ChartDirector/finance animated</A></li>
<li><A href="example-chartdirector-financecharttracklineretina.html">/ChartDirector/Finance Chart Track Line Retina</A></li>
<li><A href="example-chartdirector-financepdf.html">/ChartDirector/finance pdf</A></li>
</ul></p>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbschartdirectorplugin.html">MBS ChartDirector Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-chartdirector-financewithchartdirectorcontrol">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

