<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - WindowsAddPrintJobMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="WindowsAddPrintJobMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">WindowsAddPrintJobMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</a> class.  </p>
<div class="W">
<b><a href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</a>.<A name="1">AddJob as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-printing.html" translate="no">Printing</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion61.shtml" class=version>6.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Creates a new print job.<BR>
<B>Notes:</B> 
Returns true on success and false on failure.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-printing-windowsprinter.html">/Win/Printing/Windows Printer</A></li>
<li><A href="example-win-printing-winprint.html">/Win/Printing/WinPrint</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</a>.<A name="2">ClosePrinter</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-printing.html" translate="no">Printing</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion164.shtml" class=version>16.4</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Closes printer connection.<BR>
</div>
<div class="W">
<b><a href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</a>.<A name="3">EndDocPrinter as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-printing.html" translate="no">Printing</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion103.shtml" class=version>10.3</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
The EndDocPrinter function ends a print job for the specified printer.<BR>
<B>Notes:</B> 
<BR>
If the function succeeds, the return value is a true.<BR>
<BR>
The EndDocPrinter function returns an error if the print job was not started by calling the StartDocPrinter function.<BR>
<BR>
The sequence for a print job is as follows:<BR>
<BR>
1. To begin a print job, call StartDocPrinter.<BR>
2. To begin each page, call StartPagePrinter.<BR>
3. To write data to a page, call WritePrinter.<BR>
4. To end each page, call EndPagePrinter.<BR>
5. Repeat 2, 3, and 4 for as many pages as necessary.<BR>
6. To end the print job, call EndDocPrinter.<BR>
<BR>
When a page in a spooled file exceeds approximately 350 MB, it may fail to print and not send an error message. For example, this can occur when printing large EMF files. The page size limit depends on many factors including the amount of virtual memory available, the amount of memory allocated by calling processes, and the amount of fragmentation in the process heap.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-printing-windowsprinter.html">/Win/Printing/Windows Printer</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</a>.<A name="4">EndPagePrinter as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-printing.html" translate="no">Printing</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion103.shtml" class=version>10.3</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
The EndPagePrinter function notifies the print spooler that the application is at the end of a page in a print job.<BR>
<B>Notes:</B> 
<BR>
If the function succeeds, the return value is a true.<BR>
<BR>
The sequence for a print job is as follows:<BR>
<BR>
1. To begin a print job, call StartDocPrinter.<BR>
2. To begin each page, call StartPagePrinter.<BR>
3. To write data to a page, call WritePrinter.<BR>
4. To end each page, call EndPagePrinter.<BR>
5. Repeat 2, 3, and 4 for as many pages as necessary.<BR>
6. To end the print job, call EndDocPrinter.<BR>
<BR>
When a page in a spooled file exceeds approximately 350 MB, it can fail to print and not send an error message. For example, this can occur when printing large EMF files. The page size limit depends on many factors including the amount of virtual memory available, the amount of memory allocated by calling processes, and the amount of fragmentation in the process heap.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-printing-windowsprinter.html">/Win/Printing/Windows Printer</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</a>.<A name="5">OpenPrinter(PrinterName as string) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-printing.html" translate="no">Printing</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion61.shtml" class=version>6.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Opens the printer for printing.<BR>
<B>Notes:</B> 
<BR>
Returns true on success and false on failure.<BR>
PrinterName can be &quot;&quot; for the default printer.<BR>
</div>
<div class="W">
<b><a href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</a>.<A name="6">ScheduleJob as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-printing.html" translate="no">Printing</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion61.shtml" class=version>6.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Schedules the printing.<BR>
<B>Notes:</B> 
Returns true on success and false on failure.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-printing-windowsprinter.html">/Win/Printing/Windows Printer</A></li>
<li><A href="example-win-printing-winprint.html">/Win/Printing/WinPrint</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</a>.<A name="7">StartDocPrinter(DocName as string, Datatype as string) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-printing.html" translate="no">Printing</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion103.shtml" class=version>10.3</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
The StartDocPrinter function notifies the print spooler that a document is to be spooled for printing.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #800000;">// Print Postscript directly to Postscript printer</span><br /><span style="color: #0000FF;">const</span> PrinterName = <span style="color: #6600FE;">&quot;Brother DCP-8085DN&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> w <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</A><br /><br /><span style="color: #0000FF;">if</span> <span style="color: #0000FF;">not</span> w.OpenPrinter(PrinterName) <span style="color: #0000FF;">then</span><br />  MsgBox <span style="color: #6600FE;">&quot;OpenPrinter failed. Is the printer name correct in the source code?&quot;</span><br />  <span style="color: #0000FF;">Return</span><br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br /><br /><span style="color: #0000FF;">const</span> DocName = <span style="color: #6600FE;">&quot;My Document&quot;</span><br /><br /><span style="color: #0000FF;">if</span> <span style="color: #0000FF;">not</span> w.StartDocPrinter(<span style="color: #6600FE;">&quot;My Document&quot;</span>, w.kDataFormatRAW) <span style="color: #0000FF;">then</span><br />  MsgBox <span style="color: #6600FE;">&quot;StartDocPrinter failed.&quot;</span><br />  <span style="color: #0000FF;">Return</span><br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br /><br />MsgBox <span style="color: #6600FE;">&quot;Print Job ID: &quot;</span>+str(w.JobID)<br /><br /><span style="color: #0000FF;">call</span> w.StartPagePrinter<br /><br /><span style="color: #0000FF;">dim</span> PostScript <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;%!PS&quot;</span>+EndOfLine.UNIX+<span style="color: #6600FE;">&quot;.1 setgray&quot;</span>+EndOfLine.UNIX+<span style="color: #6600FE;">&quot;0 0 100 100 rectfill&quot;</span>+EndOfLine.UNIX+<span style="color: #6600FE;">&quot;showpage&quot;</span>+EndOfLine.UNIX<br /><br /><span style="color: #0000FF;">dim</span> BytesSent <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Integer</span> = w.WritePrinter(PostScript)<br /><br />MsgBox str(BytesSent)+<span style="color: #6600FE;">&quot; bytes of &quot;</span>+str(lenb(PostScript))+<span style="color: #6600FE;">&quot; bytes sent.&quot;</span><br /><br /><span style="color: #0000FF;">call</span> w.EndPagePrinter<br /><span style="color: #0000FF;">call</span> w.EndDocPrinter<br /><br />w = <span style="color: #0000FF;">nil</span> <span style="color: #800000;">// close printer</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
DocName: A string that specifies the name of the document.<BR>
OutputFile: Optional a path string or a folderitem that specifies the name of an output file. To print to a printer, set this to &quot;&quot; or nil or leave away.<BR>
Datatype: A string that identifies the type of data used to record the document.<BR>
<BR>
If the function succeeds, the return value is true and the JobID property is set.<BR>
<BR>
The sequence for a print job is as follows:<BR>
<BR>
1. To begin a print job, call StartDocPrinter.<BR>
2. To begin each page, call StartPagePrinter.<BR>
3. To write data to a page, call WritePrinter.<BR>
4. To end each page, call EndPagePrinter.<BR>
5. Repeat 2, 3, and 4 for as many pages as necessary.<BR>
6. To end the print job, call EndDocPrinter.<BR>
<BR>
When a page in a spooled file exceeds approximately 350 MB, it can fail to print and not send an error message. For example, this can occur when printing large EMF files. The page size limit depends on many factors including the amount of virtual memory available, the amount of memory allocated by calling processes, and the amount of fragmentation in the process heap.<BR>
<p>See also:<ul>
<li><A href="printing-windowsaddprintjobmbs-method.html#8">StartDocPrinter(DocName as string, OutputFile as folderitem, Datatype as string) as boolean</A></li>
<li><A href="printing-windowsaddprintjobmbs-method.html#9">StartDocPrinter(DocName as string, OutputFilePath as string, Datatype as string) as boolean</A></li>
</ul></p>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-printing-windowsprinter.html">/Win/Printing/Windows Printer</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</a>.<A name="8">StartDocPrinter(DocName as string, OutputFile as folderitem, Datatype as string) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-printing.html" translate="no">Printing</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion103.shtml" class=version>10.3</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
The StartDocPrinter function notifies the print spooler that a document is to be spooled for printing.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #800000;">// Print Postscript directly to Postscript printer</span><br /><span style="color: #0000FF;">const</span> PrinterName = <span style="color: #6600FE;">&quot;Brother DCP-8085DN&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> w <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</A><br /><br /><span style="color: #0000FF;">if</span> <span style="color: #0000FF;">not</span> w.OpenPrinter(PrinterName) <span style="color: #0000FF;">then</span><br />  MsgBox <span style="color: #6600FE;">&quot;OpenPrinter failed. Is the printer name correct in the source code?&quot;</span><br />  <span style="color: #0000FF;">Return</span><br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br /><br /><span style="color: #0000FF;">const</span> DocName = <span style="color: #6600FE;">&quot;My Document&quot;</span><br /><br /><span style="color: #800000;">// output to a file</span><br /><span style="color: #0000FF;">dim</span> file <span style="color: #0000FF;">as</span> FolderItem = SpecialFolder.Desktop.Child(<span style="color: #6600FE;">&quot;test.ps&quot;</span>)<br /><br /><span style="color: #0000FF;">if</span> <span style="color: #0000FF;">not</span> w.StartDocPrinter(<span style="color: #6600FE;">&quot;My Document&quot;</span>, file, w.kDataFormatRAW) <span style="color: #0000FF;">then</span><br />  MsgBox <span style="color: #6600FE;">&quot;StartDocPrinter failed.&quot;</span><br />  <span style="color: #0000FF;">Return</span><br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br /><br />MsgBox <span style="color: #6600FE;">&quot;Print Job ID: &quot;</span>+str(w.JobID)<br /><br /><span style="color: #0000FF;">call</span> w.StartPagePrinter<br /><br /><span style="color: #0000FF;">dim</span> PostScript <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;%!PS&quot;</span>+EndOfLine.UNIX+<span style="color: #6600FE;">&quot;.1 setgray&quot;</span>+EndOfLine.UNIX+<span style="color: #6600FE;">&quot;0 0 100 100 rectfill&quot;</span>+EndOfLine.UNIX+<span style="color: #6600FE;">&quot;showpage&quot;</span>+EndOfLine.UNIX<br /><br /><span style="color: #0000FF;">dim</span> BytesSent <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Integer</span> = w.WritePrinter(PostScript)<br /><br />MsgBox str(BytesSent)+<span style="color: #6600FE;">&quot; bytes of &quot;</span>+str(lenb(PostScript))+<span style="color: #6600FE;">&quot; bytes sent.&quot;</span><br /><br /><span style="color: #0000FF;">call</span> w.EndPagePrinter<br /><span style="color: #0000FF;">call</span> w.EndDocPrinter<br /><br />w = <span style="color: #0000FF;">nil</span> <span style="color: #800000;">// close printer</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
DocName: A string that specifies the name of the document.<BR>
OutputFile: Optional a path string or a folderitem that specifies the name of an output file. To print to a printer, set this to &quot;&quot; or nil or leave away.<BR>
Datatype: A string that identifies the type of data used to record the document.<BR>
<BR>
If the function succeeds, the return value is true and the JobID property is set.<BR>
<BR>
The sequence for a print job is as follows:<BR>
<BR>
1. To begin a print job, call StartDocPrinter.<BR>
2. To begin each page, call StartPagePrinter.<BR>
3. To write data to a page, call WritePrinter.<BR>
4. To end each page, call EndPagePrinter.<BR>
5. Repeat 2, 3, and 4 for as many pages as necessary.<BR>
6. To end the print job, call EndDocPrinter.<BR>
<BR>
When a page in a spooled file exceeds approximately 350 MB, it can fail to print and not send an error message. For example, this can occur when printing large EMF files. The page size limit depends on many factors including the amount of virtual memory available, the amount of memory allocated by calling processes, and the amount of fragmentation in the process heap.<BR>
<p>See also:<ul>
<li><A href="printing-windowsaddprintjobmbs-method.html#7">StartDocPrinter(DocName as string, Datatype as string) as boolean</A></li>
<li><A href="printing-windowsaddprintjobmbs-method.html#9">StartDocPrinter(DocName as string, OutputFilePath as string, Datatype as string) as boolean</A></li>
</ul></p>
</div>
<div class="W">
<b><a href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</a>.<A name="9">StartDocPrinter(DocName as string, OutputFilePath as string, Datatype as string) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-printing.html" translate="no">Printing</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion103.shtml" class=version>10.3</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
The StartDocPrinter function notifies the print spooler that a document is to be spooled for printing.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #800000;">// Print Postscript directly to Postscript printer</span><br /><span style="color: #0000FF;">const</span> PrinterName = <span style="color: #6600FE;">&quot;Brother DCP-8085DN&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> w <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</A><br /><br /><span style="color: #0000FF;">if</span> <span style="color: #0000FF;">not</span> w.OpenPrinter(PrinterName) <span style="color: #0000FF;">then</span><br />  MsgBox <span style="color: #6600FE;">&quot;OpenPrinter failed. Is the printer name correct in the source code?&quot;</span><br />  <span style="color: #0000FF;">Return</span><br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br /><br /><span style="color: #0000FF;">const</span> DocName = <span style="color: #6600FE;">&quot;My Document&quot;</span><br /><br /><span style="color: #800000;">// output to a file</span><br /><span style="color: #0000FF;">dim</span> file <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;C:\test.ps&quot;</span><br /><br /><span style="color: #0000FF;">if</span> <span style="color: #0000FF;">not</span> w.StartDocPrinter(<span style="color: #6600FE;">&quot;My Document&quot;</span>, file, w.kDataFormatRAW) <span style="color: #0000FF;">then</span><br />  MsgBox <span style="color: #6600FE;">&quot;StartDocPrinter failed.&quot;</span><br />  <span style="color: #0000FF;">Return</span><br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br /><br />MsgBox <span style="color: #6600FE;">&quot;Print Job ID: &quot;</span>+str(w.JobID)<br /><br /><span style="color: #0000FF;">call</span> w.StartPagePrinter<br /><br /><span style="color: #0000FF;">dim</span> PostScript <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;%!PS&quot;</span>+EndOfLine.UNIX+<span style="color: #6600FE;">&quot;.1 setgray&quot;</span>+EndOfLine.UNIX+<span style="color: #6600FE;">&quot;0 0 100 100 rectfill&quot;</span>+EndOfLine.UNIX+<span style="color: #6600FE;">&quot;showpage&quot;</span>+EndOfLine.UNIX<br /><br /><span style="color: #0000FF;">dim</span> BytesSent <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Integer</span> = w.WritePrinter(PostScript)<br /><br />MsgBox str(BytesSent)+<span style="color: #6600FE;">&quot; bytes of &quot;</span>+str(lenb(PostScript))+<span style="color: #6600FE;">&quot; bytes sent.&quot;</span><br /><br /><span style="color: #0000FF;">call</span> w.EndPagePrinter<br /><span style="color: #0000FF;">call</span> w.EndDocPrinter<br /><br />w = <span style="color: #0000FF;">nil</span> <span style="color: #800000;">// close printer</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
DocName: A string that specifies the name of the document.<BR>
OutputFile: Optional a path string or a folderitem that specifies the name of an output file. To print to a printer, set this to &quot;&quot; or nil or leave away.<BR>
Datatype: A string that identifies the type of data used to record the document.<BR>
<BR>
If the function succeeds, the return value is true and the JobID property is set.<BR>
<BR>
The sequence for a print job is as follows:<BR>
<BR>
1. To begin a print job, call StartDocPrinter.<BR>
2. To begin each page, call StartPagePrinter.<BR>
3. To write data to a page, call WritePrinter.<BR>
4. To end each page, call EndPagePrinter.<BR>
5. Repeat 2, 3, and 4 for as many pages as necessary.<BR>
6. To end the print job, call EndDocPrinter.<BR>
<BR>
When a page in a spooled file exceeds approximately 350 MB, it can fail to print and not send an error message. For example, this can occur when printing large EMF files. The page size limit depends on many factors including the amount of virtual memory available, the amount of memory allocated by calling processes, and the amount of fragmentation in the process heap.<BR>
<p>See also:<ul>
<li><A href="printing-windowsaddprintjobmbs-method.html#7">StartDocPrinter(DocName as string, Datatype as string) as boolean</A></li>
<li><A href="printing-windowsaddprintjobmbs-method.html#8">StartDocPrinter(DocName as string, OutputFile as folderitem, Datatype as string) as boolean</A></li>
</ul></p>
</div>
<div class="W">
<b><a href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</a>.<A name="10">StartPagePrinter as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-printing.html" translate="no">Printing</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion103.shtml" class=version>10.3</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
The StartPagePrinter function notifies the spooler that a page is about to be printed on the specified printer.<BR>
<B>Notes:</B> 
<BR>
If the function succeeds, the return value is a true.<BR>
<BR>
The sequence for a print job is as follows:<BR>
<BR>
1. To begin a print job, call StartDocPrinter.<BR>
2. To begin each page, call StartPagePrinter.<BR>
3. To write data to a page, call WritePrinter.<BR>
4. To end each page, call EndPagePrinter.<BR>
5. Repeat 2, 3, and 4 for as many pages as necessary.<BR>
6. To end the print job, call EndDocPrinter.<BR>
<BR>
When a page in a spooled file exceeds approximately 350 MB, it can fail to print and not send an error message. For example, this can occur when printing large EMF files. The page size limit depends on many factors including the amount of virtual memory available, the amount of memory allocated by calling processes, and the amount of fragmentation in the process heap.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-printing-windowsprinter.html">/Win/Printing/Windows Printer</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</a>.<A name="11">WriteJob(data as string) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-printing.html" translate="no">Printing</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion61.shtml" class=version>6.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Adds data to the spool file.<BR>
<B>Notes:</B> 
<BR>
You need to pass raw data for the printer, e.g. postscript data.<BR>
Returns the number of bytes written.<BR>
So lenb(data) should be equal to the result.<BR>
Only available between a call to AddJob and ScheduleJob. <BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-printing-windowsprinter.html">/Win/Printing/Windows Printer</A></li>
<li><A href="example-win-printing-winprint.html">/Win/Printing/WinPrint</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-windowsaddprintjobmbs.html">WindowsAddPrintJobMBS</a>.<A name="12">WritePrinter(data as string) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-printing.html" translate="no">Printing</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion103.shtml" class=version>10.3</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
The WritePrinter function notifies the print spooler that data should be written to the specified printer.<BR>
<B>Notes:</B> 
<BR>
data: The data that should be written to the printer.<BR>
<BR>
If the function succeeds, the return value is a true.<BR>
<BR>
The sequence for a print job is as follows:<BR>
<BR>
1. To begin a print job, call StartDocPrinter.<BR>
2. To begin each page, call StartPagePrinter.<BR>
3. To write data to a page, call WritePrinter.<BR>
4. To end each page, call EndPagePrinter.<BR>
5. Repeat 2, 3, and 4 for as many pages as necessary.<BR>
6. To end the print job, call EndDocPrinter.<BR>
<BR>
When a high-level document (such as an Adobe PDF or Microsoft Word file) or other printer data (such PCL, PS, or HPGL) is sent directly to a printer, the print settings defined in the document take precedent over Windows print settings. <BR>
<BR>
When a page in a spooled file exceeds approximately 350 MB, it can fail to print and not send an error message. For example, this can occur when printing large EMF files. The page size limit depends on many factors including the amount of virtual memory available, the amount of memory allocated by calling processes, and the amount of fragmentation in the process heap.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-printing-windowsprinter.html">/Win/Printing/Windows Printer</A></li>
</ul>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbswinplugin.html">MBS Win Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=printing-windowsaddprintjobmbs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

