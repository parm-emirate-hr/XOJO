<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - WindowsDragSourceMBS events</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="WindowsDragSourceMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">WindowsDragSourceMBS events</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-windowsdragsourcembs.html">WindowsDragSourceMBS</a> class.  </p>
<div class="W">
<b><a href="class-windowsdragsourcembs.html">WindowsDragSourceMBS</a>.<A name="1">GiveFeedback(Effect as Integer) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-dragdrop.html" translate="no">Drag &amp; Drop</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
Enables a source application to give visual feedback to the end user during a drag-and-drop operation by providing the DoDragDrop function with an enumeration value specifying the visual effect.<BR>
<B>Notes:</B> 
<BR>
Effect: The drop effect value returned by the most recent call to <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragEnter, <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragOver, or <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragLeave.<BR>
<BR>
Return S_OK on success. Return DRAGDROP_S_USEDEFAULTCURSORS to indicate successful completion of the method, and requests OLE to update the cursor using the OLE-provided default cursors.<BR>
<BR>
When your application detects that the user has started a drag-and-drop operation, it should call the DoDragDrop function. DoDragDrop enters a loop, calling <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragEnter when the mouse first enters a drop target window, <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragOver when the mouse changes its position within the target window, and <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragLeave when the mouse leaves the target window.<BR>
<BR>
For every call to either <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragEnter or <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragOver, DoDragDrop calls <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.GiveFeedback, passing it the drop effect value returned from the drop target call.<BR>
<BR>
DoDragDrop calls <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.DragLeave when the mouse has left the target window. Then, DoDragDrop calls <A href="class-windowsdroptargetmbs.html">WindowsDropTargetMBS</A>.GiveFeedback and passes the DROPEFFECT_NONE value in the dwEffect parameter.<BR>
<BR>
The Effect parameter can include DROPEFFECT_SCROLL, indicating that the source should put up the drag-scrolling variation of the appropriate pointer.<BR>
<BR>
Notes to Implementers<BR>
<BR>
This function is called frequently during the DoDragDrop loop, so you can gain performance advantages if you optimize your implementation as much as possible.<BR>
<BR>
GiveFeedback is responsible for changing the cursor shape or for changing the highlighted source based on the value of the dwEffect parameter. If you are using default cursors, you can return DRAGDROP_S_USEDEFAULTCURSORS, which causes OLE to update the cursor for you, using its defaults.<BR>
<h4>Some examples using this event:</h4>
<ul translate="no">
<li><A href="example-win-draganddrop-filedrag.html">/Win/Drag and Drop/File Drag</A></li>
<li><A href="example-win-draganddrop-filedragmulti.html">/Win/Drag and Drop/File Drag Multi</A></li>
<li><A href="example-win-draganddrop-folderdrag.html">/Win/Drag and Drop/Folder Drag</A></li>
<li><A href="example-win-draganddrop-picturedrag.html">/Win/Drag and Drop/Picture Drag</A></li>
<li><A href="example-win-draganddrop-picturedragwithmask.html">/Win/Drag and Drop/Picture Drag with Mask</A></li>
<li><A href="example-win-draganddrop-textdrag.html">/Win/Drag and Drop/Text Drag</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-windowsdragsourcembs.html">WindowsDragSourceMBS</a>.<A name="2">QueryContinueDrag(EscapePressed as boolean, KeyState as Integer) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-dragdrop.html" translate="no">Drag &amp; Drop</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion105.shtml" class=version>10.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
Determines whether a drag-and-drop operation should be continued, canceled, or completed. You do not call this method directly. <BR>
<B>Notes:</B> 
<BR>
The OLE DoDragDrop function calls this method during a drag-and-drop operation.<BR>
<BR>
EscapePressed: Indicates whether the Esc key has been pressed since the previous call to QueryContinueDrag or to DoDragDrop if this is the first call to QueryContinueDrag. A true value indicates the end user has pressed the escape key; a false value indicates it has not been pressed.<BR>
<BR>
KeyState: The current state of the keyboard modifier keys on the keyboard. Possible values can be a combination of any of the flags MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON, and MK_RBUTTON.<BR>
<BR>
This event can return the following values.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Return code</TD><TD valign="top">Description</TD></TR>
<TR><TD valign="top">S_OK</TD><TD valign="top">The drag operation should continue. This result occurs if no errors are detected, the mouse button starting the drag-and-drop operation has not been released, and the Esc key has not been detected.</TD></TR>
<TR><TD valign="top">DRAGDROP_S_DROP</TD><TD valign="top">The drop operation should occur completing the drag operation. This result occurs if KeyState indicates that the key that started the drag-and-drop operation has been released.</TD></TR>
<TR><TD valign="top">DRAGDROP_S_CANCEL</TD><TD valign="top">The drag operation should be canceled with no drop operation occurring. This result occurs if EscapePressed is true, indicating the Esc key has been pressed.</TD></TR>
</TABLE>
<BR>
The DoDragDrop function calls QueryContinueDrag whenever it detects a change in the keyboard or mouse button state during a drag-and-drop operation. QueryContinueDrag must determine whether the drag-and-drop operation should be continued, canceled, or completed based on the contents of the parameters KeyState and EscapePressed.<BR>
<h4>Some examples using this event:</h4>
<ul translate="no">
<li><A href="example-win-draganddrop-filedrag.html">/Win/Drag and Drop/File Drag</A></li>
<li><A href="example-win-draganddrop-filedragmulti.html">/Win/Drag and Drop/File Drag Multi</A></li>
<li><A href="example-win-draganddrop-folderdrag.html">/Win/Drag and Drop/Folder Drag</A></li>
<li><A href="example-win-draganddrop-picturedrag.html">/Win/Drag and Drop/Picture Drag</A></li>
<li><A href="example-win-draganddrop-picturedragwithmask.html">/Win/Drag and Drop/Picture Drag with Mask</A></li>
<li><A href="example-win-draganddrop-textdrag.html">/Win/Drag and Drop/Text Drag</A></li>
</ul>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbswinplugin.html">MBS Win Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=dragdrop-windowsdragsourcembs-event">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

