<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - WinHTTPClientMBS shared methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="WinHTTPClientMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">WinHTTPClientMBS shared methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-winhttpclientmbs.html">WinHTTPClientMBS</a> class.  </p>
<div class="W">
<b><a href="class-winhttpclientmbs.html">WinHTTPClientMBS</a>.<A name="1">CrackUrl(URL as string, Flags as Integer = 0) as <A href="class-winhttpclienturlcomponentsmbs.html">WinHTTPClientURLComponentsMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-network.html" translate="no">Network</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion141.shtml" class=version>14.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Separates a URL into its component parts such as host name and path.<BR>
<B>Notes:</B> 
<BR>
URL: the canonical URL to separate. WinHttpCrackUrl does not check this URL for validity or correct format before attempting to crack it.<BR>
<BR>
see also<BR>
<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa384092(v=vs.85).aspx" target=_blank>http://msdn.microsoft.com/en-us/library/windows/desktop/aa384092(v=vs.85).aspx</a><BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-proxy-windowsproxydetection.html">/Win/Proxy/Windows Proxy Detection</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-winhttpclientmbs.html">WinHTTPClientMBS</a>.<A name="2">DetectAutoProxyConfigUrl(AutoDetectFlags as Integer, byref AutoConfigUrl as string) as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-network.html" translate="no">Network</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion141.shtml" class=version>14.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Finds the URL for the Proxy Auto-Configuration (PAC) file. <BR>
<B>Notes:</B> 
<BR>
This function reports the URL of the PAC file, but it does not download the file.<BR>
<BR>
AutoDetectFlags: A data type that specifies what protocols to use to locate the PAC file. If both the DHCP and DNS auto detect flags are set, DHCP is used first; if no PAC URL is discovered using DHCP, then DNS is used.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Value</TD><TD valign="top">Meaning</TD></TR>
<TR><TD valign="top">kAutoDetectTypeDHCP</TD><TD valign="top">Use DHCP to locate the proxy auto-configuration file.</TD></TR>
<TR><TD valign="top">kAutoDetectTypeDNSA</TD><TD valign="top">Use DNS to attempt to locate the proxy auto-configuration file at a well-known location on the domain of the local computer.</TD></TR>
</TABLE>
<BR>
AutoConfigUrl: String that contains the configuration URL that receives the proxy data. <BR>
<BR>
Returns true if successful, or false otherwise. For extended error information, call LastError. Among the error codes returned are the following.<BR>
<BR>
WinHTTP implements the Web Proxy Auto-Discovery (WPAD) protocol, often referred to as autoproxy. For more information about well-known locations, see the Discovery Process section of the WPAD protocol document.<BR>
Note that because the DetectAutoProxyConfigUrl function takes time to complete its operation, it should not be called from a UI thread.<BR>
</div>
<div class="W">
<b><a href="class-winhttpclientmbs.html">WinHTTPClientMBS</a>.<A name="3">GetDefaultProxyConfiguration as <A href="class-winhttpclientproxyinfombs.html">WinHTTPClientProxyInfoMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-network.html" translate="no">Network</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion141.shtml" class=version>14.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Retrieves the default WinHTTP proxy configuration from the registry.<BR>
<B>Notes:</B> 
Returns the default proxy configuration.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-proxy-windowsproxydetection.html">/Win/Proxy/Windows Proxy Detection</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-winhttpclientmbs.html">WinHTTPClientMBS</a>.<A name="4">GetIEProxyConfigForCurrentUser as <A href="class-winhttpclientcurrentuserieproxyconfigmbs.html">WinHTTPClientCurrentUserIEProxyConfigMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-network.html" translate="no">Network</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion141.shtml" class=version>14.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Retrieves the Internet Explorer proxy configuration for the current user.<BR>
<B>Notes:</B> 
<BR>
Queries the Internet Explorer proxy settings for the current active network connection (for example, LAN, dial-up, or VPN connection).<BR>
<BR>
see also<BR>
<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa384096(v=vs.85).aspx" target=_blank>http://msdn.microsoft.com/en-us/library/windows/desktop/aa384096(v=vs.85).aspx</a><BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-proxy-windowsproxydetection.html">/Win/Proxy/Windows Proxy Detection</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-winhttpclientmbs.html">WinHTTPClientMBS</a>.<A name="5">GetProxyForHost(URL as string, Host as string, byref proxy as string, byref proxyPort as string, AutoConfigURL as string = &quot;&quot;) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-network.html" translate="no">Network</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion141.shtml" class=version>14.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Queries the proxy for a host.<BR>
<B>Notes:</B> 
<BR>
This is an universal functions using InternetGetProxyInfo, DetectAutoProxyUrl and InternetQueryOption.<BR>
<BR>
URL: The target URL.<BR>
Host: The hostname of the target server.<BR>
<BR>
Returns true on success and sets proxy and port. Returns false on failure.<BR>
AutoConfigURL is only used on first call instead of a configured auto config URL in Internet Explorer.<BR>
</div>
<div class="W">
<b><a href="class-winhttpclientmbs.html">WinHTTPClientMBS</a>.<A name="6">InternetGetProxyInfo(URL as string, Host as string) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-network.html" translate="no">Network</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion141.shtml" class=version>14.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Retrieves proxy data for accessing specified resources. <BR>
<B>Notes:</B> 
<BR>
This function can only be called by dynamically linking to &quot;JSProxy.dll&quot; (plugin loads this for you). For better autoproxy support, use HTTP Services (WinHTTP) version 5.1 instead.<BR>
<BR>
Url: Secifies the URL of the target HTTP resource.<BR>
HostName: Specifies the host name of the target URL.<BR>
<BR>
Returns the URL of the proxy to use in an HTTP request for the specified resource. <BR>
Returns empty string on any error.<BR>
</div>
<div class="W">
<b><a href="class-winhttpclientmbs.html">WinHTTPClientMBS</a>.<A name="7">SetDefaultProxyConfiguration(info as <A href="class-winhttpclientproxyinfombs.html">WinHTTPClientProxyInfoMBS</A>) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-network.html" translate="no">Network</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion141.shtml" class=version>14.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Sets the default WinHTTP proxy configuration in the registry.<BR>
<B>Notes:</B> 
<BR>
see also<BR>
<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa384113(v=vs.85).aspx" target=_blank>http://msdn.microsoft.com/en-us/library/windows/desktop/aa384113(v=vs.85).aspx</a><BR>
<BR>
SetDefaultProxyConfiguration changes the proxy configuration set by ProxyCfg.exe.<BR>
The default proxy configuration set by this function can be overridden for an existing WinHTTP session by calling SetOption and specifying the OptionProxy flag. The default proxy configuration can be overridden for a new session by specifying the configuration with the WinHttpOpen function.<BR>
The dwAccessType member of the <A href="class-winhttpclientproxyinfombs.html">WinHTTPClientProxyInfoMBS</A> structure pointed to by pProxyInfo should be set to kAccessTypeNamedProxy if a proxy is specified. Otherwise, it should be set to kAccessTypeDefaultProxy.<BR>
Any new sessions created after calling this function use the new default proxy configuration.<BR>
Even when WinHTTP is used in asynchronous mode (that is, when WINHTTP_FLAG_ASYNC has been set in WinHttpOpen), this function operates synchronously. The return value indicates success or failure. To get extended error information, call GetLastError.<BR>
Note  For Windows XP and Windows 2000, see the Run-Time Requirements section of the WinHTTP start page.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbswinplugin.html">MBS Win Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=network-winhttpclientmbs-shared-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

