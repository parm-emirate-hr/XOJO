<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /Tools/RFC/XOJO_SAP_RFC_sample</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /Tools/RFC/XOJO_SAP_RFC_sample</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/Tools/RFC/XOJO_SAP_RFC_sample</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS Tools Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /Tools/RFC/XOJO_SAP_RFC_sample<BR>
This example is the version from Mon, 17th Jan 2021.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;XOJO_SAP_RFC_sample.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kEditClear = <span style="color:#6500FE">&quot;&amp;Delete&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuit = <span style="color:#6500FE">&quot;&amp;Quit&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuitShortcut = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			AllowAutoQuit = <span style="color:#0000FF;font-weight: bold">true</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ConnectionToSAP <span style="color:#0000FF;font-weight: bold">As</span> RFCConnectionMBS</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> flights <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_CARRID = <span style="color:#6500FE">&quot;ID&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_CONNID = <span style="color:#6500FE">&quot;Nr.&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_CURRENCY = <span style="color:#6500FE">&quot;W&auml;hrung&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_Carrier = <span style="color:#6500FE">&quot;Fluggesellschaft&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_ConnectToSAP = <span style="color:#6500FE">&quot;mit</span> <span style="color:#6500FE">SAP-System</span> <span style="color:#6500FE">verbinden&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_ConnectionStateOff = <span style="color:#6500FE">&quot;nicht</span> <span style="color:#6500FE">verbunden&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_ConnectionStateOn = <span style="color:#6500FE">&quot;verbunden&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_FLDATE = <span style="color:#6500FE">&quot;Flugdatum&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_GrpLogOnData = <span style="color:#6500FE">&quot;SAP</span> <span style="color:#6500FE">Anmeldedaten&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_PAYMENTSUM = <span style="color:#6500FE">&quot;Akt.</span> <span style="color:#6500FE">Buchungssumme&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_PLANTYPE = <span style="color:#6500FE">&quot;Flugzeugtyp&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_PRICE = <span style="color:#6500FE">&quot;Flugpreis&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_SEATSMAX = <span style="color:#6500FE">&quot;Kapazit&auml;t&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_SEATSMAX_B = <span style="color:#6500FE">&quot;Kapazit&auml;t</span> <span style="color:#6500FE">BC&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_SEATSMAX_F = <span style="color:#6500FE">&quot;Kapazit&auml;t</span> <span style="color:#6500FE">FC&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_SEATSOCC = <span style="color:#6500FE">&quot;Belegt&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_SEATSOCC_B = <span style="color:#6500FE">&quot;Belegt</span> <span style="color:#6500FE">BC&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_SEATSOCC_F = <span style="color:#6500FE">&quot;Belegt</span> <span style="color:#6500FE">FC&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_SystemNumber = <span style="color:#6500FE">&quot;Instanz-Nr.&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_TitleFlights = <span style="color:#6500FE">&quot;SAP</span> <span style="color:#6500FE">RFC</span> <span style="color:#6500FE">Beispiel&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_client = <span style="color:#6500FE">&quot;Mandant&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_host = <span style="color:#6500FE">&quot;Anwendungsserver&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_language = <span style="color:#6500FE">&quot;Sprache&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_message_NoCarrier = <span style="color:#6500FE">&quot;Keine</span> <span style="color:#6500FE">Fluggesellschaft</span> <span style="color:#6500FE">gefunden&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_password = <span style="color:#6500FE">&quot;Passwort&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> gc_user = <span style="color:#6500FE">&quot;Benutzer&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">		Control GrpLogOn <span style="color:#0000FF;font-weight: bold">Inherits</span> GroupBox</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance GrpLogOn <span style="color:#0000FF;font-weight: bold">Inherits</span> GroupBox</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">me</span>.Caption = gc_GrpLogOnData
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Label_ashost <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Label_ashost <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">me</span>.Value = gc_host
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control logon_ashost <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance logon_ashost <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Label_sysnr <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Label_sysnr <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">me</span>.Value = gc_SystemNumber
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control logon_sysnr <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance logon_sysnr <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Label_client <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Label_client <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">me</span>.Value = gc_client
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control logon_client <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance logon_client <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control logon_user <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance logon_user <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Label_user <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Label_user <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">me</span>.value = gc_user
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Label_passwd <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Label_passwd <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">me</span>.Value = gc_password
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control logon_passwd <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance logon_passwd <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control logon_lang <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance logon_lang <span style="color:#0000FF;font-weight: bold">Inherits</span> TextField</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				var lv_Locale  <span style="color:#0000FF;font-weight: bold">as</span> xojo.core.locale = xojo.core.locale.current
				<span style="color:#0000FF;font-weight: bold">me</span>.value = lv_Locale.Identifier.Left(<span style="color:#326598">2</span>).Uppercase
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Label_lang <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Label_lang <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">me</span>.Value = gc_language
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Label_airline <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Label_airline <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">me</span>.Value = gc_Carrier
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control PopupSCARR <span style="color:#0000FF;font-weight: bold">Inherits</span> PopupMenu</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance PopupSCARR <span style="color:#0000FF;font-weight: bold">Inherits</span> PopupMenu</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Change()
				var carrier(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = split(PopupSCARR.SelectedRowValue,<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&quot;</span>)
				<span style="color:#0000FF;font-weight: bold">if</span> carrier.Ubound &gt; -<span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">then</span>
					
					Call_ZXOJO_GET_SFLIGHT(carrier(<span style="color:#326598">0</span>))
					
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control ListboxSFLIGHT <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance ListboxSFLIGHT <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> CellBackgroundPaint(g <span style="color:#0000FF;font-weight: bold">As</span> Graphics, row <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
				<span style="color:#0000FF;font-weight: bold">If</span> row <span style="color:#0000FF;font-weight: bold">Mod</span> <span style="color:#326598">2</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">Then</span>
					g.ForeColor = FillColor
					g.FillRectangle(<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, g.Width, g.Height)
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">me</span>.HeaderAt(<span style="color:#326598">00</span>) = gc_CARRID
				<span style="color:#0000FF;font-weight: bold">me</span>.HeaderAt(<span style="color:#326598">01</span>) = gc_CONNID
				<span style="color:#0000FF;font-weight: bold">me</span>.HeaderAt(<span style="color:#326598">02</span>) = gc_FLDATE
				<span style="color:#0000FF;font-weight: bold">me</span>.HeaderAt(<span style="color:#326598">03</span>) = gc_PRICE
				<span style="color:#0000FF;font-weight: bold">me</span>.HeaderAt(<span style="color:#326598">04</span>) = gc_CURRENCY
				<span style="color:#0000FF;font-weight: bold">me</span>.HeaderAt(<span style="color:#326598">05</span>) = gc_PLANTYPE
				<span style="color:#0000FF;font-weight: bold">me</span>.HeaderAt(<span style="color:#326598">06</span>) = gc_SEATSMAX
				<span style="color:#0000FF;font-weight: bold">me</span>.HeaderAt(<span style="color:#326598">07</span>) = gc_SEATSOCC
				<span style="color:#0000FF;font-weight: bold">me</span>.HeaderAt(<span style="color:#326598">08</span>) = gc_PAYMENTSUM
				<span style="color:#0000FF;font-weight: bold">me</span>.HeaderAt(<span style="color:#326598">09</span>) = gc_SEATSMAX_B
				<span style="color:#0000FF;font-weight: bold">me</span>.HeaderAt(<span style="color:#326598">10</span>) = gc_SEATSOCC_B
				<span style="color:#0000FF;font-weight: bold">me</span>.HeaderAt(<span style="color:#326598">11</span>) = gc_SEATSMAX_F
				<span style="color:#0000FF;font-weight: bold">me</span>.HeaderAt(<span style="color:#326598">12</span>) = gc_SEATSOCC_F
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control PushButtonConnect <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance PushButtonConnect <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				ConnectSAPSever()
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">me</span>.Caption = gc_ConnectToSAP
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control LabelConnectionState <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance LabelConnectionState <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">me</span>.Value = gc_ConnectionStateOff
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> KeyDown(Key <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">case</span> key.asc
			<span style="color:#0000FF;font-weight: bold">case</span> <span style="color:#326598">13</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Enter-Taste</span>
				ConnectSAPSever()
			<span style="color:#0000FF;font-weight: bold">case</span> <span style="color:#326598">27</span>
				<span style="color:#0000FF;font-weight: bold">me</span>.close
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">select</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			BildschirmFelderSperren(<span style="color:#0000FF;font-weight: bold">true</span>)
			
			<span style="color:#0000FF;font-weight: bold">self</span>.Title = gc_TitleFlights
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> BildschirmFelderSperren(iv_sperren <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">boolean</span>, iv_Scope <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = <span style="color:#6500FE">&quot;all&quot;</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">--------------------------------------------------------------------------------</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">BildschirmFelderSperren</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">--------------------------------------------------------------------------------</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">Sperren</span> <span style="color:#7F0000;text-style:italic">und</span> <span style="color:#7F0000;text-style:italic">entsperren</span> <span style="color:#7F0000;text-style:italic">von</span> <span style="color:#7F0000;text-style:italic">Bildschirmfeldern.</span> <span style="color:#7F0000;text-style:italic">Gesperrte</span> <span style="color:#7F0000;text-style:italic">Felder</span> <span style="color:#7F0000;text-style:italic">werden</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">ausgegraut,</span> <span style="color:#7F0000;text-style:italic">entsperrte</span> <span style="color:#7F0000;text-style:italic">Felder</span> <span style="color:#7F0000;text-style:italic">werden</span> <span style="color:#7F0000;text-style:italic">wei&szlig;</span> <span style="color:#7F0000;text-style:italic">eingef&auml;rbt.</span> <span style="color:#7F0000;text-style:italic">Checkboxen</span> <span style="color:#7F0000;text-style:italic">und</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">Radiokn&ouml;pfe</span> <span style="color:#7F0000;text-style:italic">werden</span> <span style="color:#7F0000;text-style:italic">nur</span> <span style="color:#7F0000;text-style:italic">aktiviert</span> <span style="color:#7F0000;text-style:italic">oder</span> <span style="color:#7F0000;text-style:italic">deaktiviert.</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">--------------------------------------------------------------------------------</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">--&gt;</span> <span style="color:#7F0000;text-style:italic">iv_sperren</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">Sperre</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">oder</span> <span style="color:#7F0000;text-style:italic">aus</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">--&gt;</span> <span style="color:#7F0000;text-style:italic">iv_Scope</span>   <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">Bildschirmbereich</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">--------------------------------------------------------------------------------</span>
			
			var lv_sperren        <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			var lv_enabled        <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			var lv_BackColor      <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Color</span>
			var lv_ColorProtected <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">color</span> = FillColor <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">grau</span> <span style="color:#7F0000;text-style:italic">&amp;cCCCCCC</span>
			var lv_ColorOpen      <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">color</span> = &amp;c<span style="color:#FF0000">FF</span><span style="color:#00FF00">FF</span><span style="color:#0000FF">FF</span>  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">wei&szlig;</span> <span style="color:#7F0000;text-style:italic">&amp;cFFFFFF</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Das</span> <span style="color:#7F0000;text-style:italic">Programm</span> <span style="color:#7F0000;text-style:italic">hat</span> <span style="color:#7F0000;text-style:italic">einen</span> <span style="color:#7F0000;text-style:italic">Anzeige-</span> <span style="color:#7F0000;text-style:italic">und</span> <span style="color:#7F0000;text-style:italic">einen</span> <span style="color:#7F0000;text-style:italic">&Auml;nderungsmodus.</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Im</span> <span style="color:#7F0000;text-style:italic">Anzeigemodus</span> <span style="color:#7F0000;text-style:italic">kann</span> <span style="color:#7F0000;text-style:italic">nichts</span> <span style="color:#7F0000;text-style:italic">ver&auml;ndert</span> <span style="color:#7F0000;text-style:italic">oder</span> <span style="color:#7F0000;text-style:italic">gespeichert</span> <span style="color:#7F0000;text-style:italic">werden.</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Alle</span> <span style="color:#7F0000;text-style:italic">folgenden</span> <span style="color:#7F0000;text-style:italic">existierenden</span> <span style="color:#7F0000;text-style:italic">Felder</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">Abh&auml;ngigkeit</span> <span style="color:#7F0000;text-style:italic">von</span> <span style="color:#7F0000;text-style:italic">APP.MyModus</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">auf</span> <span style="color:#7F0000;text-style:italic">ReadOnly</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">true</span> <span style="color:#7F0000;text-style:italic">oder</span> <span style="color:#7F0000;text-style:italic">false</span> <span style="color:#7F0000;text-style:italic">gesetzt.</span>
			<span style="color:#7F0000;text-style:italic">&#39;if</span> <span style="color:#7F0000;text-style:italic">app.MyModus</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">app.gc_ModusAnzeige</span> <span style="color:#7F0000;text-style:italic">then</span>
			<span style="color:#7F0000;text-style:italic">&#39;lv_sperren</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">true</span>
			<span style="color:#7F0000;text-style:italic">&#39;lv_enabled</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">false</span>
			<span style="color:#7F0000;text-style:italic">&#39;else</span>
			lv_sperren = iv_sperren
			<span style="color:#0000FF;font-weight: bold">if</span> iv_sperren <span style="color:#0000FF;font-weight: bold">then</span>
				lv_enabled = <span style="color:#0000FF;font-weight: bold">false</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				lv_enabled = <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#7F0000;text-style:italic">&#39;end</span> <span style="color:#7F0000;text-style:italic">if</span>
			<span style="color:#0000FF;font-weight: bold">if</span> lv_sperren <span style="color:#0000FF;font-weight: bold">then</span>
				lv_BackColor = lv_ColorProtected
			<span style="color:#0000FF;font-weight: bold">else</span>
				lv_BackColor = lv_ColorOpen
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> iv_Scope = <span style="color:#6500FE">&quot;all&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				
				PopupSCARR.Enabled        = lv_enabled
				<span style="color:#7F0000;text-style:italic">&#39;if</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">lv_enabled</span> <span style="color:#7F0000;text-style:italic">then</span>
				<span style="color:#7F0000;text-style:italic">&#39;PopupSCARR.SelectedRowIndex</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">-1</span>
				<span style="color:#7F0000;text-style:italic">&#39;end</span> <span style="color:#7F0000;text-style:italic">if</span>
				ListboxSFLIGHT.Enabled    = lv_enabled
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#7F0000;text-style:italic">//iv_Scope</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">&quot;alles&quot;</span> <span style="color:#7F0000;text-style:italic">oder</span> <span style="color:#7F0000;text-style:italic">&quot;AutoDoc&quot;</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Call_ZXOJO_GET_SCARR()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-------------------------------------------------------------------------------</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">Method</span> <span style="color:#7F0000;text-style:italic">Call_ZXOJO_GET_SCRARR</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-------------------------------------------------------------------------------</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">method</span> <span style="color:#7F0000;text-style:italic">reads</span> <span style="color:#7F0000;text-style:italic">SAP</span> <span style="color:#7F0000;text-style:italic">table</span> <span style="color:#7F0000;text-style:italic">SCARR</span> <span style="color:#7F0000;text-style:italic">which</span> <span style="color:#7F0000;text-style:italic">contains</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">airlines</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">example</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">fills</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">PopupSCARR</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">enable</span> <span style="color:#7F0000;text-style:italic">any</span> <span style="color:#7F0000;text-style:italic">selections</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-------------------------------------------------------------------------------</span>
			
			PopupSCARR.RemoveAllRows
			
			
			var fd <span style="color:#0000FF;font-weight: bold">As</span> RFCFunctionDescriptionMBS = app.ConnectionToSAP.FunctionDescription(<span style="color:#6500FE">&quot;ZXOJO_GET_SCARR&quot;</span>)
			
			var f <span style="color:#0000FF;font-weight: bold">As</span> RFCFunctionMBS = fd.CreateFunction
			
			f.Invoke
			
			var SCARR <span style="color:#0000FF;font-weight: bold">as</span> RFCTableMBS  = f.TableValue(<span style="color:#6500FE">&quot;ET_SCARR&quot;</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">something</span> <span style="color:#7F0000;text-style:italic">found</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">SAP</span> <span style="color:#7F0000;text-style:italic">table</span> <span style="color:#7F0000;text-style:italic">SCARR?</span>
			<span style="color:#0000FF;font-weight: bold">if</span> SCARR.RowCount &lt; <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">then</span>
				MessageBox(gc_message_NoCarrier)
				<span style="color:#0000FF;font-weight: bold">return</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			var carrier <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
			
			SCARR.MoveToFirstRow
			<span style="color:#0000FF;font-weight: bold">for</span> iRow <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">to</span> SCARR.RowCount
				
				carrier = SCARR.StringValue(<span style="color:#6500FE">&quot;CARRID&quot;</span>)+<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&quot;</span>+SCARR.StringValue(<span style="color:#6500FE">&quot;CARRNAME&quot;</span>)
				
				PopupSCARR.AddRow(carrier)
				
				<span style="color:#0000FF;font-weight: bold">if</span> irow &lt; SCARR.RowCount <span style="color:#0000FF;font-weight: bold">then</span>
					SCARR.MoveToNextRow
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
			<span style="color:#0000FF;font-weight: bold">next</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Call_ZXOJO_GET_SFLIGHT(iv_CarrID <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-------------------------------------------------------------------------------</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">Method</span> <span style="color:#7F0000;text-style:italic">Call_ZXOJO_GET_SFLIGHT</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-------------------------------------------------------------------------------</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">method</span> <span style="color:#7F0000;text-style:italic">reads</span> <span style="color:#7F0000;text-style:italic">SAP</span> <span style="color:#7F0000;text-style:italic">table</span> <span style="color:#7F0000;text-style:italic">SFLIGHT</span> <span style="color:#7F0000;text-style:italic">which</span> <span style="color:#7F0000;text-style:italic">contains</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">flights</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">example</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">fills</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListboxSFLIGHT</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">-------------------------------------------------------------------------------</span>
			
			ListboxSFLIGHT.RemoveAllRows
			
			var fd <span style="color:#0000FF;font-weight: bold">As</span> RFCFunctionDescriptionMBS = app.ConnectionToSAP.FunctionDescription(<span style="color:#6500FE">&quot;ZXOJO_GET_SFLIGHT&quot;</span>)
			
			var f <span style="color:#0000FF;font-weight: bold">As</span> RFCFunctionMBS = fd.CreateFunction
			
			f.StringValue(<span style="color:#6500FE">&quot;IV_CARRID&quot;</span>)  = iv_CarrID
			f.Invoke
			
			var SFLIGHT <span style="color:#0000FF;font-weight: bold">as</span> RFCTableMBS  = f.TableValue(<span style="color:#6500FE">&quot;ET_SFLIGHT&quot;</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">something</span> <span style="color:#7F0000;text-style:italic">found</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">SAP</span> <span style="color:#7F0000;text-style:italic">table</span> <span style="color:#7F0000;text-style:italic">SFLIGHT?</span>
			<span style="color:#0000FF;font-weight: bold">if</span> SFLIGHT.RowCount &lt; <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">then</span>
				
				var s <span style="color:#0000FF;font-weight: bold">As</span> RFCStructureMBS = f.StructureValue(<span style="color:#6500FE">&quot;ES_MESSAGE&quot;</span>)
				MessageBox( s.StringValue(<span style="color:#6500FE">&quot;MESSAGE&quot;</span>) )
				
				<span style="color:#0000FF;font-weight: bold">return</span>
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			var fldate <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
			
			SFLIGHT.MoveToFirstRow
			<span style="color:#0000FF;font-weight: bold">for</span> iRow <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">to</span> SFLIGHT.RowCount
				
				fldate = SFLIGHT.StringValue(<span style="color:#6500FE">&quot;FLDATE&quot;</span>)
				<span style="color:#0000FF;font-weight: bold">select</span> <span style="color:#0000FF;font-weight: bold">case</span> logon_lang.Value
				<span style="color:#0000FF;font-weight: bold">case</span> <span style="color:#6500FE">&quot;DE&quot;</span>
					fldate = fldate.Middle(<span style="color:#326598">6</span>,<span style="color:#326598">2</span>)+<span style="color:#6500FE">&quot;.&quot;</span>+fldate.Middle(<span style="color:#326598">4</span>,<span style="color:#326598">2</span>)+<span style="color:#6500FE">&quot;.&quot;</span>+fldate.left(<span style="color:#326598">4</span>)
				<span style="color:#0000FF;font-weight: bold">case</span> <span style="color:#6500FE">&quot;EN&quot;</span>
					fldate = fldate.Middle(<span style="color:#326598">4</span>,<span style="color:#326598">2</span>)+<span style="color:#6500FE">&quot;-&quot;</span>+fldate.Middle(<span style="color:#326598">6</span>,<span style="color:#326598">2</span>)+<span style="color:#6500FE">&quot;-&quot;</span>+fldate.left(<span style="color:#326598">4</span>)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">select</span>
				
				ListboxSFLIGHT.AddRow(SFLIGHT.StringValue(<span style="color:#6500FE">&quot;CARRID&quot;</span>) _
						, SFLIGHT.StringValue(<span style="color:#6500FE">&quot;CONNID&quot;</span>) _
						, fldate _
						, SFLIGHT.StringValue(<span style="color:#6500FE">&quot;PRICE&quot;</span>) _
						, SFLIGHT.StringValue(<span style="color:#6500FE">&quot;CURRENCY&quot;</span>) _
						, SFLIGHT.StringValue(<span style="color:#6500FE">&quot;PLANETYPE&quot;</span>) _
						, SFLIGHT.StringValue(<span style="color:#6500FE">&quot;SEATSMAX&quot;</span>) _
						, SFLIGHT.StringValue(<span style="color:#6500FE">&quot;SEATSOCC&quot;</span>) _
						, SFLIGHT.StringValue(<span style="color:#6500FE">&quot;PAYMENTSUM&quot;</span>) _
						, SFLIGHT.StringValue(<span style="color:#6500FE">&quot;SEATSMAX_B&quot;</span>) _
						, SFLIGHT.StringValue(<span style="color:#6500FE">&quot;SEATSOCC_B&quot;</span>) _
						, SFLIGHT.StringValue(<span style="color:#6500FE">&quot;SEATSMAX_F&quot;</span>) _
						, SFLIGHT.StringValue(<span style="color:#6500FE">&quot;SEATSOCC_F&quot;</span>))
				
				<span style="color:#0000FF;font-weight: bold">if</span> irow &lt; SFLIGHT.RowCount <span style="color:#0000FF;font-weight: bold">then</span>
					SFLIGHT.MoveToNextRow
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
			<span style="color:#0000FF;font-weight: bold">next</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> ConnectSAPSever()
			<span style="color:#0000FF;font-weight: bold">if</span> logon_ashost.Value = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">or</span> logon_client.value = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">or</span> logon_sysnr.Value = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">or</span> _
					logon_user.Value = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">or</span> logon_passwd.Value = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">or</span> logon_lang.Value = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				MessageBox(<span style="color:#6500FE">&quot;Logon</span> <span style="color:#6500FE">parameter</span> <span style="color:#6500FE">incomplete&quot;</span>)
				<span style="color:#0000FF;font-weight: bold">return</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			
			<span style="color:#0000FF">#If</span> TargetWin32
				var LibFile <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = <span style="color:#6500FE">&quot;sapnwrfc.dll&quot;</span>
			<span style="color:#0000FF">#Else</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">actual</span> <span style="color:#7F0000;text-style:italic">folder</span>
				var MacOsFolder <span style="color:#0000FF;font-weight: bold">as</span> folderitem = app.ExecutableFile.Parent
				
				System.EnvironmentVariable(<span style="color:#6500FE">&quot;DYLD_LIBRARY_PATH&quot;</span>) = MacOsFolder.NativePath
				
				<span style="color:#0000FF;font-weight: bold">If</span> System.EnvironmentVariable(<span style="color:#6500FE">&quot;DYLD_LIBRARY_PATH&quot;</span>) = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">Then</span>
					MessageBox(<span style="color:#6500FE">&quot;DYLD_LIBRARY_PATH</span> <span style="color:#6500FE">variable</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">set&quot;</span>)
					<span style="color:#0000FF;font-weight: bold">return</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				var LibFile <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = MacOsFolder.Child(<span style="color:#6500FE">&quot;libsapnwrfc.dylib&quot;</span>)
				var LibPath <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> = LibFile.parent.NativePath
				
				<span style="color:#0000FF;font-weight: bold">Call</span> RFCModuleMBS.SetCurrentWorkingDirectory(libPath)
				
			<span style="color:#0000FF">#EndIf</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> <span style="color:#0000FF;font-weight: bold">not</span> RFCModuleMBS.LoadLibrary(LibFile) <span style="color:#0000FF;font-weight: bold">Then</span>
				MessageBox(<span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">load</span> <span style="color:#6500FE">library&quot;</span>)
				MessageBox RFCModuleMBS.LibraryLoadErrorMessage
				<span style="color:#0000FF;font-weight: bold">return</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">&#39;msgbox</span> <span style="color:#7F0000;text-style:italic">RFCModuleMBS.Version</span>
			<span style="color:#7F0000;text-style:italic">&#39;fz.message(gc_msgty_i,</span> <span style="color:#7F0000;text-style:italic">RFCModuleMBS.Version)</span>
			<span style="color:#7F0000;text-style:italic">&#39;Break</span>
			
			var loginParams <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> Dictionary
			loginParams.Value(<span style="color:#6500FE">&quot;ashost&quot;</span>) = logon_ashost.Value
			loginParams.Value(<span style="color:#6500FE">&quot;sysnr&quot;</span>)  = logon_sysnr.Value
			loginParams.Value(<span style="color:#6500FE">&quot;client&quot;</span>) = logon_client.Value
			loginParams.Value(<span style="color:#6500FE">&quot;user&quot;</span>)   = logon_user.Value
			loginParams.Value(<span style="color:#6500FE">&quot;passwd&quot;</span>) = logon_passwd.Value
			loginParams.Value(<span style="color:#6500FE">&quot;lang&quot;</span>)   = logon_lang.Value
			
			app.ConnectionToSAP = <span style="color:#0000FF;font-weight: bold">New</span> RFCConnectionMBS(loginParams)
			
			LabelConnectionState.Value = gc_ConnectionStateOn
			
			Call_ZXOJO_GET_SCARR()
			
			BildschirmFelderSperren(<span style="color:#0000FF;font-weight: bold">false</span>)
			
			<span style="color:#0000FF;font-weight: bold">Exception</span> r <span style="color:#0000FF;font-weight: bold">As</span> RFCErrorExceptionMBS
			LabelConnectionState.Value = gc_ConnectionStateOff
			MessageBox r.message
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;Bemerkungen</span> <span style="color:#6500FE">/</span> <span style="color:#6500FE">Remarks&quot;</span>
<div class="RB_Comment">			Capacity BC means maximum capacity in business class
			Capacity FC means maximum capacity in first class</div>
</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar MainMenuBar</div>
<div class="RB_Code">		MenuItem FileMenu = <span style="color:#6500FE">&quot;&amp;File&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;#App.kFileQuit&quot;</span></div>
<div class="RB_Code">		MenuItem EditMenu = <span style="color:#6500FE">&quot;&amp;Edit&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;&amp;Undo&quot;</span></div>
<div class="RB_Code">			MenuItem EditSeparator1 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;Cu&amp;t&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;&amp;Copy&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;&amp;Paste&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;#App.kEditClear&quot;</span></div>
<div class="RB_Code">			MenuItem EditSeparator2 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditSelectAll = <span style="color:#6500FE">&quot;Select</span> <span style="color:#6500FE">&amp;All&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-tools-rfc-xojosaprfcsample">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

