<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /DynaPDF/Text Positions</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /DynaPDF/Text Positions</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/DynaPDF/Text Positions</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS DynaPDF Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /DynaPDF/Text Positions<BR>
This example is the version from Wed, 19th Jan 2021.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;Text</span> <span style="color:#6500FE">Positions.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kEditClear = <span style="color:#6500FE">&quot;&amp;Delete&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuit = <span style="color:#6500FE">&quot;&amp;Quit&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuitShortcut = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> NewDocument()
			<span style="color:#0000FF;font-weight: bold">If</span> WindowCount = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> f <span style="color:#0000FF;font-weight: bold">As</span> FolderItem = GetOpenFolderItem(FileTypes1.pdf)
				
				<span style="color:#0000FF;font-weight: bold">If</span> f &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
					OpenDocument f
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#0000FF;font-weight: bold">Dim</span> f <span style="color:#0000FF;font-weight: bold">As</span> FolderItem = FindFile(<span style="color:#6500FE">&quot;license.pdf&quot;</span>)
			<span style="color:#0000FF;font-weight: bold">If</span> f&lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">And</span> f.Exists <span style="color:#0000FF;font-weight: bold">Then</span>
				OpenDocument f
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> ff <span style="color:#0000FF;font-weight: bold">As</span> FolderItem = SpecialFolder.Desktop.child(<span style="color:#6500FE">&quot;test.pdf&quot;</span>)
			<span style="color:#0000FF;font-weight: bold">If</span> ff&lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">And</span> ff.Exists <span style="color:#0000FF;font-weight: bold">Then</span>
				OpenDocument ff
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> OpenDocument(item <span style="color:#0000FF;font-weight: bold">As</span> FolderItem)
			<span style="color:#0000FF;font-weight: bold">Dim</span> m <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MainWindow(item)
			
			m.show
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MainWindow <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control CheckSplit <span style="color:#0000FF;font-weight: bold">Inherits</span> CheckBox</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance CheckSplit <span style="color:#0000FF;font-weight: bold">Inherits</span> CheckBox</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				split = <span style="color:#0000FF;font-weight: bold">me</span>.Value
				canvas1.Invalidate
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Canvas1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Canvas</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Canvas1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Canvas</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Paint(g <span style="color:#0000FF;font-weight: bold">As</span> Graphics, areas() <span style="color:#0000FF;font-weight: bold">As</span> REALbasic.Rect)
				<span style="color:#0000FF;font-weight: bold">Const</span> factor = <span style="color:#006532">2.0</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> lines() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> Page <span style="color:#0000FF;font-weight: bold">as</span> DynaPDFPageMBS = pdf.GetPage(<span style="color:#326598">1</span>)
				<span style="color:#0000FF;font-weight: bold">dim</span> bbox <span style="color:#0000FF;font-weight: bold">as</span> DynaPDFRectMBS = page.BBox(page.kpbMediaBox)
				<span style="color:#0000FF;font-weight: bold">dim</span> PageWidth  <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = bbox.Width
				<span style="color:#0000FF;font-weight: bold">Dim</span> PageHeight <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = bbox.top - bbox.Bottom
				
				<span style="color:#0000FF;font-weight: bold">if</span> ShowPDF <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">draw</span> <span style="color:#7F0000;text-style:italic">pdf</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">background</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> pic <span style="color:#0000FF;font-weight: bold">as</span> Picture = pdf.RenderPagePicture(<span style="color:#326598">1</span>, PageWidth*factor, PageHeight*factor, <span style="color:#326598">2</span>, <span style="color:#0000FF;font-weight: bold">nil</span>)
					g.DrawPicture pic, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">now</span> <span style="color:#7F0000;text-style:italic">draw</span> <span style="color:#7F0000;text-style:italic">text</span> <span style="color:#7F0000;text-style:italic">blocks</span>
				<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> t <span style="color:#0000FF;font-weight: bold">as</span> PDFText <span style="color:#0000FF;font-weight: bold">in</span> texts
					
					<span style="color:#0000FF;font-weight: bold">dim</span> m <span style="color:#0000FF;font-weight: bold">as</span> DynaPDFMatrixMBS = t.EffectiveMatrix
					
					<span style="color:#7F0000;text-style:italic">//XY</span> <span style="color:#7F0000;text-style:italic">Axis</span>
					g.TextSize = GetScaleY(m) * t.State.FontSize * factor
					
					<span style="color:#0000FF;font-weight: bold">If</span> t.KerningA &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
						<span style="color:#0000FF;font-weight: bold">Dim</span> TextPos <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#326598">0</span>
						<span style="color:#0000FF;font-weight: bold">For</span> <span style="color:#0000FF;font-weight: bold">Each</span> k <span style="color:#0000FF;font-weight: bold">As</span> DynaPDFTextRecordAMBS <span style="color:#0000FF;font-weight: bold">In</span> t.KerningA
							<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">translate</span> <span style="color:#7F0000;text-style:italic">native</span> <span style="color:#7F0000;text-style:italic">encoding</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">Unicode</span>
							<span style="color:#0000FF;font-weight: bold">Dim</span> decoded <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
							<span style="color:#0000FF;font-weight: bold">Dim</span> ktext <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> = k.Text
							
							TextPos = TextPos - k.Advance
							
							<span style="color:#0000FF;font-weight: bold">Dim</span> TextPosStart <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = TextPos
							<span style="color:#0000FF;font-weight: bold">Dim</span> i <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span>
							<span style="color:#0000FF;font-weight: bold">Dim</span> l <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = ktext.LenB
							<span style="color:#0000FF;font-weight: bold">Dim</span> TextWidth <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#326598">0</span>
							<span style="color:#0000FF;font-weight: bold">while</span> i &lt; l
								
								<span style="color:#0000FF;font-weight: bold">Dim</span> OldTextPos <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = TextPos
								TextWidth = <span style="color:#326598">0</span>
								<span style="color:#0000FF;font-weight: bold">dim</span> ProcessedBytes <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">0</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> OneText <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> = DynaPDFMBS.TranslateRawCode(t.state.FontHandle, kText, i, TextWidth, decoded, t.state.CharSpacing, t.state.WordSpacing, t.State.TextScale, ProcessedBytes)
								
								lines.append OneText+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+Str(width)
								<span style="color:#0000FF;font-weight: bold">if</span> width &lt;= <span style="color:#006532">0.0</span> <span style="color:#0000FF;font-weight: bold">then</span>
									Break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">something</span> <span style="color:#7F0000;text-style:italic">broken?</span>
								<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
								
								<span style="color:#0000FF;font-weight: bold">If</span> ProcessedBytes &lt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">Then</span>
									Break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">should</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">happen</span>
									ProcessedBytes = <span style="color:#326598">1</span>
								<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
								
								TextPos = TextPos + TextWidth
								
								<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">here</span> <span style="color:#7F0000;text-style:italic">will</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">match</span> <span style="color:#7F0000;text-style:italic">what</span> <span style="color:#7F0000;text-style:italic">DynaPDF</span> <span style="color:#7F0000;text-style:italic">draws</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">do</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">take</span> <span style="color:#7F0000;text-style:italic">style</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">spacing</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">account</span>
								
								g.ForeColor = &amp;c<span style="color:#FF0000">00</span><span style="color:#00FF00">FF</span><span style="color:#0000FF">00</span>
								g.PenWidth = <span style="color:#326598">1</span>
								
								
								<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">calculate</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">4</span> <span style="color:#7F0000;text-style:italic">points</span>
								<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">top</span> <span style="color:#7F0000;text-style:italic">left</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> x1 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = OldTextPos
								<span style="color:#0000FF;font-weight: bold">Dim</span> y1 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#006532">0.0</span>
								
								m.Transform(x1,y1)
								
								<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">bottom</span> <span style="color:#7F0000;text-style:italic">left</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> x2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = OldTextPos
								<span style="color:#0000FF;font-weight: bold">Dim</span> y2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = t.State.FontSize
								
								m.Transform(x2,y2)
								
								<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">bottom</span> <span style="color:#7F0000;text-style:italic">right</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> x3 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = TextPos
								<span style="color:#0000FF;font-weight: bold">Dim</span> y3 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = t.State.FontSize
								
								m.Transform(x3,y3)
								
								<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">top</span> <span style="color:#7F0000;text-style:italic">right</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> x4 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = TextPos
								<span style="color:#0000FF;font-weight: bold">Dim</span> y4 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#326598">0</span>
								
								m.Transform(x4,y4)
								
								<span style="color:#0000FF;font-weight: bold">If</span> Split <span style="color:#0000FF;font-weight: bold">Then</span>
									
									<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">draw</span> <span style="color:#7F0000;text-style:italic">rectangle</span> <span style="color:#7F0000;text-style:italic">(could</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">rotated</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">skewed)</span>
									g.DrawLine x1*factor, (PageHeight-y1)*factor, x2*factor, (PageHeight-y2)*factor
									g.DrawLine x2*factor, (PageHeight-y2)*factor, x3*factor, (PageHeight-y3)*factor
									g.DrawLine x3*factor, (PageHeight-y3)*factor, x4*factor, (PageHeight-y4)*factor
									g.DrawLine x4*factor, (PageHeight-y4)*factor, x1*factor, (PageHeight-y1)*factor
								<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
								
								
								g.ForeColor = &amp;c<span style="color:#FF0000">00</span><span style="color:#00FF00">00</span><span style="color:#0000FF">FF</span>
								g.TextSize = CalcDistance(x1,y1,x2,y2)*factor
								
								<span style="color:#0000FF;font-weight: bold">Dim</span> y <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = Min(y1,y2) <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">bottom</span> <span style="color:#7F0000;text-style:italic">side</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">draw</span> <span style="color:#7F0000;text-style:italic">text.</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> x <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = (x3+x1) / <span style="color:#006532">2.0</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">middle</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">text</span> <span style="color:#7F0000;text-style:italic">block</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">our</span> <span style="color:#7F0000;text-style:italic">text</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> tw <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = g.StringWidth(OneText)
								
								g.DrawString OneText, x * factor - tw/<span style="color:#326598">2</span>, (PageHeight-y)*factor
								
								i = i + ProcessedBytes
							<span style="color:#0000FF;font-weight: bold">wend</span>
							
							
							
							<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> split <span style="color:#0000FF;font-weight: bold">then</span>
								<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">box</span> <span style="color:#7F0000;text-style:italic">around</span>
								g.PenWidth = <span style="color:#326598">1</span>
								g.ForeColor = &amp;c<span style="color:#FF0000">FF</span><span style="color:#00FF00">00</span><span style="color:#0000FF">00</span>
								
								<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">calculate</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">4</span> <span style="color:#7F0000;text-style:italic">points</span>
								<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">top</span> <span style="color:#7F0000;text-style:italic">left</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> x1 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = TextPosStart
								<span style="color:#0000FF;font-weight: bold">Dim</span> y1 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#006532">0.0</span>
								
								m.Transform(x1,y1)
								
								<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">bottom</span> <span style="color:#7F0000;text-style:italic">left</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> x2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = TextPosStart
								<span style="color:#0000FF;font-weight: bold">Dim</span> y2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = t.State.FontSize
								
								m.Transform(x2,y2)
								
								<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">bottom</span> <span style="color:#7F0000;text-style:italic">right</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> x3 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = TextPos
								<span style="color:#0000FF;font-weight: bold">Dim</span> y3 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = t.State.FontSize
								
								m.Transform(x3,y3)
								
								<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">top</span> <span style="color:#7F0000;text-style:italic">right</span>
								<span style="color:#0000FF;font-weight: bold">Dim</span> x4 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = TextPos
								<span style="color:#0000FF;font-weight: bold">Dim</span> y4 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#326598">0</span>
								
								m.Transform(x4,y4)
								
								
								g.DrawLine x1*factor, (PageHeight-y1)*factor, x2*factor, (PageHeight-y2)*factor
								g.DrawLine x2*factor, (PageHeight-y2)*factor, x3*factor, (PageHeight-y3)*factor
								g.DrawLine x3*factor, (PageHeight-y3)*factor, x4*factor, (PageHeight-y4)*factor
								g.DrawLine x4*factor, (PageHeight-y4)*factor, x1*factor, (PageHeight-y1)*factor
								
								
							<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
							
							
						<span style="color:#0000FF;font-weight: bold">next</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">next</span>
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control CheckShowPDF <span style="color:#0000FF;font-weight: bold">Inherits</span> CheckBox</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance CheckShowPDF <span style="color:#0000FF;font-weight: bold">Inherits</span> CheckBox</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				ShowPDF = <span style="color:#0000FF;font-weight: bold">me</span>.Value
				canvas1.Invalidate
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#0000FF;font-weight: bold">dim</span> p <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> MyDynapdfMBS
			p.SetLicenseKey <span style="color:#6500FE">&quot;Pro&quot;</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">For</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">example</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">Pro</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">Enterprise</span> <span style="color:#7F0000;text-style:italic">License</span>
			
			<span style="color:#0000FF;font-weight: bold">call</span> p.CreateNewPDF(<span style="color:#0000FF;font-weight: bold">Nil</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Skip</span> <span style="color:#7F0000;text-style:italic">anything</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">required</span>
			<span style="color:#0000FF;font-weight: bold">call</span> p.SetImportFlags p.kifImportAll+p.kifImportAsPage
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">From</span> <span style="color:#7F0000;text-style:italic">which</span> <span style="color:#7F0000;text-style:italic">PDF</span> <span style="color:#7F0000;text-style:italic">file</span> <span style="color:#7F0000;text-style:italic">do</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">want</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">extract</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">images?</span>
			<span style="color:#0000FF;font-weight: bold">call</span> p.OpenImportFile(<span style="color:#0000FF;font-weight: bold">self</span>.file, p.kptOpen, <span style="color:#6500FE">&quot;&quot;</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Comment</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">out</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">want</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">extract</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">images</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">specific</span> <span style="color:#7F0000;text-style:italic">pages</span> <span style="color:#7F0000;text-style:italic">only</span>
			<span style="color:#0000FF;font-weight: bold">call</span> p.ImportPDFFile(<span style="color:#326598">1</span>, <span style="color:#006532">1.0</span>, <span style="color:#006532">1.0</span>)
			<span style="color:#0000FF;font-weight: bold">call</span> p.CloseImportFile
			
			<span style="color:#0000FF;font-weight: bold">dim</span> parser <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> MyDynaPDFParseInterfaceMBS(p)
			
			<span style="color:#7F0000;text-style:italic">&#39;If</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">want</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">multipage</span> <span style="color:#7F0000;text-style:italic">TIFF</span> <span style="color:#7F0000;text-style:italic">then</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">output</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">here</span>
			<span style="color:#7F0000;text-style:italic">&#39;and</span> <span style="color:#7F0000;text-style:italic">call</span> <span style="color:#7F0000;text-style:italic">AddImage()</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">callback</span> <span style="color:#7F0000;text-style:italic">function.</span> <span style="color:#7F0000;text-style:italic">After</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">loop</span>
			<span style="color:#7F0000;text-style:italic">&#39;returns</span> <span style="color:#7F0000;text-style:italic">call</span> <span style="color:#7F0000;text-style:italic">CloseImage()</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">close</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">image</span> <span style="color:#7F0000;text-style:italic">file.</span>
			
			<span style="color:#0000FF;font-weight: bold">call</span> p.EditPage <span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">call</span> p.ParseContent(parser, p.kpfNone)
			<span style="color:#0000FF;font-weight: bold">call</span> p.EndPage
			
			<span style="color:#0000FF;font-weight: bold">self</span>.texts = parser.Texts
			<span style="color:#0000FF;font-weight: bold">self</span>.pdf = p
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> CalcDistance(x1 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>, y1 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>, x2 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>, y2 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Distance</span> <span style="color:#7F0000;text-style:italic">between</span> <span style="color:#7F0000;text-style:italic">two</span> <span style="color:#7F0000;text-style:italic">points</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> dx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = x2-x1
			<span style="color:#0000FF;font-weight: bold">dim</span> dy <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = y2-y1
			
			<span style="color:#0000FF;font-weight: bold">return</span> sqrt(dx*dx + dy*dy)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(file <span style="color:#0000FF;font-weight: bold">as</span> FolderItem)
			<span style="color:#0000FF;font-weight: bold">Self</span>.file = file
			<span style="color:#0000FF;font-weight: bold">Self</span>.Title = file.DisplayName
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Calling</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">overridden</span> <span style="color:#7F0000;text-style:italic">superclass</span> <span style="color:#7F0000;text-style:italic">constructor.</span>
			<span style="color:#0000FF;font-weight: bold">Super</span>.Constructor
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> GetScaleX(m <span style="color:#0000FF;font-weight: bold">As</span> DynapdfMatrixMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> x1 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>= <span style="color:#006532">0.0</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> y1 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>= <span style="color:#006532">0.0</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> x2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>= <span style="color:#006532">1.0</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> y2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>= <span style="color:#006532">0.0</span>
			Transform(m, x1, y1)
			Transform(m, x2, y2)
			<span style="color:#0000FF;font-weight: bold">if</span> (y1 &gt; y2) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">return</span> -CalcDistance(x1, y1, x2, y2)
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#0000FF;font-weight: bold">return</span> CalcDistance(x1, y1, x2, y2)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> GetScaleY(m <span style="color:#0000FF;font-weight: bold">As</span> DynapdfMatrixMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> x1 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>= <span style="color:#006532">0.0</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> y1 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>= <span style="color:#006532">0.0</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> x2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>= <span style="color:#006532">0.0</span>
			<span style="color:#0000FF;font-weight: bold">Dim</span> y2 <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span>= <span style="color:#006532">1.0</span>
			Transform(m, x1, y1)
			Transform(m, x2, y2)
			<span style="color:#0000FF;font-weight: bold">if</span> (y1 &gt; y2) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">return</span> -CalcDistance(x1, y1, x2, y2)
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#0000FF;font-weight: bold">return</span> CalcDistance(x1, y1, x2, y2)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ShowPDF <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = <span style="color:#0000FF;font-weight: bold">true</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> file <span style="color:#0000FF;font-weight: bold">As</span> FolderItem</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> pdf <span style="color:#0000FF;font-weight: bold">As</span> MyDynaPDFMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> split <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> texts() <span style="color:#0000FF;font-weight: bold">As</span> PDFText</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar MainMenuBar</div>
<div class="RB_Code">		MenuItem FileMenu = <span style="color:#6500FE">&quot;&amp;File&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;#App.kFileQuit&quot;</span></div>
<div class="RB_Code">		MenuItem EditMenu = <span style="color:#6500FE">&quot;&amp;Edit&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;&amp;Undo&quot;</span></div>
<div class="RB_Code">			MenuItem EditSeparator1 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;Cu&amp;t&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;&amp;Copy&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;&amp;Paste&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;#App.kEditClear&quot;</span></div>
<div class="RB_Code">			MenuItem EditSeparator2 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditSelectAll = <span style="color:#6500FE">&quot;Select</span> <span style="color:#6500FE">&amp;All&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> PDFState</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(other <span style="color:#0000FF;font-weight: bold">as</span> PDFState)
			<span style="color:#0000FF;font-weight: bold">self</span>.CharSpacing  = other.CharSpacing
			<span style="color:#0000FF;font-weight: bold">self</span>.ExtGState    = other.ExtGState
			<span style="color:#0000FF;font-weight: bold">self</span>.FontHandle   = other.FontHandle
			<span style="color:#0000FF;font-weight: bold">self</span>.FontInfo     = other.FontInfo
			<span style="color:#0000FF;font-weight: bold">self</span>.FontName     = other.FontName
			<span style="color:#0000FF;font-weight: bold">self</span>.FontSize     = other.FontSize
			<span style="color:#0000FF;font-weight: bold">self</span>.FontStyle    = other.FontStyle
			<span style="color:#0000FF;font-weight: bold">self</span>.MiterLimit   = other.MiterLimit
			<span style="color:#0000FF;font-weight: bold">self</span>.textDrawMode = other.textDrawMode
			<span style="color:#0000FF;font-weight: bold">self</span>.TextScale    = other.TextScale
			<span style="color:#0000FF;font-weight: bold">self</span>.WordSpacing  = other.WordSpacing
			<span style="color:#0000FF;font-weight: bold">self</span>.matrix       = <span style="color:#0000FF;font-weight: bold">new</span> DynaPDFMatrixMBS(other.matrix) <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">copy</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> constructor()
			matrix = <span style="color:#0000FF;font-weight: bold">new</span> DynaPDFMatrixMBS <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">makes</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">identity</span> <span style="color:#7F0000;text-style:italic">matrix</span>
			FontSize = <span style="color:#006532">1.0</span>
			CharSpacing = <span style="color:#006532">0.0</span>
			TextDrawMode = DynaPDFMBS.kdmNormal
			TextScale = <span style="color:#006532">100.0</span>
			WordSpacing = <span style="color:#006532">0.0</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> CharSpacing <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ExtGState <span style="color:#0000FF;font-weight: bold">As</span> DynaPDFExtGState2MBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> FontHandle <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> FontInfo <span style="color:#0000FF;font-weight: bold">As</span> DynaPDFFontInfoMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> FontName <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> FontSize <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> FontStyle <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Leading <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> MiterLimit <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> TextScale <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> WordSpacing <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> matrix <span style="color:#0000FF;font-weight: bold">As</span> DynaPDFMatrixMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> textDrawMode <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MyDynaPDFMBS <span style="color:#0000FF;font-weight: bold">Inherits</span> DynaPDFMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> Error(ErrorCode <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, ErrorMessage <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, ErrorType <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">output</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">messages</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">console:</span>
			System.DebugLog str(ErrorCode)+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+ErrorMessage
			
			<span style="color:#7F0000;text-style:italic">&#39;//</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">display</span> <span style="color:#7F0000;text-style:italic">dialog:</span>
			<span style="color:#7F0000;text-style:italic">&#39;Dim</span> <span style="color:#7F0000;text-style:italic">d</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">New</span> <span style="color:#7F0000;text-style:italic">MessageDialog</span> <span style="color:#7F0000;text-style:italic">//declare</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">MessageDialog</span> <span style="color:#7F0000;text-style:italic">object</span>
			<span style="color:#7F0000;text-style:italic">&#39;Dim</span> <span style="color:#7F0000;text-style:italic">b</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">MessageDialogButton</span> <span style="color:#7F0000;text-style:italic">//for</span> <span style="color:#7F0000;text-style:italic">handling</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">result</span>
			<span style="color:#7F0000;text-style:italic">&#39;</span>
			<span style="color:#7F0000;text-style:italic">&#39;d.icon=MessageDialog.GraphicCaution</span> <span style="color:#7F0000;text-style:italic">//display</span> <span style="color:#7F0000;text-style:italic">warning</span> <span style="color:#7F0000;text-style:italic">icon</span>
			<span style="color:#7F0000;text-style:italic">&#39;d.ActionButton.Caption=&quot;Continue&quot;</span>
			<span style="color:#7F0000;text-style:italic">&#39;d.CancelButton.Visible=True</span>    <span style="color:#7F0000;text-style:italic">//show</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Cancel</span> <span style="color:#7F0000;text-style:italic">button</span>
			<span style="color:#7F0000;text-style:italic">&#39;</span>
			<span style="color:#7F0000;text-style:italic">&#39;//</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">warning</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">error?</span>
			<span style="color:#7F0000;text-style:italic">&#39;</span>
			<span style="color:#7F0000;text-style:italic">&#39;if</span> <span style="color:#7F0000;text-style:italic">BitAnd(ErrorType,</span> <span style="color:#7F0000;text-style:italic">me.kE_WARNING)</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">me.kE_WARNING</span> <span style="color:#7F0000;text-style:italic">then</span>
			<span style="color:#7F0000;text-style:italic">&#39;//</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">user</span> <span style="color:#7F0000;text-style:italic">decided</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">ignore,</span> <span style="color:#7F0000;text-style:italic">we&#39;ll</span> <span style="color:#7F0000;text-style:italic">ignore</span>
			<span style="color:#7F0000;text-style:italic">&#39;if</span> <span style="color:#7F0000;text-style:italic">IgnoreWarnings</span> <span style="color:#7F0000;text-style:italic">then</span> <span style="color:#7F0000;text-style:italic">Return</span> <span style="color:#7F0000;text-style:italic">0</span>
			<span style="color:#7F0000;text-style:italic">&#39;</span>
			<span style="color:#7F0000;text-style:italic">&#39;d.Message=&quot;A</span> <span style="color:#7F0000;text-style:italic">warning</span> <span style="color:#7F0000;text-style:italic">occurred</span> <span style="color:#7F0000;text-style:italic">while</span> <span style="color:#7F0000;text-style:italic">processing</span> <span style="color:#7F0000;text-style:italic">your</span> <span style="color:#7F0000;text-style:italic">PDF</span> <span style="color:#7F0000;text-style:italic">code.&quot;</span>
			<span style="color:#7F0000;text-style:italic">&#39;</span>
			<span style="color:#7F0000;text-style:italic">&#39;//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">add</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">third</span> <span style="color:#7F0000;text-style:italic">button</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">display</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">warnings</span>
			<span style="color:#7F0000;text-style:italic">&#39;d.AlternateActionButton.Caption</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">&quot;Ignore</span> <span style="color:#7F0000;text-style:italic">warnings&quot;</span>
			<span style="color:#7F0000;text-style:italic">&#39;d.AlternateActionButton.Visible</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">true</span>
			<span style="color:#7F0000;text-style:italic">&#39;else</span>
			<span style="color:#7F0000;text-style:italic">&#39;d.Message=&quot;An</span> <span style="color:#7F0000;text-style:italic">error</span> <span style="color:#7F0000;text-style:italic">occurred</span> <span style="color:#7F0000;text-style:italic">while</span> <span style="color:#7F0000;text-style:italic">processing</span> <span style="color:#7F0000;text-style:italic">your</span> <span style="color:#7F0000;text-style:italic">PDF</span> <span style="color:#7F0000;text-style:italic">code.&quot;</span>
			<span style="color:#7F0000;text-style:italic">&#39;end</span> <span style="color:#7F0000;text-style:italic">if</span>
			<span style="color:#7F0000;text-style:italic">&#39;</span>
			<span style="color:#7F0000;text-style:italic">&#39;d.Explanation</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">str(ErrorCode)+&quot;:</span> <span style="color:#7F0000;text-style:italic">&quot;+ErrorMessage</span>
			<span style="color:#7F0000;text-style:italic">&#39;</span>
			<span style="color:#7F0000;text-style:italic">&#39;b=d.ShowModal</span> <span style="color:#7F0000;text-style:italic">//display</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">dialog</span>
			<span style="color:#7F0000;text-style:italic">&#39;</span>
			<span style="color:#7F0000;text-style:italic">&#39;Select</span> <span style="color:#7F0000;text-style:italic">Case</span> <span style="color:#7F0000;text-style:italic">b</span> <span style="color:#7F0000;text-style:italic">//determine</span> <span style="color:#7F0000;text-style:italic">which</span> <span style="color:#7F0000;text-style:italic">button</span> <span style="color:#7F0000;text-style:italic">was</span> <span style="color:#7F0000;text-style:italic">pressed.</span>
			<span style="color:#7F0000;text-style:italic">&#39;Case</span> <span style="color:#7F0000;text-style:italic">d.ActionButton</span>
			<span style="color:#7F0000;text-style:italic">&#39;Return</span> <span style="color:#7F0000;text-style:italic">0</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">ignore</span>
			<span style="color:#7F0000;text-style:italic">&#39;Case</span> <span style="color:#7F0000;text-style:italic">d.AlternateActionButton</span>
			<span style="color:#7F0000;text-style:italic">&#39;IgnoreWarnings</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">true</span>
			<span style="color:#7F0000;text-style:italic">&#39;Return</span> <span style="color:#7F0000;text-style:italic">0</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">ignore</span>
			<span style="color:#7F0000;text-style:italic">&#39;Case</span> <span style="color:#7F0000;text-style:italic">d.CancelButton</span>
			<span style="color:#7F0000;text-style:italic">&#39;Return</span> <span style="color:#7F0000;text-style:italic">-1</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">stop</span>
			<span style="color:#7F0000;text-style:italic">&#39;End</span> <span style="color:#7F0000;text-style:italic">select</span>
			<span style="color:#7F0000;text-style:italic">&#39;</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> IgnoreWarnings <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MyDynaPDFParseInterfaceMBS <span style="color:#0000FF;font-weight: bold">Inherits</span> DynaPDFParseInterfaceMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> BeginTemplate(ObjectPtr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, Handle <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, BBox <span style="color:#0000FF;font-weight: bold">as</span> DynaPDFRectMBS, Matrix <span style="color:#0000FF;font-weight: bold">as</span> DynaPDFMatrixMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">If</span> matrix &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				current.matrix = current.matrix * matrix
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> MulMatrix(ObjectPtr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, matrix <span style="color:#0000FF;font-weight: bold">as</span> DynaPDFMatrixMBS)
			<span style="color:#0000FF;font-weight: bold">If</span> matrix &lt;&gt; <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				current.matrix = current.matrix * matrix
			<span style="color:#0000FF;font-weight: bold">Else</span>
				Break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">should</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">happen</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> RestoreGraphicState() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			current = states.pop
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> SaveGraphicState() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			states.Append current
			current = <span style="color:#0000FF;font-weight: bold">new</span> PDFState(Current)
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> SetCharSpacing(ObjectPtr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, Value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			current.CharSpacing = value
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> SetExtGState(ObjectPtr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, GS <span style="color:#0000FF;font-weight: bold">as</span> DynaPDFExtGState2MBS)
			current.ExtGState = gs
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> SetFont(ObjectPtr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, fontType <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, Embedded <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">boolean</span>, FontName <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, Style <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, FontSize <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>, FontHandle <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, FontInfo <span style="color:#0000FF;font-weight: bold">as</span> DynaPDFFontInfoMBS)
			current.FontName   = FontName
			current.FontStyle  = Style
			current.FontSize   = FontSize
			current.FontInfo   = FontInfo
			current.FontHandle = FontHandle
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> SetLeading(ObjectPtr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, Value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			current.Leading = value
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> SetMiterLimit(ObjectPtr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, Value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			current.MiterLimit = value
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> SetTextDrawMode(ObjectPtr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, Mode <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>)
			current.textDrawMode = mode
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> SetTextScale(ObjectPtr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, Value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			current.TextScale = value
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> SetWordSpacing(ObjectPtr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, Value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			current.WordSpacing = value
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> ShowTextArrayA(ObjectPtr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, Matrix <span style="color:#0000FF;font-weight: bold">as</span> DynaPDFMatrixMBS, Kerning() <span style="color:#0000FF;font-weight: bold">as</span> DynaPDFTextRecordAMBS, Count <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, Width <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> t <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> PDFText
			
			t.State = <span style="color:#0000FF;font-weight: bold">new</span> PDFState(current)
			t.Count = Count
			t.Width = Width
			t.KerningA = Kerning
			t.Matrix = matrix
			
			texts.Append t
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(p <span style="color:#0000FF;font-weight: bold">as</span> MyDynaPDFMBS)
			<span style="color:#0000FF;font-weight: bold">self</span>.current = <span style="color:#0000FF;font-weight: bold">new</span> PDFState
			<span style="color:#0000FF;font-weight: bold">self</span>.pdf = p
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> States() <span style="color:#0000FF;font-weight: bold">As</span> PDFState</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Texts() <span style="color:#0000FF;font-weight: bold">As</span> PDFText</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> current <span style="color:#0000FF;font-weight: bold">As</span> PDFState</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> pdf <span style="color:#0000FF;font-weight: bold">As</span> dynaPDFmbs</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Module</span> UtilModule</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> FindFile(name <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>) <span style="color:#0000FF;font-weight: bold">As</span> FolderItem
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Look</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">file</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">parent</span> <span style="color:#7F0000;text-style:italic">folders</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">executable</span> <span style="color:#7F0000;text-style:italic">on</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> parent <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = app.ExecutableFile.Parent
			
			<span style="color:#0000FF;font-weight: bold">while</span> parent&lt;&gt;<span style="color:#0000FF;font-weight: bold">Nil</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> file <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = parent.Child(name)
				
				<span style="color:#0000FF;font-weight: bold">if</span> file&lt;&gt;<span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">and</span> file.Exists <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">Return</span> file
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				parent = parent.Parent
			<span style="color:#0000FF;font-weight: bold">wend</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Transform(m <span style="color:#0000FF;font-weight: bold">as</span> DynaPDFMatrixMBS, <span style="color:#0000FF;font-weight: bold">byref</span> x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>, <span style="color:#0000FF;font-weight: bold">byref</span> y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> tx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">double</span> = x
			x = tx * M.a + y * M.c + M.x
			y = tx * M.b + y * M.d + M.y
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Module</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> PDFText</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> EffectiveMatrix() <span style="color:#0000FF;font-weight: bold">As</span> DynaPDFMatrixMBS
			<span style="color:#0000FF;font-weight: bold">return</span> matrix * state.matrix
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Count <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Decoded <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> KerningA() <span style="color:#0000FF;font-weight: bold">As</span> DynapdfTextRecordAMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Matrix <span style="color:#0000FF;font-weight: bold">As</span> DynapdfMatrixMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Source() <span style="color:#0000FF;font-weight: bold">As</span> DynapdfTextRecordAMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> State <span style="color:#0000FF;font-weight: bold">As</span> PDFState</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Width <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	FileTypes1</div>
<div class="RB_Code">		Filetype application/pdf</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> FileTypes1</div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

<p>See also:<ul>
<li><A href="example-dynapdf-textediting-deletetext.html">/DynaPDF/text editing/delete text</A></li>
<li><A href="example-dynapdf-textediting-edittext.html">/DynaPDF/text editing/edit text</A></li>
<li><A href="example-dynapdf-textediting-replacetext.html">/DynaPDF/text editing/replace text</A></li>
<li><A href="example-dynapdf-textextraction.html">/DynaPDF/Text extraction</A></li>
<li><A href="example-dynapdf-textformatting-textformattingansi.html">/DynaPDF/text formatting/text formatting Ansi</A></li>
<li><A href="example-dynapdf-textformatting-textformattingparallel.html">/DynaPDF/text formatting/text formatting parallel</A></li>
<li><A href="example-dynapdf-textformatting-textformattingunicode.html">/DynaPDF/text formatting/text formatting Unicode</A></li>
</ul></p>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsdynapdfplugin.html">MBS DynaPDF Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-dynapdf-textpositions">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

