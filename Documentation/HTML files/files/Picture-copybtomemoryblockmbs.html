<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Picture methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Picture">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Picture methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-picture.html">Picture</a> class.  </p>
<div class="WLM">
<b><a href="class-picture.html">Picture</a>.<A name="4">CopyBtoMemoryblockMBS(destination as memoryblock, offset as Integer, PixelByteSize as Integer, StartLine as Integer = 0, EndLine as Integer = -1, Yield as Integer = 0, DestRowBytes as Integer = 0) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-graphicspictures.html" translate="no">Graphics &amp; Pictures</A></td>
<td class=grau><a href="plugins-mbspictureplugin.html">MBS Picture Plugin</a></td>
<td class=grau><a href="newinversion53.shtml" class=version>5.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Copies raw image data into a memoryblock.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">const</span> kAlphaOffset=0 <span style="color: #800000;">&apos; (BigEndian) and 3 (LittleEndian)</span><br /><span style="color: #0000FF;">dim</span> m <span style="color: #0000FF;">as</span> MemoryBlock<br /><span style="color: #0000FF;">dim</span> p <span style="color: #0000FF;">as</span> Picture<br /><br />p=New Picture(<span style="color: #336698;">100</span>,<span style="color: #336698;">100</span>,<span style="color: #336698;">32</span>)<br />p.Graphics.ForeColor=rgb(<span style="color: #336698;">255</span>,<span style="color: #336698;">128</span>,<span style="color: #336698;">1</span>)<br />p.Graphics.FillRect <span style="color: #336698;">0</span>,<span style="color: #336698;">0</span>,<span style="color: #336698;">100</span>,<span style="color: #336698;">100</span><br />p.mask.Graphics.ForeColor=rgb(<span style="color: #336698;">127</span>,<span style="color: #336698;">127</span>,<span style="color: #336698;">127</span>)<br />p.mask.Graphics.FillRect <span style="color: #336698;">0</span>,<span style="color: #336698;">0</span>,<span style="color: #336698;">100</span>,<span style="color: #336698;">100</span><br /><br /><span style="color: #800000;">// Make a new MemoryBlock</span><br />m=NewMemoryBlock(<span style="color: #336698;">100</span>*<span style="color: #336698;">100</span>*<span style="color: #336698;">4</span>) <span style="color: #800000;">// 4 bytes per Pixel</span><br /><br /><span style="color: #800000;">// copy RGB and leave room for alpha</span><br /><span style="color: #0000FF;">if</span> p.<A href="picture-copyargbtomemoryblockmbs.html">CopyARGBtoMemoryblockMBS</A>(m,<span style="color: #336698;">0</span>,<span style="color: #0000FF;">false</span>,-<span style="color: #336698;">1</span>) <span style="color: #0000FF;">then</span><br />  MsgBox <A href="global-encodingtohexmbs.html">EncodingToHexMBS</A>(m.StringValue(<span style="color: #336698;">0</span>,<span style="color: #336698;">99</span>))<br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br /><br /><span style="color: #800000;">// copy Blue channel from mask image into Memoryblock</span><br /><span style="color: #0000FF;">if</span> p.mask.CopyBtoMemoryblockMBS(m,kAlphaOffset,<span style="color: #336698;">4</span>) <span style="color: #0000FF;">then</span><br />  MsgBox <A href="global-encodingtohexmbs.html">EncodingToHexMBS</A>(m.StringValue(<span style="color: #336698;">0</span>,<span style="color: #336698;">99</span>))<br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Returns true on success.<BR>
destination should not be nil.<BR>
offset should be 0 or bigger and is the start position in the memoryblock.<BR>
PixelByteSize is normally 4 for 32bit per Pixel.<BR>
By using a different offset you can have this function working correctly on non BigEndian platforms. <BR>
The function will crash if the memoryblock is too small. Needs picture.width*picture.height*PixelByteSize bytes in the memoryblock.<BR>
Mask images in RB are all gray so it does not matter which channel you copy to get the alpha channel. This function takes the blue channel from the source image.<BR>
<BR>
This method was written for speed, so the creation of the memoryblock is your part. You can of course reuse memoryblocks for batch processing images as long as the memoryblock is big enough.<BR>
<BR>
StartLine and Endline define the range of source lines from picture. Range is from 0 to picture.height-1. if Endline is -1, we use picture.height-1 internally. Yield specifies how much CPU time is given to other threads. If yield = 0, we give no CPU time away. If yield is &gt; 0, we yield every yield/60th second to other threads. If DestRowBytes is not zero, it specifies the bytes per row in the target memoryblock for each line. <BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbspictureplugin.html">MBS Picture Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=Picture-copybtomemoryblockmbs">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

