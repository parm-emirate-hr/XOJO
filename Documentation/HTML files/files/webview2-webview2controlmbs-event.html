<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - WebView2ControlMBS events</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="WebView2ControlMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">WebView2ControlMBS events</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="control-webview2controlmbs.html">WebView2ControlMBS</a> control.</p>
<p>
 
<a href="webview2-webview2controlmbs-event1.html">Next items</a>
</p>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="1">AddScriptToExecuteOnDocumentCreatedCompleted(JavaScript as String, ErrorCode as Integer, ID as String, Tag as Variant)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
The event to report that AddScriptToExecuteOnDocumentCreated is done and provide the ID.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="2">CapturePreviewCompleted(ImageFormat as Integer, ErrorCode as Integer, PictureData as String)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
The event called when CapturePreview call is done.<BR>
<B>Notes:</B> 
<BR>
We pass you the image data as a string, so you can e.g. write it to a PNG or JPEG file.<BR>
Otherwise ErrorCode tells you the reason for the error.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="3">Close</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
<br>
The control is about to close.<BR>
In Xojo version 2021r3 and newer this event is named Closing.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="4">Closing</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Version</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
</tr>
</table>
<B>Function:</B> 
<br>
The control is about to close.<BR>
In older Xojo versions, this event is named Close.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="5">Configure</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
The event called while initializing, where you can apply properties just before plugin reads them.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="6">ConstructContextualMenu(base as MenuItem, x as Integer, y as Integer) as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion221.shtml" class=version>22.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
This event is called when it is appropriate to display a contextual menu for the control.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="7">ContainsFullScreenElementChanged</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
ContainsFullScreenElementChanged fires when the ContainsFullScreenElement property changes. <BR>
<B>Notes:</B> 
This means that an HTML element inside the WebView is entering fullscreen to the size of the WebView or leaving fullscreen. This event is useful when, for example, a video element requests to go fullscreen. The listener of ContainsFullScreenElementChanged can then resize the WebView in response.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="8">ContentLoading(isErrorPage as Boolean, NavigationID as UInt64)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
The content loading event.d<BR>
<B>Notes:</B> 
ContentLoading fires before any content is loaded, including scripts added with AddScriptToExecuteOnDocumentCreated. ContentLoading will not fire if a same page navigation occurs (such as through fragment navigations or history.pushState navigations). This follows the NavigationStarting and SourceChanged events and precedes the HistoryChanged and NavigationCompleted events.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="9">ContextualMenuAction(hitItem as MenuItem) as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion221.shtml" class=version>22.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
Called when a menuitem is choosen.<BR>
<B>Notes:</B> 
This allows the control to react on its relevant menu items. Please return true if you handled it or false to give others a chance.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="10">DocumentTitleChanged</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
The event to report a document title change.<BR>
<B>Notes:</B> 
DocumentTitleChanged fires when the DocumentTitle property of the WebView changes and may fire before or after the NavigationCompleted event.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="11">EnableMenuItems</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion221.shtml" class=version>22.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
<br>
The event where you can enable menu items.<BR>
In Xojo version 2021r3 and newer this event is named MenuBarSelected.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="12">ExecuteScriptCompleted(JavaScript as String, ErrorCode as Integer, resultObjectAsJson as String, Tag as Variant)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
The event to report ExecuteScript method is done.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="13">FocusLost</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Version</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
</tr>
</table>
<B>Function:</B> 
<br>
LostFocus fires when WebView lost focus. <BR>
In older Xojo versions, this event is named LostFocus.<BR>
<B>Notes:</B> 
In the case where MoveFocusRequested event is fired, the focus is still on WebView when MoveFocusRequested event fires. LostFocus only fires afterwards when app&#39;s code or default action of MoveFocusRequested event set focus away from WebView.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="14">FocusReceived</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Version</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
</tr>
</table>
<B>Function:</B> 
<br>
GotFocus fires when WebView got focus.<BR>
In older Xojo versions, this event is named GotFocus.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="15">FrameNavigationCompleted(isSuccess as Boolean, ErrorStatus as Integer, NavigationID as UInt64)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
FrameNavigationCompleted fires when a child frame has completely loaded (body.onload has fired) or loading stopped with error.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="16">FrameNavigationStarting(URL as String, IsUserInitiated as Boolean, IsRedirected as Boolean, NavigationID as UInt64) as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
FrameNavigationStarting fires when a child frame in the WebView requests permission to navigate to a different URI. This will fire for redirects as well.<BR>
<B>Notes:</B> 
<BR>
Corresponding navigations can be blocked until the event handler returns.<BR>
Return true to block the request.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="17">GotFocus</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
<br>
GotFocus fires when WebView got focus.<BR>
In Xojo version 2021r3 and newer this event is named FocusReceived.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="18">HistoryChanged</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
The event to report history change.<BR>
<B>Notes:</B> 
HistoryChanged listens to the change of navigation history for the top level document. Use HistoryChanged to check if CanGoBack/CanGoForward value has changed. HistoryChanged also fires for using GoBack/GoForward. HistoryChanged fires after SourceChanged and ContentLoading.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="19">LostFocus</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
<br>
LostFocus fires when WebView lost focus. <BR>
In Xojo version 2021r3 and newer this event is named FocusLost.<BR>
<B>Notes:</B> 
In the case where MoveFocusRequested event is fired, the focus is still on WebView when MoveFocusRequested event fires. LostFocus only fires afterwards when app&#39;s code or default action of MoveFocusRequested event set focus away from WebView.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="20">MenuBarSelected</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Version</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="newinversion221.shtml" class=version>22.1</a></td>
</tr>
</table>
<B>Function:</B> 
<br>
The event where you can enable menu items.<BR>
In older Xojo versions, this event is named EnableMenuItems.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="21">NavigationCompleted(isSuccess as Boolean, ErrorStatus as Integer, NavigationID as UInt64)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
The event to report a navigation action completed.<BR>
<B>Notes:</B> 
<BR>
NavigationCompleted fires when the WebView has completely loaded (body.onload has fired) or loading stopped with error.<BR>
<BR>
Please don&#39;t process directly here, but maybe call a method with timer.CallLater to do processing like using HTMLText or PlainText functions.<BR>
<BR>
Like the DocumentCompleted event in Xojo.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="22">NavigationStarting(URL as String, IsUserInitiated as Boolean, IsRedirected as Boolean, NavigationID as UInt64) as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
The event to report a navigation action.<BR>
<B>Notes:</B> 
<BR>
NavigationStarting fires when the WebView main frame is requesting permission to navigate to a different URI. This will fire for redirects as well.<BR>
Corresponding navigations can be blocked until the event handler returns.<BR>
<BR>
Return true to cancel it like Xojo&#39;s CancelLoad event.<BR>
<BR>
This event is great to check the URL. If you like to block it, you may just return true. If the user initiated the request, you may instead want to load a warning page. Also check the URL and decide whether to turn scripting on or off.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="23">NewWindowRequested(URL as String, IsUserInitiated as Boolean, WindowFeatures as <A href="class-webview2windowfeaturesmbs.html">WebView2WindowFeaturesMBS</A>, byref NewWindow as Variant) as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion215.shtml" class=version>21.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
The event called when a new window needs to be opened.<BR>
<B>Notes:</B> 
<BR>
Return true to indicate you handled the event.<BR>
If you create a new window with a <A href="control-webview2controlmbs.html">WebView2ControlMBS</A> (or <A href="control-desktopwebview2controlmbs.html">DesktopWebView2ControlMBS</A>), you can put it in NewWindow property.<BR>
<BR>
IsUserInitiated: <BR>
True when the new window request was initiated through a user gesture.<BR>
<BR>
Examples of user initiated requests are:<BR>
Selecting an anchor tag with target<BR>
Programmatic window open from a script that directly run as a result of user interaction such as via onclick handlers.<BR>
Non-user initiated requests are programmatic window opens from a script that are not directly triggered by user interaction, such as those that run while loading a new page or via timers. The Microsoft Edge popup blocker is disabled for WebView so the app is able to use this flag to block non-user initiated popups.<BR>
<BR>
URL: The target uri of the new window requested.<BR>
<BR>
NewWindow: Set the new control to use. <BR>
<BR>
If the NewWindow is set, the top-level window returns as the opened WindowProxy. The NewWindow property should be set to a control that has not been navigated previously. Don&#39;t use methods that cause navigation or interact with the DOM on this web view. Setting event handlers, changing Settings properties, or other methods are fine to call. Changes to settings should be made before NewWindow is called to ensure that those settings take effect for the newly setup WebView. Once the NewWindow is set the underlying web contents of this CoreWebView2 will be replaced and navigated as appropriate for the new window. After setting new window it cannot be changed and error will be return otherwise.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="24">Open</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
<br>
The control is about to was created and you can initialize it.<BR>
In Xojo version 2021r3 and newer this event is named Opening.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="25">Opened</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
The event called when browser initialization is done.<BR>
<B>Notes:</B> 
<BR>
Typical event flow is like this:<BR>
<BR>
<UL><LI>
Configure
</LI><LI>
Open
</LI><LI>
Window.Open
</LI><LI>
Opened
</LI></UL>
<BR>
Opened is called a few milliseconds later.<BR>
<BR>
If you load an URL, the events happen like this:<BR>
<BR>
<UL><LI>
NavigationStarting
</LI><LI>
SourceChanged
</LI><LI>
ContentLoading
</LI><LI>
HistoryChanged
</LI><LI>
DocumentTitleChanged
</LI><LI>
NavigationCompleted
</UL>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="26">Opening</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Version</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
</tr>
</table>
<B>Function:</B> 
<br>
The control is about to was created and you can initialize it.<BR>
In older Xojo versions, this event is named Open.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="27">PermissionRequested(URL as String, PermissionKind as Integer, IsUserInitiated as Boolean, byref State as Integer)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
The event to query permissions from user.<BR>
<B>Notes:</B> 
<BR>
PermissionRequested fires when content in a WebView requests permission to access some privileged resources.<BR>
If a deferral is not taken on the event args, the subsequent scripts can be blocked until the event handler returns. If a deferral is taken, then the scripts are blocked until the deferral is completed.<BR>
<BR>
URL: The origin of the web content that requests the permission.<BR>
PermissionKind: The type of the permission that is requested.<BR>
IsUserInitiated: True when the permission request was initiated through a user gesture.<BR>
State: The status of a permission request, i.e.<BR>
<BR>
Please assign State the answer you like to provide.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="28">PrintCompleted(Path as String, errorCode as Integer, isSuccessful as boolean)</A></b> &nbsp; <b style="color: #00008B"> New in 23.1 </b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion231.shtml" class=version>23.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
Receives the result of the PrintToPdf method.<BR>
<B>Notes:</B> 
If the print to PDF operation succeeds, isSuccessful is true. Otherwise, if the operation failed, isSuccessful is set to false. An invalid path returns E_INVALIDARG in errorCode.<BR>
</div>
<div class="W">
<b><a href="control-webview2controlmbs.html">WebView2ControlMBS</a>.<A name="29">ProcessFailed(processFailedKind as Integer)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-webview2.html" translate="no">WebView2</A></td>
<td class=grau><a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a></td>
<td class=grau><a href="newinversion205.shtml" class=version>20.5</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
ProcessFailed fires when a WebView process is terminated unexpectedly or becomes unresponsive.<BR>
</div>
<p>
 
<a href="webview2-webview2controlmbs-event1.html">Next items</a>
</p>
<p>The items on this page are in the following plugins: <a href="plugins-mbswinframeworksplugin.html">MBS WinFrameworks Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=webview2-webview2controlmbs-event">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

