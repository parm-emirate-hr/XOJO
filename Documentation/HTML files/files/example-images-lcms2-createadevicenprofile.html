<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /Images/LCMS2/Create a DeviceN Profile</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /Images/LCMS2/Create a DeviceN Profile</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/Images/LCMS2/Create a DeviceN Profile</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS Util Plugin, MBS Images Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /Images/LCMS2/Create a DeviceN Profile<BR>
This example is the version from Mon, 16th Mar 2014.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;Create</span> <span style="color:#6500FE">a</span> <span style="color:#6500FE">DeviceN</span> <span style="color:#6500FE">Profile.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kEditClear = <span style="color:#6500FE">&quot;&amp;L&ouml;schen&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuit = <span style="color:#6500FE">&quot;Beenden&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuitShortcut = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">errors</span> <span style="color:#7F0000;text-style:italic">go</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">Error</span> <span style="color:#7F0000;text-style:italic">method</span>
			LCMS2MBS.SetLogErrorHandler <span style="color:#0000FF;font-weight: bold">self</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> h <span style="color:#0000FF;font-weight: bold">as</span> LCMS2ProfileMBS = CreateTestProfile
			<span style="color:#0000FF;font-weight: bold">dim</span> f <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = SpecialFolder.Desktop.Child(<span style="color:#6500FE">&quot;test.icc&quot;</span>)
			
			
			<span style="color:#0000FF;font-weight: bold">if</span> h.SaveProfileToFile(f) <span style="color:#0000FF;font-weight: bold">then</span>
				
			<span style="color:#0000FF;font-weight: bold">else</span>
				MsgBox <span style="color:#6500FE">&quot;Failed&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> w <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> ProfileWindow
			
			w.Title = <span style="color:#6500FE">&quot;Test</span> <span style="color:#6500FE">Profile&quot;</span>
			w.run h
			w.show
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> OpenDocument(item <span style="color:#0000FF;font-weight: bold">As</span> FolderItem)
			<span style="color:#0000FF;font-weight: bold">dim</span> p <span style="color:#0000FF;font-weight: bold">as</span> LCMS2ProfileMBS = LCMS2ProfileMBS.OpenProfileFromFile(item)
			
			<span style="color:#0000FF;font-weight: bold">if</span> p = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				MsgBox <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">open</span> <span style="color:#6500FE">profile.&quot;</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> w <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> ProfileWindow
				
				w.Title = item.DisplayName
				w.run p
				w.show
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> CreateTestProfile() <span style="color:#0000FF;font-weight: bold">As</span> LCMS2ProfileMBS
			<span style="color:#0000FF;font-weight: bold">dim</span> ContextID <span style="color:#0000FF;font-weight: bold">as</span> Variant
			<span style="color:#0000FF;font-weight: bold">dim</span> AToB0, BToA0 <span style="color:#0000FF;font-weight: bold">as</span> LCMS2PipelineMBS
			<span style="color:#0000FF;font-weight: bold">dim</span> CLUT <span style="color:#0000FF;font-weight: bold">as</span> LCMS2StageMBS
			<span style="color:#0000FF;font-weight: bold">dim</span> ForwardSampler <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> MyForwardSampler
			<span style="color:#0000FF;font-weight: bold">dim</span> ReverseSampler <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> MyReverseSampler
			
			<span style="color:#0000FF;font-weight: bold">dim</span> hICC <span style="color:#0000FF;font-weight: bold">as</span> LCMS2ProfileMBS = LCMS2ProfileMBS.CreateProfilePlaceholder
			
			<span style="color:#0000FF;font-weight: bold">if</span> hICC = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				break
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">nil</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">setup</span> <span style="color:#7F0000;text-style:italic">header</span>
			hICC.ProfileVersion = <span style="color:#006532">4.3</span>
			hICC.DeviceClass = LCMS2MBS.kcmsSigOutputClass
			hICC.ColorSpaceType = LCMS2MBS.kcmsSig6colorData
			hICC.PCS = LCMS2MBS.kcmsSigLabData
			hICC.renderingIntent = LCMS2MBS.kINTENT_PERCEPTUAL
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">pipeline</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">CLUT,</span> <span style="color:#7F0000;text-style:italic">both</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">3</span> <span style="color:#7F0000;text-style:italic">input</span> <span style="color:#7F0000;text-style:italic">colors,</span> <span style="color:#7F0000;text-style:italic">6</span> <span style="color:#7F0000;text-style:italic">output</span> <span style="color:#7F0000;text-style:italic">colors</span>
			BToA0 = <span style="color:#0000FF;font-weight: bold">new</span> LCMS2PipelineMBS(ContextID, <span style="color:#326598">3</span>, <span style="color:#326598">6</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">9</span> <span style="color:#7F0000;text-style:italic">grid</span> <span style="color:#7F0000;text-style:italic">points</span>
			CLUT = LCMS2StageMBS.CreateStageWithCLut16bit(ContextID, <span style="color:#326598">7</span>, <span style="color:#326598">3</span>, <span style="color:#326598">6</span>)
			<span style="color:#0000FF;font-weight: bold">if</span> CLUT = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				break
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">nil</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">fill</span> <span style="color:#7F0000;text-style:italic">clut</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">values</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">MyForwardSampler</span> <span style="color:#7F0000;text-style:italic">class</span>
			<span style="color:#0000FF;font-weight: bold">call</span> CLUT.SampleCLut16bit(ForwardSampler, <span style="color:#326598">0</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">three</span> <span style="color:#7F0000;text-style:italic">input</span> <span style="color:#7F0000;text-style:italic">curves</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> CurveStage3 <span style="color:#0000FF;font-weight: bold">as</span> LCMS2StageMBS = LCMS2StageMBS.CreateStageWithToneCurves(ContextID, <span style="color:#326598">3</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">six</span> <span style="color:#7F0000;text-style:italic">input</span> <span style="color:#7F0000;text-style:italic">curves</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> CurveStage6 <span style="color:#0000FF;font-weight: bold">as</span> LCMS2StageMBS = LCMS2StageMBS.CreateStageWithToneCurves(ContextID, <span style="color:#326598">6</span>)
			
			<span style="color:#0000FF;font-weight: bold">call</span> BToA0.InsertStage BToA0.kAtBegin, CurveStage3
			<span style="color:#0000FF;font-weight: bold">call</span> BToA0.InsertStage BToA0.kAtEnd,   CLUT
			<span style="color:#0000FF;font-weight: bold">call</span> BToA0.InsertStage BToA0.kAtEnd,   CurveStage6
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> hICC.WritePipeline(LCMS2MBS.kcmsSigBToA0Tag, BToA0) <span style="color:#0000FF;font-weight: bold">then</span>
				break
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">nil</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">pipeline</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">CLUT,</span> <span style="color:#7F0000;text-style:italic">both</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">6</span> <span style="color:#7F0000;text-style:italic">input</span> <span style="color:#7F0000;text-style:italic">colors,</span> <span style="color:#7F0000;text-style:italic">3</span> <span style="color:#7F0000;text-style:italic">output</span> <span style="color:#7F0000;text-style:italic">colors</span>
			AToB0 = <span style="color:#0000FF;font-weight: bold">new</span> LCMS2PipelineMBS(ContextID, <span style="color:#326598">6</span>, <span style="color:#326598">3</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">5</span> <span style="color:#7F0000;text-style:italic">grid</span> <span style="color:#7F0000;text-style:italic">points</span>
			CLUT = LCMS2StageMBS.CreateStageWithCLut16bit(ContextID, <span style="color:#326598">7</span>, <span style="color:#326598">6</span>, <span style="color:#326598">3</span>)
			<span style="color:#0000FF;font-weight: bold">if</span> clut = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				break
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">nil</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">fill</span> <span style="color:#7F0000;text-style:italic">clut</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">values</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">MyReverseSampler</span> <span style="color:#7F0000;text-style:italic">class</span>
			<span style="color:#0000FF;font-weight: bold">call</span> clut.SampleCLut16bit(ReverseSampler, <span style="color:#326598">0</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">reuse</span> <span style="color:#7F0000;text-style:italic">curves,</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">could</span> <span style="color:#7F0000;text-style:italic">make</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">ones</span> <span style="color:#7F0000;text-style:italic">here</span>
			<span style="color:#7F0000;text-style:italic">&#39;CurveStage3</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">LCMS2StageMBS.CreateStageWithToneCurves(ContextID,</span> <span style="color:#7F0000;text-style:italic">3)</span>
			<span style="color:#7F0000;text-style:italic">&#39;CurveStage6</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">LCMS2StageMBS.CreateStageWithToneCurves(ContextID,</span> <span style="color:#7F0000;text-style:italic">6)</span>
			
			<span style="color:#0000FF;font-weight: bold">call</span> AToB0.InsertStage AToB0.kAtBegin, CurveStage6
			<span style="color:#0000FF;font-weight: bold">call</span> AToB0.InsertStage AToB0.kAtEnd,   CLUT
			<span style="color:#0000FF;font-weight: bold">call</span> AToB0.InsertStage AToB0.kAtEnd,   CurveStage3
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> hICC.WritePipeline(LCMS2MBS.kcmsSigAToB0Tag, AToB0) <span style="color:#0000FF;font-weight: bold">then</span>
				break
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">nil</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> hICC.LinkTag(LCMS2MBS.kcmsSigAToB1Tag, LCMS2MBS.kcmsSigAToB0Tag) <span style="color:#0000FF;font-weight: bold">then</span>
				break
				<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">nil</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> hICC.LinkTag(LCMS2MBS.kcmsSigAToB2Tag, LCMS2MBS.kcmsSigAToB0Tag) <span style="color:#0000FF;font-weight: bold">then</span>
				break
				<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">nil</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> hICC.LinkTag(LCMS2MBS.kcmsSigBToA1Tag, LCMS2MBS.kcmsSigBToA0Tag) <span style="color:#0000FF;font-weight: bold">then</span>
				break
				<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">nil</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> hICC.LinkTag(LCMS2MBS.kcmsSigBToA2Tag, LCMS2MBS.kcmsSigBToA0Tag) <span style="color:#0000FF;font-weight: bold">then</span>
				break
				<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">nil</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> colors <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> LCMS2NamedColorListMBS(ContextID, <span style="color:#326598">6</span>, <span style="color:#326598">3</span>) <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">six</span> <span style="color:#7F0000;text-style:italic">colors,</span> <span style="color:#7F0000;text-style:italic">Lab</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">3</span> <span style="color:#7F0000;text-style:italic">channels</span>
			
			<span style="color:#0000FF;font-weight: bold">call</span> colors.Append <span style="color:#6500FE">&quot;Color1&quot;</span>
			<span style="color:#0000FF;font-weight: bold">call</span> colors.Append <span style="color:#6500FE">&quot;Color2&quot;</span>
			<span style="color:#0000FF;font-weight: bold">call</span> colors.Append <span style="color:#6500FE">&quot;Color3&quot;</span>
			<span style="color:#0000FF;font-weight: bold">call</span> colors.Append <span style="color:#6500FE">&quot;Color4&quot;</span>
			<span style="color:#0000FF;font-weight: bold">call</span> colors.Append <span style="color:#6500FE">&quot;Color5&quot;</span>
			<span style="color:#0000FF;font-weight: bold">call</span> colors.Append <span style="color:#6500FE">&quot;Color6&quot;</span>
			
			<span style="color:#0000FF;font-weight: bold">call</span> hICC.WriteNamedColorList LCMS2MBS.kcmsSigNamedColor2Tag, colors
			
			<span style="color:#0000FF;font-weight: bold">dim</span> DescriptionMLU <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> LCMS2MLUMBS(<span style="color:#0000FF;font-weight: bold">nil</span>, <span style="color:#326598">1</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> CopyrightMLU <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> LCMS2MLUMBS(<span style="color:#0000FF;font-weight: bold">nil</span>, <span style="color:#326598">1</span>)
			
			<span style="color:#0000FF;font-weight: bold">call</span> DescriptionMLU.setUnicode <span style="color:#6500FE">&quot;en&quot;</span>, <span style="color:#6500FE">&quot;US&quot;</span>, <span style="color:#6500FE">&quot;DeviceN</span> <span style="color:#6500FE">test</span> <span style="color:#6500FE">profile&quot;</span>
			<span style="color:#0000FF;font-weight: bold">call</span> CopyrightMLU.setUnicode <span style="color:#6500FE">&quot;en&quot;</span>, <span style="color:#6500FE">&quot;US&quot;</span>, <span style="color:#6500FE">&quot;No</span> <span style="color:#6500FE">copyright,</span> <span style="color:#6500FE">use</span> <span style="color:#6500FE">freely&quot;</span>
			
			<span style="color:#0000FF;font-weight: bold">call</span> hICC.WriteMLU LCMS2MBS.kcmsSigProfileDescriptionTag, DescriptionMLU
			<span style="color:#0000FF;font-weight: bold">call</span> hICC.WriteMLU LCMS2MBS.kcmsSigCopyrightTag, CopyrightMLU
			
			<span style="color:#0000FF;font-weight: bold">dim</span> whitepoint <span style="color:#0000FF;font-weight: bold">as</span> LCMS2CIExyYMBS = LCMS2MBS.WhitePointFromTemp(<span style="color:#326598">6504</span>)
			<span style="color:#0000FF;font-weight: bold">if</span> whitepoint&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				
				<span style="color:#0000FF;font-weight: bold">call</span> hICC.WriteCIEXYZ LCMS2MBS.kcmsSigMediaWhitePointTag, LCMS2MBS.D50_XYZ
				
				<span style="color:#0000FF;font-weight: bold">dim</span> WhitePointXYZ <span style="color:#0000FF;font-weight: bold">as</span> LCMS2CIEXYZMBS = WhitePoint.XYZ
				<span style="color:#0000FF;font-weight: bold">dim</span> CHAD <span style="color:#0000FF;font-weight: bold">as</span> LCMS2MAT3MBS
				
				CHAD = LCMS2MBS.AdaptationMatrix(<span style="color:#0000FF;font-weight: bold">nil</span>, WhitePointXYZ, LCMS2MBS.D50_XYZ)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">V4</span> <span style="color:#7F0000;text-style:italic">tag,</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">many</span> <span style="color:#7F0000;text-style:italic">CMM</span> <span style="color:#7F0000;text-style:italic">does</span> <span style="color:#7F0000;text-style:italic">read</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">understand</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">no</span> <span style="color:#7F0000;text-style:italic">matter</span> <span style="color:#7F0000;text-style:italic">which</span> <span style="color:#7F0000;text-style:italic">version</span>
				<span style="color:#0000FF;font-weight: bold">call</span> hICC.WriteChromaticAdaptation(CHAD)
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			
			<span style="color:#0000FF;font-weight: bold">return</span> hICC
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Error(context <span style="color:#0000FF;font-weight: bold">as</span> LCMS2ContextMBS, ErrorCode <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt32</span>, Text <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Teil</span> <span style="color:#7F0000;text-style:italic">des</span> <span style="color:#7F0000;text-style:italic">Interfaces</span> <span style="color:#7F0000;text-style:italic">von</span> <span style="color:#7F0000;text-style:italic">LCMS2ErrorHandlerMBS</span>
			
			MsgBox text
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ProfileWindow <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control List <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance List <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> ExpandRow(row <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
				<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> Variant = <span style="color:#0000FF;font-weight: bold">me</span>.RowTag(row)
				
				Add v
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Add(tag <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Uint32</span>, name <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> Variant = p.ReadTag(tag)
			
			<span style="color:#0000FF;font-weight: bold">if</span> c&lt;&gt;<span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				List.AddFolder name
				List.RowTag(List.LastIndex) = c
			<span style="color:#0000FF;font-weight: bold">else</span>
				AddRaw tag, name
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Add(v <span style="color:#0000FF;font-weight: bold">as</span> Variant)
			<span style="color:#0000FF;font-weight: bold">if</span> v = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">ignore</span>
			<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> LCMS2CIEXYZMBS <span style="color:#0000FF;font-weight: bold">then</span>
				AddCIEXYZ v
			<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> LCMS2SequenceMBS <span style="color:#0000FF;font-weight: bold">then</span>
				AddSequence v
			<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> LCMS2PipelineMBS <span style="color:#0000FF;font-weight: bold">then</span>
				AddPipeline v
			<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> LCMS2NamedColorListMBS <span style="color:#0000FF;font-weight: bold">then</span>
				AddNamedColorList v
			<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> LCMS2ScreeningMBS <span style="color:#0000FF;font-weight: bold">then</span>
				AddScreening v
			<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> LCMS2ICCDataMBS <span style="color:#0000FF;font-weight: bold">then</span>
				AddICCData v
			<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> LCMS2MLUMBS <span style="color:#0000FF;font-weight: bold">then</span>
				AddMLU v
			<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> LCMS2CIExyYTripleMBS <span style="color:#0000FF;font-weight: bold">then</span>
				AddCIExyYTriple v
			<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> MemoryBlock <span style="color:#0000FF;font-weight: bold">then</span>
				AddMemoryblock v
			<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> LCMS2SequenceDescriptionMBS <span style="color:#0000FF;font-weight: bold">then</span>
				AddSequenceDescription v
			<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> LCMS2ToneCurveMBS <span style="color:#0000FF;font-weight: bold">then</span>
				AddToneCurve v
			<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> LCMS2StageMBS <span style="color:#0000FF;font-weight: bold">then</span>
				AddStage v
			<span style="color:#0000FF;font-weight: bold">elseif</span> v.IsArray <span style="color:#0000FF;font-weight: bold">then</span>
				
			<span style="color:#0000FF;font-weight: bold">else</span>
				break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">type</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">missing</span> <span style="color:#7F0000;text-style:italic">here</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddCIEXYZ(x <span style="color:#0000FF;font-weight: bold">as</span> LCMS2CIEXYZMBS)
			List.AddRow <span style="color:#6500FE">&quot;CIE</span> <span style="color:#6500FE">XYZ&quot;</span>
			
			List.AddRow <span style="color:#6500FE">&quot;xyz</span> <span style="color:#6500FE">point&quot;</span>, str(x.x)+<span style="color:#6500FE">&quot;/&quot;</span>+str(x.y)+<span style="color:#6500FE">&quot;/&quot;</span>+str(x.z)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> l <span style="color:#0000FF;font-weight: bold">as</span> LCMS2CIELabMBS = x.Lab
			<span style="color:#0000FF;font-weight: bold">if</span> l&lt;&gt;<span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				List.AddRow <span style="color:#6500FE">&quot;as</span> <span style="color:#6500FE">lab&quot;</span>, str(l.l)+<span style="color:#6500FE">&quot;/&quot;</span>+str(l.a)+<span style="color:#6500FE">&quot;/&quot;</span>+str(l.b)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> y <span style="color:#0000FF;font-weight: bold">as</span> LCMS2CIExyYMBS = x.xyY
			<span style="color:#0000FF;font-weight: bold">if</span> y&lt;&gt;<span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				List.AddRow <span style="color:#6500FE">&quot;as</span> <span style="color:#6500FE">xyY&quot;</span>, str(y.x)+<span style="color:#6500FE">&quot;/&quot;</span>+str(y.Y)+<span style="color:#6500FE">&quot;/&quot;</span>+str(y.yy)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddCIExyYTriple(v <span style="color:#0000FF;font-weight: bold">as</span> LCMS2CIExyYTripleMBS)
			List.AddRow <span style="color:#6500FE">&quot;CIE</span> <span style="color:#6500FE">xyY</span> <span style="color:#6500FE">Triple&quot;</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> r <span style="color:#0000FF;font-weight: bold">as</span> LCMS2CIExyYMBS = v.Red
			<span style="color:#0000FF;font-weight: bold">dim</span> g <span style="color:#0000FF;font-weight: bold">as</span> LCMS2CIExyYMBS = v.Green
			<span style="color:#0000FF;font-weight: bold">dim</span> b <span style="color:#0000FF;font-weight: bold">as</span> LCMS2CIExyYMBS = v.Blue
			
			List.AddRow <span style="color:#6500FE">&quot;Red&quot;</span>, str(r.x)+<span style="color:#6500FE">&quot;/&quot;</span>+str(r.y)+<span style="color:#6500FE">&quot;/&quot;</span>+str(r.yy)
			List.AddRow <span style="color:#6500FE">&quot;Green&quot;</span>, str(g.x)+<span style="color:#6500FE">&quot;/&quot;</span>+str(g.y)+<span style="color:#6500FE">&quot;/&quot;</span>+str(g.yy)
			List.AddRow <span style="color:#6500FE">&quot;Blue&quot;</span>, str(b.x)+<span style="color:#6500FE">&quot;/&quot;</span>+str(b.y)+<span style="color:#6500FE">&quot;/&quot;</span>+str(b.yy)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddICCData(n <span style="color:#0000FF;font-weight: bold">as</span> LCMS2ICCDataMBS)
			List.AddRow <span style="color:#6500FE">&quot;ICC</span> <span style="color:#6500FE">Data&quot;</span>
			
			List.AddRow <span style="color:#6500FE">&quot;Length&quot;</span>,str(n.Size)
			List.AddRow <span style="color:#6500FE">&quot;Flags&quot;</span>,str(n.Flags)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> m <span style="color:#0000FF;font-weight: bold">as</span> MemoryBlock = n.Data
			<span style="color:#0000FF;font-weight: bold">if</span> m&lt;&gt;<span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> size <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = m.size
				<span style="color:#0000FF;font-weight: bold">if</span> size &gt; <span style="color:#326598">100</span> <span style="color:#0000FF;font-weight: bold">then</span>
					size = <span style="color:#326598">100</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = m.StringValue(<span style="color:#326598">0</span>,size)
				List.AddRow <span style="color:#6500FE">&quot;Data&quot;</span>, EncodingToHexMBS(s)
				List.AddRow <span style="color:#6500FE">&quot;Text&quot;</span>, ClearText(s)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddMLU(n <span style="color:#0000FF;font-weight: bold">as</span> LCMS2MLUMBS)
			List.AddRow <span style="color:#6500FE">&quot;MLU&quot;</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = n.getUnicode(<span style="color:#6500FE">&quot;en&quot;</span>, n.kNoCountry)
			
			<span style="color:#0000FF;font-weight: bold">if</span> s&lt;&gt;<span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				List.AddRow <span style="color:#6500FE">&quot;Unicode</span> <span style="color:#6500FE">Text&quot;</span>, s
			<span style="color:#0000FF;font-weight: bold">else</span>
				s = n.getASCII(<span style="color:#6500FE">&quot;en&quot;</span>, n.kNoCountry)
				
				<span style="color:#0000FF;font-weight: bold">if</span> s&lt;&gt;<span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
					List.AddRow <span style="color:#6500FE">&quot;ASCII</span> <span style="color:#6500FE">Text&quot;</span>, s
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddMemoryblock(m <span style="color:#0000FF;font-weight: bold">as</span> MemoryBlock)
			<span style="color:#0000FF;font-weight: bold">dim</span> size <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = m.size
			
			List.AddRow <span style="color:#6500FE">&quot;Length&quot;</span>,str(Size)
			
			<span style="color:#0000FF;font-weight: bold">if</span> size &gt; <span style="color:#326598">100</span> <span style="color:#0000FF;font-weight: bold">then</span>
				size = <span style="color:#326598">100</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = m.StringValue(<span style="color:#326598">0</span>,size)
			List.AddRow <span style="color:#6500FE">&quot;Data&quot;</span>, EncodingToHexMBS(s)
			List.AddRow <span style="color:#6500FE">&quot;Text&quot;</span>, ClearText(s)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddNamedColorList(n <span style="color:#0000FF;font-weight: bold">as</span> LCMS2NamedColorListMBS)
			List.AddRow <span style="color:#6500FE">&quot;Named</span> <span style="color:#6500FE">Color</span> <span style="color:#6500FE">List&quot;</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = n.Count
			
			List.AddRow <span style="color:#6500FE">&quot;Color</span> <span style="color:#6500FE">Count&quot;</span>, str(c)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> u <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = n.Count-<span style="color:#326598">1</span>
			
			<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> u
				List.AddRow <span style="color:#6500FE">&quot;Name</span> <span style="color:#6500FE">&quot;</span>+str(i), n.Name(i)
				List.AddRow <span style="color:#6500FE">&quot;Prefix</span> <span style="color:#6500FE">&quot;</span>+str(i), n.Prefix(i)
				List.AddRow <span style="color:#6500FE">&quot;Suffix</span> <span style="color:#6500FE">&quot;</span>+str(i), n.Suffix(i)
				
				<span style="color:#0000FF;font-weight: bold">dim</span> PCSs(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> colorants(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> PCS(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = n.PCS(i)
				<span style="color:#0000FF;font-weight: bold">dim</span> Colorant(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = n.Colorant(i)
				
				<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> xx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> <span style="color:#0000FF;font-weight: bold">in</span> PCS
					PCSs.Append str(xx)
				<span style="color:#0000FF;font-weight: bold">next</span>
				
				<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> xx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> <span style="color:#0000FF;font-weight: bold">in</span> Colorant
					Colorants.Append str(xx)
				<span style="color:#0000FF;font-weight: bold">next</span>
				
				List.AddRow <span style="color:#6500FE">&quot;PCS</span> <span style="color:#6500FE">&quot;</span>+str(i), Join(PCSs, <span style="color:#6500FE">&quot;,</span> <span style="color:#6500FE">&quot;</span>)
				
				<span style="color:#0000FF;font-weight: bold">dim</span> l <span style="color:#0000FF;font-weight: bold">as</span> LCMS2CIELabMBS
				
				<span style="color:#0000FF;font-weight: bold">if</span> p.ProfileVersion = <span style="color:#326598">4</span> <span style="color:#0000FF;font-weight: bold">then</span>
					l = LCMS2MBS.LabEncoded2Float(PCS(<span style="color:#326598">0</span>), PCS(<span style="color:#326598">1</span>), PCS(<span style="color:#326598">2</span>))
				<span style="color:#0000FF;font-weight: bold">else</span>
					l = LCMS2MBS.LabEncoded2FloatV2(PCS(<span style="color:#326598">0</span>), PCS(<span style="color:#326598">1</span>), PCS(<span style="color:#326598">2</span>))
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> l&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
					List.AddRow <span style="color:#6500FE">&quot;PCS</span> <span style="color:#6500FE">as</span> <span style="color:#6500FE">Lab</span> <span style="color:#6500FE">&quot;</span>+str(i), str(l.l)+<span style="color:#6500FE">&quot;/&quot;</span>+str(l.a)+<span style="color:#6500FE">&quot;/&quot;</span>+str(l.b)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> ll <span style="color:#0000FF;font-weight: bold">as</span> LCMS2CIEXYZMBS
				ll = LCMS2MBS.XYZEncoded2Float(PCS(<span style="color:#326598">0</span>), PCS(<span style="color:#326598">1</span>), PCS(<span style="color:#326598">2</span>))
				
				<span style="color:#0000FF;font-weight: bold">if</span> ll&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
					List.AddRow <span style="color:#6500FE">&quot;PCS</span> <span style="color:#6500FE">as</span> <span style="color:#6500FE">XYZ</span> <span style="color:#6500FE">&quot;</span>+str(i), str(ll.x)+<span style="color:#6500FE">&quot;/&quot;</span>+str(ll.y)+<span style="color:#6500FE">&quot;/&quot;</span>+str(ll.z)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				List.AddRow <span style="color:#6500FE">&quot;Colorant</span> <span style="color:#6500FE">&quot;</span>+str(i), Join(colorants, <span style="color:#6500FE">&quot;,</span> <span style="color:#6500FE">&quot;</span>)
				
				
			<span style="color:#0000FF;font-weight: bold">next</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddPipeline(v <span style="color:#0000FF;font-weight: bold">as</span> LCMS2PipelineMBS)
			List.AddRow <span style="color:#6500FE">&quot;Pipeline&quot;</span>
			List.AddRow <span style="color:#6500FE">&quot;InputChannels&quot;</span>, str(v.InputChannels)
			List.AddRow <span style="color:#6500FE">&quot;OutputChannels&quot;</span>, str(v.OutputChannels)
			List.AddRow <span style="color:#6500FE">&quot;StageCount&quot;</span>, str(v.StageCount)
			
			
			<span style="color:#0000FF;font-weight: bold">dim</span> stages() <span style="color:#0000FF;font-weight: bold">as</span> LCMS2StageMBS = v.Stages
			
			<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> stage <span style="color:#0000FF;font-weight: bold">as</span> LCMS2StageMBS <span style="color:#0000FF;font-weight: bold">in</span> stages
				List.AddFolder <span style="color:#6500FE">&quot;Stage&quot;</span>
				List.RowTag(List.LastIndex) = stage
			<span style="color:#0000FF;font-weight: bold">next</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> m1 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> MemoryBlock(<span style="color:#326598">4</span>*<span style="color:#326598">16</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> m2 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> MemoryBlock(<span style="color:#326598">4</span>*<span style="color:#326598">16</span>)
			
			<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> <span style="color:#326598">15</span>
				m1.SingleValue(i*<span style="color:#326598">4</span>) = <span style="color:#006532">1.0</span>
			<span style="color:#0000FF;font-weight: bold">next</span>
			
			v.EvalFloat m1,m2
			
			<span style="color:#0000FF;font-weight: bold">dim</span> u <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = v.OutputChannels-<span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> u
				List.AddRow <span style="color:#6500FE">&quot;Channel</span> <span style="color:#6500FE">&quot;</span>+str(i)+<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">1.0</span> <span style="color:#6500FE">gives&quot;</span>, str(m2.SingleValue(<span style="color:#326598">4</span>*i))
				
			<span style="color:#0000FF;font-weight: bold">next</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddRaw(tag <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt32</span>, name <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> MemoryBlock = p.ReadRawTag(tag)
			
			<span style="color:#0000FF;font-weight: bold">if</span> c&lt;&gt;<span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				List.AddFolder name
				List.RowTag(List.LastIndex) = c
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddScreening(v <span style="color:#0000FF;font-weight: bold">as</span> LCMS2ScreeningMBS)
			List.AddRow <span style="color:#6500FE">&quot;Screening&quot;</span>
			List.AddRow <span style="color:#6500FE">&quot;Channels&quot;</span>, str(v.Channels)
			List.AddRow <span style="color:#6500FE">&quot;Flags&quot;</span>, str(v.Flag)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> u <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = v.Channels-<span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> u
				<span style="color:#0000FF;font-weight: bold">dim</span> s <span style="color:#0000FF;font-weight: bold">as</span> LCMS2ScreeningChannelMBS = v.Channel(i)
				
				List.AddRow <span style="color:#6500FE">&quot;Channel</span> <span style="color:#6500FE">&quot;</span>+str(i), str(s.Frequency)+<span style="color:#6500FE">&quot;/&quot;</span>+str(s.ScreenAngle)+<span style="color:#6500FE">&quot;/&quot;</span>+str(s.SpotShape)
			<span style="color:#0000FF;font-weight: bold">next</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddSequence(v <span style="color:#0000FF;font-weight: bold">as</span> LCMS2SequenceMBS)
			List.AddRow <span style="color:#6500FE">&quot;Sequence&quot;</span>
			List.AddRow <span style="color:#6500FE">&quot;Count&quot;</span>, str(v.Count)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> u <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = v.Count-<span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> u
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> LCMS2SequenceDescriptionMBS = v.Description(i)
				
				List.AddFolder str(i)+<span style="color:#6500FE">&quot;.</span> <span style="color:#6500FE">description&quot;</span>
				List.RowTag(List.LastIndex) = c
				
			<span style="color:#0000FF;font-weight: bold">next</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddSequenceDescription(v <span style="color:#0000FF;font-weight: bold">as</span> LCMS2SequenceDescriptionMBS)
			List.AddRow <span style="color:#6500FE">&quot;AttributeFlags&quot;</span>, hex(v.AttributeFlags)
			
			List.AddFolder <span style="color:#6500FE">&quot;Description&quot;</span>
			List.RowTag(List.LastIndex) = v.Description
			
			List.AddRow <span style="color:#6500FE">&quot;DeviceMfg&quot;</span>, hex(v.DeviceMfg)
			List.AddRow <span style="color:#6500FE">&quot;DeviceModel&quot;</span>, hex(v.DeviceModel)
			
			List.AddFolder <span style="color:#6500FE">&quot;Manufacturer&quot;</span>
			List.RowTag(List.LastIndex) = v.Manufacturer
			
			List.AddFolder <span style="color:#6500FE">&quot;Model&quot;</span>
			List.RowTag(List.LastIndex) = v.Model
			
			List.AddRow <span style="color:#6500FE">&quot;ProfileID&quot;</span>, EncodingToHexMBS(v.ProfileID)
			List.AddRow <span style="color:#6500FE">&quot;Technology&quot;</span>, hex(v.Technology)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddStage(stage <span style="color:#0000FF;font-weight: bold">as</span> LCMS2StageMBS)
			<span style="color:#0000FF;font-weight: bold">dim</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = <span style="color:#6500FE">&quot;&quot;</span>
			
			<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">case</span> stage.Type
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigCurveSetElemType
				s = <span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">CurveSet&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMatrixElemType
				s = <span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">Matrix&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigCLutElemType
				s = <span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">CLut&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigBAcsElemType
				s = <span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">BAcs&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigEAcsElemType
				s = <span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">EAcs&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigIdentityElemType
				s = <span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">identity&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">Select</span>
			
			List.AddRow <span style="color:#6500FE">&quot;Stage.Type&quot;</span>, hex(stage.Type)+s
			List.AddRow <span style="color:#6500FE">&quot;Stage.InputChannels&quot;</span>, str(stage.InputChannels)
			List.AddRow <span style="color:#6500FE">&quot;Stage.OutputChannels&quot;</span>, str(stage.OutputChannels)
			
			<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">case</span> stage.Type
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigCurveSetElemType
				<span style="color:#0000FF;font-weight: bold">dim</span> t(-<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">as</span> LCMS2ToneCurveMBS = stage.ToneCurves
				<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> tt <span style="color:#0000FF;font-weight: bold">as</span> LCMS2ToneCurveMBS <span style="color:#0000FF;font-weight: bold">in</span> t
					List.AddFolder <span style="color:#6500FE">&quot;Tone</span> <span style="color:#6500FE">Curve&quot;</span>
					List.RowTag(List.LastIndex) = tt
				<span style="color:#0000FF;font-weight: bold">next</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMatrixElemType
				
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigCLutElemType
				
				List.AddRow <span style="color:#6500FE">&quot;CLutEntries&quot;</span>, str(stage.CLutEntries)
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigBAcsElemType
				
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigEAcsElemType
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">Select</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddToneCurve(v <span style="color:#0000FF;font-weight: bold">as</span> LCMS2ToneCurveMBS)
			List.AddRow <span style="color:#6500FE">&quot;Tone</span> <span style="color:#6500FE">Curve&quot;</span>
			List.AddRow <span style="color:#6500FE">&quot;IsDescending&quot;</span>, str(v.IsDescending)
			List.AddRow <span style="color:#6500FE">&quot;IsLinear&quot;</span>, str(v.IsLinear)
			List.AddRow <span style="color:#6500FE">&quot;IsMonotonic&quot;</span>, str(v.IsMonotonic)
			List.AddRow <span style="color:#6500FE">&quot;IsMultisegment&quot;</span>, str(v.IsMultisegment)
			List.AddRow <span style="color:#6500FE">&quot;ParametricType&quot;</span>, str(v.ParametricType)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> ClearText(s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">string</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> m <span style="color:#0000FF;font-weight: bold">as</span> MemoryBlock = s
			
			<span style="color:#0000FF;font-weight: bold">dim</span> u <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = m.Size-<span style="color:#326598">1</span>
			
			<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> u
				<span style="color:#0000FF;font-weight: bold">if</span> m.Byte(i)&lt;<span style="color:#326598">32</span> <span style="color:#0000FF;font-weight: bold">then</span>
					m.Byte(i) = asc(<span style="color:#6500FE">&quot;.&quot;</span>)
				<span style="color:#0000FF;font-weight: bold">elseif</span> m.Byte(i)&gt;<span style="color:#326598">127</span> <span style="color:#0000FF;font-weight: bold">then</span>
					m.Byte(i) = asc(<span style="color:#6500FE">&quot;.&quot;</span>)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">next</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> m
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> GetColorSpaceTypeName(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">string</span>
			<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">case</span> x
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigXYZData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;XYZ&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigLabData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Lab&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigLuvData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Luv&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigYCbCrData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;YCbCr&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigYxyData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Yxy&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigRgbData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Rgb&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigGrayData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Gray&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigHsvData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Hsv&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigHlsData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Hls&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigCmykData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Cmyk&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigCmyData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Cmy&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCH1Data
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCH1&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCH2Data
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCH2&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCH3Data
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCH3&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCH4Data
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCH4&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCH5Data
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCH5&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCH6Data
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCH6&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCH7Data
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCH7&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCH8Data
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCH8&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCH9Data
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCH9&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCHAData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCHA&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCHBData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCHB&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCHCData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCHC&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCHDData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCHD&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCHEData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCHE&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigMCHFData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MCHF&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigNamedData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Named&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig1colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;1color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig2colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;2color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig3colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;3color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig4colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;4color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig5colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;5color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig6colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;6color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig7colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;7color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig8colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;8color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig9colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;9color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig10colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;10color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig11colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;11color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig12colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;12color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig13colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;13color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig14colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;14color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSig15colorData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;15color&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigLuvKData
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;LuvK&quot;</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#6500FE">&quot;?&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">Select</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> GetDeviceClassName(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">uint32</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">string</span>
			<span style="color:#0000FF;font-weight: bold">select</span> <span style="color:#0000FF;font-weight: bold">case</span> x
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigInputClass
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Input&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigDisplayClass
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Display&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigOutputClass
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Output&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigLinkClass
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Link&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigAbstractClass
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Abstract&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigColorSpaceClass
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;ColorSpace&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> LCMS2MBS.kcmsSigNamedColorClass
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;NamedColor&quot;</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#6500FE">&quot;?&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">Select</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Run(p <span style="color:#0000FF;font-weight: bold">as</span> LCMS2ProfileMBS)
			<span style="color:#0000FF;font-weight: bold">self</span>.p = p
			
			<span style="color:#7F0000;text-style:italic">&#39;List.AddRow</span> <span style="color:#7F0000;text-style:italic">&quot;Handle&quot;,</span> <span style="color:#7F0000;text-style:italic">hex(p.Handle)</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">EncodingToHexMBS</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">Util</span> <span style="color:#7F0000;text-style:italic">plugin</span>
			
			List.AddRow <span style="color:#6500FE">&quot;Name&quot;</span>, p.name
			List.AddRow <span style="color:#6500FE">&quot;HeaderProfileID&quot;</span>, EncodingToHexMBS(p.HeaderProfileID)
			List.AddRow <span style="color:#6500FE">&quot;ProfileICCversion&quot;</span>, hex(p.ProfileICCversion)
			List.AddRow <span style="color:#6500FE">&quot;ProfileVersion&quot;</span>, hex(p.ProfileVersion)
			List.AddRow <span style="color:#6500FE">&quot;PCS&quot;</span>, str(p.PCS)
			List.AddRow <span style="color:#6500FE">&quot;DeviceClass&quot;</span>, hex(p.DeviceClass)+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+GetDeviceClassName(p.DeviceClass)
			List.AddRow <span style="color:#6500FE">&quot;TagCount&quot;</span>, str(p.TagCount)
			List.AddRow <span style="color:#6500FE">&quot;HeaderFlags&quot;</span>, str(p.HeaderFlags)
			List.AddRow <span style="color:#6500FE">&quot;HeaderAttributes&quot;</span>, str(p.HeaderAttributes)
			List.AddRow <span style="color:#6500FE">&quot;RenderingIntent&quot;</span>, str(p.RenderingIntent)
			List.AddRow <span style="color:#6500FE">&quot;ColorSpaceType&quot;</span>, hex(p.ColorSpaceType)+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+GetColorSpaceTypeName(p.ColorSpaceType)
			List.AddRow <span style="color:#6500FE">&quot;ChannelCount&quot;</span>, str(p.ChannelCount)
			List.AddRow <span style="color:#6500FE">&quot;HeaderManufacturer&quot;</span>, str(p.HeaderManufacturer)
			List.AddRow <span style="color:#6500FE">&quot;HeaderModel&quot;</span>, str(p.HeaderModel)
			List.AddRow <span style="color:#6500FE">&quot;IsMatrixShaper&quot;</span>,str(p.IsMatrixShaper)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> d <span style="color:#0000FF;font-weight: bold">as</span> LCMS2DateMBS = p.HeaderCreationDateTime
			<span style="color:#0000FF;font-weight: bold">if</span> d = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				List.AddRow <span style="color:#6500FE">&quot;HeaderCreationDateTime&quot;</span>, <span style="color:#6500FE">&quot;n/a&quot;</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> da <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> date
				da.Year = d.Year+<span style="color:#326598">1900</span>
				da.Month = d.Month
				da.day = d.Day
				da.Minute = d.Minute
				da.Hour = d.Hour
				da.Second = d.Second
				List.AddRow <span style="color:#6500FE">&quot;HeaderCreationDateTime&quot;</span>, da.SQLDateTime
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			Add LCMS2MBS.kcmsSigAToB0Tag, <span style="color:#6500FE">&quot;A</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">B</span> <span style="color:#6500FE">0&quot;</span>
			Add LCMS2MBS.kcmsSigAToB1Tag, <span style="color:#6500FE">&quot;A</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">B</span> <span style="color:#6500FE">1&quot;</span>
			Add LCMS2MBS.kcmsSigAToB2Tag, <span style="color:#6500FE">&quot;A</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">B</span> <span style="color:#6500FE">2&quot;</span>
			Add LCMS2MBS.kcmsSigBlueColorantTag, <span style="color:#6500FE">&quot;BlueColorant&quot;</span>
			Add LCMS2MBS.kcmsSigBlueMatrixColumnTag, <span style="color:#6500FE">&quot;BlueMatrixColumn&quot;</span>
			Add LCMS2MBS.kcmsSigBlueTRCTag, <span style="color:#6500FE">&quot;BlueTRC&quot;</span>
			Add LCMS2MBS.kcmsSigBToA0Tag, <span style="color:#6500FE">&quot;B</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">A</span> <span style="color:#6500FE">0&quot;</span>
			Add LCMS2MBS.kcmsSigBToA1Tag, <span style="color:#6500FE">&quot;B</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">A</span> <span style="color:#6500FE">1&quot;</span>
			Add LCMS2MBS.kcmsSigBToA2Tag, <span style="color:#6500FE">&quot;B</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">A</span> <span style="color:#6500FE">2&quot;</span>
			Add LCMS2MBS.kcmsSigCalibrationDateTimeTag, <span style="color:#6500FE">&quot;CalibrationDateTime&quot;</span>
			Add LCMS2MBS.kcmsSigCharTargetTag, <span style="color:#6500FE">&quot;CharTarget&quot;</span>
			Add LCMS2MBS.kcmsSigChromaticAdaptationTag, <span style="color:#6500FE">&quot;ChromaticAdaptation&quot;</span>
			Add LCMS2MBS.kcmsSigChromaticityTag, <span style="color:#6500FE">&quot;Chromaticity&quot;</span>
			Add LCMS2MBS.kcmsSigColorantOrderTag, <span style="color:#6500FE">&quot;ColorantOrder&quot;</span>
			Add LCMS2MBS.kcmsSigColorantTableTag, <span style="color:#6500FE">&quot;ColorantTable&quot;</span>
			Add LCMS2MBS.kcmsSigColorantTableOutTag, <span style="color:#6500FE">&quot;ColorantTableOut&quot;</span>
			Add LCMS2MBS.kcmsSigColorimetricIntentImageStateTag, <span style="color:#6500FE">&quot;ColorimetricIntentImageState&quot;</span>
			Add LCMS2MBS.kcmsSigCopyrightTag, <span style="color:#6500FE">&quot;Copyright&quot;</span>
			Add LCMS2MBS.kcmsSigCrdInfoTag, <span style="color:#6500FE">&quot;CrdInfo&quot;</span>
			Add LCMS2MBS.kcmsSigDataTag, <span style="color:#6500FE">&quot;Data&quot;</span>
			Add LCMS2MBS.kcmsSigDateTimeTag, <span style="color:#6500FE">&quot;DateTime&quot;</span>
			Add LCMS2MBS.kcmsSigDeviceMfgDescTag, <span style="color:#6500FE">&quot;DeviceMfgDesc&quot;</span>
			Add LCMS2MBS.kcmsSigDeviceModelDescTag, <span style="color:#6500FE">&quot;DeviceModelDesc&quot;</span>
			Add LCMS2MBS.kcmsSigDeviceSettingsTag, <span style="color:#6500FE">&quot;DeviceSettings&quot;</span>
			Add LCMS2MBS.kcmsSigDToB0Tag, <span style="color:#6500FE">&quot;D</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">B</span> <span style="color:#6500FE">0&quot;</span>
			Add LCMS2MBS.kcmsSigDToB1Tag, <span style="color:#6500FE">&quot;D</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">B</span> <span style="color:#6500FE">1&quot;</span>
			Add LCMS2MBS.kcmsSigDToB2Tag, <span style="color:#6500FE">&quot;D</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">B</span> <span style="color:#6500FE">2&quot;</span>
			Add LCMS2MBS.kcmsSigDToB3Tag, <span style="color:#6500FE">&quot;D</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">B</span> <span style="color:#6500FE">3&quot;</span>
			Add LCMS2MBS.kcmsSigBToD0Tag, <span style="color:#6500FE">&quot;B</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">D</span> <span style="color:#6500FE">0&quot;</span>
			Add LCMS2MBS.kcmsSigBToD1Tag, <span style="color:#6500FE">&quot;B</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">D</span> <span style="color:#6500FE">1&quot;</span>
			Add LCMS2MBS.kcmsSigBToD2Tag, <span style="color:#6500FE">&quot;B</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">D</span> <span style="color:#6500FE">2&quot;</span>
			Add LCMS2MBS.kcmsSigBToD3Tag, <span style="color:#6500FE">&quot;B</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">D</span> <span style="color:#6500FE">3&quot;</span>
			Add LCMS2MBS.kcmsSigGamutTag, <span style="color:#6500FE">&quot;Gamut&quot;</span>
			Add LCMS2MBS.kcmsSigGrayTRCTag, <span style="color:#6500FE">&quot;GrayTRC&quot;</span>
			Add LCMS2MBS.kcmsSigGreenColorantTag, <span style="color:#6500FE">&quot;GreenColorant&quot;</span>
			Add LCMS2MBS.kcmsSigGreenMatrixColumnTag, <span style="color:#6500FE">&quot;GreenMatrixColumn&quot;</span>
			Add LCMS2MBS.kcmsSigGreenTRCTag, <span style="color:#6500FE">&quot;GreenTRC&quot;</span>
			Add LCMS2MBS.kcmsSigLuminanceTag, <span style="color:#6500FE">&quot;Luminance&quot;</span>
			Add LCMS2MBS.kcmsSigMeasurementTag, <span style="color:#6500FE">&quot;Measurement&quot;</span>
			Add LCMS2MBS.kcmsSigMediaBlackPointTag, <span style="color:#6500FE">&quot;MediaBlackPoint&quot;</span>
			Add LCMS2MBS.kcmsSigMediaWhitePointTag, <span style="color:#6500FE">&quot;MediaWhitePoint&quot;</span>
			Add LCMS2MBS.kcmsSigNamedColorTag, <span style="color:#6500FE">&quot;NamedColor&quot;</span>
			Add LCMS2MBS.kcmsSigNamedColor2Tag, <span style="color:#6500FE">&quot;NamedColor2&quot;</span>
			Add LCMS2MBS.kcmsSigOutputResponseTag, <span style="color:#6500FE">&quot;OutputResponse&quot;</span>
			Add LCMS2MBS.kcmsSigPerceptualRenderingIntentGamutTag, <span style="color:#6500FE">&quot;PerceptualRenderingIntentGamut&quot;</span>
			Add LCMS2MBS.kcmsSigPreview0Tag, <span style="color:#6500FE">&quot;Preview0&quot;</span>
			Add LCMS2MBS.kcmsSigPreview1Tag, <span style="color:#6500FE">&quot;Preview1&quot;</span>
			Add LCMS2MBS.kcmsSigPreview2Tag, <span style="color:#6500FE">&quot;Preview2&quot;</span>
			Add LCMS2MBS.kcmsSigProfileDescriptionTag, <span style="color:#6500FE">&quot;ProfileDescription&quot;</span>
			Add LCMS2MBS.kcmsSigProfileSequenceDescTag, <span style="color:#6500FE">&quot;ProfileSequenceDesc&quot;</span>
			Add LCMS2MBS.kcmsSigProfileSequenceIdTag, <span style="color:#6500FE">&quot;ProfileSequenceId&quot;</span>
			Add LCMS2MBS.kcmsSigPs2CRD0Tag, <span style="color:#6500FE">&quot;PS</span> <span style="color:#6500FE">2</span> <span style="color:#6500FE">CRD</span> <span style="color:#6500FE">0&quot;</span>
			Add LCMS2MBS.kcmsSigPs2CRD1Tag, <span style="color:#6500FE">&quot;PS</span> <span style="color:#6500FE">2</span> <span style="color:#6500FE">CRD</span> <span style="color:#6500FE">1&quot;</span>
			Add LCMS2MBS.kcmsSigPs2CRD2Tag, <span style="color:#6500FE">&quot;PS</span> <span style="color:#6500FE">2</span> <span style="color:#6500FE">CRD</span> <span style="color:#6500FE">2&quot;</span>
			Add LCMS2MBS.kcmsSigPs2CRD3Tag, <span style="color:#6500FE">&quot;PS</span> <span style="color:#6500FE">2</span> <span style="color:#6500FE">CRD</span> <span style="color:#6500FE">3&quot;</span>
			Add LCMS2MBS.kcmsSigPs2CSATag, <span style="color:#6500FE">&quot;PS</span> <span style="color:#6500FE">2</span> <span style="color:#6500FE">CSA&quot;</span>
			Add LCMS2MBS.kcmsSigPs2RenderingIntentTag, <span style="color:#6500FE">&quot;PS</span> <span style="color:#6500FE">2</span> <span style="color:#6500FE">RenderingIntent&quot;</span>
			Add LCMS2MBS.kcmsSigRedColorantTag, <span style="color:#6500FE">&quot;RedColorant&quot;</span>
			Add LCMS2MBS.kcmsSigRedMatrixColumnTag, <span style="color:#6500FE">&quot;RedMatrixColumn&quot;</span>
			Add LCMS2MBS.kcmsSigRedTRCTag, <span style="color:#6500FE">&quot;RedTRC&quot;</span>
			Add LCMS2MBS.kcmsSigSaturationRenderingIntentGamutTag, <span style="color:#6500FE">&quot;SaturationRenderingIntentGamut&quot;</span>
			Add LCMS2MBS.kcmsSigScreeningDescTag, <span style="color:#6500FE">&quot;ScreeningDesc&quot;</span>
			Add LCMS2MBS.kcmsSigScreeningTag, <span style="color:#6500FE">&quot;Screening&quot;</span>
			Add LCMS2MBS.kcmsSigTechnologyTag, <span style="color:#6500FE">&quot;Technology&quot;</span>
			Add LCMS2MBS.kcmsSigUcrBgTag, <span style="color:#6500FE">&quot;UcrBg&quot;</span>
			Add LCMS2MBS.kcmsSigViewingCondDescTag, <span style="color:#6500FE">&quot;ViewingCondDesc&quot;</span>
			Add LCMS2MBS.kcmsSigViewingConditionsTag, <span style="color:#6500FE">&quot;ViewingConditions&quot;</span>
			Add LCMS2MBS.kcmsSigVcgtTag, <span style="color:#6500FE">&quot;Vcgt&quot;</span>
			Add LCMS2MBS.kcmsSigMetaTag, <span style="color:#6500FE">&quot;Meta&quot;</span>
			
			
			
			<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = List.ListCount-<span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = c <span style="color:#0000FF;font-weight: bold">DownTo</span> <span style="color:#326598">0</span>
				List.Expanded(i) = <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">next</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> p <span style="color:#0000FF;font-weight: bold">As</span> LCMS2ProfileMBS</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar MenuBar1</div>
<div class="RB_Code">		MenuItem FileMenu = <span style="color:#6500FE">&quot;&amp;Ablage&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;#App.kFileQuit&quot;</span></div>
<div class="RB_Code">		MenuItem EditMenu = <span style="color:#6500FE">&quot;&amp;Bearbeiten&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;&amp;R&uuml;ckg&auml;ngig&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu1 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;&amp;Ausschneiden&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;&amp;Kopieren&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;&amp;Einf&uuml;gen&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;#App.kEditClear&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu0 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditSelectAll = <span style="color:#6500FE">&quot;&amp;Alles</span> <span style="color:#6500FE">ausw&auml;hlen&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Module</span> Module1</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddRow(<span style="color:#0000FF;font-weight: bold">extends</span> l <span style="color:#0000FF;font-weight: bold">as</span> listbox, s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, t <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>)
			l.AddRow s
			l.Cell(l.LastIndex,<span style="color:#326598">1</span>)=t
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Module</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	FileTypes1</div>
<div class="RB_Code">		Filetype ICC Profile</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> FileTypes1</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MyForwardSampler <span style="color:#0000FF;font-weight: bold">Inherits</span> LCMS2StageSamplerMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> SamplerInteger(InValues <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Ptr</span>, OutValues <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Ptr</span>, InputChannels <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, OutputChannels <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Lab</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">DeviceN</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">input</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> c1 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = InValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">0</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> c2 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = InValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">2</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> c3 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = InValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">4</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">output</span>
			
			OutValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">0</span>) = c1
			OutValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">2</span>) = c1
			OutValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">4</span>) = c2
			OutValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">6</span>) = c2
			OutValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">8</span>) = c3
			OutValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">10</span>) = c3
			
			<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">true</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MyReverseSampler <span style="color:#0000FF;font-weight: bold">Inherits</span> LCMS2StageSamplerMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> SamplerInteger(InValues <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Ptr</span>, OutValues <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Ptr</span>, InputChannels <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, OutputChannels <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">DeviceN</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">Lab</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">input</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> c1 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = InValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">0</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> c2 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = InValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">2</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> c3 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = InValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">4</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> c4 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = InValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">6</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> c5 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = InValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">8</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> c6 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = InValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">10</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">output</span>
			
			OutValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">0</span>) = (c1+c2)/<span style="color:#326598">2</span>
			OutValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">2</span>) = (c3+c4)/<span style="color:#326598">2</span>
			OutValues.<span style="color:#0000FF;font-weight: bold">UInt16</span>(<span style="color:#326598">4</span>) = (c5+c6)/<span style="color:#326598">2</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">true</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

<p>See also:<ul>
<li><A href="example-images-lcms2-createacmykprofile.html">/Images/LCMS2/Create a CMYK Profile</A></li>
<li><A href="example-images-lcms2-createprofile.html">/Images/LCMS2/Create Profile</A></li>
</ul></p>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsimagesplugin.html">MBS Images Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-images-lcms2-createadevicenprofile">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

