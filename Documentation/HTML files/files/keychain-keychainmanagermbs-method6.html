<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - KeychainManagerMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="KeychainManagerMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">KeychainManagerMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="module-keychainmanagermbs.html">KeychainManagerMBS</a> module. </p>
<p>
<a href="keychain-keychainmanagermbs-method5.html">Previous items</a>
 
</p>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="1">kSecUseOperationPrompt as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion185.shtml" class=version>18.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Specifies a dictionary key whose value is a string that represents a user-visible string describing the operation for which the application is attempting to authenticate.<BR>
<B>Notes:</B> 
The application is responsible for the text localization.<BR>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="2">kSecValueData as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Keys used in the results dictionary for CopyMatching or Additem, indicating the type of values returned. <BR>
<B>Notes:</B> 
<BR>
Data attribute key. A persistent reference to a credential can be stored on disk for later use or passed to other processes.<BR>
The corresponding value is of type memoryblock.  For keys and password items, the data is secret (encrypted) and may require the user to enter a password for access.<BR>
Available in OS X v10.6 and later.<BR>
You can specify zero or more of these types depending on the function you are calling.<BR>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="3">kSecValuePersistentRef as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Keys used in the results dictionary for CopyMatching or Additem, indicating the type of values returned. <BR>
<B>Notes:</B> 
<BR>
Persistent reference attribute key.<BR>
The corresponding value is of type CFDataRef. The bytes in this memoryblock can be stored by the caller and used on a subsequent invocation of the application (or even a different application) to retrieve the item referenced by it.<BR>
Available in OS X v10.6 and later.<BR>
You can specify zero or more of these types depending on the function you are calling.<BR>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="4">kSecValueRef as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Keys used in the results dictionary for CopyMatching or Additem, indicating the type of values returned. <BR>
<B>Notes:</B> 
<BR>
Reference attribute key.<BR>
The corresponding value, depending on the item class requested, is of type <A href="class-keychainitemmbs.html">KeychainItemMBS</A>, SecKeyRef, SecCertificateRef, or SecIdentityRef.<BR>
Available in OS X v10.6 and later.<BR>
You can specify zero or more of these types depending on the function you are calling.<BR>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="5">LockAll</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Locks all keychains belonging to the current user.<BR>
<B>Notes:</B> 
<BR>
Your application should not call this function unless you are responding to a user&#39;s request to lock a keychain. In general, you should leave the keychain unlocked so that the user does not have to unlock it again in another application.<BR>
Lasterror is set.<BR>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="6">Open(file as folderitem) as <A href="class-keychainmbs.html">KeychainMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Opens a keychain.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> file <span style="color: #0000FF;">as</span> FolderItem = SpecialFolder.Desktop.Child(<span style="color: #6600FE;">&quot;test.keychain&quot;</span>)<br /><span style="color: #0000FF;">dim</span> k <span style="color: #0000FF;">as</span> <A href="class-keychainmbs.html">KeychainMBS</A> = <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.Open(file)<br /><br />MsgBox k.Name</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
You may use this function to retrieve a pointer to a keychain object given the path of the keychain. You do not need to close the keychain, but you should release the memory that the pointer occupies when you are finished with it.<BR>
Lasterror is set.<BR>
<p>See also:<ul>
<li><A href="keychain-keychainmanagermbs-method6.html#7">Open(path as string) as KeychainMBS</A></li>
</ul></p>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="7">Open(path as string) as <A href="class-keychainmbs.html">KeychainMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Opens a keychain.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> file <span style="color: #0000FF;">as</span> FolderItem = SpecialFolder.Desktop.Child(<span style="color: #6600FE;">&quot;test.keychain&quot;</span>)<br /><span style="color: #0000FF;">dim</span> k <span style="color: #0000FF;">as</span> <A href="class-keychainmbs.html">KeychainMBS</A> = <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.Open(file.NativePath)<br /><br />MsgBox k.Name</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
You may use this function to retrieve a pointer to a keychain object given the path of the keychain. You do not need to close the keychain, but you should release the memory that the pointer occupies when you are finished with it.<BR>
Lasterror is set.<BR>
<p>See also:<ul>
<li><A href="keychain-keychainmanagermbs-method6.html#6">Open(file as folderitem) as KeychainMBS</A></li>
</ul></p>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="8">PreferenceDomain as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Gets or sets the current keychain preference domain.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> n <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Integer</span> = <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.PreferenceDomain<br /><span style="color: #0000FF;">Select</span> <span style="color: #0000FF;">case</span> n<br /><span style="color: #0000FF;">case</span> <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.kSecPreferencesDomainCommon<br />  MsgBox <span style="color: #6600FE;">&quot;common&quot;</span><br /><span style="color: #0000FF;">case</span> <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.kSecPreferencesDomainDynamic<br />  MsgBox <span style="color: #6600FE;">&quot;dynamic&quot;</span><br /><span style="color: #0000FF;">case</span> <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.kSecPreferencesDomainSystem<br />  MsgBox <span style="color: #6600FE;">&quot;system&quot;</span><br /><span style="color: #0000FF;">case</span> <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.kSecPreferencesDomainUser<br />  MsgBox <span style="color: #6600FE;">&quot;user&quot;</span><br /><span style="color: #0000FF;">else</span><br />  MsgBox <span style="color: #6600FE;">&quot;unknown&quot;</span><br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">Select</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
A preference domain is a set of security-related preferences, such as the default keychain and the current keychain search list. The default preference domain for system daemons (that is, for daemons running in the root session) is the system domain. The default preference domain for all other programs is the user domain. Use the PreferenceDomain function to change the preference domain.<BR>
<BR>
This function changes the preference domain for all subsequent function calls; for example, if you change from the system domain to the user domain and then call Lock specifying nil for the keychain, the function locks the default system keychain rather than the default user keychain. You might want to use this function, for example, when launching a system daemon from a user session so that the daemon uses system preferences rather than user <BR>
(Read and Write computed property)<BR>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="9">SearchCreateFromAttributes(keychain as <A href="class-keychainmbs.html">KeychainMBS</A>, itemClass as string, AttributeKeys() as string, AttributeValues() as string) as <A href="class-keychainsearchmbs.html">KeychainSearchMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Creates a search object matching a list of zero or more attributes.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> AttributeKeys() <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span><br /><span style="color: #0000FF;">dim</span> AttributeValues() <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span><br /><span style="color: #0000FF;">dim</span> keychain <span style="color: #0000FF;">as</span> <A href="class-keychainmbs.html">KeychainMBS</A> = <span style="color: #0000FF;">nil</span> <span style="color: #800000;">// default</span><br /><br /><span style="color: #0000FF;">dim</span> search <span style="color: #0000FF;">as</span> <A href="class-keychainsearchmbs.html">KeychainSearchMBS</A> = <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.SearchCreateFromAttributes(keychain, <span style="color: #6600FE;">&quot;genp&quot;</span>, AttributeKeys, AttributeValues)<br /><span style="color: #0000FF;">dim</span> items() <span style="color: #0000FF;">as</span> <A href="class-keychainitemmbs.html">KeychainItemMBS</A><br /><br /><span style="color: #0000FF;">dim</span> item <span style="color: #0000FF;">as</span> <A href="class-keychainitemmbs.html">KeychainItemMBS</A> = search.NextItem<br /><span style="color: #0000FF;">while</span> item&lt;&gt;Nil<br />  items.Append item<br />  item = search.NextItem<br /><span style="color: #0000FF;">wend</span><br /><br />MsgBox str(UBound(items)+<span style="color: #336698;">1</span>)+<span style="color: #6600FE;">&quot; items found.&quot;</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
keychains: An array of keychains to search, a single keychain, or nil to search the user&#39;s current keychain search list. Use the function SearchList to retrieve the user&#39;s default search list.<BR>
itemClass: The keychain item class. See &quot;Keychain Item Class Constants&quot; for valid constants.<BR>
AttributeKeys: List of zero or more keychain attribute keys to match.<BR>
AttributeValues: List of zero or more keychain attribute values to match.<BR>
<BR>
Returns the current search object. <BR>
Lasterror is set.<BR>
<BR>
Each item stored in the keychain contains data (such as a certificate), which is indexed by the item&#39;s attributes. You look up an item in a keychain by its attributes. If you find a match, you can then retrieve the item&#39;s data. Use the search object created by this function as input to the SecKeychainSearchCopyNext function to find a a keychain item.<BR>
<BR>
To find and obtain data from a password keychain item, use the FindInternetPassword or FindGenericPassword function.<BR>
<p>See also:<ul>
<li><A href="keychain-keychainmanagermbs-method6.html#10">SearchCreateFromAttributes(keychains() as KeychainMBS, itemClass as string, AttributeKeys() as string, AttributeValues() as string) as KeychainSearchMBS</A></li>
</ul></p>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="10">SearchCreateFromAttributes(keychains() as <A href="class-keychainmbs.html">KeychainMBS</A>, itemClass as string, AttributeKeys() as string, AttributeValues() as string) as <A href="class-keychainsearchmbs.html">KeychainSearchMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Creates a search object matching a list of zero or more attributes.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> AttributeKeys() <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span><br /><span style="color: #0000FF;">dim</span> AttributeValues() <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span><br /><br /><span style="color: #0000FF;">dim</span> keychains() <span style="color: #0000FF;">as</span> <A href="class-keychainmbs.html">KeychainMBS</A><br /><br />AttributeKeys.Append <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.kSecAttrAccount<br />AttributeValues.Append <span style="color: #6600FE;">&quot;myusername&quot;</span><br />keychains = <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.DomainSearchList(<A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.kSecPreferencesDomainUser)<br /><br /><span style="color: #0000FF;">dim</span> search <span style="color: #0000FF;">as</span> <A href="class-keychainsearchmbs.html">KeychainSearchMBS</A> = <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.SearchCreateFromAttributes(keychains, <span style="color: #6600FE;">&quot;genp&quot;</span>, AttributeKeys, AttributeValues)<br /><span style="color: #0000FF;">dim</span> items() <span style="color: #0000FF;">as</span> <A href="class-keychainitemmbs.html">KeychainItemMBS</A><br /><br /><span style="color: #0000FF;">dim</span> item <span style="color: #0000FF;">as</span> <A href="class-keychainitemmbs.html">KeychainItemMBS</A> = search.NextItem<br /><span style="color: #0000FF;">while</span> item&lt;&gt;Nil<br />  items.Append item<br />  item = search.NextItem<br /><span style="color: #0000FF;">wend</span><br /><br />MsgBox str(UBound(items)+<span style="color: #336698;">1</span>)+<span style="color: #6600FE;">&quot; items found.&quot;</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
keychains: An array of keychains to search, a single keychain, or nil to search the user&#39;s current keychain search list. Use the function SearchList to retrieve the user&#39;s default search list.<BR>
itemClass: The keychain item class. See &quot;Keychain Item Class Constants&quot; for valid constants.<BR>
AttributeKeys: List of zero or more keychain attribute keys to match.<BR>
AttributeValues: List of zero or more keychain attribute values to match.<BR>
<BR>
Returns the current search object. <BR>
Lasterror is set.<BR>
<BR>
Each item stored in the keychain contains data (such as a certificate), which is indexed by the item&#39;s attributes. You look up an item in a keychain by its attributes. If you find a match, you can then retrieve the item&#39;s data. Use the search object created by this function as input to the SecKeychainSearchCopyNext function to find a a keychain item.<BR>
<BR>
To find and obtain data from a password keychain item, use the FindInternetPassword or FindGenericPassword function.<BR>
<p>See also:<ul>
<li><A href="keychain-keychainmanagermbs-method6.html#9">SearchCreateFromAttributes(keychain as KeychainMBS, itemClass as string, AttributeKeys() as string, AttributeValues() as string) as KeychainSearchMBS</A></li>
</ul></p>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="11">SearchList as <A href="class-keychainmbs.html">KeychainMBS</A>()</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Retrieves a keychain search list.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> SearchList() <span style="color: #0000FF;">as</span> <A href="class-keychainmbs.html">KeychainMBS</A> = <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.SearchList<br /><span style="color: #0000FF;">dim</span> names() <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">String</span><br /><br /><span style="color: #0000FF;">for</span> <span style="color: #0000FF;">each</span> k <span style="color: #0000FF;">as</span> <A href="class-keychainmbs.html">KeychainMBS</A> <span style="color: #0000FF;">in</span> SearchList<br />  names.Append k.Name<br /><span style="color: #0000FF;">next</span><br /><br />MsgBox Join(names, EndOfLine)</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Returns keychain search list.<BR>
Lasterror is set.<BR>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="12">SetDomainDefault(domain as Integer, keychain as <A href="class-keychainmbs.html">KeychainMBS</A>)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Sets the default keychain for a specified preference domain.<BR>
<B>Notes:</B> 
<BR>
domain: The preference domain for which you wish to set the default keychain. <BR>
keychain: A reference to the keychain you wish to set as default in the specified preference domain.<BR>
<BR>
Lasterror is set.<BR>
A preference domain is a set of security-related preferences, such as the default keychain and the current keychain search list. Use this function if you want to set the default keychain for a specific preference domain. Use the SetDefault function if you want to set the default keychain for the current preference domain. See the PreferenceDomain function for a discussion of current and default preference domains.<BR>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="13">SetDomainSearchList(domain as Integer, list() as <A href="class-keychainmbs.html">KeychainMBS</A>)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Sets the keychain search list for a specified preference domain.<BR>
<B>Notes:</B> 
<BR>
domain: The preference domain for which you wish to set the default keychain search list. See &quot;Keychain Preference Domain Constants&quot;for possible domain values.<BR>
searchList: A keychain search list to set in the preference domain.<BR>
<BR>
Lasterror is set.<BR>
A preference domain is a set of security-related preferences, such as the default keychain and the current keychain search list. Use this function if you want to set the keychain search list for a specific preference domain. Use the SetSearchList function if you want to set the keychain search list for the current preference domain. See the PreferenceDomain function for a discussion of current and default preference domains.<BR>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="14">SetSearchList(list() as <A href="class-keychainmbs.html">KeychainMBS</A>)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Specifies the list of keychains to use in the default keychain search list.<BR>
<B>Notes:</B> 
<BR>
searchList: An array of keychain references specifying the list of keychains to use in the default keychain search list. Passing an empty array clears the search list.<BR>
<BR>
Lasterror is set.<BR>
The default keychain search list is used by several functions; see for example SearchCreateFromAttributes, FindInternetPassword, or FindGenericPassword. To obtain the current default keychain search list, use the SearchList function.<BR>
<BR>
The default keychain search list is displayed as the keychain list in the Keychain Access utility. If you use SetSearchList to change the keychain search list, the list displayed in Keychain Access changes accordingly.<BR>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="15">UpdateItem(Query as Dictionary, attributesToUpdate as dictionary) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Modifies items that match a search query.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #800000;">// build query</span><br /><span style="color: #0000FF;">dim</span> query <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> Dictionary<br /><br /><span style="color: #0000FF;">dim</span> ServiceName <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;mytest&quot;</span><br /><span style="color: #0000FF;">dim</span> Username <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;myusername&quot;</span><br /><br />query.value( <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.kSecAttrAccount ) = Username<br />query.value( <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.kSecAttrService ) = ServiceName<br />query.value( <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.kSecClass ) = <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.kSecClassGenericPassword<br /><br /><span style="color: #800000;">// Build Dictionary with new values</span><br /><span style="color: #0000FF;">dim</span> newValues <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> Dictionary<br />newValues.value( <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.kSecAttrComment ) = <span style="color: #6600FE;">&quot;Just a test&quot;</span><br /><br /><span style="color: #800000;">// and update</span><br /><span style="color: #0000FF;">if</span> <A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.UpdateItem(query, newValues) <span style="color: #0000FF;">then</span><br />  MsgBox <span style="color: #6600FE;">&quot;OK&quot;</span><br /><span style="color: #0000FF;">else</span><br />  MsgBox <span style="color: #6600FE;">&quot;Failed.&quot;</span><br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
query: A dictionary containing an item class specification and optional attributes for controlling the search. Specify the items whose values you wish to change. See &quot;Search Keys&quot; for a description of currently defined search attributes.<BR>
attributesToUpdate: A dictionary containing the attributes whose values should be changed, along with the new values. Only real keychain attributes are permitted in this dictionary (no &quot;meta&quot; attributes are allowed.) See &quot;Attribute Item Keys and Values&quot; for a description of currently defined value attributes.<BR>
<BR>
Lasterror is set.<BR>
See the discussion section of the CopyMatching function for information about how to construct a search dictionary.<BR>
<BR>
Available in OS X v10.6 and later.<BR>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="16">UserInteractionAllowed as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Indicates whether Keychain Services functions that normally display a user interaction are allowed to do so.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;">MsgBox str(<A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.UserInteractionAllowed)<br /><A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.UserInteractionAllowed = <span style="color: #0000FF;">false</span><br />MsgBox str(<A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.UserInteractionAllowed)</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Lasterror is set.<BR>
A Boolean value indicating whether user interaction is permitted. If true, user interaction is allowed, and Keychain Services functions that display a user interface can do so as appropriate.<BR>
(Read and Write computed property)<BR>
</div>
<div class="M">
<b><a href="module-keychainmanagermbs.html">KeychainManagerMBS</a>.<A name="17">Version as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-keychain.html" translate="no">Keychain</A></td>
<td class=grau><a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a></td>
<td class=grau><a href="newinversion131.shtml" class=version>13.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Determines the version of Keychain Services installed on the user&#39;s system.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;">MsgBox str(<A href="module-keychainmanagermbs.html">KeychainManagerMBS</A>.Version)</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Your application can call the Version function to find out which version of Keychain Services is installed on the user&#39;s system.<BR>
Lasterror is set.<BR>
</div>
<p>
<a href="keychain-keychainmanagermbs-method5.html">Previous items</a>
 
</p>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmacclassicplugin.html">MBS MacClassic Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=keychain-keychainmanagermbs-method6">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

