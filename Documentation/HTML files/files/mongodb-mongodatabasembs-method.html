<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - MongoDatabaseMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="MongoDatabaseMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">MongoDatabaseMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-mongodatabasembs.html">MongoDatabaseMBS</a> class.  </p>
<div class="WLMI">
<b><a href="class-mongodatabasembs.html">MongoDatabaseMBS</a>.<A name="1">Aggregate(pipelineJSON as String, OptionsJSON as String = &quot;&quot;) as <A href="class-mongocursormbs.html">MongoCursorMBS</A></A></b> &nbsp; <b style="color: #00008B"> New in 23.1 </b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion231.shtml" class=version>23.1</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Creates an aggregate database.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>

<span style="color: #000000;"><span style="color: #0000FF;">dim</span> database <span style="color: #0000FF;">as</span> <A href="class-mongodatabasembs.html">MongoDatabaseMBS</A> <span style="color: #800000;">// your database</span><br /><br /><span style="color: #0000FF;">dim</span> Cursor <span style="color: #0000FF;">as</span> <A href="class-mongocursormbs.html">MongoCursorMBS</A> = database.Aggregate(<span style="color: #6600FE;">&quot;[{&quot;</span><span style="color: #6600FE;">&quot;$listLocalSessions&quot;</span><span style="color: #6600FE;">&quot;: {}}]&quot;</span>)<br /><span style="color: #800000;">// loop over cursor</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
This function creates a cursor which sends the aggregate command on the underlying database upon the first call to MongoDB.CursorNext. For more information on building aggregation pipelines, see the MongoDB Manual entry on the aggregate command. Note that the pipeline must start with a compatible stage that does not require an underlying collection (e.g. &ldquo;$currentOp&rdquo;, &ldquo;$listLocalSessions&rdquo;).<BR>
Returns a new cursor on success.<BR>
<BR>
Please review the documentation for MongoDB on how to build the JSON for pipeline or options.<BR>
<BR>
In case of an error, raises <A href="class-mongoexceptionmbs.html">MongoExceptionMBS</A>.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongodatabasembs.html">MongoDatabaseMBS</a>.<A name="2">Collection(Name as String) as <A href="class-mongocollectionmbs.html">MongoCollectionMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Gets the collection with given name.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongodatabasembs.html">MongoDatabaseMBS</a>.<A name="3">CollectionNames(OptionsJSON as String = &quot;&quot;) as String()</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Fetches the list of the names of all of the collections in database.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>

<span style="color: #000000;"><span style="color: #0000FF;">const</span> URL = <span style="color: #6600FE;">&quot;mongodb://192.168.2.102/&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> uri <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongourimbs.html">MongoURIMBS</A>(URL)<br /><span style="color: #0000FF;">dim</span> client <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongoclientmbs.html">MongoClientMBS</A>(uri)<br /><br /><span style="color: #0000FF;">dim</span> database <span style="color: #0000FF;">as</span> <A href="class-mongodatabasembs.html">MongoDatabaseMBS</A> = client.Database(<span style="color: #6600FE;">&quot;local&quot;</span>)<br /><span style="color: #0000FF;">dim</span> Collections() <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = database.CollectionNames<br /><br />Break <span style="color: #800000;">// see in debugger</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
see MongoDB documentation for list of options:<BR>
<a href="https://www.mongodb.com/docs/manual/reference/command/listCollections/" target=_blank>https://www.mongodb.com/docs/manual/reference/command/listCollections/</a><BR>
<BR>
In case of an error, raises <A href="class-mongoexceptionmbs.html">MongoExceptionMBS</A>.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongodatabasembs.html">MongoDatabaseMBS</a>.<A name="4">Command(commandJSON as String, OptionsJSON as String = &quot;&quot;) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Execute a command on the server, interpreting opts according to the MongoDB server version. <BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>

<span style="color: #000000;"><span style="color: #0000FF;">const</span> URL = <span style="color: #6600FE;">&quot;mongodb://localhost/&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> uri <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongourimbs.html">MongoURIMBS</A>(URL)<br /><span style="color: #0000FF;">dim</span> client <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongoclientmbs.html">MongoClientMBS</A>(uri)<br /><span style="color: #0000FF;">dim</span> database <span style="color: #0000FF;">as</span> <A href="class-mongodatabasembs.html">MongoDatabaseMBS</A> = client.Database(<span style="color: #6600FE;">&quot;local&quot;</span>)<br /><br /><span style="color: #0000FF;">dim</span> ping <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> JSONItem<br />ping.Value(<span style="color: #6600FE;">&quot;ping&quot;</span>) = <span style="color: #336698;">1</span><br /><br /><span style="color: #0000FF;">dim</span> reply <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = database.Command(ping.ToString)<br /><br />Break <span style="color: #800000;">// { &quot;ok&quot; : 1.0 }</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Returns the reply from the server.<BR>
<BR>
In case of an error, raises <A href="class-mongoexceptionmbs.html">MongoExceptionMBS</A>.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongodatabasembs.html">MongoDatabaseMBS</a>.<A name="5">Constructor</A></b> &nbsp; <b style="color: #8B0000"> Private </b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
The private constructor.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongodatabasembs.html">MongoDatabaseMBS</a>.<A name="6">Copy as <A href="class-mongodatabasembs.html">MongoDatabaseMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Performs a deep copy of the database struct and its configuration. <BR>
</div>
<div class="WLMI">
<b><a href="class-mongodatabasembs.html">MongoDatabaseMBS</a>.<A name="7">CreateCollection(Name as String, OptionsJSON as String = &quot;&quot;) as <A href="class-mongocollectionmbs.html">MongoCollectionMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Creates a collection in the database.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>

<span style="color: #000000;"><span style="color: #0000FF;">const</span> URL = <span style="color: #6600FE;">&quot;mongodb://localhost/&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> uri <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongourimbs.html">MongoURIMBS</A>(URL)<br /><span style="color: #0000FF;">dim</span> client <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongoclientmbs.html">MongoClientMBS</A>(uri)<br /><br /><span style="color: #0000FF;">dim</span> database <span style="color: #0000FF;">as</span> <A href="class-mongodatabasembs.html">MongoDatabaseMBS</A> = client.Database(<span style="color: #6600FE;">&quot;local&quot;</span>)<br /><span style="color: #0000FF;">dim</span> Collection <span style="color: #0000FF;">as</span> <A href="class-mongocollectionmbs.html">MongoCollectionMBS</A> = database.CreateCollection(<span style="color: #6600FE;">&quot;testing2&quot;</span>)<br /><br />MessageBox Collection.Name<br /><br />Break</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
If no write concern is provided in opts, the database&rsquo;s write concern is used.<BR>
<BR>
For a list of all options, see the MongoDB Manual entry on the create command.<BR>
In case of an error, raises <A href="class-mongoexceptionmbs.html">MongoExceptionMBS</A>.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongodatabasembs.html">MongoDatabaseMBS</a>.<A name="8">FindCollections(OptionsJSON as String = &quot;&quot;) as <A href="class-mongocursormbs.html">MongoCursorMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Fetches a cursor containing documents, each corresponding to a collection on this database.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>

<span style="color: #000000;"><span style="color: #0000FF;">const</span> URL = <span style="color: #6600FE;">&quot;mongodb://localhost/&quot;</span><br /><br /><span style="color: #0000FF;">dim</span> uri <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongourimbs.html">MongoURIMBS</A>(URL)<br /><span style="color: #0000FF;">dim</span> client <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-mongoclientmbs.html">MongoClientMBS</A>(uri)<br /><br /><span style="color: #0000FF;">dim</span> database <span style="color: #0000FF;">as</span> <A href="class-mongodatabasembs.html">MongoDatabaseMBS</A> = client.Database(<span style="color: #6600FE;">&quot;local&quot;</span>)<br /><br /><span style="color: #0000FF;">dim</span> cursor <span style="color: #0000FF;">as</span> <A href="class-mongocursormbs.html">MongoCursorMBS</A> = database.FindCollections<br /><span style="color: #0000FF;">dim</span> Record <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span><br /><br /><span style="color: #0000FF;">while</span> cursor.NextRecord(record)<br />  <br />  MessageBox record<br />  <br /><span style="color: #0000FF;">wend</span><br /><br />Break</span>
</pre>
</div>
<B>Notes:</B> 
In case of an error, raises <A href="class-mongoexceptionmbs.html">MongoExceptionMBS</A>.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-mongodb-mongodbblog.html">/MongoDB/MongoDB Blog</A></li>
<li><A href="example-mongodb-mongodbtest.html">/MongoDB/MongoDB Test</A></li>
</ul>
</div>
<div class="WLMI">
<b><a href="class-mongodatabasembs.html">MongoDatabaseMBS</a>.<A name="9">HasCollection(Name as String) as Boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion223.shtml" class=version>22.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Checks to see if a collection exists on the MongoDB server within database.<BR>
<B>Notes:</B> 
<BR>
If the function succeeds, it returns true if the collection exists and false if not.<BR>
Raises exception in case of an invalid arguments or a server or network error.<BR>
<BR>
In case of an error, raises <A href="class-mongoexceptionmbs.html">MongoExceptionMBS</A>.<BR>
</div>
<div class="WLMI">
<b><a href="class-mongodatabasembs.html">MongoDatabaseMBS</a>.<A name="10">Watch(pipelineJSON as String, OptionsJSON as String = &quot;&quot;) as <A href="class-mongochangestreammbs.html">MongoChangeStreamMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-mongodb.html" translate="no">MongoDB</A></td>
<td class=grau><a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a></td>
<td class=grau><a href="newinversion230.shtml" class=version>23.0</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Creates a change stream for a database.<BR>
<B>Notes:</B> 
<BR>
It is preferred to call this function over using a raw aggregation to create a change stream.<BR>
<BR>
This function uses the read preference and read concern of the database. If the change stream needs to re-establish connection, the same read preference will be used. This may happen if the change stream encounters a resumable error.<BR>
<BR>
Warning A change stream is only supported with majority read concern.<BR>
This function is considered a retryable read operation. Upon a transient error (a network error, errors due to replica set failover, etc.) the operation is safely retried once. If retryreads is false in the URI the retry behavior does not apply.<BR>
<BR>
Call this method on the database which the change stream listens to.<BR>
<BR>
pipelineJSON: A JSON representing an aggregation pipeline appended to the change stream. This may be an empty document.<BR>
<BR>
OptionsJSON: A JSON containing change stream options. options may be &quot;&quot; or a JSON document with additional command options:<BR>
<BR>
batchSize: An integer representing number of documents requested to be returned on each call to NextChange()<BR>
<BR>
resumeAfter: A Document representing the logical starting point of the change stream. The result of StreamResumeToken() or the _id field of any change received from a change stream can be used here. This option is mutually exclusive with startAfter and startAtOperationTime.<BR>
<BR>
startAfter: A Document representing the logical starting point of the change stream. Unlike resumeAfter, this can resume notifications after an &ldquo;invalidate&rdquo; event. The result of StreamResumeToken() or the _id field of any change received from a change stream can be used here. This option is mutually exclusive with resumeAfter and startAtOperationTime.<BR>
<BR>
startAtOperationTime: A Timestamp. The change stream only provides changes that occurred at or after the specified timestamp. Any command run against the server will return an operation time that can be used here. This option is mutually exclusive with resumeAfter and startAfter.<BR>
<BR>
maxAwaitTimeMS: An int64 representing the maximum amount of time a call to StreamResumeToken() will block waiting for data<BR>
<BR>
fullDocument: An optional UTF-8 string. Set this option to &ldquo;default&rdquo;, &ldquo;updateLookup&rdquo;, &ldquo;whenAvailable&rdquo;, or &ldquo;required&rdquo;, If unset, The string &ldquo;default&rdquo; is assumed. Set this option to &ldquo;updateLookup&rdquo; to direct the change stream cursor to lookup the most current majority-committed version of the document associated to an update change stream event.<BR>
<BR>
fullDocumentBeforeChange: An optional UTF-8 string. Set this option to &ldquo;whenAvailable&rdquo;, &ldquo;required&rdquo;, or &ldquo;off&rdquo;. When unset, the default value is &ldquo;off&rdquo;. Similar to &ldquo;fullDocument&rdquo;, but returns the value of the document before the associated change.<BR>
<BR>
comment: A JSON specifying the comment to attach to this command. The comment will appear in log messages, profiler output, and currentOp output. Only string values are supported prior to MongoDB 4.4.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmongodbplugin.html">MBS MongoDB Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=mongodb-mongodatabasembs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

