<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - CTLineMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="CTLineMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">CTLineMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-ctlinembs.html">CTLineMBS</a> class.  </p>
<div class="M">
<b><a href="class-ctlinembs.html">CTLineMBS</a>.<A name="1">Bounds(options as Integer = 0) as <A href="class-cgrectmbs.html">CGRectMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coretext.html" translate="no">CoreText</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion142.shtml" class=version>14.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Queries bounds.<BR>
</div>
<div class="M">
<b><a href="class-ctlinembs.html">CTLineMBS</a>.<A name="2">Constructor</A></b> &nbsp; <b style="color: #8B0000"> Private </b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coretext.html" translate="no">CoreText</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion142.shtml" class=version>14.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
The private constructor.<BR>
</div>
<div class="M">
<b><a href="class-ctlinembs.html">CTLineMBS</a>.<A name="3">CreateJustifiedLine(justificationFactor as Double, justificationWidth as Double) as <A href="class-ctlinembs.html">CTLineMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coretext.html" translate="no">CoreText</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion142.shtml" class=version>14.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Creates a justified line from an existing line.<BR>
<B>Notes:</B> 
<BR>
line: The line from which to create a justified line.<BR>
justificationFactor: Full or partial justification. When set to 1.0 or greater, full justification is performed. If this parameter is set to less than 1.0, varying degrees of partial justification are performed. If it is set to 0 or less, no justification is performed.<BR>
justificationWidth: The width to which the resultant line is justified. If justificationWidth is less than the actual width of the line, then negative justification is performed (that is, glyphs are squeezed together).<BR>
<BR>
Returns a reference to a justified CTLine object if the call was successful; otherwise, nil.<BR>
Available in OS X v10.5 and later.<BR>
</div>
<div class="M">
<b><a href="class-ctlinembs.html">CTLineMBS</a>.<A name="4">CreateTruncatedLine(width as Double, truncationType as Integer, truncationToken as <A href="class-ctlinembs.html">CTLineMBS</A> = nil) as <A href="class-ctlinembs.html">CTLineMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coretext.html" translate="no">CoreText</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion142.shtml" class=version>14.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Creates a truncated line from an existing line.<BR>
<B>Notes:</B> 
<BR>
line: The line from which to create a truncated line.<BR>
width: The width at which truncation begins. The line is truncated if its width is greater than the width passed in this parameter.<BR>
truncationType: The type of truncation to perform if needed. See constants for possible values.<BR>
truncationToken: This token is added at the point where truncation took place, to indicate that the line was truncated. Usually, the truncation token is the ellipsis character (U+2026). If this parameter is set to nil, then no truncation token is used and the line is simply cut off.<BR>
<BR>
Returns a reference to a truncated CTLine object if the call was successful; otherwise, NULL.<BR>
<BR>
The line specified in truncationToken should have a width less than the width specified by the width parameter. If the width of the line specified in truncationToken is greater than width and truncation is needed, the function returns nil.<BR>
<BR>
Available in OS X v10.5 and later.<BR>
</div>
<div class="M">
<b><a href="class-ctlinembs.html">CTLineMBS</a>.<A name="5">Draw(context as <A href="class-cgcontextmbs.html">CGContextMBS</A>)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coretext.html" translate="no">CoreText</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion142.shtml" class=version>14.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Draws a complete line.<BR>
<B>Notes:</B> 
<BR>
context: The context into which the line is drawn.<BR>
<BR>
This is a convenience function because the line could be drawn run-by-run by getting the glyph runs, getting the glyphs out of them, and calling a function such as <A href="class-cgcontextmbs.html">CGContextMBS</A>.ShowGlyphsAtPositions. This call can leave the graphics context in any state and does not flush the context after the draw operation.<BR>
<BR>
Available in OS X v10.5 and later.<BR>
</div>
<div class="M">
<b><a href="class-ctlinembs.html">CTLineMBS</a>.<A name="6">GlyphRuns as <A href="class-ctrunmbs.html">CTRunMBS</A>()</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coretext.html" translate="no">CoreText</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion142.shtml" class=version>14.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Returns the array of glyph runs that make up the line object.<BR>
<B>Notes:</B> 
<BR>
Returns an array containing the <A href="class-ctrunmbs.html">CTRunMBS</A> objects that make up the line.<BR>
Available in OS X v10.5 and later.<BR>
</div>
<div class="M">
<b><a href="class-ctlinembs.html">CTLineMBS</a>.<A name="7">ImageBounds(context as <A href="class-cgcontextmbs.html">CGContextMBS</A>) as <A href="class-cgrectmbs.html">CGRectMBS</A></A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coretext.html" translate="no">CoreText</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion142.shtml" class=version>14.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Calculates the image bounds for a line.<BR>
<B>Notes:</B> 
<BR>
context: The context for which the image bounds are calculated. This is required because the context could have settings in it that would cause changes in the image bounds.<BR>
<BR>
Returns a rectangle that tightly encloses the paths of the line&#39;s glyphs, or, if the line or context is invalid, CGRectNull.<BR>
Available in OS X v10.5 and later.<BR>
</div>
<div class="M">
<b><a href="class-ctlinembs.html">CTLineMBS</a>.<A name="8">OffsetForStringIndex(charIndex as Integer, byref secondaryOffset as Double) as Double</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coretext.html" translate="no">CoreText</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion142.shtml" class=version>14.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Determines the graphical offset or offsets for a string index.<BR>
<B>Notes:</B> 
<BR>
charIndex: The string index corresponding to the desired position.<BR>
secondaryOffset: On output, the secondary offset along the baseline for charIndex. When a single caret is sufficient for a string index, this value will be the same as the primary offset, which is the return value of this function. May be NULL.<BR>
<BR>
Returns the primary offset along the baseline for charIndex, or 0.0 if the line does not support string access.<BR>
<BR>
This function returns the graphical offset or offsets corresponding to a string index, suitable for movement between adjacent lines or for drawing a custom caret. For moving between adjacent lines, the primary offset can be adjusted for any relative indentation of the two lines; a CGPoint constructed with the adjusted offset for its x value and 0.0 for its y value is suitable for passing to CTLineGetStringIndexForPosition. For drawing a custom caret, the returned primary offset corresponds to the portion of the caret that represents the visual insertion location for a character whose direction matches the line&#39;s writing direction.<BR>
<BR>
Available in OS X v10.5 and later.<BR>
</div>
<div class="M">
<b><a href="class-ctlinembs.html">CTLineMBS</a>.<A name="9">PenOffsetForFlush(flushFactor as Double, flushWidth as Double) as Double</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coretext.html" translate="no">CoreText</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion142.shtml" class=version>14.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Gets the pen offset required to draw flush text.<BR>
<B>Notes:</B> 
<BR>
flushFactor: Determines the type of flushness. A flushFactor of 0 or less indicates left flush. A flushFactor of 1.0 or more indicates right flush. Flush factors between 0 and 1.0 indicate varying degrees of center flush, with a value of 0.5 being totally center flush.<BR>
flushWidth: Specifies the width to which the flushness operation should apply.<BR>
<BR>
Returns the offset from the current pen position for the flush operation.<BR>
Available in OS X v10.5 and later.<BR>
</div>
<div class="M">
<b><a href="class-ctlinembs.html">CTLineMBS</a>.<A name="10">StringIndexForPosition(position as <A href="class-cgpointmbs.html">CGPointMBS</A>) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coretext.html" translate="no">CoreText</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion142.shtml" class=version>14.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Performs hit testing.<BR>
<B>Notes:</B> 
<BR>
position: The location of the mouse click relative to the line&#39;s origin.<BR>
<BR>
Returns the string index for the position, or if the line does not support string access, kCFNotFound. Relative to the line&#39;s string range, this value can be no less than the first string index and no greater than the last string index plus 1.<BR>
<BR>
This function can be used to determine the string index for a mouse click or other event. This string index corresponds to the character before which the next character should be inserted. This determination is made by analyzing the string from which a typesetter was created and the corresponding glyphs as embodied by a particular line.<BR>
Available in OS X v10.5 and later.<BR>
</div>
<div class="M">
<b><a href="class-ctlinembs.html">CTLineMBS</a>.<A name="11">TypographicBounds(byref ascent as Double, byref descent as Double, byref leading as Double) as Double</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coretext.html" translate="no">CoreText</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion142.shtml" class=version>14.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Calculates the typographic bounds of a line.<BR>
<B>Notes:</B> 
<BR>
ascent: On output, the ascent of the line.<BR>
descent: On output, the descent of the line.<BR>
leading: On output, the leading of the line. <BR>
<BR>
Returns the typographic width of the line. If the line is invalid, this function returns 0.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=coretext-ctlinembs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

