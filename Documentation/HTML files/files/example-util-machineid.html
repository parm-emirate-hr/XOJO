<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /Util/Machine ID</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /Util/Machine ID</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/Util/Machine ID</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS Util Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /Util/Machine ID<BR>
This example is the version from Fri, 15th Nov 2018.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;Machine</span> <span style="color:#6500FE">ID.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kEditClear = <span style="color:#6500FE">&quot;&amp;Delete&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuit = <span style="color:#6500FE">&quot;&amp;Quit&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuitShortcut = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			pref.init
			
			
			<span style="color:#0000FF;font-weight: bold">dim</span> r <span style="color:#0000FF;font-weight: bold">as</span> CheckMachineResult = Pref.CheckMachineID
			<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">case</span> r
			<span style="color:#0000FF;font-weight: bold">case</span> CheckMachineResult.Accepted
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">okay</span>
			<span style="color:#0000FF;font-weight: bold">case</span> CheckMachineResult.NewMachine
				MsgBox <span style="color:#6500FE">&quot;This</span> <span style="color:#6500FE">is</span> <span style="color:#6500FE">a</span> <span style="color:#6500FE">new</span> <span style="color:#6500FE">computer.</span> <span style="color:#6500FE">Please</span> <span style="color:#6500FE">enter</span> <span style="color:#6500FE">license</span> <span style="color:#6500FE">key</span> <span style="color:#6500FE">again.&quot;</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">computer,</span> <span style="color:#7F0000;text-style:italic">ask</span> <span style="color:#7F0000;text-style:italic">customer</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">license</span> <span style="color:#7F0000;text-style:italic">key</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">activation</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">than</span> <span style="color:#7F0000;text-style:italic">reset</span> <span style="color:#7F0000;text-style:italic">table</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">pref.ResetMachineID</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">call</span> <span style="color:#7F0000;text-style:italic">pref.CheckMachineID</span> <span style="color:#7F0000;text-style:italic">again</span>
				
			<span style="color:#0000FF;font-weight: bold">case</span> CheckMachineResult.Error
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">&quot;Database</span> <span style="color:#7F0000;text-style:italic">error?&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> CheckMachineResult.FirstLaunch
				MsgBox <span style="color:#6500FE">&quot;Welcome</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">my</span> <span style="color:#6500FE">great</span> <span style="color:#6500FE">app!&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">Select</span>
			
			
			<span style="color:#0000FF;font-weight: bold">dim</span> n <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = pref.value(<span style="color:#6500FE">&quot;LaunchCounter&quot;</span>)
			pref.Value(<span style="color:#6500FE">&quot;LaunchCounter&quot;</span>) = n + <span style="color:#326598">1</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar MainMenuBar</div>
<div class="RB_Code">		MenuItem FileMenu = <span style="color:#6500FE">&quot;&amp;File&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;#App.kFileQuit&quot;</span></div>
<div class="RB_Code">		MenuItem EditMenu = <span style="color:#6500FE">&quot;&amp;Edit&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;&amp;Undo&quot;</span></div>
<div class="RB_Code">			MenuItem EditSeparator1 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;Cu&amp;t&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;&amp;Copy&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;&amp;Paste&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;#App.kEditClear&quot;</span></div>
<div class="RB_Code">			MenuItem EditSeparator2 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditSelectAll = <span style="color:#6500FE">&quot;Select</span> <span style="color:#6500FE">&amp;All&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Module</span> Pref</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> PrefFilename = <span style="color:#6500FE">&quot;MachineIDTestApp.db&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> PrefPassword = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Enum</span> CheckMachineResult
			Unknown = <span style="color:#326598">0</span>
			FirstLaunch
			Accepted
			NewMachine
			Error = -<span style="color:#326598">1</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Enum</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Protected</span> <span style="color:#0000FF;font-weight: bold">Function</span> CheckMachineID() <span style="color:#0000FF;font-weight: bold">As</span> CheckMachineResult
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">those</span> <span style="color:#7F0000;text-style:italic">10</span> <span style="color:#7F0000;text-style:italic">values</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> MacAddress     <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = SystemInformationMBS.MACAddressString
			<span style="color:#0000FF;font-weight: bold">dim</span> MacModel       <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = SystemInformationMBS.MacModel
			<span style="color:#0000FF;font-weight: bold">dim</span> HardDiscSerial <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = SystemInformationMBS.HardDiscSerial
			<span style="color:#0000FF;font-weight: bold">dim</span> MacUUID        <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = SystemInformationMBS.MacUUID
			<span style="color:#0000FF;font-weight: bold">dim</span> WinProductKey  <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = SystemInformationMBS.WinProductKey
			<span style="color:#0000FF;font-weight: bold">dim</span> ComputerName   <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = SystemInformationMBS.ComputerName.trim
			<span style="color:#0000FF;font-weight: bold">dim</span> CPUBrandString <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = SystemInformationMBS.CPUBrandString
			<span style="color:#0000FF;font-weight: bold">dim</span> Platform       <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = GetPlatform
			<span style="color:#0000FF;font-weight: bold">dim</span> ProcessorCount <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = SystemInformationMBS.ProcessorCount(SystemInformationMBS.kProcessorCountPhysical)
			<span style="color:#0000FF;font-weight: bold">dim</span> PhysicalRAM    <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Int64</span> = round(SystemInformationMBS.PhysicalRAM)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> r <span style="color:#0000FF;font-weight: bold">as</span> RecordSet = db.sqlSelect(<span style="color:#6500FE">&quot;SELECT</span> <span style="color:#6500FE">*</span> <span style="color:#6500FE">FROM</span> <span style="color:#6500FE">Machines&quot;</span>)
			
			<span style="color:#0000FF;font-weight: bold">if</span> db.Error <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> e <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = db.ErrorMessage
				break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">debugger</span>
				MsgBox e
				<span style="color:#0000FF;font-weight: bold">return</span> CheckMachineResult.Error
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> result <span style="color:#0000FF;font-weight: bold">as</span> CheckMachineResult
			<span style="color:#0000FF;font-weight: bold">dim</span> add <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = <span style="color:#0000FF;font-weight: bold">false</span>
			
			
			<span style="color:#0000FF;font-weight: bold">if</span> r = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">or</span> r.EOF <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">nothing</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">table,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">add</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">first</span> <span style="color:#7F0000;text-style:italic">run</span>
				add = <span style="color:#0000FF;font-weight: bold">true</span>
				result = CheckMachineResult.FirstLaunch
				
			<span style="color:#0000FF;font-weight: bold">else</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">records,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">compare</span>
				
				result = CheckMachineResult.NewMachine
				
				<span style="color:#0000FF;font-weight: bold">while</span> <span style="color:#0000FF;font-weight: bold">not</span> r.EOF
					
					<span style="color:#0000FF;font-weight: bold">dim</span> rMacAddress     <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = r.Field(<span style="color:#6500FE">&quot;MacAddress&quot;</span>).StringValue
					<span style="color:#0000FF;font-weight: bold">dim</span> rMacModel       <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = r.Field(<span style="color:#6500FE">&quot;MacModel&quot;</span>).StringValue
					<span style="color:#0000FF;font-weight: bold">dim</span> rHardDiscSerial <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = r.Field(<span style="color:#6500FE">&quot;HardDiscSerial&quot;</span>).StringValue
					<span style="color:#0000FF;font-weight: bold">dim</span> rMacUUID        <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = r.Field(<span style="color:#6500FE">&quot;MacUUID&quot;</span>).StringValue
					<span style="color:#0000FF;font-weight: bold">dim</span> rWinProductKey  <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = r.Field(<span style="color:#6500FE">&quot;WinProductKey&quot;</span>).StringValue
					<span style="color:#0000FF;font-weight: bold">dim</span> rComputerName   <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = r.Field(<span style="color:#6500FE">&quot;ComputerName&quot;</span>).StringValue
					<span style="color:#0000FF;font-weight: bold">dim</span> rCPUBrandString <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = r.Field(<span style="color:#6500FE">&quot;CPUBrandString&quot;</span>).StringValue
					<span style="color:#0000FF;font-weight: bold">dim</span> rPlatform       <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = r.Field(<span style="color:#6500FE">&quot;Platform&quot;</span>).StringValue
					<span style="color:#0000FF;font-weight: bold">dim</span> rProcessorCount <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = r.Field(<span style="color:#6500FE">&quot;ProcessorCount&quot;</span>).IntegerValue
					<span style="color:#0000FF;font-weight: bold">dim</span> rPhysicalRAM    <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Int64</span> = r.Field(<span style="color:#6500FE">&quot;PhysicalRAM&quot;</span>).Int64Value
					
					<span style="color:#0000FF;font-weight: bold">dim</span> MatchCount <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>
					<span style="color:#0000FF;font-weight: bold">if</span> rMacAddress = MacAddress <span style="color:#0000FF;font-weight: bold">then</span>
						MatchCount = MatchCount + <span style="color:#326598">1</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">if</span> rMacModel = MacModel <span style="color:#0000FF;font-weight: bold">then</span>
						MatchCount = MatchCount + <span style="color:#326598">1</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">if</span> rHardDiscSerial = HardDiscSerial <span style="color:#0000FF;font-weight: bold">then</span>
						MatchCount = MatchCount + <span style="color:#326598">1</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">if</span> rMacUUID = MacUUID <span style="color:#0000FF;font-weight: bold">then</span>
						MatchCount = MatchCount + <span style="color:#326598">1</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">if</span> rWinProductKey = WinProductKey <span style="color:#0000FF;font-weight: bold">then</span>
						MatchCount = MatchCount + <span style="color:#326598">1</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">if</span> rComputerName = ComputerName <span style="color:#0000FF;font-weight: bold">then</span>
						MatchCount = MatchCount + <span style="color:#326598">1</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">if</span> rCPUBrandString = CPUBrandString <span style="color:#0000FF;font-weight: bold">then</span>
						MatchCount = MatchCount + <span style="color:#326598">1</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">if</span> rPlatform = Platform <span style="color:#0000FF;font-weight: bold">then</span>
						MatchCount = MatchCount + <span style="color:#326598">1</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">if</span> rProcessorCount = ProcessorCount <span style="color:#0000FF;font-weight: bold">then</span>
						MatchCount = MatchCount + <span style="color:#326598">1</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">if</span> rPhysicalRAM = PhysicalRAM <span style="color:#0000FF;font-weight: bold">then</span>
						MatchCount = MatchCount + <span style="color:#326598">1</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					
					<span style="color:#0000FF;font-weight: bold">if</span> MatchCount = <span style="color:#326598">10</span> <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">matched,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">it&#39;s</span> <span style="color:#7F0000;text-style:italic">okay.</span>
						<span style="color:#0000FF;font-weight: bold">return</span> CheckMachineResult.Accepted
					<span style="color:#0000FF;font-weight: bold">elseif</span> MatchCount = <span style="color:#326598">9</span> <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">one</span> <span style="color:#7F0000;text-style:italic">changed,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">lets</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">database,</span> <span style="color:#7F0000;text-style:italic">unless</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">find</span> <span style="color:#7F0000;text-style:italic">perfect</span> <span style="color:#7F0000;text-style:italic">match</span>
						add = <span style="color:#0000FF;font-weight: bold">true</span>
						result = CheckMachineResult.Accepted
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					
					
					
					r.MoveNext
				<span style="color:#0000FF;font-weight: bold">wend</span>
				
				
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			
			
			
			<span style="color:#0000FF;font-weight: bold">if</span> add <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">add</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">configuration</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> d <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> DatabaseRecord
				d.Column(<span style="color:#6500FE">&quot;MacAddress&quot;</span>) = MacAddress
				d.Column(<span style="color:#6500FE">&quot;MacModel&quot;</span>) = MacModel
				d.Column(<span style="color:#6500FE">&quot;HardDiscSerial&quot;</span>) = HardDiscSerial
				d.Column(<span style="color:#6500FE">&quot;MacUUID&quot;</span>) = MacUUID
				d.Column(<span style="color:#6500FE">&quot;WinProductKey&quot;</span>) = WinProductKey
				d.Column(<span style="color:#6500FE">&quot;CPUBrandString&quot;</span>) = CPUBrandString
				d.Column(<span style="color:#6500FE">&quot;ComputerName&quot;</span>) = ComputerName
				d.Column(<span style="color:#6500FE">&quot;MacUUID&quot;</span>) = MacUUID
				d.IntegerColumn(<span style="color:#6500FE">&quot;ProcessorCount&quot;</span>) = ProcessorCount
				d.Int64Column(<span style="color:#6500FE">&quot;PhysicalRAM&quot;</span>) = PhysicalRAM
				d.Column(<span style="color:#6500FE">&quot;Platform&quot;</span>) = Platform
				
				db.InsertRecord(<span style="color:#6500FE">&quot;Machines&quot;</span>, d)
				
				<span style="color:#0000FF;font-weight: bold">if</span> db.Error <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> e <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = db.ErrorMessage
					break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">debugger</span>
					MsgBox e
					<span style="color:#0000FF;font-weight: bold">return</span> CheckMachineResult.Error
					
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			
			
			<span style="color:#0000FF;font-weight: bold">return</span> result
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Protected</span> <span style="color:#0000FF;font-weight: bold">Function</span> GetPlatform() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">string</span>
			<span style="color:#0000FF">#if</span> TargetWindows <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Windows&quot;</span>
			<span style="color:#0000FF">#elseif</span> TargetMacOS <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;MacOS&quot;</span>
			<span style="color:#0000FF">#elseif</span> TargetIOS <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;iOS&quot;</span>
			<span style="color:#0000FF">#elseif</span> TargetLinux <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#6500FE">&quot;Linux&quot;</span>
			<span style="color:#0000FF">#else</span>
				?
			<span style="color:#0000FF">#endif</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Init()
			dic = <span style="color:#0000FF;font-weight: bold">new</span> Dictionary
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">define</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">PrefFilename</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">name</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">preferences</span> <span style="color:#7F0000;text-style:italic">file</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> file <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = SpecialFolder.Preferences.Child(PrefFileName)
			
			<span style="color:#0000FF">#if</span> RBVersion &lt; <span style="color:#326598">2013</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">Real</span> <span style="color:#7F0000;text-style:italic">Studio</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> d <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> REALSQLDatabase
			<span style="color:#0000FF">#else</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">Xojo</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> d <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> SQLiteDatabase
			<span style="color:#0000FF">#endif</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> PrefPassword.len &gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">put</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">PrefPassword</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">password</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">pref</span> <span style="color:#7F0000;text-style:italic">file</span>
				d.EncryptionKey = PrefPassword
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			d.DatabaseFile = file
			
			<span style="color:#0000FF;font-weight: bold">if</span> file.Exists <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">if</span> d.Connect <span style="color:#0000FF;font-weight: bold">then</span>
					Pref.db = d
					ReadTable
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> e <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = D.ErrorMessage
					break
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#0000FF;font-weight: bold">if</span> d.CreateDatabaseFile <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">table</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">preferences</span>
					d.SQLExecute <span style="color:#6500FE">&quot;CREATE</span> <span style="color:#6500FE">TABLE</span> <span style="color:#6500FE">Pref</span> <span style="color:#6500FE">(Key</span> <span style="color:#6500FE">VARCHAR</span> <span style="color:#6500FE">UNIQUE,</span> <span style="color:#6500FE">Value</span> <span style="color:#6500FE">VARCHAR)&quot;</span>
					<span style="color:#0000FF;font-weight: bold">if</span> d.Error <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#0000FF;font-weight: bold">dim</span> e <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = D.ErrorMessage
						Break
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					
					d.SQLExecute <span style="color:#6500FE">&quot;CREATE</span> <span style="color:#6500FE">TABLE</span> <span style="color:#6500FE">Machines</span> <span style="color:#6500FE">(ID</span> <span style="color:#6500FE">INTEGER</span> <span style="color:#6500FE">NOT</span> <span style="color:#6500FE">NULL</span> <span style="color:#6500FE">PRIMARY</span> <span style="color:#6500FE">KEY</span> <span style="color:#6500FE">AUTOINCREMENT</span> <span style="color:#6500FE">UNIQUE,</span> <span style="color:#6500FE">&quot;</span>+_
							<span style="color:#6500FE">&quot;MACAddress</span> <span style="color:#6500FE">VARCHAR,</span> <span style="color:#6500FE">MacModel</span> <span style="color:#6500FE">VARCHAR,</span> <span style="color:#6500FE">HardDiscSerial</span> <span style="color:#6500FE">VARCHAR,</span> <span style="color:#6500FE">MacUUID</span> <span style="color:#6500FE">VARCHAR,</span> <span style="color:#6500FE">&quot;</span>+_
							<span style="color:#6500FE">&quot;WinProductKey</span> <span style="color:#6500FE">VARCHAR,</span> <span style="color:#6500FE">ComputerName</span> <span style="color:#6500FE">VARCHAR,</span> <span style="color:#6500FE">CPUBrandString</span> <span style="color:#6500FE">VARCHAR,</span> <span style="color:#6500FE">Platform</span> <span style="color:#6500FE">VARCHAR,</span> <span style="color:#6500FE">&quot;</span>+_
							<span style="color:#6500FE">&quot;PhysicalRAM</span> <span style="color:#6500FE">INTEGER,</span> <span style="color:#6500FE">ProcessorCount</span> <span style="color:#6500FE">INTEGER)&quot;</span>
					<span style="color:#0000FF;font-weight: bold">if</span> d.Error <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#0000FF;font-weight: bold">dim</span> e <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = D.ErrorMessage
						Break
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					
					d.Commit
					Pref.db = d
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> e <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = D.ErrorMessage
					break
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> ReadTable()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">values</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">cached</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">dictionary</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">memory</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">quick</span> <span style="color:#7F0000;text-style:italic">read</span> <span style="color:#7F0000;text-style:italic">access</span>
			
			
			<span style="color:#0000FF;font-weight: bold">dim</span> r <span style="color:#0000FF;font-weight: bold">as</span> RecordSet = db.SQLSelect(<span style="color:#6500FE">&quot;SELECT</span> <span style="color:#6500FE">Key,Value</span> <span style="color:#6500FE">FROM</span> <span style="color:#6500FE">Pref&quot;</span>)
			
			<span style="color:#0000FF;font-weight: bold">if</span> db.Error <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> e <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = db.ErrorMessage
				Break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">debugger</span>
				<span style="color:#0000FF">#Pragma</span> Unused e
				<span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">while</span> <span style="color:#0000FF;font-weight: bold">not</span> r.EOF
				<span style="color:#0000FF;font-weight: bold">dim</span> Key <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = r.IdxField(<span style="color:#326598">1</span>).StringValue
				<span style="color:#0000FF;font-weight: bold">dim</span> Value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = r.IdxField(<span style="color:#326598">2</span>).StringValue
				
				dic.Value(key) = value
				
				r.MoveNext
			<span style="color:#0000FF;font-weight: bold">wend</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Protected</span> <span style="color:#0000FF;font-weight: bold">Sub</span> ResetMachineID()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">computer,</span> <span style="color:#7F0000;text-style:italic">ask</span> <span style="color:#7F0000;text-style:italic">customer</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">license</span> <span style="color:#7F0000;text-style:italic">key</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">activation</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">than</span> <span style="color:#7F0000;text-style:italic">reset</span> <span style="color:#7F0000;text-style:italic">table</span> <span style="color:#7F0000;text-style:italic">here</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">call</span> <span style="color:#7F0000;text-style:italic">CheckMachineID</span> <span style="color:#7F0000;text-style:italic">again</span>
			
			db.SQLExecute <span style="color:#6500FE">&quot;DELETE</span> <span style="color:#6500FE">FROM</span> <span style="color:#6500FE">Machines&quot;</span>
			
			
			<span style="color:#0000FF;font-weight: bold">if</span> db.Error <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> e <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = db.ErrorMessage
				break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">debugger</span>
				MsgBox e
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> Value(key <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>) <span style="color:#0000FF;font-weight: bold">As</span> Variant
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">query</span> <span style="color:#7F0000;text-style:italic">values</span> <span style="color:#7F0000;text-style:italic">here</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> dic.Lookup(key, <span style="color:#0000FF;font-weight: bold">nil</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Value(key <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> value <span style="color:#0000FF;font-weight: bold">as</span> variant)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">value</span> <span style="color:#7F0000;text-style:italic">here</span>
			
			
			<span style="color:#0000FF;font-weight: bold">dim</span> sql <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = <span style="color:#6500FE">&quot;INSERT</span> <span style="color:#6500FE">OR</span> <span style="color:#6500FE">REPLACE</span> <span style="color:#6500FE">INTO</span> <span style="color:#6500FE">Pref</span> <span style="color:#6500FE">(Key,</span> <span style="color:#6500FE">Value)</span> <span style="color:#6500FE">VALUES</span> <span style="color:#6500FE">(?,?)&quot;</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> p <span style="color:#0000FF;font-weight: bold">as</span> PreparedSQLStatement = db.Prepare(sql)
			
			p.BindType(<span style="color:#326598">0</span>, SQLitePreparedStatement.SQLITE_TEXT)
			p.BindType(<span style="color:#326598">1</span>, SQLitePreparedStatement.SQLITE_TEXT)
			
			p.Bind(<span style="color:#326598">0</span>, key)
			p.Bind(<span style="color:#326598">1</span>, value)
			
			p.SQLExecute
			
			<span style="color:#0000FF;font-weight: bold">if</span> db.Error <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> e <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = db.ErrorMessage
				Break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">debugger</span>
				<span style="color:#0000FF">#Pragma</span> Unused e
				<span style="color:#0000FF;font-weight: bold">Return</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			
			
			dic.Value(key) = value
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;About&quot;</span>
<div class="RB_Comment">			Machine ID v1.0
			
			This example is to show you how to make preferences based on a SQLite database.
			And to show how to do machine id for licsensing.
			
			We check 10 values for a machine.
			We do allow one to change between runs without doing license key or activation again.
			e.g. if user upgrades RAM or switches hard disk, we will still recognize the configuration
			
			
			You may want to fine tune this to your needs.
			
			
			¬© 2018 by Christian Schmitz</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Protected</span> db <span style="color:#0000FF;font-weight: bold">As</span> SQLiteDatabase</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> dic <span style="color:#0000FF;font-weight: bold">As</span> Dictionary</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Module</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MainWindow <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control List <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance List <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			Update
			
			<span style="color:#0000FF;font-weight: bold">self</span>.title = str(pref.value(<span style="color:#6500FE">&quot;LaunchCounter&quot;</span>))+<span style="color:#6500FE">&quot;nth</span> <span style="color:#6500FE">launch.&quot;</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> Update()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">show</span> <span style="color:#7F0000;text-style:italic">entries</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">table</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> db <span style="color:#0000FF;font-weight: bold">as</span> SQLiteDatabase
			<span style="color:#0000FF;font-weight: bold">dim</span> r <span style="color:#0000FF;font-weight: bold">as</span> RecordSet = pref.db.sqlSelect(<span style="color:#6500FE">&quot;SELECT</span> <span style="color:#6500FE">*</span> <span style="color:#6500FE">FROM</span> <span style="color:#6500FE">Machines&quot;</span>)
			
			<span style="color:#0000FF;font-weight: bold">if</span> pref.db.Error <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> e <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = pref.db.ErrorMessage
				break
				MsgBox e
				<span style="color:#0000FF;font-weight: bold">return</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			
			<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = r.FieldCount
			list.ColumnCount = c
			<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">to</span> c
				List.Heading(i-<span style="color:#326598">1</span>) = r.IdxField(i).name
			<span style="color:#0000FF;font-weight: bold">next</span>
			
			
			<span style="color:#0000FF;font-weight: bold">while</span> <span style="color:#0000FF;font-weight: bold">not</span> r.EOF
				
				List.AddRow <span style="color:#6500FE">&quot;&quot;</span>
				
				<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">to</span> c
					List.cell(list.LastIndex, i-<span style="color:#326598">1</span>) = r.IdxField(i).StringValue
				<span style="color:#0000FF;font-weight: bold">next</span>
				
				r.MoveNext
			<span style="color:#0000FF;font-weight: bold">wend</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsutilplugin.html">MBS Util Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-util-machineid">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

