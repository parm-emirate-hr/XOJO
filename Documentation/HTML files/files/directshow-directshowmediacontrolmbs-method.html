<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - DirectShowMediaControlMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="DirectShowMediaControlMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">DirectShowMediaControlMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-directshowmediacontrolmbs.html">DirectShowMediaControlMBS</a> class.  </p>
<div class="W">
<b><a href="class-directshowmediacontrolmbs.html">DirectShowMediaControlMBS</a>.<A name="1">Constructor</A></b> &nbsp; <b style="color: #8B0000"> Private </b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-directshow.html" translate="no">DirectShow</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion121.shtml" class=version>12.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
The private constructor.<BR>
</div>
<div class="W">
<b><a href="class-directshowmediacontrolmbs.html">DirectShowMediaControlMBS</a>.<A name="2">GetState(msTimeout as Integer = -1) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-directshow.html" translate="no">DirectShow</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion121.shtml" class=version>12.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Retrieves the state of the filter graph&mdash;paused, running, or stopped.<BR>
<B>Notes:</B> 
<BR>
msTimeout: Duration of the time-out, in milliseconds, or INFINITE (-1) to specify an infinite time-out.<BR>
<BR>
State transitions are not necessarily synchronous. Therefore, when you call this method, the filter graph might be in transition to a new state. In that case, the method blocks until the transition completes or until the specified time-out elapses.<BR>
<BR>
Lasterror is set.<BR>
<BR>
Applications can use this method to determine whether playback has started after a call to Run. Generally, applications should have their own mechanism for tracking which state they have put the filter graph into. Applications typically use the current state to determine which user interface controls are enabled or disabled. For example, once the graph goes into the running state, the application might disable a &quot;Play&quot; button and enable &quot;Stop&quot; and &quot;Pause&quot; buttons.<BR>
If the filter graph is in a transition to a new state, the returned state is the new state, not the previous state.<BR>
This method returns an error if there is a call on another thread to change the state while this method is blocked.<BR>
Avoid specifying a time-out of INFINITE, because threads cannot process messages while waiting in GetState. If you call GetState from the thread that processes Windows messages, specify small wait times on the call in order to remain responsive to user input. This is especially important when the source is streaming over a network or from the Internet because state transitions in these environments can take significantly more time to complete.<BR>
</div>
<div class="W">
<b><a href="class-directshowmediacontrolmbs.html">DirectShowMediaControlMBS</a>.<A name="3">Pause</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-directshow.html" translate="no">DirectShow</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion121.shtml" class=version>12.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Pauses all the filters in the filter graph.<BR>
<B>Notes:</B> 
<BR>
Lasterror is set.<BR>
<BR>
Pausing the filter graph cues the graph for immediate rendering when the graph is next run. While the graph is paused, filters process data but do not render it. Data is pushed through the graph and processed by transform filters as far as buffering permits, but renderer filters do not render the data. However, video renderers display a static poster frame of the first sample.<BR>
<BR>
If the method returns S_FALSE, call the GetState method to wait for the state transition to complete, or to check if the transition has completed. When you call Pause to display the first frame of a video file, always follow it immediately with a call to GetState to ensure that the state transition has completed. Failure to do this can result in the video rectangle being painted black.<BR>
If the method fails, it stops the graph before returning.<BR>
</div>
<div class="W">
<b><a href="class-directshowmediacontrolmbs.html">DirectShowMediaControlMBS</a>.<A name="4">RenderFile(FilePath as string)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-directshow.html" translate="no">DirectShow</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion121.shtml" class=version>12.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Builds a filter graph that renders the specified file.<BR>
<B>Notes:</B> 
<BR>
Lasterror is set.<BR>
<BR>
filePath: Specifies the name of the file to load.<BR>
</div>
<div class="W">
<b><a href="class-directshowmediacontrolmbs.html">DirectShowMediaControlMBS</a>.<A name="5">Run</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-directshow.html" translate="no">DirectShow</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion121.shtml" class=version>12.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Runs all the filters in the filter graph. <BR>
<B>Notes:</B> 
<BR>
While the graph is running, data moves through the graph and is rendered.<BR>
Lasterror is set.<BR>
<BR>
If the filter graph is stopped, this method pauses the graph before running. If the graph is already running, the method returns S_OK but has no effect.<BR>
The graph runs until the application calls the Pause or Stop method. When playback reaches the end of the stream, the graph continues to run, but the filters do not stream any more data. At that point, the application can pause or stop the graph. For information about the end-of-stream event, see Pause and EC_COMPLETE.<BR>
This method does not seek to the beginning of the stream. Therefore, if you run the graph, pause it, and then run it again, playback resumes from the paused position. If you run the graph after it has reached the end of the stream, nothing is rendered. To seek the graph, use the MediaSeeking interface.<BR>
If method returns S_FALSE, it means that the method returned before all of the filters switched to a running state. The filters will complete the transition after the method returns. Optionally, you can wait for the transition to complete by calling the GetState method with a timeout value. However, this is not required.<BR>
If the Run method returns an error code, it means that one or more filters failed to run. However, some filters might be in a running state. In a multistream graph, entire streams might be playing successfully. Typically the application would tear down the graph and report an error in this case.<BR>
</div>
<div class="W">
<b><a href="class-directshowmediacontrolmbs.html">DirectShowMediaControlMBS</a>.<A name="6">Stop</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-directshow.html" translate="no">DirectShow</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion121.shtml" class=version>12.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Stops all the filters in the graph.<BR>
<B>Notes:</B> 
<BR>
Lasterror is set.<BR>
<BR>
If the graph is running, this method pauses the graph before stopping it. While paused, video renderers can copy the current frame to display as a poster frame.<BR>
<BR>
This method does not seek to the beginning of the stream. If you call this method and then call the Run method, playback resumes from the stopped position. To seek, use the IMediaSeeking interface.<BR>
<BR>
The Filter Graph Manager pauses all the filters in the graph, and then calls the Stop method on all filters, without waiting for the pause operations to complete. Therefore, some filters might have their Stop method called before they complete their pause operation. If you develop a custom rendering filter, you might need to handle this case by pausing the filter if it receives a stop command while in a running state. However, most filters do not need to take any special action in this regard.<BR>
</div>
<div class="W">
<b><a href="class-directshowmediacontrolmbs.html">DirectShowMediaControlMBS</a>.<A name="7">StopWhenReady</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-directshow.html" translate="no">DirectShow</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion121.shtml" class=version>12.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Pauses the filter graph, allowing filters to queue data, and then stops the filter graph.<BR>
<B>Notes:</B> 
<BR>
Lasterror is set.<BR>
<BR>
This method is useful if you want to seek the filter graph while the graph is stopped. As long as the filter graph is stopped, changes in the current position do not repaint the video window with a new frame. Therefore, calling SetPositions does not update the video window. To update the window after the seek operation, call StopWhenReady. This method transitions the graph to a paused state, waits for the pause operation to complete, and then transitions the graph back to stopped. The pause operation queues data in the graph, so that the video renderer receives and displays the new frame.<BR>
<BR>
This method is asynchronous. It waits on a separate thread for the pause to complete. The calling thread does not block, which enables the application to respond to user input. When the method returns, the logical state of the graph is stopped, even before the pause operation completes. If you call the GetState method at this point, it returns State_Stopped.<BR>
<BR>
If the application issues another state-change command (such as pause, run, or seek) before the pause operation completes, the new command cancels the pending stop command. The pause operation completes, but the graph does not stop.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-directshow-playcap.html">/Win/DirectShow/PlayCap</A></li>
<li><A href="example-win-directshow-playcapwithformatsettings.html">/Win/DirectShow/PlayCap with format settings</A></li>
<li><A href="example-win-directshow-playcapwithframegrabber.html">/Win/DirectShow/PlayCap with frame grabber</A></li>
<li><A href="example-win-directshow-playcapwithframegrabberevent.html">/Win/DirectShow/PlayCap with frame grabber event</A></li>
<li><A href="example-win-directshow-selectandcapture.html">/Win/DirectShow/Select and Capture</A></li>
<li><A href="example-win-directshow-selectandcapturewithaudio.html">/Win/DirectShow/Select and Capture with Audio</A></li>
</ul>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbswinplugin.html">MBS Win Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=directshow-directshowmediacontrolmbs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

