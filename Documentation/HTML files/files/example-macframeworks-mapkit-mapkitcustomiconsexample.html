<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /MacFrameworks/MapKit/MapKit Custom Icons example</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /MacFrameworks/MapKit/MapKit Custom Icons example</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/MacFrameworks/MapKit/MapKit Custom Icons example</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS MacBase Plugin, MBS MacFrameworks Plugin, MBS MacCG Plugin, MBS MacCF Plugin, MBS Main Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /MacFrameworks/MapKit/MapKit Custom Icons example<BR>
This example is the version from Wed, 10th Nov 2020.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;MapKit</span> <span style="color:#6500FE">Custom</span> <span style="color:#6500FE">Icons</span> <span style="color:#6500FE">example.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kEditClear = <span style="color:#6500FE">&quot;&amp;L&ouml;schen&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuit = <span style="color:#6500FE">&quot;Beenden&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuitShortcut = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#0000FF">#if</span> TargetMachO <span style="color:#0000FF;font-weight: bold">and</span> Target64Bit <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">okay</span>
			<span style="color:#0000FF">#else</span>
				MsgBox <span style="color:#6500FE">&quot;Please</span> <span style="color:#6500FE">run</span> <span style="color:#6500FE">on</span> <span style="color:#6500FE">macOS</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">64-bit.&quot;</span>
			<span style="color:#0000FF">#endif</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;Acknowledgements&quot;</span>
<div class="RB_Comment">			https://icons8.com/icons/set/traffic-jam
			Traffic Jam icon by icons8.com</div>
</div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;Plugins</span> <span style="color:#6500FE">needed&quot;</span>
<div class="RB_Comment">			MacFrameworks Main MacCocoa MacBase MacControls</div>
</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MainWindow <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Map <span style="color:#0000FF;font-weight: bold">Inherits</span> MapKitViewControlMBS</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Map <span style="color:#0000FF;font-weight: bold">Inherits</span> MapKitViewControlMBS</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> ClusterAnnotationForMemberAnnotations(mapView <span style="color:#0000FF;font-weight: bold">as</span> MKMapViewMBS, memberAnnotations() <span style="color:#0000FF;font-weight: bold">as</span> MKAnnotationMBS) <span style="color:#0000FF;font-weight: bold">As</span> MKClusterAnnotationMBS
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">annotations</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">fused</span> <span style="color:#7F0000;text-style:italic">(the</span> <span style="color:#7F0000;text-style:italic">memberAnnotations)</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">passed</span> <span style="color:#7F0000;text-style:italic">into</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">event</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">creates</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">returns</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">clusterAnnotation</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">store</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">title</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">information</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">what</span> <span style="color:#7F0000;text-style:italic">type</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">annotations</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">cluster</span> <span style="color:#7F0000;text-style:italic">contains</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> clusterAnnotation <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MKClusterAnnotationMBS( memberAnnotations )
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> number <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = memberAnnotations.Ubound + <span style="color:#326598">1</span>
				
				<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> popIconTypeSelection.Text
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Cluster</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">both</span> <span style="color:#6500FE">Drivers</span> <span style="color:#6500FE">and</span> <span style="color:#6500FE">Cars&quot;</span>
					
					<span style="color:#0000FF;font-weight: bold">Dim</span> NumberOfDriversInCluster <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span>
					<span style="color:#0000FF;font-weight: bold">Dim</span> NumberOfCarsInCluster <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span>
					
					<span style="color:#0000FF;font-weight: bold">For</span> <span style="color:#0000FF;font-weight: bold">Each</span> Annotation <span style="color:#0000FF;font-weight: bold">As</span> MKAnnotationMBS <span style="color:#0000FF;font-weight: bold">In</span> memberAnnotations
						<span style="color:#0000FF;font-weight: bold">If</span> Annotation <span style="color:#0000FF;font-weight: bold">IsA</span> DriverAnnotation <span style="color:#0000FF;font-weight: bold">Then</span> NumberOfDriversInCluster = NumberOfDriversInCluster + <span style="color:#326598">1</span>
						<span style="color:#0000FF;font-weight: bold">If</span> Annotation <span style="color:#0000FF;font-weight: bold">IsA</span> CarAnnotation <span style="color:#0000FF;font-weight: bold">Then</span> NumberOfCarsInCluster = NumberOfCarsInCluster + <span style="color:#326598">1</span>
					<span style="color:#0000FF;font-weight: bold">Next</span>
					
					clusterAnnotation.Title = <span style="color:#6500FE">&quot;Drivers</span> <span style="color:#6500FE">&amp;</span> <span style="color:#6500FE">Cars&quot;</span>
					clusterAnnotation.SubTitle = <span style="color:#6500FE">&quot;#</span> <span style="color:#6500FE">of</span> <span style="color:#6500FE">Drivers:</span> <span style="color:#6500FE">&quot;</span> + Str(NumberOfDriversInCluster) + EndOfLine + <span style="color:#6500FE">&quot;#</span> <span style="color:#6500FE">of</span> <span style="color:#6500FE">Cars:</span> <span style="color:#6500FE">&quot;</span> + Str(NumberOfCarsInCluster)
					
					
				<span style="color:#0000FF;font-weight: bold">Else</span>
					
					<span style="color:#0000FF;font-weight: bold">Dim</span> Annotation <span style="color:#0000FF;font-weight: bold">As</span> MKAnnotationMBS = memberAnnotations(<span style="color:#326598">0</span>)
					
					<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#0000FF;font-weight: bold">True</span>
						
					<span style="color:#0000FF;font-weight: bold">Case</span> Annotation <span style="color:#0000FF;font-weight: bold">IsA</span> DriverAnnotation
						
						clusterAnnotation.Title = <span style="color:#6500FE">&quot;Drivers&quot;</span>
						clusterAnnotation.SubTitle = <span style="color:#6500FE">&quot;#</span> <span style="color:#6500FE">of</span> <span style="color:#6500FE">Drivers:</span> <span style="color:#6500FE">&quot;</span> + Str(number)
						
					<span style="color:#0000FF;font-weight: bold">Case</span> Annotation <span style="color:#0000FF;font-weight: bold">IsA</span> CarAnnotation
						
						clusterAnnotation.Title = <span style="color:#6500FE">&quot;Cars&quot;</span>
						clusterAnnotation.SubTitle = <span style="color:#6500FE">&quot;#</span> <span style="color:#6500FE">of</span> <span style="color:#6500FE">Cars:</span> <span style="color:#6500FE">&quot;</span> + Str(number)
						
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
				
				
				<span style="color:#0000FF;font-weight: bold">Return</span> clusterAnnotation
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				mapview = <span style="color:#0000FF;font-weight: bold">Me</span>.View
				
				mapview.showsScale = <span style="color:#0000FF;font-weight: bold">True</span>
				mapview.showsZoomControls = <span style="color:#0000FF;font-weight: bold">True</span>
				mapview.ShowsCompass = <span style="color:#0000FF;font-weight: bold">True</span>
				
				mapview.showsUserLocation = <span style="color:#0000FF;font-weight: bold">True</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">NSImageMBS</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Driver</span> <span style="color:#7F0000;text-style:italic">icon</span>
				DriverIcon = <span style="color:#0000FF;font-weight: bold">New</span> NSImageMBS( SwallowIconPNG )
				DriverIcon.setSize <span style="color:#326598">32</span>, <span style="color:#326598">32</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">NSImageMBS</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Driver</span> <span style="color:#7F0000;text-style:italic">cluster</span> <span style="color:#7F0000;text-style:italic">icon</span>
				DriverClusterIcon = <span style="color:#0000FF;font-weight: bold">New</span> NSImageMBS( SwallowClusterIconPNG )
				DriverClusterIcon.setSize <span style="color:#326598">48</span>, <span style="color:#326598">48</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">NSImageMBS</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">car</span> <span style="color:#7F0000;text-style:italic">icon</span>
				CarIcon = <span style="color:#0000FF;font-weight: bold">New</span> NSImageMBS( CarPNG )
				DriverIcon.setSize <span style="color:#326598">32</span>, <span style="color:#326598">32</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">NSImageMBS</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Car</span> <span style="color:#7F0000;text-style:italic">cluster</span> <span style="color:#7F0000;text-style:italic">icon</span>
				CarClusterIcon = <span style="color:#0000FF;font-weight: bold">New</span> NSImageMBS( CarsPNG )
				CarClusterIcon.setSize <span style="color:#326598">48</span>, <span style="color:#326598">48</span>
				
				AddSampleAnnotations
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">region</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">map</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">show</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">startup</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> coordinates <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> CLLocationCoordinate2DMBS(-<span style="color:#006532">36.91849</span>, <span style="color:#006532">174.6986</span>)
				<span style="color:#0000FF;font-weight: bold">Dim</span> span <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MKCoordinateSpanMBS( <span style="color:#006532">0.1</span>, <span style="color:#006532">0.1</span> )
				<span style="color:#0000FF;font-weight: bold">Dim</span> region <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MKCoordinateRegionMBS( coordinates, span )
				mapview.region = region
				mapview.zoomLevel = <span style="color:#326598">15</span>
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> viewForAnnotation(mapView <span style="color:#0000FF;font-weight: bold">as</span> MKMapViewMBS, annotation <span style="color:#0000FF;font-weight: bold">as</span> MKAnnotationMBS) <span style="color:#0000FF;font-weight: bold">As</span> MKAnnotationViewMBS
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">prevent</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">race</span> <span style="color:#7F0000;text-style:italic">condition</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">IconType</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">changes</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">stop</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">while</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">map</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">being</span> <span style="color:#7F0000;text-style:italic">updated</span>
				
				<span style="color:#0000FF;font-weight: bold">If</span> mapIsUpdating <span style="color:#0000FF;font-weight: bold">Then</span>
					<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">Nil</span>
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">otherwise</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">following</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">callout</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">shown</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">you</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">change</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">IconType</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">FROM</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">TO</span> <span style="color:#7F0000;text-style:italic">&quot;Cluster</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">both</span> <span style="color:#7F0000;text-style:italic">Drivers</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">Cars&quot;:</span>
				<span style="color:#7F0000;text-style:italic">//</span>
				<span style="color:#7F0000;text-style:italic">//</span>   <span style="color:#7F0000;text-style:italic">A</span> <span style="color:#7F0000;text-style:italic">Cocoa</span> <span style="color:#7F0000;text-style:italic">NSInternalInconsistencyException</span> <span style="color:#7F0000;text-style:italic">was</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">handled:</span>
				<span style="color:#7F0000;text-style:italic">//</span>     <span style="color:#7F0000;text-style:italic">MKAnnotationView</span> <span style="color:#7F0000;text-style:italic">instances</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">cluster</span> <span style="color:#7F0000;text-style:italic">annotations</span> <span style="color:#7F0000;text-style:italic">cannot</span> <span style="color:#7F0000;text-style:italic">use</span>
				<span style="color:#7F0000;text-style:italic">//</span>     <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">different</span> <span style="color:#7F0000;text-style:italic">clusteringIdentifier</span> <span style="color:#7F0000;text-style:italic">than</span> <span style="color:#7F0000;text-style:italic">its</span> <span style="color:#7F0000;text-style:italic">annotation.</span>
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">let</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">OS</span> <span style="color:#7F0000;text-style:italic">handle</span> <span style="color:#7F0000;text-style:italic">user</span> <span style="color:#7F0000;text-style:italic">locations</span> <span style="color:#7F0000;text-style:italic">itself</span>
				
				<span style="color:#0000FF;font-weight: bold">If</span> annotation <span style="color:#0000FF;font-weight: bold">IsA</span> MKUserLocationMBS <span style="color:#0000FF;font-weight: bold">Then</span>
					<span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#0000FF;font-weight: bold">Nil</span>
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">IMPORTANT:</span> <span style="color:#7F0000;text-style:italic">THERE</span> <span style="color:#7F0000;text-style:italic">ARE</span> <span style="color:#7F0000;text-style:italic">ONLY</span> <span style="color:#7F0000;text-style:italic">THREE</span> <span style="color:#7F0000;text-style:italic">TYPES</span> <span style="color:#7F0000;text-style:italic">OF</span> <span style="color:#7F0000;text-style:italic">CUSTOM</span> <span style="color:#7F0000;text-style:italic">ANNOTATIONS</span> <span style="color:#7F0000;text-style:italic">ON</span> <span style="color:#7F0000;text-style:italic">THE</span> <span style="color:#7F0000;text-style:italic">MAP</span>
				<span style="color:#7F0000;text-style:italic">//</span>            <span style="color:#7F0000;text-style:italic">(FOUR</span> <span style="color:#7F0000;text-style:italic">IF</span> <span style="color:#7F0000;text-style:italic">YOU</span> <span style="color:#7F0000;text-style:italic">ALLOW</span> <span style="color:#7F0000;text-style:italic">THE</span> <span style="color:#7F0000;text-style:italic">USER</span> <span style="color:#7F0000;text-style:italic">LOCATION</span> <span style="color:#7F0000;text-style:italic">TO</span> <span style="color:#7F0000;text-style:italic">BE</span> <span style="color:#7F0000;text-style:italic">SHOWN)</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">&bull;</span> <span style="color:#7F0000;text-style:italic">DriverAnnotation</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">&bull;</span> <span style="color:#7F0000;text-style:italic">CarAnnotation</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">&bull;</span> <span style="color:#7F0000;text-style:italic">ClusterAnnotation</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">ONLY</span> <span style="color:#7F0000;text-style:italic">their</span> <span style="color:#7F0000;text-style:italic">views</span> <span style="color:#7F0000;text-style:italic">differ</span> <span style="color:#7F0000;text-style:italic">depending</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">selection,</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">annotations</span> <span style="color:#7F0000;text-style:italic">do</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">change</span>
				
				
				<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> popIconTypeSelection.Text
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Red</span> <span style="color:#6500FE">Pins&quot;</span>
					<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForPin( annotation, <span style="color:#6500FE">&quot;Red</span> <span style="color:#6500FE">Pin&quot;</span>, <span style="color:#6500FE">&quot;Red</span> <span style="color:#6500FE">Pin&quot;</span>, <span style="color:#6500FE">&quot;red&quot;</span>, <span style="color:#326598">1000</span> )
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Green</span> <span style="color:#6500FE">Pins&quot;</span>
					<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForPin( annotation, <span style="color:#6500FE">&quot;Green</span> <span style="color:#6500FE">Pin&quot;</span>, <span style="color:#6500FE">&quot;Green</span> <span style="color:#6500FE">Pin&quot;</span>, <span style="color:#6500FE">&quot;green&quot;</span>, <span style="color:#326598">1000</span> )
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Purple</span> <span style="color:#6500FE">Pins&quot;</span>
					<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForPin( annotation, <span style="color:#6500FE">&quot;Purple</span> <span style="color:#6500FE">Pin&quot;</span>, <span style="color:#6500FE">&quot;Purple</span> <span style="color:#6500FE">Pin&quot;</span>, <span style="color:#6500FE">&quot;purple&quot;</span>, <span style="color:#326598">1000</span> )
					
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Custom</span> <span style="color:#6500FE">Icon&quot;</span>  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">each</span> <span style="color:#7F0000;text-style:italic">type</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">different</span> <span style="color:#7F0000;text-style:italic">icon</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">type</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">annotation</span> <span style="color:#7F0000;text-style:italic">becomes</span> <span style="color:#7F0000;text-style:italic">important</span>
					
					<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#0000FF;font-weight: bold">True</span>
						
					<span style="color:#0000FF;font-weight: bold">Case</span> annotation <span style="color:#0000FF;font-weight: bold">IsA</span> DriverAnnotation
						<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForCustomAnnotation( annotation, <span style="color:#6500FE">&quot;Driver&quot;</span>, <span style="color:#6500FE">&quot;Driver&quot;</span>, DriverIcon, <span style="color:#326598">1000</span> )
						
					<span style="color:#0000FF;font-weight: bold">Case</span> annotation <span style="color:#0000FF;font-weight: bold">IsA</span> CarAnnotation
						<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForCustomAnnotation( annotation, <span style="color:#6500FE">&quot;Car&quot;</span>, <span style="color:#6500FE">&quot;Car&quot;</span>, CarIcon, <span style="color:#326598">1000</span> )
						
					<span style="color:#0000FF;font-weight: bold">Case</span> annotation <span style="color:#0000FF;font-weight: bold">IsA</span> MKClusterAnnotationMBS  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">confer</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">type</span> <span style="color:#7F0000;text-style:italic">information</span> <span style="color:#7F0000;text-style:italic">via</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">title</span>
						
						<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> annotation.title
							
						<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Drivers&quot;</span>
							<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForCustomAnnotation( annotation, <span style="color:#6500FE">&quot;Drivers&quot;</span>, <span style="color:#6500FE">&quot;Driver&quot;</span>, DriverClusterIcon, <span style="color:#326598">1000</span> )
							
						<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Cars&quot;</span>
							<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForCustomAnnotation( annotation, <span style="color:#6500FE">&quot;Cars&quot;</span>, <span style="color:#6500FE">&quot;Car&quot;</span>, CarClusterIcon, <span style="color:#326598">1000</span> )
							
						<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
						
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
					
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Custom</span> <span style="color:#6500FE">Icon</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">Number&quot;</span>
					
					<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#0000FF;font-weight: bold">True</span>
						
					<span style="color:#0000FF;font-weight: bold">Case</span> annotation <span style="color:#0000FF;font-weight: bold">IsA</span> DriverAnnotation
						<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForCustomAnnotation( annotation, <span style="color:#6500FE">&quot;Driver&quot;</span>, <span style="color:#6500FE">&quot;Driver&quot;</span>, DriverIcon, <span style="color:#326598">1000</span> )
						
					<span style="color:#0000FF;font-weight: bold">Case</span> annotation <span style="color:#0000FF;font-weight: bold">IsA</span> CarAnnotation
						<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForCustomAnnotation( annotation, <span style="color:#6500FE">&quot;Car&quot;</span>, <span style="color:#6500FE">&quot;Car&quot;</span>, CarIcon, <span style="color:#326598">1000</span> )
						
					<span style="color:#0000FF;font-weight: bold">Case</span> annotation <span style="color:#0000FF;font-weight: bold">IsA</span> MKClusterAnnotationMBS
						
						<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> annotation.title
							
						<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Drivers&quot;</span>
							<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForCustomAnnotation( annotation, <span style="color:#6500FE">&quot;Drivers</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">Numbers&quot;</span>, <span style="color:#6500FE">&quot;Driver&quot;</span>, DriverClusterIcon, <span style="color:#326598">1000</span> )
							
						<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Cars&quot;</span>
							<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForCustomAnnotation( annotation, <span style="color:#6500FE">&quot;Cars</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">Numbers&quot;</span>, <span style="color:#6500FE">&quot;Car&quot;</span>, CarClusterIcon, <span style="color:#326598">1000</span> )
							
						<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
						
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
					
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Cluster</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">both</span> <span style="color:#6500FE">Drivers</span> <span style="color:#6500FE">and</span> <span style="color:#6500FE">Cars&quot;</span>
					
					<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#0000FF;font-weight: bold">True</span>
						
					<span style="color:#0000FF;font-weight: bold">Case</span> annotation <span style="color:#0000FF;font-weight: bold">IsA</span> DriverAnnotation
						<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForCustomAnnotation( annotation, <span style="color:#6500FE">&quot;Driver&quot;</span>, <span style="color:#6500FE">&quot;Cluster</span> <span style="color:#6500FE">all&quot;</span>, DriverIcon, <span style="color:#326598">1000</span> )
						
					<span style="color:#0000FF;font-weight: bold">Case</span> annotation <span style="color:#0000FF;font-weight: bold">IsA</span> CarAnnotation
						<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForCustomAnnotation( annotation, <span style="color:#6500FE">&quot;Car&quot;</span>, <span style="color:#6500FE">&quot;Cluster</span> <span style="color:#6500FE">all&quot;</span>, CarIcon, <span style="color:#326598">1000</span> )
						
					<span style="color:#0000FF;font-weight: bold">Case</span> annotation <span style="color:#0000FF;font-weight: bold">IsA</span> MKClusterAnnotationMBS
						
						<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> annotation.title
							
						<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Drivers</span> <span style="color:#6500FE">&amp;</span> <span style="color:#6500FE">Cars&quot;</span>
							<span style="color:#0000FF;font-weight: bold">Return</span> GetViewForCustomAnnotation( annotation, <span style="color:#6500FE">&quot;Drivers</span> <span style="color:#6500FE">and</span> <span style="color:#6500FE">Cars&quot;</span>, <span style="color:#6500FE">&quot;Cluster</span> <span style="color:#6500FE">all&quot;</span>, <span style="color:#0000FF;font-weight: bold">Nil</span>, <span style="color:#326598">1000</span> )
							
						<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
						
					<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
					
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
				
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">other</span> <span style="color:#7F0000;text-style:italic">annotations</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">dealt</span> <span style="color:#7F0000;text-style:italic">with?</span>
				
				<span style="color:#0000FF">#If</span> DebugBuild <span style="color:#0000FF;font-weight: bold">Then</span>
					Break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">annotation</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">found</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">check</span> <span style="color:#7F0000;text-style:italic">debugger</span> <span style="color:#7F0000;text-style:italic">what&#39;s</span> <span style="color:#7F0000;text-style:italic">going</span> <span style="color:#7F0000;text-style:italic">on!</span>
				<span style="color:#0000FF">#EndIf</span>
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control popIconTypeSelection <span style="color:#0000FF;font-weight: bold">Inherits</span> PopupMenu</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance popIconTypeSelection <span style="color:#0000FF;font-weight: bold">Inherits</span> PopupMenu</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Change()
				UpdateMap
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control popShowLocationsFor <span style="color:#0000FF;font-weight: bold">Inherits</span> PopupMenu</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance popShowLocationsFor <span style="color:#0000FF;font-weight: bold">Inherits</span> PopupMenu</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Change()
				UpdateMap
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control aLabel <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance aLabel(<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance aLabel(<span style="color:#326598">2</span>) <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Close()
			Quit
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddAnnotationFor(address <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, annotationType <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">find</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">address</span> <span style="color:#7F0000;text-style:italic">via</span> <span style="color:#7F0000;text-style:italic">geocoder</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> c <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> CLGeocoderMBS
			<span style="color:#0000FF;font-weight: bold">Dim</span> h <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> CLGeocodeCompletionHandlerMBS
			
			<span style="color:#0000FF;font-weight: bold">AddHandler</span> h.Completed, <span style="color:#0000FF;font-weight: bold">AddressOf</span> geocodeAddressStringCompleted
			
			<span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">Dim</span> <span style="color:#7F0000;text-style:italic">tag</span> <span style="color:#7F0000;text-style:italic">As</span> <span style="color:#7F0000;text-style:italic">Variant</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">annotationType</span>
			<span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">c.geocodeAddressString(address,</span> <span style="color:#7F0000;text-style:italic">h,</span> <span style="color:#7F0000;text-style:italic">tag)</span>
			
			<span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">Dim</span> <span style="color:#7F0000;text-style:italic">tag</span> <span style="color:#7F0000;text-style:italic">As</span> <span style="color:#7F0000;text-style:italic">Variant</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">annotationType</span>
			c.geocodeAddressString(address, h, annotationType)
			
			<span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">geocoders.Append</span> <span style="color:#7F0000;text-style:italic">c</span>  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">???</span> <span style="color:#7F0000;text-style:italic">Is</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">needed</span> <span style="color:#7F0000;text-style:italic">???</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddSampleAnnotations()
			AddAnnotationFor( <span style="color:#6500FE">&quot;1</span> <span style="color:#6500FE">Bolton</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Driver</span> <span style="color:#6500FE">Annotation&quot;</span> )
			AddAnnotationFor( <span style="color:#6500FE">&quot;5</span> <span style="color:#6500FE">Bolton</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Driver</span> <span style="color:#6500FE">Annotation&quot;</span> )
			AddAnnotationFor( <span style="color:#6500FE">&quot;15</span> <span style="color:#6500FE">Bolton</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Driver</span> <span style="color:#6500FE">Annotation&quot;</span> )
			AddAnnotationFor( <span style="color:#6500FE">&quot;28</span> <span style="color:#6500FE">Bolton</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Driver</span> <span style="color:#6500FE">Annotation&quot;</span> )
			
			AddAnnotationFor( <span style="color:#6500FE">&quot;2</span> <span style="color:#6500FE">Terry</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Driver</span> <span style="color:#6500FE">Annotation&quot;</span> )
			AddAnnotationFor( <span style="color:#6500FE">&quot;16</span> <span style="color:#6500FE">Terry</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Driver</span> <span style="color:#6500FE">Annotation&quot;</span> )
			AddAnnotationFor( <span style="color:#6500FE">&quot;33</span> <span style="color:#6500FE">Terry</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Driver</span> <span style="color:#6500FE">Annotation&quot;</span> )
			AddAnnotationFor( <span style="color:#6500FE">&quot;38</span> <span style="color:#6500FE">Terry</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Driver</span> <span style="color:#6500FE">Annotation&quot;</span> )
			
			
			
			AddAnnotationFor( <span style="color:#6500FE">&quot;2</span> <span style="color:#6500FE">Bolton</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Car</span> <span style="color:#6500FE">Annotation&quot;</span> )
			AddAnnotationFor( <span style="color:#6500FE">&quot;17</span> <span style="color:#6500FE">Bolton</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Car</span> <span style="color:#6500FE">Annotation&quot;</span> )
			AddAnnotationFor( <span style="color:#6500FE">&quot;22</span> <span style="color:#6500FE">Bolton</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Car</span> <span style="color:#6500FE">Annotation&quot;</span> )
			
			AddAnnotationFor( <span style="color:#6500FE">&quot;5</span> <span style="color:#6500FE">Terry</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Car</span> <span style="color:#6500FE">Annotation&quot;</span> )
			AddAnnotationFor( <span style="color:#6500FE">&quot;7</span> <span style="color:#6500FE">Terry</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Car</span> <span style="color:#6500FE">Annotation&quot;</span> )
			AddAnnotationFor( <span style="color:#6500FE">&quot;25</span> <span style="color:#6500FE">Terry</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Car</span> <span style="color:#6500FE">Annotation&quot;</span> )
			AddAnnotationFor( <span style="color:#6500FE">&quot;34</span> <span style="color:#6500FE">Terry</span> <span style="color:#6500FE">Street,</span> <span style="color:#6500FE">Blockhouse</span> <span style="color:#6500FE">Bay,</span> <span style="color:#6500FE">Auckland&quot;</span>, <span style="color:#6500FE">&quot;Car</span> <span style="color:#6500FE">Annotation&quot;</span> )
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> GetViewForCustomAnnotation(annotation <span style="color:#0000FF;font-weight: bold">as</span> MKAnnotationMBS, reuseIdentifier <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, clusteringIdentifier <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>, image <span style="color:#0000FF;font-weight: bold">as</span> NSImageMBS, displayPriority <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> MKAnnotationViewMBS
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Uses</span> <span style="color:#7F0000;text-style:italic">different</span> <span style="color:#7F0000;text-style:italic">reuse</span> <span style="color:#7F0000;text-style:italic">identifiers</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">Cluster</span> <span style="color:#7F0000;text-style:italic">views</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">without</span> <span style="color:#7F0000;text-style:italic">number</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">NOTE</span> <span style="color:#7F0000;text-style:italic">FOR</span> <span style="color:#7F0000;text-style:italic">VIEWS</span> <span style="color:#7F0000;text-style:italic">WITH</span> <span style="color:#7F0000;text-style:italic">NUMBERS:</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">views</span> <span style="color:#7F0000;text-style:italic">having</span> <span style="color:#7F0000;text-style:italic">different</span> <span style="color:#7F0000;text-style:italic">numbers</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">same</span> <span style="color:#7F0000;text-style:italic">reuse</span> <span style="color:#7F0000;text-style:italic">identifier</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">can&#39;t</span> <span style="color:#7F0000;text-style:italic">simply</span> <span style="color:#7F0000;text-style:italic">return</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">reusable</span> <span style="color:#7F0000;text-style:italic">view</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">it&#39;s</span> <span style="color:#7F0000;text-style:italic">number</span> <span style="color:#7F0000;text-style:italic">might</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">wrong</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">customise</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">reusable</span> <span style="color:#7F0000;text-style:italic">view</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">ensure</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">shows</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">correct</span> <span style="color:#7F0000;text-style:italic">number</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">So</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">CAN&#39;T</span> <span style="color:#7F0000;text-style:italic">do</span> <span style="color:#7F0000;text-style:italic">this:</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">either</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">suitable</span> <span style="color:#7F0000;text-style:italic">annotation</span> <span style="color:#7F0000;text-style:italic">view</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">returned,</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">Nil</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">test</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">Nil:</span>
			<span style="color:#7F0000;text-style:italic">//</span>    <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">Nil</span> <span style="color:#7F0000;text-style:italic">then</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">new</span> <span style="color:#7F0000;text-style:italic">view</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">customise</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">return</span>
			<span style="color:#7F0000;text-style:italic">//</span>    <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">Nil</span> <span style="color:#7F0000;text-style:italic">then</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">return</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">reuse</span> <span style="color:#7F0000;text-style:italic">view</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Dim</span> <span style="color:#7F0000;text-style:italic">view</span> <span style="color:#7F0000;text-style:italic">As</span> <span style="color:#7F0000;text-style:italic">MKAnnotationViewMBS</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">mapView.dequeueReusableAnnotationViewWithIdentifier(</span> <span style="color:#7F0000;text-style:italic">reuseIdentifier</span> <span style="color:#7F0000;text-style:italic">)</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">view</span> <span style="color:#7F0000;text-style:italic">&lt;&gt;</span> <span style="color:#7F0000;text-style:italic">Nil</span> <span style="color:#7F0000;text-style:italic">Then</span>
			<span style="color:#7F0000;text-style:italic">//</span>   <span style="color:#7F0000;text-style:italic">Return</span> <span style="color:#7F0000;text-style:italic">view</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Else</span>
			<span style="color:#7F0000;text-style:italic">//</span>   <span style="color:#7F0000;text-style:italic">view</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">New</span> <span style="color:#7F0000;text-style:italic">MKAnnotationViewMBS(</span> <span style="color:#7F0000;text-style:italic">annotation,</span> <span style="color:#7F0000;text-style:italic">reuseIdentifier</span> <span style="color:#7F0000;text-style:italic">)</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">End</span> <span style="color:#7F0000;text-style:italic">If</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">do</span> <span style="color:#7F0000;text-style:italic">this:</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">variable</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">type</span> <span style="color:#7F0000;text-style:italic">AnnotationView</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">try</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">assign</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">view</span>
			<span style="color:#7F0000;text-style:italic">//</span>   <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">same</span> <span style="color:#7F0000;text-style:italic">reuseIdentifier</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">reuse</span> <span style="color:#7F0000;text-style:italic">pool</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">views</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> view <span style="color:#0000FF;font-weight: bold">As</span> MKAnnotationViewMBS = mapView.dequeueReusableAnnotationViewWithIdentifier( reuseIdentifier )
			
			<span style="color:#0000FF;font-weight: bold">If</span> view = <span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				view = <span style="color:#0000FF;font-weight: bold">New</span> MKAnnotationViewMBS( annotation, reuseIdentifier )
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">cluster</span> <span style="color:#7F0000;text-style:italic">annotations</span> <span style="color:#7F0000;text-style:italic">should</span> <span style="color:#7F0000;text-style:italic">show</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">number</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">annotations</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">cluster</span>
			
			<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> reuseIdentifier
				
			<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Cars</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">Numbers&quot;</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">Car</span> <span style="color:#7F0000;text-style:italic">cluster</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">number</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">draw</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">subtitle</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> number <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> = Replace( annotation.subtitle, <span style="color:#6500FE">&quot;#</span> <span style="color:#6500FE">of</span> <span style="color:#6500FE">Cars:</span> <span style="color:#6500FE">&quot;</span>, <span style="color:#6500FE">&quot;&quot;</span> )
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> pic <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> Picture( image.width, image.height )
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> g <span style="color:#0000FF;font-weight: bold">As</span> Graphics = pic.Graphics
				g.DrawPicture( CarsPNG, <span style="color:#326598">0</span>, <span style="color:#326598">0</span> )
				
				g.ForeColor = &amp;c<span style="color:#FF0000">76</span><span style="color:#00FF00">D6</span><span style="color:#0000FF">FF</span>  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Color.Teal</span>
				g.Transparency = <span style="color:#326598">20</span>  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">0.0</span> <span style="color:#7F0000;text-style:italic">(opaque)</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">100.0</span> <span style="color:#7F0000;text-style:italic">(fully</span> <span style="color:#7F0000;text-style:italic">transparent)</span>
				g.FillOval( <span style="color:#326598">13</span>, <span style="color:#326598">10</span>, <span style="color:#326598">26</span>, <span style="color:#326598">26</span> )
				
				g.ForeColor = <span style="color:#0000FF;font-weight: bold">Color</span>.Blue
				g.TextSize = <span style="color:#326598">18</span>
				g.Bold = <span style="color:#0000FF;font-weight: bold">True</span>
				g.Transparency = <span style="color:#326598">0</span>  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">0.0</span> <span style="color:#7F0000;text-style:italic">(opaque)</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">100.0</span> <span style="color:#7F0000;text-style:italic">(fully</span> <span style="color:#7F0000;text-style:italic">transparent)</span>
				g.DrawString( number, <span style="color:#326598">20</span>, <span style="color:#326598">30</span> )
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> img <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> NSImageMBS( pic )
				view.image = img
				
				
			<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Drivers</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">Numbers&quot;</span>  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">Driver</span> <span style="color:#7F0000;text-style:italic">cluster</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">number</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">draw</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">subtitle</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> number <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> = Replace( annotation.subtitle, <span style="color:#6500FE">&quot;#</span> <span style="color:#6500FE">of</span> <span style="color:#6500FE">Drivers:</span> <span style="color:#6500FE">&quot;</span>, <span style="color:#6500FE">&quot;&quot;</span> )
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> pic <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> Picture( image.width, image.height )
				<span style="color:#0000FF;font-weight: bold">Dim</span> g <span style="color:#0000FF;font-weight: bold">As</span> Graphics = pic.Graphics
				g.DrawPicture( SwallowClusterIconPNG, <span style="color:#326598">0</span>, <span style="color:#326598">0</span> )
				
				g.ForeColor = <span style="color:#0000FF;font-weight: bold">Color</span>.Yellow
				g.Transparency = <span style="color:#326598">20</span>  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">0.0</span> <span style="color:#7F0000;text-style:italic">(opaque)</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">100.0</span> <span style="color:#7F0000;text-style:italic">(fully</span> <span style="color:#7F0000;text-style:italic">transparent)</span>
				g.FillOval( <span style="color:#326598">13</span>, <span style="color:#326598">10</span>, <span style="color:#326598">26</span>, <span style="color:#326598">26</span> )
				
				g.ForeColor = <span style="color:#0000FF;font-weight: bold">Color</span>.Red  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Teal</span>
				g.TextSize = <span style="color:#326598">18</span>
				g.Bold = <span style="color:#0000FF;font-weight: bold">True</span>
				g.Transparency = <span style="color:#326598">0</span>  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">0.0</span> <span style="color:#7F0000;text-style:italic">(opaque)</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">100.0</span> <span style="color:#7F0000;text-style:italic">(fully</span> <span style="color:#7F0000;text-style:italic">transparent)</span>
				g.DrawString( number, <span style="color:#326598">20</span>, <span style="color:#326598">30</span> )
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> img <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> NSImageMBS( pic )
				view.image = img
				
				
			<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Drivers</span> <span style="color:#6500FE">and</span> <span style="color:#6500FE">Cars&quot;</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> rg <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> RegEx
				<span style="color:#0000FF;font-weight: bold">Dim</span> myMatch <span style="color:#0000FF;font-weight: bold">As</span> RegExMatch
				rg.SearchPattern = <span style="color:#6500FE">&quot;#</span> <span style="color:#6500FE">of</span> <span style="color:#6500FE">Drivers:</span> <span style="color:#6500FE">(\d*)\n#</span> <span style="color:#6500FE">of</span> <span style="color:#6500FE">Cars:</span> <span style="color:#6500FE">(\d*)&quot;</span>
				myMatch = rg.Search(annotation.subtitle)
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> NumberOfDrivers <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Val( myMatch.SubExpressionString(<span style="color:#326598">1</span>) )
				<span style="color:#0000FF;font-weight: bold">Dim</span> NumberOfCars <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Val( myMatch.SubExpressionString(<span style="color:#326598">2</span>) )
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> total <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span> =  NumberOfDrivers + NumberOfCars
				<span style="color:#0000FF;font-weight: bold">Dim</span> totalAsText <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span> = Str( total )
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> percent <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Double</span> = NumberOfDrivers / total
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">picture</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> pic <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> Picture( <span style="color:#326598">96</span>, <span style="color:#326598">96</span> )
				<span style="color:#0000FF;font-weight: bold">Dim</span> g <span style="color:#0000FF;font-weight: bold">As</span> Graphics = pic.Graphics
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">Bottom</span> <span style="color:#7F0000;text-style:italic">Circle</span>
				g.ForeColor = Colour.DarkBlue
				g.FillOval <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, g.width, g.height
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">percent</span> <span style="color:#7F0000;text-style:italic">done</span> <span style="color:#7F0000;text-style:italic">arc</span>
				<span style="color:#0000FF;font-weight: bold">Dim</span> a <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> ArcShape
				a.ArcAngle = <span style="color:#006532">6.283</span> * percent
				a.StartAngle = -<span style="color:#006532">1.5708</span>
				a.FillColor = Colour.Magenta
				a.Height = <span style="color:#326598">96</span>
				a.Width = <span style="color:#326598">96</span>
				
				g.DrawObject(a, g.Width/<span style="color:#326598">2</span>, g.Height/<span style="color:#326598">2</span>)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">top</span> <span style="color:#7F0000;text-style:italic">circle</span>
				g.ForeColor = <span style="color:#0000FF;font-weight: bold">Color</span>.White
				g.FillOval  <span style="color:#326598">18</span>,<span style="color:#326598">18</span>, <span style="color:#326598">60</span>,<span style="color:#326598">60</span>  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">60</span> <span style="color:#7F0000;text-style:italic">IS</span> <span style="color:#7F0000;text-style:italic">CIRCLE</span> <span style="color:#7F0000;text-style:italic">WIDTH!!!</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Draw</span> <span style="color:#7F0000;text-style:italic">text</span>
				g.ForeColor = <span style="color:#0000FF;font-weight: bold">Color</span>.Black
				g.Bold = <span style="color:#0000FF;font-weight: bold">True</span>
				g.TextSize = <span style="color:#326598">32</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">adjust</span> <span style="color:#7F0000;text-style:italic">text</span> <span style="color:#7F0000;text-style:italic">size</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">number</span> <span style="color:#7F0000;text-style:italic">does</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">fit</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">center</span> <span style="color:#7F0000;text-style:italic">circle</span>
				<span style="color:#0000FF;font-weight: bold">While</span> g.StringWidth( totalAsText ) &gt; <span style="color:#326598">58</span>
					g.TextSize = g.TextSize - <span style="color:#326598">1</span>
				<span style="color:#0000FF;font-weight: bold">Wend</span>
				
				g.DrawString totalAsText, <span style="color:#326598">48</span>-(g.StringWidth(totalAsText)/<span style="color:#326598">2</span>), <span style="color:#326598">48</span> + g.TextHeight/<span style="color:#326598">3</span>  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">32</span> <span style="color:#7F0000;text-style:italic">29</span> <span style="color:#7F0000;text-style:italic">22</span> <span style="color:#7F0000;text-style:italic">17</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> clusterIcon <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> NSImageMBS( pic )
				clusterIcon.setSize <span style="color:#326598">48</span>, <span style="color:#326598">48</span>
				
				view.image = clusterIcon
				
			<span style="color:#0000FF;font-weight: bold">Else</span>   <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">cluster</span> <span style="color:#7F0000;text-style:italic">annotation</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">cluster</span> <span style="color:#7F0000;text-style:italic">without</span> <span style="color:#7F0000;text-style:italic">number</span>
				view.image = image
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
			
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">display</span> <span style="color:#7F0000;text-style:italic">priority</span>
			view.displayPriority = displayPriority
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">collision</span> <span style="color:#7F0000;text-style:italic">mode</span>
			view.collisionMode = <span style="color:#326598">1</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">callout</span>
			view.canShowCallout = <span style="color:#0000FF;font-weight: bold">True</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">clustering</span>
			view.clusteringIdentifier = clusteringIdentifier
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">hook</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">annotation</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">annotation</span> <span style="color:#7F0000;text-style:italic">view</span>
			view.annotation = annotation
			
			<span style="color:#0000FF;font-weight: bold">Return</span> view
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> GetViewForPin(annotation <span style="color:#0000FF;font-weight: bold">as</span> MKAnnotationMBS, reuseIdentifier <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>, clusteringIdentifier <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>, pinColour <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>, displayPriority <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> MKPinAnnotationViewMBS
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">without</span> <span style="color:#7F0000;text-style:italic">clustering</span> <span style="color:#7F0000;text-style:italic">nothing</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">do,</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">clustering</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">customise</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">view</span>
			
			<span style="color:#0000FF;font-weight: bold">Dim</span> viewForPin <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> MKPinAnnotationViewMBS( annotation, reuseIdentifier )
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">display</span> <span style="color:#7F0000;text-style:italic">priority</span>
			viewForPin.displayPriority = displayPriority
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">collision</span> <span style="color:#7F0000;text-style:italic">mode</span>
			viewForPin.collisionMode = <span style="color:#326598">1</span>  <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">circular</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">clustering</span>
			viewForPin.clusteringIdentifier = clusteringIdentifier
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">callout</span>
			viewForPin.canShowCallout = <span style="color:#0000FF;font-weight: bold">True</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> pinColour = <span style="color:#6500FE">&quot;red&quot;</span> <span style="color:#0000FF;font-weight: bold">Then</span> viewForPin.pinTintColor = MKPinAnnotationViewMBS.RedPinColor
			<span style="color:#0000FF;font-weight: bold">If</span> pinColour = <span style="color:#6500FE">&quot;green&quot;</span> <span style="color:#0000FF;font-weight: bold">Then</span> viewForPin.pinTintColor = MKPinAnnotationViewMBS.GreenPinColor
			<span style="color:#0000FF;font-weight: bold">If</span> pinColour = <span style="color:#6500FE">&quot;purple&quot;</span> <span style="color:#0000FF;font-weight: bold">Then</span> viewForPin.pinTintColor = MKPinAnnotationViewMBS.PurplePinColor
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">hook</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">annotation</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">view</span>
			viewForPin.annotation = annotation
			
			<span style="color:#0000FF;font-weight: bold">Return</span> viewForPin
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> UpdateMap()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">prevent</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">race</span> <span style="color:#7F0000;text-style:italic">condition</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">IconType</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">changes</span>
			
			mapIsUpdating = <span style="color:#0000FF;font-weight: bold">True</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">otherwise</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">following</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">callout</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">shown</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">you</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">change</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">IconType</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">FROM</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">TO</span> <span style="color:#7F0000;text-style:italic">&quot;Cluster</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">both</span> <span style="color:#7F0000;text-style:italic">Drivers</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">Cars&quot;:</span>
			<span style="color:#7F0000;text-style:italic">//</span>
			<span style="color:#7F0000;text-style:italic">//</span>   <span style="color:#7F0000;text-style:italic">A</span> <span style="color:#7F0000;text-style:italic">Cocoa</span> <span style="color:#7F0000;text-style:italic">NSInternalInconsistencyException</span> <span style="color:#7F0000;text-style:italic">was</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">handled:</span>
			<span style="color:#7F0000;text-style:italic">//</span>     <span style="color:#7F0000;text-style:italic">MKAnnotationView</span> <span style="color:#7F0000;text-style:italic">instances</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">cluster</span> <span style="color:#7F0000;text-style:italic">annotations</span> <span style="color:#7F0000;text-style:italic">cannot</span> <span style="color:#7F0000;text-style:italic">use</span>
			<span style="color:#7F0000;text-style:italic">//</span>     <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">different</span> <span style="color:#7F0000;text-style:italic">clusteringIdentifier</span> <span style="color:#7F0000;text-style:italic">than</span> <span style="color:#7F0000;text-style:italic">its</span> <span style="color:#7F0000;text-style:italic">annotation.</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Delete</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">map&#39;s</span> <span style="color:#7F0000;text-style:italic">annotations</span>
			
			mapview.removeAnnotations( mapview.annotations )
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">add</span> <span style="color:#7F0000;text-style:italic">annotations</span> <span style="color:#7F0000;text-style:italic">depending</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">user&#39;s</span> <span style="color:#7F0000;text-style:italic">settings</span>
			
			<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> popShowLocationsFor.Text
				
			<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Drivers&quot;</span>
				
				mapview.addAnnotations( ListOfDriverAnnotations )
				
			<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;cars&quot;</span>
				
				mapview.addAnnotations( ListOfCarAnnotations )
				
			<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;both&quot;</span>
				
				mapview.addAnnotations( ListOfDriverAnnotations )
				mapview.addAnnotations( ListOfCarAnnotations )
				
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
			
			mapIsUpdating = <span style="color:#0000FF;font-weight: bold">False</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> geocodeAddressStringCompleted(handler <span style="color:#0000FF;font-weight: bold">as</span> CLGeocodeCompletionHandlerMBS, geocoder <span style="color:#0000FF;font-weight: bold">as</span> CLGeocoderMBS, placemarks() <span style="color:#0000FF;font-weight: bold">as</span> CLPlacemarkMBS, error <span style="color:#0000FF;font-weight: bold">as</span> NSErrorMBS, tag <span style="color:#0000FF;font-weight: bold">as</span> variant)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">got</span> <span style="color:#7F0000;text-style:italic">something,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">show</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">map</span>
			
			<span style="color:#0000FF;font-weight: bold">If</span> placemarks.Ubound &gt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">Then</span>
				
				<span style="color:#0000FF;font-weight: bold">Dim</span> placemark <span style="color:#0000FF;font-weight: bold">As</span> CLPlacemarkMBS = placemarks(<span style="color:#326598">0</span>)
				<span style="color:#0000FF;font-weight: bold">Dim</span> location <span style="color:#0000FF;font-weight: bold">As</span> CLLocationMBS = placemark.location
				
				
				<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">Case</span> Tag
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Driver</span> <span style="color:#6500FE">Annotation&quot;</span>
					
					<span style="color:#0000FF;font-weight: bold">Dim</span> newAnnotation <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> DriverAnnotation
					
					newAnnotation.coordinate = <span style="color:#0000FF;font-weight: bold">New</span> CLLocationCoordinate2DMBS(location.Latitude, location.Longitude)
					newAnnotation.title = <span style="color:#6500FE">&quot;Driver</span> <span style="color:#6500FE">at&quot;</span>
					newAnnotation.subtitle = placemark.name
					
					ListOfDriverAnnotations.Append newAnnotation
					
					mapView.addAnnotation newAnnotation
					
				<span style="color:#0000FF;font-weight: bold">Case</span> <span style="color:#6500FE">&quot;Car</span> <span style="color:#6500FE">Annotation&quot;</span>
					
					<span style="color:#0000FF;font-weight: bold">Dim</span> newAnnotation <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">New</span> CarAnnotation
					
					newAnnotation.coordinate = <span style="color:#0000FF;font-weight: bold">New</span> CLLocationCoordinate2DMBS(location.Latitude, location.Longitude)
					newAnnotation.title = <span style="color:#6500FE">&quot;Car</span> <span style="color:#6500FE">at&quot;</span>
					newAnnotation.subtitle = placemark.name
					
					ListOfCarAnnotations.Append newAnnotation
					
					mapView.addAnnotation newAnnotation
					
				<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Select</span>
				
				
				
				
			<span style="color:#0000FF;font-weight: bold">Else</span>
				Break
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">If</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;Read</span> <span style="color:#6500FE">me&quot;</span>
<div class="RB_Comment">			Auckland, 10th of November 2020
			
			I hope I documented this example sufficiently for you to follow.
			
			A much more extensive description has been published in a series of articles 
			about using MapKit in Xojo with the help of the MBS MapKit plugin.
			
			The series started in xDev 17.5 and is still ongoing, with 
			the most relevant parts being in issues 18.5, 18.6, and 19.1
			
			I hope you find this example helpful.
			
			Markus Winter</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> CarClusterIcon <span style="color:#0000FF;font-weight: bold">As</span> NSImageMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> CarIcon <span style="color:#0000FF;font-weight: bold">As</span> NSImageMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> DriverClusterIcon <span style="color:#0000FF;font-weight: bold">As</span> NSImageMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> DriverIcon <span style="color:#0000FF;font-weight: bold">As</span> NSImageMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ListOfCarAnnotations() <span style="color:#0000FF;font-weight: bold">As</span> CarAnnotation</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ListOfDriverAnnotations() <span style="color:#0000FF;font-weight: bold">As</span> DriverAnnotation</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> geocoders() <span style="color:#0000FF;font-weight: bold">As</span> CLGeocoderMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> mapIsUpdating <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span> = <span style="color:#0000FF;font-weight: bold">False</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> mapview <span style="color:#0000FF;font-weight: bold">As</span> MKMapViewMBS</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar MenuBar1</div>
<div class="RB_Code">		MenuItem FileMenu = <span style="color:#6500FE">&quot;&amp;Ablage&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;#App.kFileQuit&quot;</span></div>
<div class="RB_Code">		MenuItem EditMenu = <span style="color:#6500FE">&quot;&amp;Bearbeiten&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;&amp;R&uuml;ckg&auml;ngig&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu1 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;&amp;Ausschneiden&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;&amp;Kopieren&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;&amp;Einf&uuml;gen&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;#App.kEditClear&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu0 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditSelectAll = <span style="color:#6500FE">&quot;&amp;Alles</span> <span style="color:#6500FE">ausw&auml;hlen&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> DriverAnnotation <span style="color:#0000FF;font-weight: bold">Inherits</span> MKPointAnnotationMBS</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> CarAnnotation <span style="color:#0000FF;font-weight: bold">Inherits</span> MKPointAnnotationMBS</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Module</span> Colour</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> DarkBlue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">color</span> = &amp;c<span style="color:#FF0000">00</span><span style="color:#00FF00">00</span><span style="color:#0000FF">6C</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Magenta <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">color</span> = &amp;c<span style="color:#FF0000">CC</span><span style="color:#00FF00">29</span><span style="color:#0000FF">99</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Module</span></div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

<p>See also:<ul>
<li><A href="example-macframeworks-mapkit-mapkitcustomimage.html">/MacFrameworks/MapKit/MapKit Custom Image</A></li>
<li><A href="example-macframeworks-mapkit-mapkitios.html">/MacFrameworks/MapKit/MapKit iOS</A></li>
<li><A href="example-macframeworks-mapkit-mapkitlocalsearch.html">/MacFrameworks/MapKit/MapKit Local Search</A></li>
<li><A href="example-macframeworks-mapkit-mapkitroute.html">/MacFrameworks/MapKit/MapKit Route</A></li>
<li><A href="example-macframeworks-mapkit-mapkittest.html">/MacFrameworks/MapKit/MapKit Test</A></li>
</ul></p>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmacframeworksplugin.html">MBS MacFrameworks Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-macframeworks-mapkit-mapkitcustomiconsexample">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

