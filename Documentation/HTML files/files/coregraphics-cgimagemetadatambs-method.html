<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - CGImageMetadataMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="CGImageMetadataMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">CGImageMetadataMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-cgimagemetadatambs.html">CGImageMetadataMBS</a> class.  </p>
<div class="M">
<b><a href="class-cgimagemetadatambs.html">CGImageMetadataMBS</a>.<A name="1">Constructor</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coregraphics.html" translate="no">CoreGraphics</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion185.shtml" class=version>18.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Creates an empty metadata object.<BR>
<p>See also:<ul>
<li><A href="coregraphics-cgimagemetadatambs-method.html#2">Constructor(metadata as CGImageMetadataMBS)</A></li>
</ul></p>
</div>
<div class="M">
<b><a href="class-cgimagemetadatambs.html">CGImageMetadataMBS</a>.<A name="2">Constructor(metadata as <A href="class-cgimagemetadatambs.html">CGImageMetadataMBS</A>)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coregraphics.html" translate="no">CoreGraphics</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion185.shtml" class=version>18.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Copy constructor.<BR>
<B>Notes:</B> 
Creates a copy of the metadata.<BR>
<p>See also:<ul>
<li><A href="coregraphics-cgimagemetadatambs-method.html">Constructor</A></li>
</ul></p>
</div>
<div class="M">
<b><a href="class-cgimagemetadatambs.html">CGImageMetadataMBS</a>.<A name="3">CreateXMPData(options as Dictionary = nil) as MemoryBlock</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coregraphics.html" translate="no">CoreGraphics</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion185.shtml" class=version>18.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Serializes the CGImageMetadataRef to XMP data.<BR>
<B>Notes:</B> 
<BR>
This converts all of the metadata tags to a block of XMP data. Common uses include creating sidecar files that contain metadata for image formats that do not support embedded XMP, or cannot be edited due to other format restrictions (such as proprietary RAW camera formats).<BR>
<BR>
options: should be nil. Options are currently not used, but may be used in future release.<BR>
<BR>
Returns a Memoryblock containing an XMP representation of the metadata. Returns nil if an error occurred. <BR>
</div>
<div class="M">
<b><a href="class-cgimagemetadatambs.html">CGImageMetadataMBS</a>.<A name="4">StringValueWithPath(parent as <A href="class-cgimagemetadatatagmbs.html">CGImageMetadataTagMBS</A> = nil, path as String) as String</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coregraphics.html" translate="no">CoreGraphics</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion185.shtml" class=version>18.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Searches for a specific tag in a CGImageMetadataRef and returns its string value.<BR>
<B>Notes:</B> 
<BR>
This is a convenience method for searching for a tag at path and extracting the string value.<BR>
<BR>
parent: A parent tag. If nil, the path is relative to the root of the metadata (i.e. it is not a child of another property).<BR>
path: A string with the path to the desired tag. Please consult the documentation of TagWithPath for information about path syntax.<BR>
<BR>
Returns a string from a <A href="class-cgimagemetadatatagmbs.html">CGImageMetadataTagMBS</A> located at &#39;path&#39;. The tag must be of type kTypeString or kTypeAlternateText.<BR>
For AlternateText tags, the element with the &quot;x-default&quot; language qualifier will be returned. For other types, &quot;&quot; will be returned.<BR>
</div>
<div class="M">
<b><a href="class-cgimagemetadatambs.html">CGImageMetadataMBS</a>.<A name="5">TagMatchingImageProperty(dictionaryName as String, propertyName as String) as Variant</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coregraphics.html" translate="no">CoreGraphics</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion185.shtml" class=version>18.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Searches for a specific CGImageMetadataTag matching an image property constant.<BR>
<B>Notes:</B> 
<BR>
Provides a bridge for values from CGImageCopyPropertiesAtIndex, simplifying access for properties defined in EXIF and IPTC standards, which have no notion of namespaces, prefixes, or XMP property types.<BR>
<BR>
Metadata: Working Group guidance is factored into the mapping of CGImage properties to XMP compatible metadata tags.<BR>
<BR>
For example, kCGImagePropertyExifDateTimeOriginal will get the value of the corresponding XMP tag, which is photoshop:DateCreated. Note that property values will still be in their XMP forms, such as &quot;YYYY-MM-DDThh:mm:ss&quot; for DateTime, rather than the EXIF or IPTC DateTime formats.<BR>
<BR>
dictionaryName: the metadata subdictionary to which the image property belongs, such as kCGImagePropertyExifDictionary or kCGImagePropertyIPTCDictionary. Not all dictionaries and properties are supported at this time.<BR>
propertyName: the name of the property. This must be a defined property constant corresponding to the &#39;dictionaryName&#39;. For example, kCGImagePropertyTIFFOrientation, kCGImagePropertyExifDateTimeOriginal, or kCGImagePropertyIPTCKeywords. A warning will be logged if the CGImageProperty is unsupported by CGImageMetadata.<BR>
<BR>
Returns a CGImageMetadataTagRef with the appropriate namespace, prefix, tag name, and XMP value for the corresponding CGImageProperty. Returns nil if the property could not be found.<BR>
</div>
<div class="M">
<b><a href="class-cgimagemetadatambs.html">CGImageMetadataMBS</a>.<A name="6">Tags as <A href="class-cgimagemetadatatagmbs.html">CGImageMetadataTagMBS</A>()</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coregraphics.html" translate="no">CoreGraphics</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion185.shtml" class=version>18.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Obtain an array of tags from a metadata object.<BR>
<p>See also:<ul>
<li><A href="coregraphics-cgimagemetadatambs-method.html#7">Tags(rootPath as string, options as Dictionary = nil) as CGImageMetadataTagMBS()</A></li>
</ul></p>
</div>
<div class="M">
<b><a href="class-cgimagemetadatambs.html">CGImageMetadataMBS</a>.<A name="7">Tags(rootPath as string, options as Dictionary = nil) as <A href="class-cgimagemetadatatagmbs.html">CGImageMetadataTagMBS</A>()</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coregraphics.html" translate="no">CoreGraphics</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion185.shtml" class=version>18.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Returns the tags matching the path and options.<BR>
<B>Notes:</B> 
<BR>
This function iterates over all of the tags in a metadata to collect the matching one. The default behavior iterates over all top-level tags in the metadata. <BR>
<BR>
rootPath: Iteration will occur for all children of the tag matching the root path. Please refer to TagWithPath for information about path syntax. If an empty string, the search will be executed  for all top-level tags in the metadata container.<BR>
options: A dictionary of options for iterating through the tags.<BR>
Currently the only supported option is kCGImageMetadataEnumerateRecursively, which should be set to a boolean.<BR>
<BR>
Returns array with found items.<BR>
<p>See also:<ul>
<li><A href="coregraphics-cgimagemetadatambs-method.html#6">Tags as CGImageMetadataTagMBS()</A></li>
</ul></p>
</div>
<div class="M">
<b><a href="class-cgimagemetadatambs.html">CGImageMetadataMBS</a>.<A name="8">TagWithPath(parent as <A href="class-cgimagemetadatatagmbs.html">CGImageMetadataTagMBS</A> = nil, path as string) as Variant</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-coregraphics.html" translate="no">CoreGraphics</A></td>
<td class=grau><a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a></td>
<td class=grau><a href="newinversion185.shtml" class=version>18.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
Searches for a specific <A href="class-cgimagemetadatatagmbs.html">CGImageMetadataTagMBS</A> in a <A href="class-cgimagemetadatambs.html">CGImageMetadataMBS</A>.<BR>
<B>Notes:</B> 
<BR>
This is the primary function for clients to obtain specific metadata properties from an image. The &#39;path&#39; mechanism provides a way to access both simple top-level properties, such as Date &amp; Time, or complex deeply-nested properties with ease.<BR>
<BR>
parent: A parent tag. If nil, the path is relative to the root of the metadata (i.e. it is not a child of another property). If the parent is provided, the effective path will be the concatenation of the parent&#39;s path and the &#39;path&#39; parameter. This is useful for accessing array elements or structure fields inside nested tags.<BR>
<BR>
path: A string representing a path to the desired tag. Paths consist of a tag prefix (i.e. &quot;exif&quot;) joined with a tag name (i.e. &quot;Flash&quot;) by a colon (&quot;:&quot;), such as &quot;exif:Flash&quot;. <BR>
Elements of ordered and unordered arrays are accessed via 0-based indices inside square [] brackets.<BR>
Elements of alternate-text arrays are accessed by an RFC 3066 language code inside square [] brackets.<BR>
Fields of a structure are delimited by a period, &#39;.&#39;.<BR>
Qualifiers are delimited by the &#39;?&#39; character. Only tags with string values (kTypeString) are allowed to have qualifiers - arrays and structures may not contain qualifiers.<BR>
<BR>
If parent is nil, a prefix must be specified for the first tag. Prefixes for all subsequent tags are optional. If unspecified, the prefix is inherented from the nearest parent tag with a prefix. Custom prefixes must be registered using RegisterNamespaceForPrefix prior to use  in any path-based functions.<BR>
<BR>
Examples:<BR>
<BR>
<UL><LI>
&#39;path&#39; = &quot;xmp:CreateDate&quot;  
</LI><LI>
&#39;path&#39; = &quot;exif:Flash.Fired&quot;
</LI><LI>
&#39;parent&#39; = tag at path &quot;exif:Flash&quot;, path = &quot;exif:Fired&quot; (equivilent to previous)
</LI><LI>
&#39;path&#39; = &quot;exif:Flash.RedEyeMode&quot;
</LI><LI>
&#39;path&#39; = &quot;dc:title&quot;
</LI><LI>
&#39;path&#39; = &quot;dc:subject&quot;
</LI><LI>
&#39;path&#39; = &quot;dc:subject[2]&quot;
</LI><LI>
&#39;parent&#39; = tag at path &quot;dc:subject&quot;, path = &quot;[2]&quot; (equivilent to previous
</LI><LI>
&#39;path&#39; = &quot;dc:description[x-default]
</LI><LI>
&#39;path&#39; = &quot;dc.description[de]
</LI><LI>
&#39;path&#39; = &quot;dc.description[fr]
</LI><LI>
&#39;path&#39; = &quot;foo:product
</LI><LI>
&#39;path&#39; = &quot;foo:product?bar:manufacturer
</LI></UL>
<BR>
Returns a <A href="class-cgimagemetadatatagmbs.html">CGImageMetadataTagMBS</A> matching &#39;path&#39;, or nil if no  match is found. The copy of the tag&#39;s value is shallow. Tags copied from an immutable <A href="class-cgimagemetadatambs.html">CGImageMetadataMBS</A> are also immutable. Because this function returns a copy of the tag&#39;s value, any modification of the tag&#39;s value must be followed by a SetTagWithPath to commit the change to the metadata container.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmaccgplugin.html">MBS MacCG Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=coregraphics-cgimagemetadatambs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

