<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - NSAppleScriptMBS shared methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="NSAppleScriptMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">NSAppleScriptMBS shared methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-nsapplescriptmbs.html">NSAppleScriptMBS</a> class.  </p>
<div class="M">
<b><a href="class-nsapplescriptmbs.html">NSAppleScriptMBS</a>.<A name="1">DeterminePermissionToAutomateTarget(target as <A href="class-nsappleeventdescriptormbs.html">NSAppleEventDescriptorMBS</A>, theAEEventClass as string = &quot;****&quot;, theAEEventID as String = &quot;****&quot;, askUserIfNeeded as boolean) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-applescript.html" translate="no">Apple Script</A></td>
<td class=grau><a href="plugins-mbsmaccocoaplugin.html">MBS MacCocoa Plugin</a></td>
<td class=grau><a href="newinversion184.shtml" class=version>18.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Determines whether the current application is able to send an AppleEvent with the given eventClass and eventID to the application described as target.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> target <span style="color: #0000FF;">as</span> <A href="class-nsappleeventdescriptormbs.html">NSAppleEventDescriptorMBS</A> = <A href="class-nsappleeventdescriptormbs.html">NSAppleEventDescriptorMBS</A>.descriptorWithBundleIdentifier(<span style="color: #6600FE;">&quot;com.apple.Safari&quot;</span>)<br /><br /><span style="color: #800000;">// we ask for all apple events</span><br /><span style="color: #0000FF;">dim</span> e <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">integer</span> = <A href="class-nsapplescriptmbs.html">NSAppleScriptMBS</A>.DeterminePermissionToAutomateTarget(target, <span style="color: #6600FE;">&quot;****&quot;</span>, <span style="color: #6600FE;">&quot;****&quot;</span>, <span style="color: #0000FF;">true</span>)<br /><br />MsgBox str(e)</span>
</pre>
</div>
<B>Notes:</B> 
<BR>
Mac OS 10.14 and later impose additional requirements on applications when they send AppleEvents to other applications in order to insure that users are aware of and consent to allowing such control or information exchange.  Generally this involves the user being prompted in a secure fashion the first time an application attempts to send an AppleEvent to another application. If the user consents then this application can send events to the target.  If the user does not consent then any future attempts to send AppleEvents will result in a failure with errAEEventNotPermitted (-1743) being returned.<BR>
<BR>
Certain AppleEvents are allowed to be sent without prompting the user.  Pass typeWildCard for the eventClass and eventID to determine if every event is allowed to be sent from this application to the target.<BR>
<BR>
Applications can determine, without sending an AppleEvent to a target application, whether they are allowed to send AppleEvents to the target with this function.  If askUserIfNeeded is true, and this application does not yet have permission to send AppleEvents to the target, then the user will be asked if permission can be granted; if askUserIfNeeded is false and permission has not been granted, then errAEEventWouldRequireUserConsent (-1744) will be returned.<BR>
The target must refer to an already running application.<BR>
<BR>
If the current application is permitted to send the given AppleEvent to the target, then noErr (0) will be returned.  If the current application is not permitted to send the event, errAEEventNotPermitted (-1743) will be returned.  If the target application is not running, then procNotFound (-600) will be returned.  If askUserIfNeeded is false, and this application is not yet permitted to send AppleEvents to the target, then errAEEventWouldRequireUserConsent (-1744) will be returned.<BR>
<BR>
Mac OS X threading: Thread safe since version 10.14.  Do not call this function on your main thread because it may take arbitrarily long to return if the user needs to be prompted for consent.<BR>
<BR>
target: The address descriptor. Before calling AEDeterminePermissionToAutomateTarget, you set the descriptor to identify the target application for the Apple event.  The target address descriptor must refer to a running application.  If the target application is on another machine, then Remote AppleEvents must be enabled on that machine for the user.<BR>
theAEEventClass: The event class of the Apple event to determine permission for.<BR>
theAEEventID: The event ID of the Apple event to determine permission for.<BR>
askUserIfNeeded: a Boolean; if true, and if this application does not yet have permission to send events to the target application, then prompt the user to obtain permission.  If false, do not prompt the user.<BR>
<BR>
Plugin returns -1 if the function is not available, e.g. older MacOS versions.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-maccocoa-applescript-determinepermissiontoautomatetarget.html">/MacCocoa/AppleScript/DeterminePermissionToAutomateTarget</A></li>
</ul>
</div>
<div class="M">
<b><a href="class-nsapplescriptmbs.html">NSAppleScriptMBS</a>.<A name="2">NSAppleScriptErrorAppName as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-applescript.html" translate="no">Apple Script</A></td>
<td class=grau><a href="plugins-mbsmaccocoaplugin.html">MBS MacCocoa Plugin</a></td>
<td class=grau><a href="newinversion112.shtml" class=version>11.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
One of the keys in the error dictionary.<BR>
<B>Notes:</B> 
Value for this key is a string that specifies the name of the application that generated the error.<BR>
</div>
<div class="M">
<b><a href="class-nsapplescriptmbs.html">NSAppleScriptMBS</a>.<A name="3">NSAppleScriptErrorBriefMessage as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-applescript.html" translate="no">Apple Script</A></td>
<td class=grau><a href="plugins-mbsmaccocoaplugin.html">MBS MacCocoa Plugin</a></td>
<td class=grau><a href="newinversion112.shtml" class=version>11.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
One of the keys in the error dictionary.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> source <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;tell application &quot;</span><span style="color: #6600FE;">&quot;iTunes&quot;</span><span style="color: #6600FE;">&quot;&quot;</span>+EndOfLine+<span style="color: #6600FE;">&quot;pause&quot;</span>+EndOfLine+<span style="color: #6600FE;">&quot;end if&quot;</span><br /><span style="color: #0000FF;">dim</span> n <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-nsapplescriptmbs.html">NSAppleScriptMBS</A>(source)<br /><br /><span style="color: #0000FF;">dim</span> error <span style="color: #0000FF;">as</span> Dictionary<br /><span style="color: #0000FF;">if</span> <span style="color: #0000FF;">not</span> n.compile(error) <span style="color: #0000FF;">then</span><br />  <span style="color: #800000;">// shows error about missing tell where it found an if.</span><br />  MsgBox error.Value(n.NSAppleScriptErrorBriefMessage)<br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span></span>
</pre>
</div>
<B>Notes:</B> 
Value for this key is a string that provides a brief description of the error.<BR>
</div>
<div class="M">
<b><a href="class-nsapplescriptmbs.html">NSAppleScriptMBS</a>.<A name="4">NSAppleScriptErrorMessage as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-applescript.html" translate="no">Apple Script</A></td>
<td class=grau><a href="plugins-mbsmaccocoaplugin.html">MBS MacCocoa Plugin</a></td>
<td class=grau><a href="newinversion112.shtml" class=version>11.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
One of the keys in the error dictionary.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> source <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;tell application &quot;</span><span style="color: #6600FE;">&quot;iTunes&quot;</span><span style="color: #6600FE;">&quot;&quot;</span>+EndOfLine+<span style="color: #6600FE;">&quot;pause&quot;</span>+EndOfLine+<span style="color: #6600FE;">&quot;end if&quot;</span><br /><span style="color: #0000FF;">dim</span> n <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-nsapplescriptmbs.html">NSAppleScriptMBS</A>(source)<br /><br /><span style="color: #0000FF;">dim</span> error <span style="color: #0000FF;">as</span> Dictionary<br /><span style="color: #0000FF;">if</span> n.compile(error) <span style="color: #0000FF;">then</span><br />  MsgBox <span style="color: #6600FE;">&quot;OK&quot;</span><br /><span style="color: #0000FF;">else</span><br />  <span style="color: #800000;">// shows error about missing tell where it found an if.</span><br />  MsgBox error.Value(n.NSAppleScriptErrorMessage)<br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span></span>
</pre>
</div>
<B>Notes:</B> 
Value for this key is a <A href="class-nsrangembs.html">NSRangeMBS</A> object.<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-maccocoa-applescript-nsapplescriptmbsquerymailmailboxes.html">/MacCocoa/AppleScript/NSAppleScriptMBS query Mail mailboxes</A></li>
</ul>
</div>
<div class="M">
<b><a href="class-nsapplescriptmbs.html">NSAppleScriptMBS</a>.<A name="5">NSAppleScriptErrorNumber as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-applescript.html" translate="no">Apple Script</A></td>
<td class=grau><a href="plugins-mbsmaccocoaplugin.html">MBS MacCocoa Plugin</a></td>
<td class=grau><a href="newinversion112.shtml" class=version>11.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
One of the keys in the error dictionary.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> source <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;tell application &quot;</span><span style="color: #6600FE;">&quot;iTunes&quot;</span><span style="color: #6600FE;">&quot;&quot;</span>+EndOfLine+<span style="color: #6600FE;">&quot;pause&quot;</span>+EndOfLine+<span style="color: #6600FE;">&quot;end if&quot;</span><br /><span style="color: #0000FF;">dim</span> n <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-nsapplescriptmbs.html">NSAppleScriptMBS</A>(source)<br /><br /><span style="color: #0000FF;">dim</span> error <span style="color: #0000FF;">as</span> Dictionary<br /><span style="color: #0000FF;">if</span> <span style="color: #0000FF;">not</span> n.compile(error) <span style="color: #0000FF;">then</span><br />  <span style="color: #800000;">// error about missing tell where it found an if.</span><br />  MsgBox error.Value(n.NSAppleScriptErrorNumber) <span style="color: #800000;">// shows -2741</span><br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span></span>
</pre>
</div>
<B>Notes:</B> 
Value for this key is a number that specifies the error number.<BR>
</div>
<div class="M">
<b><a href="class-nsapplescriptmbs.html">NSAppleScriptMBS</a>.<A name="6">NSAppleScriptErrorRange as string</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>shared method</td>
<td class=grau><A href="topic-applescript.html" translate="no">Apple Script</A></td>
<td class=grau><a href="plugins-mbsmaccocoaplugin.html">MBS MacCocoa Plugin</a></td>
<td class=grau><a href="newinversion112.shtml" class=version>11.2</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
One of the keys in the error dictionary.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> source <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">string</span> = <span style="color: #6600FE;">&quot;tell application &quot;</span><span style="color: #6600FE;">&quot;iTunes&quot;</span><span style="color: #6600FE;">&quot;&quot;</span>+EndOfLine+<span style="color: #6600FE;">&quot;pause&quot;</span>+EndOfLine+<span style="color: #6600FE;">&quot;end if&quot;</span><br /><span style="color: #0000FF;">dim</span> n <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> <A href="class-nsapplescriptmbs.html">NSAppleScriptMBS</A>(source)<br /><br /><span style="color: #0000FF;">dim</span> error <span style="color: #0000FF;">as</span> Dictionary<br /><span style="color: #0000FF;">if</span> <span style="color: #0000FF;">not</span> n.compile(error) <span style="color: #0000FF;">then</span><br />  <span style="color: #800000;">// error about missing tell where it found an if.</span><br />  <span style="color: #0000FF;">dim</span> r <span style="color: #0000FF;">as</span> <A href="class-nsrangembs.html">NSRangeMBS</A> = error.Value(n.NSAppleScriptErrorRange)<br />  MsgBox r.String <span style="color: #800000;">// {36,2}, the position of the if</span><br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span></span>
</pre>
</div>
<B>Notes:</B> 
Value for this key is a string that supplies a detailed description of the error condition.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmaccocoaplugin.html">MBS MacCocoa Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=applescript-nsapplescriptmbs-shared-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

