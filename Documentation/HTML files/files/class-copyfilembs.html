<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - CopyFileMBS class</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="CopyFileMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">CopyFileMBS class</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<H3>CopyFileMBS class</H3>
<div class="M">

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>class</td>
<td class=grau><A href="topic-files.html" translate="no">Files</A></td>
<td class=grau><a href="plugins-mbsmacosxplugin.html">MBS MacOSX Plugin</a></td>
<td class=grau><a href="newinversion194.shtml" class=version>19.4</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>All</td>
</tr>
</table>
<B>Function:</B> 
The class for copyfile function.<BR>
<B>Notes:</B> 
<BR>
We provide a class to hold state and get event for progress.<BR>
Uses low level copyfile API from MacOS.<BR>
<BR>
See copyfile man page in terminal.<BR>
</div>
<ul>
<li class="M">event <A href="files-copyfilembs-event.html">Progress</A>(What as Integer, Stage as Integer, Source as String, Dest as String) as Integer</li>
<LI>4 properties<UL>
<li class="M">property <A href="files-copyfilembs-property.html">BytesCopied</A> as Int64</li>
<li class="M">property <A href="files-copyfilembs-property.html#2">WasCloned</A> as Boolean</li>
<li class="M">property <A href="files-copyfilembs-property.html#3">XAttrName</A> as String</li>
<li class="M">property <A href="files-copyfilembs-property.html#4">YieldTicks</A> as Integer</li>
</UL></LI>
<LI>2 methods<UL>
<li class="M">method <A href="files-copyfilembs-method.html">CopyFile</A>(From as FolderItem, Dest as FolderItem, flags as Integer) as Integer</li>
<li class="M">method <A href="files-copyfilembs-method.html#2">CopyFile</A>(From as String, Dest as String, flags as Integer) as Integer</li>
</UL></LI>
<li class="M">shared method <A href="files-copyfilembs-shared-method.html">ErrorMessage</A>(error as Integer) as String</li>
<LI>35 constants<UL>
</UL></LI>
</ul>
<h3 lang="en">Flags</h3>
<table cellpadding=2 cellspacing=2>
<tr>
<th bgcolor="#DDDDDD">Constant</th>
<th bgcolor="#DDDDDD">Value</th>
<th bgcolor="#DDDDDD">Description</th>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html">kFlagsACL </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 1</td>
<td bgcolor="#DDDDDD" valign=top>
Copy the source file&#39;s access control lists.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#2">kFlagsAll </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 15</td>
<td bgcolor="#DDDDDD" valign=top>
Copy the entire file; equivalent to BitwiseOr(kFlagsMetaData, kFlagsData).<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#3">kFlagsCheck </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h10000</td>
<td bgcolor="#DDDDDD" valign=top>
Return a bitmask (corresponding to the flags argument) indicating which contents would be copied; no data are actually copied.  (E.g., if flags was set to kFlagsCheck + kFlagsMetaData, and the from file had extended attributes but no ACLs, the return value would be kFlagsXAttr.)<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#4">kFlagsClone </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h1000000</td>
<td bgcolor="#DDDDDD" valign=top>
Try to clone the file instead.  This is a best try flag i.e. if cloning fails, fallback to copying the file.  This flag is equivalent to BitwiseOr(kFlagsExcl, kFlagsACL, kFlagsStat, kFlagsXAttr, kFlagsData, kFlagsNoFollowSource).  <BR>
Note that if cloning is successful, progress event will not be invoked.  Note also that there is no support for cloning directories: if a directory is provided as the source and kFlagsCloneForce is not passed, this will instead copy the directory. Recursive copying however is supported.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#5">kFlagsCloneForce </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h2000000</td>
<td bgcolor="#DDDDDD" valign=top>
Clone the file instead.  This is a force flag i.e. if cloning fails, an error is returned.  This flag is equivalent to BitwiseOr(kFlagsExcl, kFlagsACL, kFlagsStat, kFlagsXAttr, kFlagsData, kFlagsNoFollowSource).  Note that if cloning is successful, progress callbacks will not be invoked.  Note also that there is no support for cloning directories: if a directory is provided as the source, an error will be returned. <BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#6">kFlagsData </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 8</td>
<td bgcolor="#DDDDDD" valign=top>
Copy the source file&#39;s data.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#7">kFlagsDataSparse </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h8000000</td>
<td bgcolor="#DDDDDD" valign=top>
Copy a file sparsely.  This requires that the source and destination file systems support sparse files with hole sizes at least as large as their block sizes. <BR>
If kFlagsData is also specified, this will fall back to a full copy if sparse copying cannot be performed for any reason; otherwise, an error is returned.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#8">kFlagsExcl </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h20000</td>
<td bgcolor="#DDDDDD" valign=top>
Fail if the to file already exists. <BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#9">kFlagsMetaData </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 7</td>
<td bgcolor="#DDDDDD" valign=top>
Copy the metadata; equivalent to BitwiseOr(kFlagsSecurity, kFlagsXAttr).<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#10">kFlagsMove </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h100000</td>
<td bgcolor="#DDDDDD" valign=top>
Unlink (using remove(3)) the from file. <BR>
No error is returned if remove(3) fails.  Note that remove(3) removes a symbolic link itself, not the target of the link.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#11">kFlagsNoFollow </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;hC00000</td>
<td bgcolor="#DDDDDD" valign=top>
This is a convenience macro, equivalent to BitwiseOr(kFlagsNoFollowDest, kFlagsNoFollowSource).<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#12">kFlagsNoFollowDest </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h80000</td>
<td bgcolor="#DDDDDD" valign=top>
Do not follow the to file, if it is a symbolic link.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#13">kFlagsNoFollowSource </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h40000</td>
<td bgcolor="#DDDDDD" valign=top>
Do not follow the from file, if it is a symbolic link.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#14">kFlagsPack </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h400000</td>
<td bgcolor="#DDDDDD" valign=top>
Serialize the from file.  The to file is an Apple-Double-format file.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#15">kFlagsRecursive </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h8000</td>
<td bgcolor="#DDDDDD" valign=top>
Causes copyfile to recursively copy a hierarchy. <BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#16">kFlagsRunInPlace </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h4000000</td>
<td bgcolor="#DDDDDD" valign=top>
If the src file has quarantine information, add the QTN_FLAG_DO_NOT_TRANSLOCATE flag to the quarantine information of the dst file. This allows a bundle to run in place instead of being translocated.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#17">kFlagsSecurity </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 3</td>
<td bgcolor="#DDDDDD" valign=top>
Copy the source file&#39;s POSIX and ACL information; equivalent to BitwiseOr(kFlagsStat,kFlagsACL).<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#18">kFlagsStat </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 2</td>
<td bgcolor="#DDDDDD" valign=top>
Copy the source file&#39;s POSIX information (mode, modification time, etc.).<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#19">kFlagsUnlink </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h200000</td>
<td bgcolor="#DDDDDD" valign=top>
Unlink the to file before starting.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#20">kFlagsUnpack </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h800000</td>
<td bgcolor="#DDDDDD" valign=top>
Unserialize the from file.  The from file is an AppleDouble-format file; the to file will have the extended attributes, ACLs, resource fork, and FinderInfo data from the to file, regardless of the flags argument passed in.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#21">kFlagsVerbose </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> &amp;h40000000</td>
<td bgcolor="#DDDDDD" valign=top>
Verbose messages.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#22">kFlagsXAttr </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 4</td>
<td bgcolor="#DDDDDD" valign=top>
Copy the source file&#39;s extended attributes.<BR>
</td>
</tr>
</table>
<h3 lang="en">Event Return Values</h3>
<table cellpadding=2 cellspacing=2>
<tr>
<th bgcolor="#DDDDDD">Constant</th>
<th bgcolor="#DDDDDD">Value</th>
<th bgcolor="#DDDDDD">Description</th>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#23">kReturnContinue </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 0</td>
<td bgcolor="#DDDDDD" valign=top>
The copy will continue as expected.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#24">kReturnQuit </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 2</td>
<td bgcolor="#DDDDDD" valign=top>
The data copy will be aborted; in the case of kStageProgress, result will be set to ECANCELED (89).<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#25">kReturnSkip </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 1</td>
<td bgcolor="#DDDDDD" valign=top>
The data copy will be aborted, but without error.<BR>
</td>
</tr>
</table>
<h3 lang="en">Progress</h3>
<table cellpadding=2 cellspacing=2>
<tr>
<th bgcolor="#DDDDDD">Constant</th>
<th bgcolor="#DDDDDD">Value</th>
<th bgcolor="#DDDDDD">Description</th>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#26">kStageError </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 3</td>
<td bgcolor="#DDDDDD" valign=top>
Indicates an error has happened at some stage.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#27">kStageFinish </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 2</td>
<td bgcolor="#DDDDDD" valign=top>
After copying has successfully finished.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#28">kStageProgress </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 4</td>
<td bgcolor="#DDDDDD" valign=top>
Copy in progress.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const.html#29">kStageStart </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 1</td>
<td bgcolor="#DDDDDD" valign=top>
Before copying has begun.<BR>
</td>
</tr>
</table>
<h3 lang="en">What</h3>
<table cellpadding=2 cellspacing=2>
<tr>
<th bgcolor="#DDDDDD">Constant</th>
<th bgcolor="#DDDDDD">Value</th>
<th bgcolor="#DDDDDD">Description</th>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const1.html">kWhatCopyData </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 4</td>
<td bgcolor="#DDDDDD" valign=top>
Data is copied currently.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const1.html#2">kWhatCopyXAttr </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 5</td>
<td bgcolor="#DDDDDD" valign=top>
Extended attributes are copied currently.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const1.html#3">kWhatRecurseDir </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 2</td>
<td bgcolor="#DDDDDD" valign=top>
The object being copied is a directory, and is being entered.  (That is, none of the filesystem objects contained within the directory have been copied yet.)<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const1.html#4">kWhatRecurseDirCleanup </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 3</td>
<td bgcolor="#DDDDDD" valign=top>
The object being copied is a directory, and all of the objects contained have been copied.  At this stage, the destination directory being copied will have any extra permissions that were added to allow the copying will be removed.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const1.html#5">kWhatRecurseError </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 0</td>
<td bgcolor="#DDDDDD" valign=top>
There was an error in processing an element of the source hierarchy; this happens when fts(3) returns an error or unknown file type.<BR>
</td>
</tr>
<tr class="M">
<td bgcolor="#DDDDDD" valign=top><a href="files-copyfilembs-const1.html#6">kWhatRecurseFile </a></td>
<td bgcolor="#DDDDDD" valign=top align=Right> 1</td>
<td bgcolor="#DDDDDD" valign=top>
The object being copied is a file (or, rather, something other than a directory).<BR>
</td>
</tr>
</table>
<p>This class has no sub classes.</p>
<h4>Some examples using this class:</h4>
<ul translate="no">
<li class=""><A href="example-macosx-copyfiletest.html">/MacOSX/CopyFile Test</A></li>
</ul>
<h4>Blog Entries</h4>
<ul>
<li><a href="https://www.mbsplugins.de/archive/2019-09-17/MonkeyBread_Software_Releases_/monkeybreadsoftware_blog_xojo">MonkeyBread Software Releases the MBS Xojo Plugins in version 19.4</a></li>
<li><a href="https://www.mbsplugins.de/archive/2019-08-23/MBS_Xojo_Plugins_version_194pr/monkeybreadsoftware_blog_xojo">MBS Xojo Plugins, version 19.4pr3</a></li>
</ul>
<h4>Xojo Developer Magazine</h4>
<ul>
<li><a href="http://www.xdevmag.com/browse/18.3/">18.3, page 54: Happy Birthday MonkeyBread Software, What is new in the MBS Xojo Plugins by Stefanie Juchmes</a></li>
</ul>
<h4>Videos</h4>
<ul>
<li><a href="https://www.monkeybreadsoftware.de/xojo/video/MBSXojoPlugins2020.shtml">XDC 2020 MBS Plugins Presentation</a></li>
</ul>
<BR>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmacosxplugin.html">MBS MacOSX Plugin</a>.</p>
<br clear=all><p>
<a href="class-control.html">Control</a>
 &nbsp; - &nbsp; 
<a href="class-coreaudiolistenermbs.html">CoreAudioListenerMBS</a>
</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=class-copyfilembs">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

