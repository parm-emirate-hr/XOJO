<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /MacControls/Listbox and TableView Demos/ListboxTV drop-in/Flat Only/ListboxTV with ContainerControl Cells</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /MacControls/Listbox and TableView Demos/ListboxTV drop-in/Flat Only/ListboxTV with ContainerControl Cells</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/MacControls/Listbox and TableView Demos/ListboxTV drop-in/Flat Only/ListboxTV with ContainerControl Cells</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS MacOSX Plugin, MBS MacCocoa Plugin, MBS MacBase Plugin, MBS MacControls Plugin, MBS Main Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /MacControls/Listbox and TableView Demos/ListboxTV drop-in/Flat Only/ListboxTV with ContainerControl Cells<BR>
This example is the version from Tue, 20th Aug 2018.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;ListboxTV</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">ContainerControl</span> <span style="color:#6500FE">Cells.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kEditClear = <span style="color:#6500FE">&quot;&amp;Delete&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuit = <span style="color:#6500FE">&quot;&amp;Quit&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuitShortcut = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#0000FF">#if</span> <span style="color:#0000FF;font-weight: bold">false</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">useful</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">debugging</span> <span style="color:#7F0000;text-style:italic">issues</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">incorrect</span> <span style="color:#7F0000;text-style:italic">cell</span> <span style="color:#7F0000;text-style:italic">placement:</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Inject</span> <span style="color:#7F0000;text-style:italic">FScript</span> <span style="color:#7F0000;text-style:italic">into</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">App&#39;s</span> <span style="color:#7F0000;text-style:italic">menu</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">(you</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">place</span> <span style="color:#7F0000;text-style:italic">FScript.framework</span> <span style="color:#7F0000;text-style:italic">into</span> <span style="color:#7F0000;text-style:italic">/Library/Frameworks</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">make</span> <span style="color:#7F0000;text-style:italic">sure</span> <span style="color:#7F0000;text-style:italic">it&#39;s</span> <span style="color:#7F0000;text-style:italic">one</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">supports</span> <span style="color:#7F0000;text-style:italic">32</span> <span style="color:#7F0000;text-style:italic">bit</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">debug</span> <span style="color:#7F0000;text-style:italic">your</span> <span style="color:#7F0000;text-style:italic">Xojo</span> <span style="color:#7F0000;text-style:italic">app</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">architecture)</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> f <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = SpecialFolder.Library.Child(<span style="color:#6500FE">&quot;Frameworks&quot;</span>).Child(<span style="color:#6500FE">&quot;FScript.framework&quot;</span>)
				<span style="color:#0000FF;font-weight: bold">declare</span> <span style="color:#0000FF;font-weight: bold">function</span> NSClassFromString <span style="color:#0000FF;font-weight: bold">lib</span> <span style="color:#6500FE">&quot;Cocoa&quot;</span> (name <span style="color:#0000FF;font-weight: bold">as</span> CFStringRef) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Ptr</span>
				<span style="color:#0000FF;font-weight: bold">declare</span> <span style="color:#0000FF;font-weight: bold">function</span> bundleWithPath <span style="color:#0000FF;font-weight: bold">lib</span> <span style="color:#6500FE">&quot;Cocoa&quot;</span> selector <span style="color:#6500FE">&quot;bundleWithPath:&quot;</span> (cls <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Ptr</span>, path <span style="color:#0000FF;font-weight: bold">as</span> CFStringRef) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Ptr</span>
				<span style="color:#0000FF;font-weight: bold">declare</span> <span style="color:#0000FF;font-weight: bold">function</span> load <span style="color:#0000FF;font-weight: bold">lib</span> <span style="color:#6500FE">&quot;Cocoa&quot;</span> selector <span style="color:#6500FE">&quot;load&quot;</span> (obj <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Ptr</span>) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> path <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>
				<span style="color:#0000FF">#if</span> RBVersion &gt;= <span style="color:#326598">2013</span> <span style="color:#0000FF;font-weight: bold">then</span>
					path = f.NativePath
				<span style="color:#0000FF">#else</span>
					path = f.ShellPath
				<span style="color:#0000FF">#endif</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> bndl <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">ptr</span> = bundleWithPath (NSClassFromString (<span style="color:#6500FE">&quot;NSBundle&quot;</span>), path)
				<span style="color:#0000FF;font-weight: bold">if</span> bndl = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">or</span> <span style="color:#0000FF;font-weight: bold">not</span> load(bndl) <span style="color:#0000FF;font-weight: bold">then</span>
					break
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">declare</span> <span style="color:#0000FF;font-weight: bold">sub</span> insertInMainMenu <span style="color:#0000FF;font-weight: bold">lib</span> <span style="color:#6500FE">&quot;Cocoa&quot;</span> selector <span style="color:#6500FE">&quot;insertInMainMenu&quot;</span> (cls <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Ptr</span>)
					insertInMainMenu (NSClassFromString (<span style="color:#6500FE">&quot;FScriptMenuItem&quot;</span>))
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
			<span style="color:#0000FF">#endif</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar MainMenuBar</div>
<div class="RB_Code">		MenuItem FileMenu = <span style="color:#6500FE">&quot;&amp;File&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;#App.kFileQuit&quot;</span></div>
<div class="RB_Code">		MenuItem EditMenu = <span style="color:#6500FE">&quot;&amp;Edit&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;&amp;Undo&quot;</span></div>
<div class="RB_Code">			MenuItem EditSeparator1 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;Cu&amp;t&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;&amp;Copy&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;&amp;Paste&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;#App.kEditClear&quot;</span></div>
<div class="RB_Code">			MenuItem EditSeparator2 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditSelectAll = <span style="color:#6500FE">&quot;Select</span> <span style="color:#6500FE">&amp;All&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ListboxDemoWin <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control cocoaListbox <span style="color:#0000FF;font-weight: bold">Inherits</span> ListBoxTV</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance cocoaListbox <span style="color:#0000FF;font-weight: bold">Inherits</span> ListBoxTV</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> DidResizeCells()
				adjustContainerSizes
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
				<span style="color:#0000FF;font-weight: bold">me</span>.TableView.rowHeight = <span style="color:#326598">120</span>
				<span style="color:#0000FF;font-weight: bold">me</span>.TableView.backgroundColor = NSColorMBS.grayColor
				<span style="color:#0000FF;font-weight: bold">me</span>.IntercellSpacing = <span style="color:#326598">0</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Removes</span> <span style="color:#7F0000;text-style:italic">gaps</span> <span style="color:#7F0000;text-style:italic">between</span> <span style="color:#7F0000;text-style:italic">cells</span>
				
				mRowCount = <span style="color:#326598">10</span>
				<span style="color:#0000FF;font-weight: bold">me</span>.DataSource = <span style="color:#0000FF;font-weight: bold">self</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">lets</span> <span style="color:#7F0000;text-style:italic">ListboxTV</span> <span style="color:#7F0000;text-style:italic">invoke</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">DataSource_...</span> <span style="color:#7F0000;text-style:italic">functions</span> <span style="color:#7F0000;text-style:italic">here</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">inquire</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">count</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">rows</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">our</span> <span style="color:#7F0000;text-style:italic">list</span>
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> view(tableColumn <span style="color:#0000FF;font-weight: bold">as</span> NSTableColumnMBS, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> NSViewMBS
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> ContainerCell (<span style="color:#0000FF;font-weight: bold">me</span>, tableColumn, row)
				mCellContainers.Append c
				c.EmbedWithin (<span style="color:#0000FF;font-weight: bold">self</span>, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>)
				
				c.Width = tableColumn.Width
				
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">me</span>.TableView.rowHeight &gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					c.Height = <span style="color:#0000FF;font-weight: bold">me</span>.TableView.rowHeight
				<span style="color:#0000FF;font-weight: bold">else</span>
					break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">should</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">TableView.rowHeight</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">fixed</span> <span style="color:#7F0000;text-style:italic">value</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Open</span> <span style="color:#7F0000;text-style:italic">event</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#0000FF;font-weight: bold">return</span> c.NSViewMBS
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> DataSource_Cell(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> ListCellTV
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Part</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource</span> <span style="color:#7F0000;text-style:italic">interface.</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_CellDidUpdate(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV, updatesText <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>, updatesChecked <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Part</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource</span> <span style="color:#7F0000;text-style:italic">interface.</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_CellWillUpdate(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV, updatesText <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>, updatesChecked <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Part</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource</span> <span style="color:#7F0000;text-style:italic">interface.</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_DeleteAllRows()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Part</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource</span> <span style="color:#7F0000;text-style:italic">interface.</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_MoveColumn(fromIdx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, toIdx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Part</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource</span> <span style="color:#7F0000;text-style:italic">interface.</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_MoveRows(fromIdxs() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, toAboveIdx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Part</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource</span> <span style="color:#7F0000;text-style:italic">interface.</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> DataSource_RowCount() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Part</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource</span> <span style="color:#7F0000;text-style:italic">interface.</span>
			
			<span style="color:#0000FF;font-weight: bold">return</span> mRowCount
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> DataSource_RowTag(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> Variant
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Part</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource</span> <span style="color:#7F0000;text-style:italic">interface.</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_RowTag(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> tag <span style="color:#0000FF;font-weight: bold">as</span> Variant)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Part</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource</span> <span style="color:#7F0000;text-style:italic">interface.</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_SetColumnCount(colCount <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Part</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource</span> <span style="color:#7F0000;text-style:italic">interface.</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_SortRows(sorters() <span style="color:#0000FF;font-weight: bold">as</span> NSSortDescriptorMBS)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Part</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource</span> <span style="color:#7F0000;text-style:italic">interface.</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> adjustContainerSizes()
			<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> c <span style="color:#0000FF;font-weight: bold">as</span> ContainerCell <span style="color:#0000FF;font-weight: bold">in</span> mCellContainers
				c.AdjustContainerSize
			<span style="color:#0000FF;font-weight: bold">next</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mCellContainers() <span style="color:#0000FF;font-weight: bold">As</span> ContainerCell</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mRowCount <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ContainerCell <span style="color:#0000FF;font-weight: bold">Inherits</span> ContainerControl</div>
<div class="RB_Code">		ComputedProperty Column <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> ListColumnTV = ListColumnTV (mColumn.Value)
				<span style="color:#0000FF;font-weight: bold">return</span> c.ColumnIndex
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty Row <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mRow
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control PushButton1 <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance PushButton1 <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				MsgBox <span style="color:#6500FE">&quot;This</span> <span style="color:#6500FE">is</span> <span style="color:#6500FE">Row</span> <span style="color:#6500FE">&quot;</span>+Str(<span style="color:#0000FF;font-weight: bold">self</span>.Row)+<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">Col</span> <span style="color:#6500FE">&quot;</span>+Str(<span style="color:#0000FF;font-weight: bold">self</span>.Column)
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control LabelHeading <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance LabelHeading <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AdjustContainerSize()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">function</span> <span style="color:#7F0000;text-style:italic">needs</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">called</span> <span style="color:#7F0000;text-style:italic">whenever</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Listbox</span> <span style="color:#7F0000;text-style:italic">may</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">its</span> <span style="color:#7F0000;text-style:italic">cells</span> <span style="color:#7F0000;text-style:italic">resized,</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">order</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">re-adjust</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ContainerControl</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">fits</span> <span style="color:#7F0000;text-style:italic">into</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">TableView</span> <span style="color:#7F0000;text-style:italic">Cell.</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> lb <span style="color:#0000FF;font-weight: bold">as</span> ListboxTV = ListboxTV(mListbox.Value)
			<span style="color:#0000FF;font-weight: bold">dim</span> col <span style="color:#0000FF;font-weight: bold">as</span> NSTableColumnMBS = NSTableColumnMBS (mColumn.Value)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ContainerControl&#39;s</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">column&#39;s</span> <span style="color:#7F0000;text-style:italic">width</span>
			<span style="color:#0000FF;font-weight: bold">me</span>.Width = col.Width
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Resizing</span> <span style="color:#7F0000;text-style:italic">may</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">also</span> <span style="color:#7F0000;text-style:italic">changed</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">control&#39;s</span> <span style="color:#7F0000;text-style:italic">origin,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">reset</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">0,0:</span>
			<span style="color:#0000FF;font-weight: bold">me</span>.NSViewMBS.frame = <span style="color:#0000FF;font-weight: bold">new</span> NSRectMBS (<span style="color:#326598">0</span>, <span style="color:#326598">0</span>, <span style="color:#0000FF;font-weight: bold">me</span>.Width, <span style="color:#0000FF;font-weight: bold">me</span>.Height)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(owner <span style="color:#0000FF;font-weight: bold">as</span> ListBoxTV, column <span style="color:#0000FF;font-weight: bold">as</span> NSTableColumnMBS, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			mListbox = <span style="color:#0000FF;font-weight: bold">new</span> WeakRef (owner)
			mColumn = <span style="color:#0000FF;font-weight: bold">new</span> WeakRef (column)
			mRow = row
			
			<span style="color:#0000FF;font-weight: bold">self</span>.LabelHeading.Text = <span style="color:#6500FE">&quot;Row</span> <span style="color:#6500FE">&quot;</span>+Str(<span style="color:#0000FF;font-weight: bold">self</span>.Row)+<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">Col</span> <span style="color:#6500FE">&quot;</span>+Str(<span style="color:#0000FF;font-weight: bold">self</span>.Column)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mColumn <span style="color:#0000FF;font-weight: bold">As</span> WeakRef</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mListbox <span style="color:#0000FF;font-weight: bold">As</span> WeakRef</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mRow <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ListBoxTV <span style="color:#0000FF;font-weight: bold">Inherits</span> NSTableControlMBS</div>
<div class="RB_Code">		ComputedProperty AutoHideScrollBars <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					mDelayedHideScrollers = value
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">me</span>.autohidesScrollers = value
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">return</span> mDelayedHideScrollers
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">me</span>.autohidesScrollers
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty ColumnCount <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					mDelayedColumnCount = value
				<span style="color:#0000FF;font-weight: bold">else</span>
					
					<span style="color:#0000FF;font-weight: bold">if</span> value &lt; <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">then</span> value = <span style="color:#326598">1</span>
					
					<span style="color:#0000FF;font-weight: bold">dim</span> newUbound <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = value-<span style="color:#326598">1</span>
					
					<span style="color:#0000FF;font-weight: bold">if</span> newUbound = mCols.Ubound <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">no</span> <span style="color:#7F0000;text-style:italic">change</span>
						<span style="color:#0000FF;font-weight: bold">return</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Add</span> <span style="color:#7F0000;text-style:italic">columns</span>
					<span style="color:#0000FF;font-weight: bold">while</span> newUbound &gt; mCols.Ubound
						<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> ListColumnTV (mSelfRef, mCols.Ubound+<span style="color:#326598">1</span>)
						mCols.Append c
						c.title = Str(mCols.Ubound)
						mTableView.addTableColumn c
					<span style="color:#0000FF;font-weight: bold">wend</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Remove</span> <span style="color:#7F0000;text-style:italic">columns</span>
					<span style="color:#0000FF;font-weight: bold">while</span> mCols.Ubound &gt; newUbound
						mTableView.removeTableColumn (mCols.Pop)
					<span style="color:#0000FF;font-weight: bold">wend</span>
					
					mDataSource.DataSource_SetColumnCount value
					
					_needsReload
					
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">return</span> mDelayedColumnCount
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">return</span> mCols.Ubound+<span style="color:#326598">1</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty ColumnWidths <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					mDelayedColumnWidths = value
				<span style="color:#0000FF;font-weight: bold">else</span>
					
					<span style="color:#0000FF;font-weight: bold">dim</span> w() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>
					<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> <span style="color:#0000FF;font-weight: bold">in</span> value.Split(<span style="color:#6500FE">&quot;,&quot;</span>)
						w.Append s
					<span style="color:#0000FF;font-weight: bold">next</span>
					<span style="color:#0000FF;font-weight: bold">redim</span> w(mCols.Ubound)
					
					<span style="color:#0000FF;font-weight: bold">if</span> value = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">or</span> w.Ubound &lt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">User</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">any</span> <span style="color:#7F0000;text-style:italic">rules</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">widths</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">one</span> <span style="color:#7F0000;text-style:italic">column</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">let&#39;s</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">TableView&#39;s</span> <span style="color:#7F0000;text-style:italic">auto</span> <span style="color:#7F0000;text-style:italic">resizing</span>
						
						mHasDynamicColumnWidths = <span style="color:#0000FF;font-weight: bold">false</span>
						mTableView.columnAutoresizingStyle = mDefaultColumnAutoresizingStyle
						
					<span style="color:#0000FF;font-weight: bold">else</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">User</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">explicit</span> <span style="color:#7F0000;text-style:italic">rules</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">widths</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">our</span> <span style="color:#7F0000;text-style:italic">own</span> <span style="color:#7F0000;text-style:italic">resizing</span> <span style="color:#7F0000;text-style:italic">implementation</span> <span style="color:#7F0000;text-style:italic">(see</span> <span style="color:#7F0000;text-style:italic">&#39;_recalcColumnWidths&#39;)</span>
						
						<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> mCols.Ubound
							<span style="color:#0000FF;font-weight: bold">dim</span> col <span style="color:#0000FF;font-weight: bold">as</span> ListColumnTV = mCols(i)
							col.WidthExpression = w(i)
						<span style="color:#0000FF;font-weight: bold">next</span>
						
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">return</span> mDelayedColumnWidths
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> res() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>
					<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> col <span style="color:#0000FF;font-weight: bold">as</span> ListColumnTV <span style="color:#0000FF;font-weight: bold">in</span> mCols
						<span style="color:#0000FF;font-weight: bold">if</span> mMaintainColumnWidths <span style="color:#0000FF;font-weight: bold">then</span>
							res.Append col.WidthExpression
						<span style="color:#0000FF;font-weight: bold">else</span>
							res.Append Str (col.WidthActual,<span style="color:#6500FE">&quot;-#&quot;</span>)
						<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">next</span>
					<span style="color:#0000FF;font-weight: bold">return</span> Join (res, <span style="color:#6500FE">&quot;,&quot;</span>)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty ColumnsResizable <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					mDelayedColumnResizing = value
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">me</span>.allowsColumnResizing = value
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">return</span> mDelayedColumnResizing
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">me</span>.allowsColumnResizing
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty DataSource <span style="color:#0000FF;font-weight: bold">As</span> ListBoxTVDataSource</div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> value = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
					value = <span style="color:#0000FF;font-weight: bold">new</span> ListBoxTV_Support.ListBoxTVStaticDataSource (mSelfRef)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				mDataSource = value
				
				mDataSource.DataSource_SetColumnCount mCols.Ubound+<span style="color:#326598">1</span>
				
				<span style="color:#0000FF;font-weight: bold">me</span>.Reload() <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">needs</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">reload</span> <span style="color:#7F0000;text-style:italic">without</span> <span style="color:#7F0000;text-style:italic">delay,</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">rowCount</span> <span style="color:#7F0000;text-style:italic">won&#39;t</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">inquired</span> <span style="color:#7F0000;text-style:italic">before</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">redraw</span> <span style="color:#7F0000;text-style:italic">may</span> <span style="color:#7F0000;text-style:italic">occur</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mDataSource
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty EnableDrag <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				mEnableDrag = value
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mEnableDrag
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty EnableDragReorder <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				mEnableDragReorder = value
				<span style="color:#0000FF;font-weight: bold">if</span> value <span style="color:#0000FF;font-weight: bold">then</span>
					mTableView.registerForDraggedTypes <span style="color:#0000FF;font-weight: bold">Array</span> (<span style="color:#6500FE">&quot;private.EnableDragReorder&quot;</span>)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mEnableDragReorder
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty GridLinesHorizontal <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">const</span> NSTableViewDashedHorizontalGridLineMask = <span style="color:#326598">8</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
				<span style="color:#0000FF;font-weight: bold">select</span> <span style="color:#0000FF;font-weight: bold">case</span> value
				<span style="color:#0000FF;font-weight: bold">case</span> ListBox.BorderDefault, ListBox.BorderNone
					v = NSTableViewMBS.NSTableViewGridNone
				<span style="color:#0000FF;font-weight: bold">case</span> ListBox.BorderThinDotted
					v = NSTableViewMBS.NSTableViewSolidHorizontalGridLineMask <span style="color:#0000FF;font-weight: bold">or</span> NSTableViewDashedHorizontalGridLineMask
				<span style="color:#0000FF;font-weight: bold">else</span>
					v = NSTableViewMBS.NSTableViewSolidHorizontalGridLineMask
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">select</span>
				
				<span style="color:#0000FF;font-weight: bold">me</span>.TableView.gridStyleMask = (<span style="color:#0000FF;font-weight: bold">me</span>.TableView.gridStyleMask <span style="color:#0000FF;font-weight: bold">AND</span> <span style="color:#0000FF;font-weight: bold">NOT</span> (NSTableViewMBS.NSTableViewSolidHorizontalGridLineMask <span style="color:#0000FF;font-weight: bold">or</span> NSTableViewDashedHorizontalGridLineMask)) <span style="color:#0000FF;font-weight: bold">OR</span> v
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">const</span> NSTableViewDashedHorizontalGridLineMask = <span style="color:#326598">8</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#0000FF;font-weight: bold">me</span>.TableView.gridStyleMask <span style="color:#0000FF;font-weight: bold">AND</span> (NSTableViewMBS.NSTableViewSolidHorizontalGridLineMask <span style="color:#0000FF;font-weight: bold">or</span> NSTableViewDashedHorizontalGridLineMask)
				<span style="color:#0000FF;font-weight: bold">if</span> (v <span style="color:#0000FF;font-weight: bold">AND</span> NSTableViewDashedHorizontalGridLineMask) &lt;&gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">return</span> ListBox.BorderThinDotted
				<span style="color:#0000FF;font-weight: bold">elseif</span> v &lt;&gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">return</span> ListBox.BorderThinSolid
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">return</span> ListBox.BorderNone
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty GridLinesVertical <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
				<span style="color:#0000FF;font-weight: bold">select</span> <span style="color:#0000FF;font-weight: bold">case</span> value
				<span style="color:#0000FF;font-weight: bold">case</span> ListBox.BorderDefault, ListBox.BorderNone
					v = NSTableViewMBS.NSTableViewGridNone
				<span style="color:#0000FF;font-weight: bold">else</span>
					v = NSTableViewMBS.NSTableViewSolidVerticalGridLineMask
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">select</span>
				<span style="color:#0000FF;font-weight: bold">me</span>.TableView.gridStyleMask = (<span style="color:#0000FF;font-weight: bold">me</span>.TableView.gridStyleMask <span style="color:#0000FF;font-weight: bold">AND</span> <span style="color:#0000FF;font-weight: bold">NOT</span> NSTableViewMBS.NSTableViewSolidVerticalGridLineMask) <span style="color:#0000FF;font-weight: bold">OR</span> v
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#0000FF;font-weight: bold">me</span>.TableView.gridStyleMask <span style="color:#0000FF;font-weight: bold">AND</span> NSTableViewMBS.NSTableViewSolidVerticalGridLineMask
				<span style="color:#0000FF;font-weight: bold">if</span> v &lt;&gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">return</span> ListBox.BorderThinSolid
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">return</span> ListBox.BorderNone
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty HasHeading <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> value &lt;&gt; <span style="color:#0000FF;font-weight: bold">me</span>.HasHeading <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">if</span> value <span style="color:#0000FF;font-weight: bold">then</span>
						mTableView.headerView = mHeaderView
					<span style="color:#0000FF;font-weight: bold">else</span>
						mTableView.headerView = <span style="color:#0000FF;font-weight: bold">nil</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mTableView.headerView &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty IntercellSpacing <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">dim</span> ss <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> NSSizeMBS
				ss.Width = value
				ss.Height = value
				<span style="color:#0000FF;font-weight: bold">self</span>.TableView.intercellSpacing = ss
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty ListCount <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mDataSource.DataSource_RowCount
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty ListIndex <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> value &gt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">and</span> value &lt; <span style="color:#0000FF;font-weight: bold">me</span>.ListCount <span style="color:#0000FF;font-weight: bold">then</span>
					mTableView.selectRowIndexes (NSIndexSetMBS.indexSetWithIndex(value), <span style="color:#0000FF;font-weight: bold">false</span>)
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">me</span>.DeselectAll
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> mSelectionCache.count = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">return</span> -<span style="color:#326598">1</span>
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">return</span> mSelectionCache.firstIndex
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty MaintainColumnWidths <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
<div class="RB_Comment">			True: Emulate Xojo's algorithm to keep columns sized based on "%" and "*" values in ColumnWidths or Columns(n).WidthExpression.
			False: If ColumnWidths is set, the columns are adjusted once. After that, they are maintained by NSTableView's columnAutoresizingStyle property.</div></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				mMaintainColumnWidths = value
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mMaintainColumnWidths
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty RequiresSelection <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					mDelayedRequiresSelection = value
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">me</span>.allowsEmptySelection = <span style="color:#0000FF;font-weight: bold">not</span> value
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">return</span> mDelayedRequiresSelection
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">not</span> <span style="color:#0000FF;font-weight: bold">me</span>.allowsEmptySelection
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty ScrollPosition <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#7F0000;text-style:italic">&#39;</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#326598">0</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty ScrollbarHorizontal <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					mDelayedHorScroller = value
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">me</span>.hasHorizontalScroller = value
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">return</span> mDelayedHorScroller
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">me</span>.hasHorizontalScroller
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty ScrollbarVertical <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					mDelayedVerScroller = value
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">me</span>.hasVerticalScroller = value
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">return</span> mDelayedVerScroller
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">me</span>.hasVerticalScroller
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty SelectionType <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					mDelayedSelectionType = value
				<span style="color:#0000FF;font-weight: bold">else</span>
					mTableView.allowsMultipleSelection = value &lt;&gt; <span style="color:#326598">0</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">return</span> mDelayedSelectionType
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">if</span> mTableView.allowsMultipleSelection <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#326598">1</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty SortedColumn <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Note:</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">method</span> <span style="color:#7F0000;text-style:italic">should</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">depress</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">header,</span> <span style="color:#7F0000;text-style:italic">i.e.</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">indicate</span> <span style="color:#7F0000;text-style:italic">sorting,</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">does</span> <span style="color:#7F0000;text-style:italic">currently.</span> <span style="color:#7F0000;text-style:italic">Not</span> <span style="color:#7F0000;text-style:italic">perfect,</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">should</span> <span style="color:#7F0000;text-style:italic">work</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">most</span> <span style="color:#7F0000;text-style:italic">cases.</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">return</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Re-arrange</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">existing</span> <span style="color:#7F0000;text-style:italic">sort</span> <span style="color:#7F0000;text-style:italic">descriptors</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">specified</span> <span style="color:#7F0000;text-style:italic">column</span> <span style="color:#7F0000;text-style:italic">comes</span> <span style="color:#7F0000;text-style:italic">first</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> sorters() <span style="color:#0000FF;font-weight: bold">as</span> NSSortDescriptorMBS = mTableView.sortDescriptors()
				<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> sorter <span style="color:#0000FF;font-weight: bold">as</span> NSSortDescriptorMBS <span style="color:#0000FF;font-weight: bold">in</span> sorters
					<span style="color:#0000FF;font-weight: bold">dim</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = mTableView.columnWithIdentifier (sorter.key)
					<span style="color:#0000FF;font-weight: bold">if</span> col = value <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">found</span> <span style="color:#7F0000;text-style:italic">it</span>
						<span style="color:#0000FF;font-weight: bold">dim</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = sorters.IndexOf (sorter)
						<span style="color:#0000FF;font-weight: bold">if</span> i &lt;&gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
							sorters.Remove i
							sorters.Insert <span style="color:#326598">0</span>, sorter
							mTableView.setSortDescriptors sorters
						<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
						<span style="color:#0000FF;font-weight: bold">return</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">next</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">there</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">no</span> <span style="color:#7F0000;text-style:italic">sort</span> <span style="color:#7F0000;text-style:italic">descriptors</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">our</span> <span style="color:#7F0000;text-style:italic">column,</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">our</span> <span style="color:#7F0000;text-style:italic">ListColumnTV</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> col <span style="color:#0000FF;font-weight: bold">as</span> ListColumnTV = Column(value)
				sorters.Insert <span style="color:#326598">0</span>, col.SortDescriptorPrototype
				mTableView.setSortDescriptors sorters
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">dim</span> sorters() <span style="color:#0000FF;font-weight: bold">as</span> NSSortDescriptorMBS = mTableView.sortDescriptors()
				<span style="color:#0000FF;font-weight: bold">if</span> sorters.Ubound &gt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> firstSorter <span style="color:#0000FF;font-weight: bold">as</span> NSSortDescriptorMBS = sorters(<span style="color:#326598">0</span>)
					<span style="color:#0000FF;font-weight: bold">return</span> mTableView.columnWithIdentifier (firstSorter.key)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty TextFont <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				mTextFont = value
				_needsReload
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mTextFont
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty TextSize <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				mTextSize = value
				_needsReload
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mTextSize
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty UseContextualClickEvent <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
<div class="RB_Comment">			Set this to True if you want to use the ContextualMenu events.</div></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				mUseContextualClickEvent = value
				<span style="color:#0000FF;font-weight: bold">if</span> value <span style="color:#0000FF;font-weight: bold">then</span>
					mTableView.menu = mContextMenu
				<span style="color:#0000FF;font-weight: bold">else</span>
					mTableView.menu = <span style="color:#0000FF;font-weight: bold">nil</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mUseContextualClickEvent
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty UseFocusRing <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> value <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">me</span>.ScrollView.focusRingType = NSScrollViewMBS.NSFocusRingTypeExterior
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">me</span>.ScrollView.focusRingType = NSScrollViewMBS.NSFocusRingTypeNone
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">me</span>.ScrollView.focusRingType = NSScrollViewMBS.NSFocusRingTypeExterior
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> DragReorderPBType = <span style="color:#6500FE">&quot;private.DragReorder&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> Support_OSX_10_6 = <span style="color:#0000FF;font-weight: bold">true</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> Version = <span style="color:#326598">5</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Enum</span> columnWidthCalcTypes
			actual
			minimum
			maximum
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Enum</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Enum</span> columnWidthTypes
			absolute
			percentage
			remain
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Enum</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> CellAction(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> CellBackgroundPaint(g <span style="color:#0000FF;font-weight: bold">As</span> Graphics, row <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, textFrame <span style="color:#0000FF;font-weight: bold">as</span> NSRectMBS, controlView <span style="color:#0000FF;font-weight: bold">as</span> NSViewMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> CellClick(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> CellTextPaint(g <span style="color:#0000FF;font-weight: bold">As</span> Graphics, row <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, textFrame <span style="color:#0000FF;font-weight: bold">as</span> NSRectMBS, controlView <span style="color:#0000FF;font-weight: bold">as</span> NSViewMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> Change()
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> CollapseRow(row <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> ColumnsMoved(oldColumn <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, newColumn <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> ColumnsResized(column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, oldWidth <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> CompareRows(cell1 <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV, cell2 <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV, row1 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, row2 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">ByRef</span> result <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> ConstructContextualMenu(base <span style="color:#0000FF;font-weight: bold">as</span> MenuItem, x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, clickedRow <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, clickedColumn <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, parentMenu <span style="color:#0000FF;font-weight: bold">as</span> NSMenuMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> ConstructContextualMenuForHeader(base <span style="color:#0000FF;font-weight: bold">as</span> MenuItem, x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, clickedColumn <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, parentMenu <span style="color:#0000FF;font-weight: bold">as</span> NSMenuMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> ContextualMenuAction(hitItem <span style="color:#0000FF;font-weight: bold">as</span> MenuItem, clickedRow <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, clickedColumn <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> DenyReorderColumn(fromColumn <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, toColumn <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> DidResizeCells()
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> DragReorderColumns(movedColumn <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, insertColumn <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> DragReorderRows(newPosition <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, parentRow <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> DragRow(drag <span style="color:#0000FF;font-weight: bold">as</span> DragItemTV, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">ByRef</span> operationMask <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">ByRef</span> thisAppOnly <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> DropObject(obj <span style="color:#0000FF;font-weight: bold">as</span> DragItemTV, operationMask <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, aboveRow <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, draggingInfo <span style="color:#0000FF;font-weight: bold">as</span> NSDraggingInfoMBS)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> ExpandRow(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> HeaderPressed(column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> MouseDown(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> Open()
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> SortColumn(column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> WillDisplayCell(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV, textFieldCell <span style="color:#0000FF;font-weight: bold">as</span> NSCellMBS, tableColumn <span style="color:#0000FF;font-weight: bold">as</span> NSTableColumnMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Event</span> didTile()
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Event</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> ColumnDidMove(notification <span style="color:#0000FF;font-weight: bold">as</span> NSNotificationMBS, OldColumn <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, NewColumn <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			mInsideHeaderDrag = <span style="color:#0000FF;font-weight: bold">false</span>
			mIgnoreTileEvents = <span style="color:#0000FF;font-weight: bold">false</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> indexes() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> col <span style="color:#0000FF;font-weight: bold">as</span> ListColumnTV <span style="color:#0000FF;font-weight: bold">in</span> mCols
				col._updateOwnIndex
				indexes.Append col.ColumnIndex
			<span style="color:#0000FF;font-weight: bold">next</span>
			indexes.SortWith mCols
			
			mDataSource.DataSource_MoveColumn (oldColumn, newColumn)
			
			<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> ColumnsMoved(oldColumn, newColumn)
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> ColumnDidResize(notification <span style="color:#0000FF;font-weight: bold">as</span> NSNotificationMBS, tableColumn <span style="color:#0000FF;font-weight: bold">as</span> NSTableColumnMBS, OldWidth <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>)
			<span style="color:#0000FF;font-weight: bold">if</span> mInsideHeaderDrag <span style="color:#0000FF;font-weight: bold">then</span>
				mInsideHeaderDrag = <span style="color:#0000FF;font-weight: bold">false</span>
				mIgnoreTileEvents = <span style="color:#0000FF;font-weight: bold">false</span>
				<span style="color:#0000FF;font-weight: bold">me</span>.updateColumnWidthExpressions
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Does</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">cursor</span> <span style="color:#7F0000;text-style:italic">remain</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">&quot;Resizing&quot;</span> <span style="color:#7F0000;text-style:italic">state?</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">happens</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">Real</span> <span style="color:#7F0000;text-style:italic">Studio</span> <span style="color:#7F0000;text-style:italic">2012,</span> <span style="color:#7F0000;text-style:italic">however,</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">Xojo</span> <span style="color:#7F0000;text-style:italic">2016.</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mIgnoreTileEvents <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> ColumnsResized (ListColumnTV(tableColumn).ColumnIndex, oldWidth)
			<span style="color:#0000FF;font-weight: bold">end</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> ConstructContextualMenu(base <span style="color:#0000FF;font-weight: bold">as</span> MenuItem, x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#7F0000;text-style:italic">&#39;</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> ContextualMenuAction(hitItem <span style="color:#0000FF;font-weight: bold">as</span> MenuItem) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#7F0000;text-style:italic">&#39;</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> DropObject(obj <span style="color:#0000FF;font-weight: bold">As</span> DragItem, action <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			break
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> MouseDown(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, Modifiers <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> handleMouseDown (x, y, modifiers)
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#0000FF;font-weight: bold">me</span>.setDelayedProperties()
			<span style="color:#0000FF;font-weight: bold">me</span>.setupFromInitialValue()
			
			<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> Open()
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> SelectionDidChange(notification <span style="color:#0000FF;font-weight: bold">as</span> NSNotificationMBS)
			mSelectionCache = mTableView.selectedRowIndexes()
			
			<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> Change()
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> acceptDrop(info <span style="color:#0000FF;font-weight: bold">as</span> NSDraggingInfoMBS, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, dropOperation <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finishes</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">drop</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> pb <span style="color:#0000FF;font-weight: bold">as</span> NSPasteboardMBS = info.draggingPasteboard
			<span style="color:#0000FF;font-weight: bold">dim</span> operationMask <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = info.draggingSourceOperationMask
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Is</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">moved</span> <span style="color:#7F0000;text-style:italic">row?</span>
			<span style="color:#0000FF;font-weight: bold">if</span> mEnableDragReorder <span style="color:#0000FF;font-weight: bold">and</span> info.draggingSource = mTableView <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> mb <span style="color:#0000FF;font-weight: bold">as</span> MemoryBlock = pb.dataForType(DragReorderPBType)
				<span style="color:#0000FF;font-weight: bold">if</span> mb &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> srcRows() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
					<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> mb.Size-<span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">step</span> <span style="color:#326598">4</span>
						srcRows.Append mb.Int32Value(i)
					<span style="color:#0000FF;font-weight: bold">next</span>
					<span style="color:#0000FF;font-weight: bold">me</span>.SelectRows srcRows <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">makes</span> <span style="color:#7F0000;text-style:italic">sure</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">moved</span> <span style="color:#7F0000;text-style:italic">rows</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">selected</span> <span style="color:#7F0000;text-style:italic">because</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">DragReorderRows</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">expects</span> <span style="color:#7F0000;text-style:italic">that</span>
					<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> DragReorderRows (row, -<span style="color:#326598">1</span>) <span style="color:#0000FF;font-weight: bold">then</span>
						mDataSource.DataSource_MoveRows (srcRows, row)
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">true</span> <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">-&gt;</span> <span style="color:#7F0000;text-style:italic">drop</span> <span style="color:#7F0000;text-style:italic">was</span> <span style="color:#7F0000;text-style:italic">successful</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Send</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">DropObject</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">handler</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> dragItems <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> DragItemTV (pb)
			<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> DropObject (dragItems, operationMask, row, info) <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">should</span> <span style="color:#7F0000;text-style:italic">pass</span> <span style="color:#7F0000;text-style:italic">&quot;Action</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">Integer&quot;</span> <span style="color:#7F0000;text-style:italic">here,</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">I</span> <span style="color:#7F0000;text-style:italic">don&#39;t</span> <span style="color:#7F0000;text-style:italic">know</span> <span style="color:#7F0000;text-style:italic">how</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">translation</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">operationMask</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">supposed</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">done.</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> dataCell(tableColumn <span style="color:#0000FF;font-weight: bold">as</span> NSTableColumnMBS, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Int64</span>) <span style="color:#0000FF;font-weight: bold">As</span> NSCellMBS
			<span style="color:#0000FF;font-weight: bold">if</span> tableColumn = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">nil</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> tcol <span style="color:#0000FF;font-weight: bold">as</span> ListColumnTV = ListColumnTV(tableColumn)
			<span style="color:#0000FF;font-weight: bold">dim</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = tcol.ColumnIndex
			<span style="color:#0000FF;font-weight: bold">dim</span> myCell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = _cell(row, col)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> t <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = myCell.Type
			
			<span style="color:#0000FF;font-weight: bold">if</span> t = ListBox.TypeCheckbox <span style="color:#0000FF;font-weight: bold">or</span> (t = ListBox.TypeDefault <span style="color:#0000FF;font-weight: bold">and</span> tcol.Type = ListBox.TypeCheckbox) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">A</span> <span style="color:#7F0000;text-style:italic">checkbox</span> <span style="color:#7F0000;text-style:italic">cell</span>
				<span style="color:#0000FF;font-weight: bold">static</span> bc <span style="color:#0000FF;font-weight: bold">as</span> NSButtonCellMBS
				<span style="color:#0000FF;font-weight: bold">if</span> bc = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">once</span>
					bc = <span style="color:#0000FF;font-weight: bold">new</span> NSButtonCellMBS (<span style="color:#6500FE">&quot;x&quot;</span>)
					<span style="color:#0000FF;font-weight: bold">declare</span> <span style="color:#0000FF;font-weight: bold">sub</span> setButtonType <span style="color:#0000FF;font-weight: bold">lib</span> <span style="color:#6500FE">&quot;Cocoa&quot;</span> selector <span style="color:#6500FE">&quot;setButtonType:&quot;</span> (h <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, t <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
					setButtonType (bc.Handle, NSButtonMBS.NSSwitchButton)
					bc.wraps = <span style="color:#0000FF;font-weight: bold">false</span>
					bc.lineBreakMode = NSParagraphStyleMBS.NSLineBreakByTruncatingTail
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">return</span> bc
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">We</span> <span style="color:#7F0000;text-style:italic">return</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">custom</span> <span style="color:#7F0000;text-style:italic">NSTextFieldCell,</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">order</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">perform</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">custom</span> <span style="color:#7F0000;text-style:italic">painting</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">its</span> <span style="color:#7F0000;text-style:italic">drawWithFrame</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">handler.</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">We</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">lazy</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">re-use</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">same</span> <span style="color:#7F0000;text-style:italic">cell,</span> <span style="color:#7F0000;text-style:italic">because</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">keep</span> <span style="color:#7F0000;text-style:italic">getting</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">called</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">each</span> <span style="color:#7F0000;text-style:italic">drawn</span> <span style="color:#7F0000;text-style:italic">cell,</span> <span style="color:#7F0000;text-style:italic">sequentially.</span>
			<span style="color:#0000FF;font-weight: bold">static</span> cc <span style="color:#0000FF;font-weight: bold">as</span> ListBoxTV_Support.ListDrawCellHandler
			<span style="color:#0000FF;font-weight: bold">if</span> cc = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				cc = <span style="color:#0000FF;font-weight: bold">new</span> ListBoxTV_Support.ListDrawCellHandler (mSelfRef)
				cc.editable = <span style="color:#0000FF;font-weight: bold">true</span>
				cc.wraps = <span style="color:#0000FF;font-weight: bold">false</span>
				cc.lineBreakMode = NSParagraphStyleMBS.NSLineBreakByTruncatingTail
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">return</span> cc
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> didClickTableColumn(tableColumn <span style="color:#0000FF;font-weight: bold">as</span> NSTableColumnMBS)
			mInsideHeaderDrag = <span style="color:#0000FF;font-weight: bold">false</span>
			mIgnoreTileEvents = <span style="color:#0000FF;font-weight: bold">false</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = ListColumnTV(tableColumn).ColumnIndex
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> HeaderPressed (column) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">handled</span>
				<span style="color:#0000FF;font-weight: bold">return</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">me</span>.SortedColumn = column
			
			_sort
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> didDragTableColumn(tableColumn <span style="color:#0000FF;font-weight: bold">as</span> NSTableColumnMBS)
			mInsideHeaderDrag = <span style="color:#0000FF;font-weight: bold">false</span>
			mIgnoreTileEvents = <span style="color:#0000FF;font-weight: bold">false</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> didTile()
			<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> didTile
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mIgnoreTileEvents <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">if</span> mMaintainColumnWidths <span style="color:#0000FF;font-weight: bold">then</span>
					_recalcColumnWidths()
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> mouseDownInHeaderOfTableColumn(tableColumn <span style="color:#0000FF;font-weight: bold">as</span> NSTableColumnMBS)
			<span style="color:#0000FF;font-weight: bold">if</span> mMaintainColumnWidths <span style="color:#0000FF;font-weight: bold">then</span>
				mIgnoreTileEvents = <span style="color:#0000FF;font-weight: bold">true</span>
				mInsideHeaderDrag = <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> numberOfRowsInTableView() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mDataSource.DataSource_RowCount()
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> objectValue(column <span style="color:#0000FF;font-weight: bold">as</span> NSTableColumnMBS, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> Variant
			<span style="color:#0000FF;font-weight: bold">dim</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = ListColumnTV(column).ColumnIndex
			<span style="color:#0000FF;font-weight: bold">dim</span> myCell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = _cell (row, col, <span style="color:#0000FF;font-weight: bold">true</span>)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> t <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = myCell.Type
			<span style="color:#0000FF;font-weight: bold">if</span> t = ListBox.TypeCheckbox <span style="color:#0000FF;font-weight: bold">or</span> (t = ListBox.TypeDefault <span style="color:#0000FF;font-weight: bold">and</span> ListColumnTV(column).Type = ListBox.TypeCheckbox) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">checkbox</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">return</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Checkbox</span> <span style="color:#7F0000;text-style:italic">value,</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">its</span> <span style="color:#7F0000;text-style:italic">title</span> <span style="color:#7F0000;text-style:italic">text</span>
				<span style="color:#0000FF;font-weight: bold">return</span> myCell.Checked
			<span style="color:#0000FF;font-weight: bold">end</span>
			
			<span style="color:#0000FF;font-weight: bold">return</span> myCell.Text
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> setObjectValue(value <span style="color:#0000FF;font-weight: bold">as</span> Variant, column <span style="color:#0000FF;font-weight: bold">as</span> NSTableColumnMBS, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = ListColumnTV(column).ColumnIndex
			<span style="color:#0000FF;font-weight: bold">dim</span> myCell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = _cell (row, col)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> isCheckbox <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> t <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = myCell.Type
			<span style="color:#0000FF;font-weight: bold">if</span> t = ListBox.TypeCheckbox <span style="color:#0000FF;font-weight: bold">or</span> (t = ListBox.TypeDefault <span style="color:#0000FF;font-weight: bold">and</span> ListColumnTV(column).Type = ListBox.TypeCheckbox) <span style="color:#0000FF;font-weight: bold">then</span>
				isCheckbox = <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">end</span>
			
			mDataSource.DataSource_CellWillUpdate (row, col, myCell, <span style="color:#0000FF;font-weight: bold">not</span> isCheckbox, isCheckbox)
			
			<span style="color:#0000FF;font-weight: bold">if</span> isCheckbox <span style="color:#0000FF;font-weight: bold">then</span>
				myCell.Checked = value.BooleanValue
			<span style="color:#0000FF;font-weight: bold">elseif</span> value <span style="color:#0000FF;font-weight: bold">isA</span> NSAttributedStringMBS <span style="color:#0000FF;font-weight: bold">then</span>
				myCell.Text = NSAttributedStringMBS(value).text
			<span style="color:#0000FF;font-weight: bold">else</span>
				myCell.Text = value.StringValue
			<span style="color:#0000FF;font-weight: bold">end</span>
			
			mDataSource.DataSource_CellDidUpdate (row, col, myCell, <span style="color:#0000FF;font-weight: bold">not</span> isCheckbox, isCheckbox)
			
			<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> CellAction (row, col)
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> shouldEditTableColumn(tableColumn <span style="color:#0000FF;font-weight: bold">as</span> NSTableColumnMBS, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Int64</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> t <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = ListColumnTV(tableColumn).EffectiveType(row)
			<span style="color:#0000FF;font-weight: bold">return</span> t = ListBox.TypeEditable <span style="color:#0000FF;font-weight: bold">or</span> t = ListBox.TypeCheckbox
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> shouldReorderColumn(columnIndex <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Int64</span>, newColumnIndex <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Int64</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">not</span> <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> DenyReorderColumn (columnIndex, newColumnIndex)
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> validateDrop(info <span style="color:#0000FF;font-weight: bold">as</span> NSDraggingInfoMBS, proposedRow <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, dropOperation <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Determines</span> <span style="color:#7F0000;text-style:italic">whether</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">row</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">accepted</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">drop</span> <span style="color:#7F0000;text-style:italic">target</span>
			<span style="color:#0000FF;font-weight: bold">if</span> mEnableDragReorder <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">if</span> dropOperation = NSTableViewMBS.NSTableViewDropAbove <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> operationMask <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = info.draggingSourceOperationMask
					<span style="color:#0000FF;font-weight: bold">return</span> operationMask
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> willDisplayCell(cell <span style="color:#0000FF;font-weight: bold">as</span> NSCellMBS, tableColumn <span style="color:#0000FF;font-weight: bold">as</span> NSTableColumnMBS, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Int64</span>)
			<span style="color:#0000FF">#if</span> Support_OSX_10_6
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">We&#39;re</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">outdated</span> <span style="color:#7F0000;text-style:italic">NSCells</span> <span style="color:#7F0000;text-style:italic">instead</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">NSViews</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">keep</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">control</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">OSX</span> <span style="color:#7F0000;text-style:italic">10.6.</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">prefer</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">custom</span> <span style="color:#7F0000;text-style:italic">NSViews</span> <span style="color:#7F0000;text-style:italic">(e.g.</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">order</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">add</span> <span style="color:#7F0000;text-style:italic">buttons,</span> <span style="color:#7F0000;text-style:italic">input</span> <span style="color:#7F0000;text-style:italic">fields,</span> <span style="color:#7F0000;text-style:italic">checkboxes</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">more</span> <span style="color:#7F0000;text-style:italic">labels),</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">implement</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTV.view</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">there&#39;s</span> <span style="color:#7F0000;text-style:italic">code</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">event,</span> <span style="color:#7F0000;text-style:italic">then</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">ListBoxTV.willDisplayCell</span> <span style="color:#7F0000;text-style:italic">won&#39;t</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">invoked,</span> <span style="color:#7F0000;text-style:italic">i.e.</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">end</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">modern</span> <span style="color:#7F0000;text-style:italic">NSView</span> <span style="color:#7F0000;text-style:italic">based</span> <span style="color:#7F0000;text-style:italic">TableView.</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = ListColumnTV(tableColumn).ColumnIndex
				<span style="color:#0000FF;font-weight: bold">dim</span> myCell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = _cell (row, col)
				<span style="color:#0000FF;font-weight: bold">dim</span> tfc <span style="color:#0000FF;font-weight: bold">as</span> NSTextFieldCellMBS
				<span style="color:#0000FF;font-weight: bold">dim</span> bc <span style="color:#0000FF;font-weight: bold">as</span> NSButtonCellMBS
				
				<span style="color:#0000FF;font-weight: bold">if</span> cell <span style="color:#0000FF;font-weight: bold">isA</span> NSButtonCellMBS <span style="color:#0000FF;font-weight: bold">then</span>
					bc = NSButtonCellMBS(cell)
				<span style="color:#0000FF;font-weight: bold">else</span>
					tfc = NSTextFieldCellMBS(cell)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Preset</span> <span style="color:#7F0000;text-style:italic">font</span>
				<span style="color:#0000FF;font-weight: bold">if</span> mTextFont &lt;&gt; <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">and</span> mTextFont &lt;&gt; <span style="color:#6500FE">&quot;System&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
					cell.font = NSFontMBS.fontWithName (mTextFont, mTextSize)
				<span style="color:#0000FF;font-weight: bold">elseif</span> mTextSize &gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					cell.font = NSFontMBS.systemFontOfSize (mTextSize)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> WillDisplayCell (row, col, myCell, cell, tableColumn) <span style="color:#0000FF;font-weight: bold">then</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Button</span> <span style="color:#7F0000;text-style:italic">title</span>
					<span style="color:#0000FF;font-weight: bold">if</span> bc &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
						bc.title = myCell.text
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Cell</span> <span style="color:#7F0000;text-style:italic">text</span> <span style="color:#7F0000;text-style:italic">color</span>
					<span style="color:#0000FF;font-weight: bold">if</span> tfc &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#0000FF;font-weight: bold">if</span> myCell.TextColor &lt;&gt; &amp;c<span style="color:#FF0000">00</span><span style="color:#00FF00">00</span><span style="color:#0000FF">00</span>00 <span style="color:#0000FF;font-weight: bold">then</span>
							<span style="color:#0000FF;font-weight: bold">dim</span> xc <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Color</span> = myCell.TextColor
							<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> NSColorMBS = NSColorMBS.colorWithCalibratedRGB (xc.Red/<span style="color:#326598">255</span>, xc.Green/<span style="color:#326598">255</span>, xc.Blue/<span style="color:#326598">255</span>, <span style="color:#326598">1</span>-xc.Alpha/<span style="color:#326598">255</span>)
							tfc.textColor = c
						<span style="color:#0000FF;font-weight: bold">else</span>
							tfc.textColor = <span style="color:#0000FF;font-weight: bold">nil</span>
						<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Cell</span> <span style="color:#7F0000;text-style:italic">background</span> <span style="color:#7F0000;text-style:italic">color</span>
					<span style="color:#0000FF;font-weight: bold">if</span> myCell.BackgroundColor &lt;&gt; &amp;c<span style="color:#FF0000">FF</span><span style="color:#00FF00">FF</span><span style="color:#0000FF">FF</span>FF <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#0000FF;font-weight: bold">dim</span> xc <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Color</span> = myCell.BackgroundColor
						<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> NSColorMBS = NSColorMBS.colorWithCalibratedRGB (xc.Red/<span style="color:#326598">255</span>, xc.Green/<span style="color:#326598">255</span>, xc.Blue/<span style="color:#326598">255</span>, <span style="color:#326598">1</span>-xc.Alpha/<span style="color:#326598">255</span>)
						<span style="color:#0000FF;font-weight: bold">if</span> bc &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
							bc.backgroundColor = c
						<span style="color:#0000FF;font-weight: bold">else</span>
							tfc.backgroundColor = c
							<span style="color:#0000FF">#if</span> <span style="color:#0000FF;font-weight: bold">false</span> <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">handle</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">ListDrawCellHandler.drawWithFrame</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">also</span> <span style="color:#7F0000;text-style:italic">works</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">indented</span> <span style="color:#7F0000;text-style:italic">text</span>
								tfc.drawsBackground = <span style="color:#0000FF;font-weight: bold">true</span>
							<span style="color:#0000FF">#endif</span>
						<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">elseif</span> bc &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
						bc.backgroundColor = <span style="color:#0000FF;font-weight: bold">nil</span>
					<span style="color:#0000FF;font-weight: bold">else</span>
						tfc.backgroundColor = <span style="color:#0000FF;font-weight: bold">nil</span>
						tfc.drawsBackground = <span style="color:#0000FF;font-weight: bold">false</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Cell</span> <span style="color:#7F0000;text-style:italic">text</span> <span style="color:#7F0000;text-style:italic">alignment</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> align <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
					<span style="color:#0000FF;font-weight: bold">if</span> myCell.alignment &lt;&gt; ListBox.AlignDefault <span style="color:#0000FF;font-weight: bold">then</span>
						align = myCell.alignment
					<span style="color:#0000FF;font-weight: bold">else</span>
						align = ListColumnTV(tableColumn).Alignment
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">select</span> <span style="color:#0000FF;font-weight: bold">case</span> align
					<span style="color:#0000FF;font-weight: bold">case</span> ListBox.AlignDefault
						align = NSTextMBS.NSNaturalTextAlignment
					<span style="color:#0000FF;font-weight: bold">case</span> ListBox.AlignLeft
						align = NSTextMBS.NSLeftTextAlignment
					<span style="color:#0000FF;font-weight: bold">case</span> ListBox.AlignRight
						align = NSTextMBS.NSRightTextAlignment
					<span style="color:#0000FF;font-weight: bold">case</span> ListBox.AlignCenter
						align = NSTextMBS.NSCenterTextAlignment
					<span style="color:#0000FF;font-weight: bold">case</span> ListBox.AlignDecimal
						align = NSTextMBS.NSJustifiedTextAlignment
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">select</span>
					cell.alignment = align
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Cell</span> <span style="color:#7F0000;text-style:italic">text</span> <span style="color:#7F0000;text-style:italic">indentation</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">background</span> <span style="color:#7F0000;text-style:italic">drawing</span> <span style="color:#7F0000;text-style:italic">(handled</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">ListDrawCellHandler.drawWithFrame)</span>
					<span style="color:#0000FF;font-weight: bold">if</span> tfc &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#0000FF;font-weight: bold">if</span> tfc <span style="color:#0000FF;font-weight: bold">isA</span> ListBoxTV_Support.ListDrawCellHandler <span style="color:#0000FF;font-weight: bold">then</span>
							ListBoxTV_Support.ListDrawCellHandler(tfc).cell = myCell
						<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">else</span>
						<span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">unfortunately,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">cannot</span> <span style="color:#7F0000;text-style:italic">indent</span> <span style="color:#7F0000;text-style:italic">checkbox</span> <span style="color:#7F0000;text-style:italic">cells</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
			<span style="color:#0000FF">#endif</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> writeRowsWithIndexes(rowIndexes <span style="color:#0000FF;font-weight: bold">as</span> NSIndexSetMBS, pboard <span style="color:#0000FF;font-weight: bold">as</span> NSPasteboardMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> didAdd <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			
			<span style="color:#0000FF;font-weight: bold">call</span> pboard.clearContents
			
			<span style="color:#0000FF;font-weight: bold">if</span> mEnableDrag <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">me</span>.SelectRows rowIndexes.Values <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">makes</span> <span style="color:#7F0000;text-style:italic">sure</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">dragged</span> <span style="color:#7F0000;text-style:italic">rows</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">selected</span> <span style="color:#7F0000;text-style:italic">because</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">DragRow</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">expects</span> <span style="color:#7F0000;text-style:italic">that</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> drag <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> DragItemTV (pboard)
				<span style="color:#0000FF;font-weight: bold">dim</span> operationMask <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = NSDraggingInfoMBS.NSDragOperationEvery <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Xojo</span> <span style="color:#7F0000;text-style:italic">uses</span> <span style="color:#7F0000;text-style:italic">NSDragOperationEvery,</span> <span style="color:#7F0000;text-style:italic">Real</span> <span style="color:#7F0000;text-style:italic">Studio</span> <span style="color:#7F0000;text-style:italic">used</span> <span style="color:#7F0000;text-style:italic">NSDragOperationAll_Obsolete</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> locally <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = <span style="color:#0000FF;font-weight: bold">false</span>
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> DragRow (drag, rowIndexes.firstIndex, operationMask, locally) <span style="color:#0000FF;font-weight: bold">then</span>
					drag.FinishAddedItems
					mTableView.setDraggingSourceOperationMask (operationMask, locally)
					didAdd = <span style="color:#0000FF;font-weight: bold">true</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> mEnableDragReorder <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Put</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">moved</span> <span style="color:#7F0000;text-style:italic">rows</span> <span style="color:#7F0000;text-style:italic">into</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">MemoryBlock</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">pass</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">private</span> <span style="color:#7F0000;text-style:italic">data</span> <span style="color:#7F0000;text-style:italic">item</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">pasteboard</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> rows() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = rowIndexes.Values()
				<span style="color:#0000FF;font-weight: bold">dim</span> mb <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> MemoryBlock (<span style="color:#326598">4</span> * (rows.Ubound+<span style="color:#326598">1</span>))
				<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> rows.Ubound
					mb.Int32Value (<span style="color:#326598">4</span>*i) = rows(i)
				<span style="color:#0000FF;font-weight: bold">next</span>
				pboard.dataForType (DragReorderPBType) = mb
				didAdd = <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">return</span> didAdd
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AcceptFileDrop(type <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			mTableView.registerForDraggedTypes <span style="color:#0000FF;font-weight: bold">Array</span> (NSPasteboardMBS.NSFilenamesPboardType, <span style="color:#6500FE">&quot;public.file-url&quot;</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AcceptMacDataDrop(type <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			<span style="color:#0000FF;font-weight: bold">me</span>.AcceptRawDataDrop (type)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AcceptPictureDrop()
			break <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">missing</span> <span style="color:#7F0000;text-style:italic">(needs</span> <span style="color:#7F0000;text-style:italic">methods</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">DragItemTV,</span> <span style="color:#7F0000;text-style:italic">too)</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AcceptRawDataDrop(type <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			mTableView.registerForDraggedTypes <span style="color:#0000FF;font-weight: bold">Array</span> (ListBoxTV_Support.convertOSType(type))
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AcceptTextDrop()
			mTableView.registerForDraggedTypes <span style="color:#0000FF;font-weight: bold">Array</span> (NSPasteboardMBS.NSStringPboardType, NSPasteboardMBS.NSPasteboardTypeString)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddRow(items() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			addItems items
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddRow(<span style="color:#0000FF;font-weight: bold">ParamArray</span> items <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			addItems items
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> Cell(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">return</span> _cell(row,column).Text
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Cell(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			_cell(row,column).Text = v
			_needsReload()
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> CellAlignment(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = _cell(row, column)
			<span style="color:#0000FF;font-weight: bold">return</span> cell.Alignment
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> CellAlignment(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = _cell(row, column)
			<span style="color:#0000FF;font-weight: bold">if</span> cell.Alignment &lt;&gt; v <span style="color:#0000FF;font-weight: bold">then</span>
				cell.Alignment = v
				_needsReload()
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> CellAlignmentOffset(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = _cell(row, column)
			<span style="color:#0000FF;font-weight: bold">return</span> cell.Indentation
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> CellAlignmentOffset(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = _cell(row, column)
			<span style="color:#0000FF;font-weight: bold">if</span> cell.Indentation &lt;&gt; v <span style="color:#0000FF;font-weight: bold">then</span>
				cell.Indentation = v
				_needsReload()
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> CellBold(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> _cell(row, column).Bold
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> CellBold(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)
			<span style="color:#0000FF;font-weight: bold">if</span> _cell(row, column).Bold &lt;&gt; v <span style="color:#0000FF;font-weight: bold">then</span>
				_cell(row, column).Bold = v
				_needsReload()
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> CellCheck(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> _cell(row, column).Checked
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> CellCheck(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)
			<span style="color:#0000FF;font-weight: bold">if</span> _cell(row, column).Checked &lt;&gt; v <span style="color:#0000FF;font-weight: bold">then</span>
				_cell(row, column).Checked = v
				_needsReload()
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> CellHelpTag(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">return</span> _cell(row, column).ToolTip
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> CellHelpTag(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			_cell(row, column).ToolTip = v
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> CellItalic(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> _cell(row, column).Italic
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> CellItalic(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)
			<span style="color:#0000FF;font-weight: bold">if</span> _cell(row, column).Italic &lt;&gt; v <span style="color:#0000FF;font-weight: bold">then</span>
				_cell(row, column).Italic = v
				_needsReload()
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> CellStyle(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> ListCellTV
			<span style="color:#0000FF;font-weight: bold">return</span> _cell(row,column)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> CellTag(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> Variant
			<span style="color:#0000FF;font-weight: bold">return</span> _cell(row,column).tag
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> CellTag(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> v <span style="color:#0000FF;font-weight: bold">as</span> Variant)
			_cell(row,column).tag = v
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> CellType(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = _cell(row, column)
			<span style="color:#0000FF;font-weight: bold">return</span> cell.Type
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> CellType(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = _cell(row, column)
			<span style="color:#0000FF;font-weight: bold">if</span> cell.Type &lt;&gt; v <span style="color:#0000FF;font-weight: bold">then</span>
				cell.Type = v
				_needsReload()
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> Column(col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> ListColumnTV
			<span style="color:#0000FF;font-weight: bold">return</span> mCols(col)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> ColumnAlignment(column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mCols(column).Alignment
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> ColumnAlignment(column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			mCols(column).Alignment = v
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> ColumnAlignmentOffset(column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mCols(column).AlignmentOffset
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> ColumnAlignmentOffset(column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			mCols(column).AlignmentOffset = v
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> ColumnFromXY(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> loc0 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> NSPointMBS (x, y)
			<span style="color:#0000FF;font-weight: bold">dim</span> loc <span style="color:#0000FF;font-weight: bold">as</span> NSPointMBS = mTableView.convertPointFromView (loc0, <span style="color:#0000FF;font-weight: bold">me</span>.ScrollView)
			<span style="color:#0000FF;font-weight: bold">return</span> mTableView.columnAtPoint (loc)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> ColumnSortDirection(column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mCols(column).SortDirection
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> ColumnSortDirection(column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> dir <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			mCols(column).SortDirection = dir
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> ColumnType(column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mCols(column).Type
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> ColumnType(column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			mCols(column).Type = v
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">We</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">weak</span> <span style="color:#7F0000;text-style:italic">ref</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">ourselves</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">pass</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">our</span> <span style="color:#7F0000;text-style:italic">chiild</span> <span style="color:#7F0000;text-style:italic">classes</span> <span style="color:#7F0000;text-style:italic">instead</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">them</span> <span style="color:#7F0000;text-style:italic">creating</span> <span style="color:#7F0000;text-style:italic">more</span> <span style="color:#7F0000;text-style:italic">WeakRefs</span> <span style="color:#7F0000;text-style:italic">(this</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">performance</span> <span style="color:#7F0000;text-style:italic">optimization)</span>
			mSelfRef = <span style="color:#0000FF;font-weight: bold">new</span> WeakRef (<span style="color:#0000FF;font-weight: bold">me</span>)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Our</span> <span style="color:#7F0000;text-style:italic">separate</span> <span style="color:#7F0000;text-style:italic">class</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">handling</span> <span style="color:#7F0000;text-style:italic">listbox</span> <span style="color:#7F0000;text-style:italic">content</span> <span style="color:#7F0000;text-style:italic">(can</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">replaced</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">user)</span>
			mDataSource = <span style="color:#0000FF;font-weight: bold">new</span> ListBoxTV_Support.ListBoxTVStaticDataSource (mSelfRef)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">local</span> <span style="color:#7F0000;text-style:italic">properties</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">cleaner</span> <span style="color:#7F0000;text-style:italic">access</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">tableview</span> <span style="color:#7F0000;text-style:italic">properties</span>
			mTableView = <span style="color:#0000FF;font-weight: bold">me</span>.View
			mHeaderView = mTableView.headerView
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Context</span> <span style="color:#7F0000;text-style:italic">Menu</span> <span style="color:#7F0000;text-style:italic">preparation</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">Cells</span>
			mContextMenu = <span style="color:#0000FF;font-weight: bold">new</span> ListBoxTV_Support.ListBoxTVContextMenu (mSelfRef)
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Context</span> <span style="color:#7F0000;text-style:italic">Menu</span> <span style="color:#7F0000;text-style:italic">preparation</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Header,</span> <span style="color:#7F0000;text-style:italic">see</span> <span style="color:#7F0000;text-style:italic">http://stackoverflow.com/a/3850215/43615</span>
			mTableView.headerView.menu = mContextMenu
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Let&#39;s</span> <span style="color:#7F0000;text-style:italic">preset</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">columns</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">automatic</span> <span style="color:#7F0000;text-style:italic">resizing</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">overwritten</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">code</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">Open()</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">later,</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">disabled</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">setting</span> <span style="color:#7F0000;text-style:italic">ColumnWidths</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">non-empty</span> <span style="color:#7F0000;text-style:italic">string.</span>
			mDefaultColumnAutoresizingStyle = NSTableViewMBS.NSTableViewUniformColumnAutoresizingStyle
			mTableView.columnAutoresizingStyle = mDefaultColumnAutoresizingStyle
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">We</span> <span style="color:#7F0000;text-style:italic">cache</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">performance</span> <span style="color:#7F0000;text-style:italic">reasons</span> <span style="color:#7F0000;text-style:italic">(not</span> <span style="color:#7F0000;text-style:italic">sure</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">that&#39;s</span> <span style="color:#7F0000;text-style:italic">necessary,</span> <span style="color:#7F0000;text-style:italic">though)</span>
			mSelectionCache = NSIndexSetMBS.indexSet()
			
			<span style="color:#0000FF;font-weight: bold">super</span>.Constructor
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DeleteAllRows()
			mDataSource.DataSource_DeleteAllRows
			<span style="color:#0000FF;font-weight: bold">me</span>.ScrollPosition = <span style="color:#326598">0</span>
			mLastAddedIndex = -<span style="color:#326598">1</span>
			
			<span style="color:#0000FF;font-weight: bold">me</span>.Reload() <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">needs</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">reload</span> <span style="color:#7F0000;text-style:italic">without</span> <span style="color:#7F0000;text-style:italic">delay,</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">rowCount</span> <span style="color:#7F0000;text-style:italic">won&#39;t</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">inquired</span> <span style="color:#7F0000;text-style:italic">before</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">redraw</span> <span style="color:#7F0000;text-style:italic">may</span> <span style="color:#7F0000;text-style:italic">occur</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DeselectAll()
			mTableView.deselectAll
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> Expanded(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			break <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">supported</span> <span style="color:#7F0000;text-style:italic">here</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">code</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">&quot;ListBox</span> <span style="color:#7F0000;text-style:italic">TableView</span> <span style="color:#7F0000;text-style:italic">(Hierarchical).rbp&quot;</span> <span style="color:#7F0000;text-style:italic">instead</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Expanded(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> exp <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)
			break <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">supported</span> <span style="color:#7F0000;text-style:italic">here</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">code</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">&quot;ListBox</span> <span style="color:#7F0000;text-style:italic">TableView</span> <span style="color:#7F0000;text-style:italic">(Hierarchical).rbp&quot;</span> <span style="color:#7F0000;text-style:italic">instead</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> HeaderHeight() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mTableView.headerView.frame.Height
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> Heading(col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mCols(col).headerCell.stringValue
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Heading(col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> txt <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			mCols(col).headerCell.stringValue = txt
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> InvalidateCell(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">We&#39;re</span> <span style="color:#7F0000;text-style:italic">lazy</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">simply</span> <span style="color:#7F0000;text-style:italic">reload</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">entire</span> <span style="color:#7F0000;text-style:italic">view&#39;s</span> <span style="color:#7F0000;text-style:italic">cells.</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Ideally,</span> <span style="color:#7F0000;text-style:italic">we&#39;re</span> <span style="color:#7F0000;text-style:italic">determine</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">rect</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">row/col</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">then</span> <span style="color:#7F0000;text-style:italic">call</span> <span style="color:#7F0000;text-style:italic">&quot;setNeedsDisplayInRect:&quot;</span> <span style="color:#7F0000;text-style:italic">instead.</span>
			_needsReload()
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> LastIndex() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mLastAddedIndex
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> List(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">me</span>.Cell (row, <span style="color:#326598">0</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> List(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			<span style="color:#0000FF;font-weight: bold">me</span>.Cell (row, <span style="color:#326598">0</span>) = v
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> PressHeader(col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">method,</span> <span style="color:#7F0000;text-style:italic">contrary</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">just</span> <span style="color:#7F0000;text-style:italic">setting</span> <span style="color:#7F0000;text-style:italic">SortedColumn</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">calling</span> <span style="color:#7F0000;text-style:italic">Sort,</span> <span style="color:#7F0000;text-style:italic">should</span> <span style="color:#7F0000;text-style:italic">also</span> <span style="color:#7F0000;text-style:italic">depress</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">header,</span> <span style="color:#7F0000;text-style:italic">whereas</span> <span style="color:#7F0000;text-style:italic">SortedColumn</span> <span style="color:#7F0000;text-style:italic">should</span> <span style="color:#7F0000;text-style:italic">not.</span> <span style="color:#7F0000;text-style:italic">Doesn&#39;t</span> <span style="color:#7F0000;text-style:italic">work</span> <span style="color:#7F0000;text-style:italic">right</span> <span style="color:#7F0000;text-style:italic">yet,</span> <span style="color:#7F0000;text-style:italic">though</span>
			<span style="color:#0000FF;font-weight: bold">me</span>.SortedColumn = col
			<span style="color:#0000FF;font-weight: bold">me</span>.Sort
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> RecalculateColumnWidths()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Call</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">after</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">column</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">entire</span> <span style="color:#7F0000;text-style:italic">control</span> <span style="color:#7F0000;text-style:italic">got</span> <span style="color:#7F0000;text-style:italic">resized</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">want</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">keep</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">&quot;*&quot;</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">&quot;%&quot;</span> <span style="color:#7F0000;text-style:italic">column</span> <span style="color:#7F0000;text-style:italic">widths</span> <span style="color:#7F0000;text-style:italic">re-applied</span>
			_recalcColumnWidths()
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Reload()
			_reloadNow(<span style="color:#0000FF;font-weight: bold">nil</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> RowFromXY(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> loc0 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> NSPointMBS (x, y)
			<span style="color:#0000FF;font-weight: bold">dim</span> loc <span style="color:#0000FF;font-weight: bold">as</span> NSPointMBS = mTableView.convertPointFromView (loc0, <span style="color:#0000FF;font-weight: bold">me</span>.ScrollView)
			<span style="color:#0000FF;font-weight: bold">return</span> mTableView.rowAtPoint (loc)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> RowHeight() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">return</span> Round (mTableView.rowHeight)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> RowPicture(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> Picture
			<span style="color:#0000FF;font-weight: bold">return</span> _cell(row,<span style="color:#326598">0</span>).picture
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> RowPicture(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> pic <span style="color:#0000FF;font-weight: bold">as</span> Picture)
			_cell(row,<span style="color:#326598">0</span>).picture = pic
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> RowTag(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> Variant
			<span style="color:#0000FF;font-weight: bold">return</span> mDataSource.DataSource_RowTag(row)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> RowTag(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> tag <span style="color:#0000FF;font-weight: bold">as</span> Variant)
			mDataSource.DataSource_RowTag(row) = tag
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> SelCount() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mSelectionCache.count
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> SelectRows(rows() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> <span style="color:#0000FF;font-weight: bold">set</span> <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> NSMutableIndexSetMBS
			<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> <span style="color:#0000FF;font-weight: bold">in</span> rows
				<span style="color:#0000FF;font-weight: bold">set</span>.addIndex row
			<span style="color:#0000FF;font-weight: bold">next</span>
			mSelectionCache = <span style="color:#0000FF;font-weight: bold">set</span>
			mTableView.selectRowIndexes mSelectionCache, <span style="color:#0000FF;font-weight: bold">false</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> Selected(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mSelectionCache.containsIndex (row)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Selected(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> sel <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> isSelected <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = mSelectionCache.containsIndex (row)
			<span style="color:#0000FF;font-weight: bold">if</span> isSelected &lt;&gt; sel <span style="color:#0000FF;font-weight: bold">then</span>
				mSelectionCache = mSelectionCache.mutableCopy
				<span style="color:#0000FF;font-weight: bold">if</span> sel <span style="color:#0000FF;font-weight: bold">then</span>
					NSMutableIndexSetMBS(mSelectionCache).addIndex row
				<span style="color:#0000FF;font-weight: bold">else</span>
					NSMutableIndexSetMBS(mSelectionCache).removeIndex row
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				mTableView.selectRowIndexes mSelectionCache, <span style="color:#0000FF;font-weight: bold">false</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> SelectedRows() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>()
			<span style="color:#0000FF;font-weight: bold">return</span> mSelectionCache.Values
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Sort()
			_sort
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> TableView() <span style="color:#0000FF;font-weight: bold">As</span> NSTableViewMBS
			<span style="color:#0000FF;font-weight: bold">return</span> mTableView
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> UpdateColumnWidthExpressions()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Takes</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">column</span> <span style="color:#7F0000;text-style:italic">widths</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">adjusts</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListColumnTV.WidthExpression</span> <span style="color:#7F0000;text-style:italic">values</span> <span style="color:#7F0000;text-style:italic">accordingly</span>
			
			_suppressReload = <span style="color:#0000FF;font-weight: bold">true</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> colSpacing <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = mTableView.intercellSpacing.Width <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">extra</span> <span style="color:#7F0000;text-style:italic">space</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">every</span> <span style="color:#7F0000;text-style:italic">visible</span> <span style="color:#7F0000;text-style:italic">column</span> <span style="color:#7F0000;text-style:italic">occupies</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Determine</span> <span style="color:#7F0000;text-style:italic">total</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">first</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> totalWidth <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">for</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> mCols.Ubound
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> ListColumnTV = mCols(col)
				<span style="color:#0000FF;font-weight: bold">dim</span> w <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Round (c.width)
				<span style="color:#0000FF;font-weight: bold">if</span> w &gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> w = w + colSpacing
				totalWidth = totalWidth + w
			<span style="color:#0000FF;font-weight: bold">next</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Now</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">expressions</span> <span style="color:#7F0000;text-style:italic">(absolute</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">percentage)</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> remainWidth <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = totalWidth
			<span style="color:#0000FF;font-weight: bold">dim</span> asteriskValues() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> lowestAsteriskWidth <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = totalWidth
			<span style="color:#0000FF;font-weight: bold">for</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> mCols.Ubound
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> ListColumnTV = mCols(col)
				<span style="color:#0000FF;font-weight: bold">dim</span> w <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = Round (c.width)
				<span style="color:#0000FF;font-weight: bold">dim</span> expr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = mCols(col).WidthExpression
				<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> t <span style="color:#0000FF;font-weight: bold">as</span> columnWidthTypes = determineColumnWidthType (columnWidthCalcTypes.actual, expr, v)
				<span style="color:#0000FF;font-weight: bold">if</span> t = columnWidthTypes.absolute <span style="color:#0000FF;font-weight: bold">or</span> (t = columnWidthTypes.remain <span style="color:#0000FF;font-weight: bold">and</span> w = <span style="color:#326598">0</span>) <span style="color:#0000FF;font-weight: bold">then</span>
					c.WidthExpression = Str(w,<span style="color:#6500FE">&quot;-#&quot;</span>)
					asteriskValues.Append <span style="color:#326598">0</span>
					<span style="color:#0000FF;font-weight: bold">if</span> w &gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> w = w + colSpacing
					remainWidth = remainWidth - w
				<span style="color:#0000FF;font-weight: bold">elseif</span> t = columnWidthTypes.percentage <span style="color:#0000FF;font-weight: bold">then</span>
					c.WidthExpression = ListBoxTV_Support.trimPeriod (Str (w / totalWidth * <span style="color:#326598">100</span>,<span style="color:#6500FE">&quot;-#.#####&quot;</span>)) + <span style="color:#6500FE">&quot;%&quot;</span>
					asteriskValues.Append <span style="color:#326598">0</span>
					<span style="color:#0000FF;font-weight: bold">if</span> w &gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> w = w + colSpacing
					remainWidth = remainWidth - w
				<span style="color:#0000FF;font-weight: bold">else</span>
					asteriskValues.Append w
					remainWidth = remainWidth - colSpacing
					<span style="color:#0000FF;font-weight: bold">if</span> w &lt; lowestAsteriskWidth <span style="color:#0000FF;font-weight: bold">then</span> lowestAsteriskWidth = w
				<span style="color:#0000FF;font-weight: bold">end</span>
			<span style="color:#0000FF;font-weight: bold">next</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Finally,</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">asterisk</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">expressions</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> scale <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span> = remainWidth / lowestAsteriskWidth <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">don&#39;t</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">any</span> <span style="color:#7F0000;text-style:italic">asterisk</span> <span style="color:#7F0000;text-style:italic">values</span> <span style="color:#7F0000;text-style:italic">below</span> <span style="color:#7F0000;text-style:italic">1</span>
			<span style="color:#0000FF;font-weight: bold">for</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> mCols.Ubound
				<span style="color:#0000FF;font-weight: bold">dim</span> w <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = asteriskValues(col)
				<span style="color:#0000FF;font-weight: bold">if</span> w &lt;&gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> ListColumnTV = mCols(col)
					c.WidthExpression = ListBoxTV_Support.trimPeriod (Str (Max (<span style="color:#326598">1</span>, w / remainWidth * scale),<span style="color:#6500FE">&quot;-#.########&quot;</span>)) + <span style="color:#6500FE">&quot;*&quot;</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">next</span>
			
			<span style="color:#0000FF;font-weight: bold">finally</span>
			_suppressReload = <span style="color:#0000FF;font-weight: bold">false</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> _cell(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, ignoreCache <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = <span style="color:#0000FF;font-weight: bold">false</span>) <span style="color:#0000FF;font-weight: bold">As</span> ListCellTV
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> ignoreCache <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">if</span> mPreviousCell &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">and</span> mPreviousCell._internalUse.Left = row <span style="color:#0000FF;font-weight: bold">and</span> mPreviousCell._internalUse.Right = column <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Usually,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">three</span> <span style="color:#7F0000;text-style:italic">calls</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">same</span> <span style="color:#7F0000;text-style:italic">cell</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">sequence</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">1st</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">objectValue,</span> <span style="color:#7F0000;text-style:italic">2nd</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">dataCellForTableColumn,</span> <span style="color:#7F0000;text-style:italic">3rd</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">willDisplayCell</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">We</span> <span style="color:#7F0000;text-style:italic">cache</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">cell</span> <span style="color:#7F0000;text-style:italic">here</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">performance</span> <span style="color:#7F0000;text-style:italic">reasons</span>
					<span style="color:#0000FF;font-weight: bold">return</span> mPreviousCell
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = mDataSource.DataSource_Cell (row, column)
			<span style="color:#0000FF;font-weight: bold">if</span> cell = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">an</span> <span style="color:#7F0000;text-style:italic">empty</span> <span style="color:#7F0000;text-style:italic">one</span>
				cell = <span style="color:#0000FF;font-weight: bold">new</span> ListCellTV ()
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			cell._internalUse = row : column
			
			mPreviousCell = cell
			
			<span style="color:#0000FF;font-weight: bold">return</span> cell
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> _cellBackgroundPaint(g <span style="color:#0000FF;font-weight: bold">As</span> Graphics, row <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, textFrame <span style="color:#0000FF;font-weight: bold">as</span> NSRectMBS, controlView <span style="color:#0000FF;font-weight: bold">as</span> NSViewMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> CellBackgroundPaint (g, row, column, textFrame, controlView)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> _cellTextPaint(g <span style="color:#0000FF;font-weight: bold">As</span> Graphics, row <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, textFrame <span style="color:#0000FF;font-weight: bold">as</span> NSRectMBS, controlView <span style="color:#0000FF;font-weight: bold">as</span> NSViewMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> CellTextPaint (g, row, column, x, y, textFrame, controlView)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> _clickedColumn() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mTableView.clickedColumn
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> _clickedRow() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mTableView.clickedRow
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> _compareRows(c1 <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV, c2 <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV, <span style="color:#0000FF;font-weight: bold">ByRef</span> result <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> CompareRows (c1, c2, c1._internalUse.Left, c2._internalUse.Left, c1._internalUse.Right, result)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> _constructContextualMenu(base <span style="color:#0000FF;font-weight: bold">as</span> MenuItem, x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, menu <span style="color:#0000FF;font-weight: bold">as</span> NSMenuMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> res <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			mSelectionCache = mTableView.selectedRowIndexes()
			<span style="color:#0000FF;font-weight: bold">if</span> row &lt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Header</span> <span style="color:#7F0000;text-style:italic">click</span>
				res = <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> ConstructContextualMenuForHeader (base, x, y, column, menu)
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Cell</span> <span style="color:#7F0000;text-style:italic">click</span>
				res = <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> ConstructContextualMenu (base, x, y, row, column, menu)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">return</span> res
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> _contextualMenuAction(hitItem <span style="color:#0000FF;font-weight: bold">as</span> MenuItem, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">call</span> <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> ContextualMenuAction (hitItem, row, column)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> _hasFocus() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">me</span>.Window.Focus = <span style="color:#0000FF;font-weight: bold">me</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> _needsReload(needsRecalcColumnWidths <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = <span style="color:#0000FF;font-weight: bold">false</span>, enableXojoColumnWidths <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = <span style="color:#0000FF;font-weight: bold">false</span>)
			<span style="color:#0000FF;font-weight: bold">if</span> _suppressReload <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">return</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> needsRecalcColumnWidths <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">A</span> <span style="color:#7F0000;text-style:italic">column&#39;s</span> <span style="color:#7F0000;text-style:italic">WidthActual</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">WidthExpression</span> <span style="color:#7F0000;text-style:italic">was</span> <span style="color:#7F0000;text-style:italic">set</span>
				mColumnWidthsDirty = <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> enableXojoColumnWidths <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">means</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">WidthExpression</span> <span style="color:#7F0000;text-style:italic">(or</span> <span style="color:#7F0000;text-style:italic">ColumnWidths)</span> <span style="color:#7F0000;text-style:italic">property</span> <span style="color:#7F0000;text-style:italic">was</span> <span style="color:#7F0000;text-style:italic">set.</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">means</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">user</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">may</span> <span style="color:#7F0000;text-style:italic">want</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">dynamic</span> <span style="color:#7F0000;text-style:italic">width</span> <span style="color:#7F0000;text-style:italic">modifiers</span> <span style="color:#7F0000;text-style:italic">(&quot;%&quot;</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">&quot;*&quot;)</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">Xojo</span> <span style="color:#7F0000;text-style:italic">instead</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">default</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">NSTableView&#39;s</span> <span style="color:#7F0000;text-style:italic">columnAutoresizingStyle</span> <span style="color:#7F0000;text-style:italic">modes.</span>
				mHasDynamicColumnWidths = <span style="color:#0000FF;font-weight: bold">true</span>
				mTableView.columnAutoresizingStyle = NSTableViewMBS.NSTableViewLastColumnOnlyAutoresizingStyle
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> mReloadTimer = <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				mReloadTimer = <span style="color:#0000FF;font-weight: bold">new</span> Timer
				<span style="color:#0000FF;font-weight: bold">AddHandler</span> mReloadTimer.Action, <span style="color:#0000FF;font-weight: bold">AddressOf</span> _reloadNow
				mReloadTimer.Period = <span style="color:#326598">0</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			mReloadTimer.Mode = Timer.ModeSingle
			mReloadTimer.Reset
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> _recalcColumnWidths()
			<span style="color:#0000FF">#pragma</span> DisableBackgroundTasks
			
			mColumnWidthsDirty = <span style="color:#0000FF;font-weight: bold">false</span>
			
			mTableView.columnAutoresizingStyle = NSTableViewMBS.NSTableViewLastColumnOnlyAutoresizingStyle
			
			<span style="color:#0000FF;font-weight: bold">dim</span> totalWidth <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#0000FF;font-weight: bold">me</span>.ScrollView.documentVisibleRect.Width
			<span style="color:#0000FF;font-weight: bold">dim</span> remainingWidth <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = totalWidth
			<span style="color:#0000FF;font-weight: bold">dim</span> remainingMinWidth <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = totalWidth
			<span style="color:#0000FF;font-weight: bold">dim</span> remainingMaxWidth <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = totalWidth
			<span style="color:#0000FF;font-weight: bold">dim</span> asteriskCount, asteriskCountMin, asteriskCountMax <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>, asteriskColumnCount <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> actualWidth(), minWidth(), maxWidth() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> colSpacing <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = mTableView.intercellSpacing.Width <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">extra</span> <span style="color:#7F0000;text-style:italic">space</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">every</span> <span style="color:#7F0000;text-style:italic">visible</span> <span style="color:#7F0000;text-style:italic">column</span> <span style="color:#7F0000;text-style:italic">occupies</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">first</span> <span style="color:#7F0000;text-style:italic">pass</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">determine</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">space</span> <span style="color:#7F0000;text-style:italic">occupied</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">non-asterisk</span> <span style="color:#7F0000;text-style:italic">columns</span>
			<span style="color:#0000FF;font-weight: bold">for</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> mCols.Ubound
				<span style="color:#0000FF;font-weight: bold">dim</span> minW, maxW, actW <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, type <span style="color:#0000FF;font-weight: bold">as</span> columnWidthTypes
				type = calcColumnWidth (columnWidthCalcTypes.actual, mCols(col).WidthExpression, totalWidth, mCols.Ubound-col, colSpacing, asteriskCount, remainingWidth, actW)
				<span style="color:#0000FF;font-weight: bold">call</span> calcColumnWidth (columnWidthCalcTypes.minimum, mCols(col).MinWidthExpression, totalWidth, mCols.Ubound-col, colSpacing, asteriskCountMin, remainingMinWidth, minW)
				<span style="color:#0000FF;font-weight: bold">call</span> calcColumnWidth (columnWidthCalcTypes.maximum, mCols(col).MaxWidthExpression, totalWidth, mCols.Ubound-col, colSpacing, asteriskCountMax, remainingMaxWidth, maxW)
				actualWidth.Append actW
				minWidth.Append minW
				maxWidth.Append maxW
				<span style="color:#0000FF;font-weight: bold">if</span> type = columnWidthTypes.remain <span style="color:#0000FF;font-weight: bold">then</span>
					asteriskColumnCount = asteriskColumnCount + <span style="color:#326598">1</span>
				<span style="color:#0000FF;font-weight: bold">end</span>
				<span style="color:#0000FF;font-weight: bold">if</span> type = columnWidthTypes.absolute <span style="color:#0000FF;font-weight: bold">and</span> actW &lt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">and</span> minW &lt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">hide</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">column</span>
					<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mCols(col).Hidden <span style="color:#0000FF;font-weight: bold">then</span>
						mCols(col).Hidden = <span style="color:#0000FF;font-weight: bold">true</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">unhide</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">column</span>
					<span style="color:#0000FF;font-weight: bold">if</span> mCols(col).Hidden <span style="color:#0000FF;font-weight: bold">then</span>
						mCols(col).Hidden = <span style="color:#0000FF;font-weight: bold">false</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">next</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">second</span> <span style="color:#7F0000;text-style:italic">pass</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">determine</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">space</span> <span style="color:#7F0000;text-style:italic">occupied</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">remaining</span> <span style="color:#7F0000;text-style:italic">asterisk</span> <span style="color:#7F0000;text-style:italic">columns</span>
			<span style="color:#0000FF;font-weight: bold">if</span> asteriskCount &gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
				remainingWidth = Round (Max (<span style="color:#326598">0</span>, remainingWidth - asteriskColumnCount * colSpacing))
				<span style="color:#0000FF;font-weight: bold">dim</span> asteriskWidth <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span> = remainingWidth / asteriskCount
				<span style="color:#0000FF;font-weight: bold">dim</span> lastAsteriskCol <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = -<span style="color:#326598">1</span>
				<span style="color:#0000FF;font-weight: bold">for</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> mCols.Ubound
					<span style="color:#0000FF;font-weight: bold">if</span> remainingWidth &lt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> remainingWidth = <span style="color:#326598">0</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> type <span style="color:#0000FF;font-weight: bold">as</span> columnWidthTypes = determineColumnWidthType (columnWidthCalcTypes.actual, mCols(col).WidthExpression, value)
					<span style="color:#0000FF;font-weight: bold">if</span> type = columnWidthTypes.remain <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#0000FF;font-weight: bold">dim</span> columnWidth <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span> = Round (value * asteriskWidth)
						actualWidth(col) = columnWidth
						lastAsteriskCol = col
						remainingWidth = remainingWidth - columnWidth
						asteriskCount = asteriskCount - value
						<span style="color:#0000FF;font-weight: bold">if</span> asteriskCount &lt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">exit</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">next</span>
				<span style="color:#0000FF;font-weight: bold">if</span> lastAsteriskCol &gt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					actualWidth(lastAsteriskCol) = actualWidth(lastAsteriskCol) + remainingWidth
				<span style="color:#0000FF;font-weight: bold">end</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">finally,</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">actual</span> <span style="color:#7F0000;text-style:italic">widths</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">table</span> <span style="color:#7F0000;text-style:italic">view</span>
			mIgnoreTileEvents = <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">for</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> mCols.Ubound
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> ListColumnTV = mCols(col)
				c.minWidth = minWidth(col)
				c.maxWidth = maxWidth(col)
				c.width = actualWidth(col)
			<span style="color:#0000FF;font-weight: bold">next</span>
			
			<span style="color:#0000FF;font-weight: bold">RaiseEvent</span> DidResizeCells()
			
			<span style="color:#0000FF;font-weight: bold">finally</span>
			mIgnoreTileEvents = <span style="color:#0000FF;font-weight: bold">false</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> _reloadNow(t <span style="color:#0000FF;font-weight: bold">as</span> Timer)
			<span style="color:#0000FF;font-weight: bold">if</span> mReloadTimer &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span> mReloadTimer.Mode = Timer.ModeOff
			
			mIgnoreTileEvents = <span style="color:#0000FF;font-weight: bold">false</span>
			mInsideHeaderDrag = <span style="color:#0000FF;font-weight: bold">false</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> mColumnWidthsDirty <span style="color:#0000FF;font-weight: bold">then</span>
				mColumnWidthsDirty = <span style="color:#0000FF;font-weight: bold">false</span>
				<span style="color:#0000FF;font-weight: bold">if</span> mHasDynamicColumnWidths <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">A</span> <span style="color:#7F0000;text-style:italic">column&#39;s</span> <span style="color:#7F0000;text-style:italic">WidthExpression</span> <span style="color:#7F0000;text-style:italic">had</span> <span style="color:#7F0000;text-style:italic">been</span> <span style="color:#7F0000;text-style:italic">set,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">want</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">re-adjust</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">columns</span> <span style="color:#7F0000;text-style:italic">accordingly,</span> <span style="color:#7F0000;text-style:italic">once</span>
					_recalcColumnWidths()
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			mTableView.reloadData
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> mMaintainColumnWidths <span style="color:#0000FF;font-weight: bold">then</span>
				mTableView.columnAutoresizingStyle = mDefaultColumnAutoresizingStyle
			<span style="color:#0000FF;font-weight: bold">end</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> _selectedRow() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mTableView.selectedRow
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> _sort()
			<span style="color:#0000FF;font-weight: bold">dim</span> sorters() <span style="color:#0000FF;font-weight: bold">as</span> NSSortDescriptorMBS = mTableView.sortDescriptors
			<span style="color:#0000FF;font-weight: bold">if</span> sorters.Ubound &lt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">return</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> firstSorter <span style="color:#0000FF;font-weight: bold">as</span> NSSortDescriptorMBS = sorters(<span style="color:#326598">0</span>)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = mTableView.columnWithIdentifier(firstSorter.key)
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> SortColumn (col) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">user&#39;s</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">code</span> <span style="color:#7F0000;text-style:italic">handled</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">sorting</span>
				<span style="color:#0000FF;font-weight: bold">return</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			mDataSource.DataSource_SortRows sorters
			
			mTableView.reloadData
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> addItems(items() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			<span style="color:#0000FF;font-weight: bold">if</span> mDataSource <span style="color:#0000FF;font-weight: bold">isA</span> ListBoxTV_Support.ListBoxTVStaticDataSource <span style="color:#0000FF;font-weight: bold">then</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> col0 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>
				<span style="color:#0000FF;font-weight: bold">if</span> items.Ubound &gt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					col0 = items(<span style="color:#326598">0</span>)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				ListBoxTV_Support.ListBoxTVStaticDataSource(mDataSource).AddRow col0
				
				mLastAddedIndex = mDataSource.DataSource_RowCount-<span style="color:#326598">1</span>
				
				<span style="color:#0000FF;font-weight: bold">for</span> column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">to</span> items.Ubound
					_cell(mLastAddedIndex,column).text = items(column)
				<span style="color:#0000FF;font-weight: bold">next</span>
				
			<span style="color:#0000FF;font-weight: bold">else</span>
				break <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">If</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">assigned</span> <span style="color:#7F0000;text-style:italic">your</span> <span style="color:#7F0000;text-style:italic">own</span> <span style="color:#7F0000;text-style:italic">DataSource,</span> <span style="color:#7F0000;text-style:italic">then</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">cannot</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">AddRow()</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">makes</span> <span style="color:#7F0000;text-style:italic">little</span> <span style="color:#7F0000;text-style:italic">sense</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			_needsReload
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> calcColumnWidth(calcType <span style="color:#0000FF;font-weight: bold">as</span> columnWidthCalcTypes, expr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>, totalWidth <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, colsLeft <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, extraSpace <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">ByRef</span> asterisksInOut <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>, <span style="color:#0000FF;font-weight: bold">ByRef</span> remainWidthInOut <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">ByRef</span> widthOut <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> columnWidthTypes
			<span style="color:#0000FF;font-weight: bold">dim</span> space <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> type <span style="color:#0000FF;font-weight: bold">as</span> columnWidthTypes = determineColumnWidthType (calcType, expr, value)
			
			<span style="color:#0000FF;font-weight: bold">if</span> type = columnWidthTypes.absolute <span style="color:#0000FF;font-weight: bold">then</span>
				space = Round (value)
			<span style="color:#0000FF;font-weight: bold">elseif</span> type = columnWidthTypes.percentage <span style="color:#0000FF;font-weight: bold">then</span>
				space = Round (totalWidth * value / <span style="color:#326598">100</span>)
			<span style="color:#0000FF;font-weight: bold">else</span>
				asterisksInOut = asterisksInOut + Max (<span style="color:#326598">1</span>, value)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			remainWidthInOut = remainWidthInOut - space
			
			<span style="color:#0000FF;font-weight: bold">if</span> space &gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">column</span> <span style="color:#7F0000;text-style:italic">occupies</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">space,</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Cell</span> <span style="color:#7F0000;text-style:italic">will</span> <span style="color:#7F0000;text-style:italic">actually</span> <span style="color:#7F0000;text-style:italic">add</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">more</span> <span style="color:#7F0000;text-style:italic">pixels,</span> <span style="color:#7F0000;text-style:italic">which</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">remove</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">remaining</span> <span style="color:#7F0000;text-style:italic">space</span>
				remainWidthInOut = remainWidthInOut - extraSpace
				<span style="color:#0000FF;font-weight: bold">if</span> remainWidthInOut &lt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">and</span> space &gt; -remainWidthInOut <span style="color:#0000FF;font-weight: bold">then</span>
					space = space + remainWidthInOut
					remainWidthInOut = <span style="color:#326598">0</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			widthOut = space
			
			<span style="color:#0000FF;font-weight: bold">return</span> type
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> determineColumnWidthType(calcType <span style="color:#0000FF;font-weight: bold">as</span> columnWidthCalcTypes, expr <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>, <span style="color:#0000FF;font-weight: bold">ByRef</span> value <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>) <span style="color:#0000FF;font-weight: bold">As</span> columnWidthTypes
			<span style="color:#0000FF">#pragma</span> DisableBackgroundTasks
			
			expr = expr.Trim
			
			<span style="color:#0000FF;font-weight: bold">if</span> expr = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">if</span> calcType = columnWidthCalcTypes.actual <span style="color:#0000FF;font-weight: bold">then</span>
					value = <span style="color:#326598">1</span>
					<span style="color:#0000FF;font-weight: bold">return</span> columnWidthTypes.remain
				<span style="color:#0000FF;font-weight: bold">elseif</span> calcType = columnWidthCalcTypes.maximum <span style="color:#0000FF;font-weight: bold">then</span>
					value = <span style="color:#326598">100</span>
					<span style="color:#0000FF;font-weight: bold">return</span> columnWidthTypes.percentage
				<span style="color:#0000FF;font-weight: bold">else</span>
					value = <span style="color:#326598">0</span>
					<span style="color:#0000FF;font-weight: bold">return</span> columnWidthTypes.absolute
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> number <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>, pos <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">for</span> pos = <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">to</span> expr.Len
				<span style="color:#0000FF;font-weight: bold">dim</span> ch <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = expr.Mid(pos,<span style="color:#326598">1</span>).Asc
				<span style="color:#0000FF;font-weight: bold">if</span> (ch &lt; <span style="color:#326598">48</span> <span style="color:#0000FF;font-weight: bold">or</span> ch &gt; <span style="color:#326598">57</span>) <span style="color:#0000FF;font-weight: bold">and</span> ch &lt;&gt; <span style="color:#326598">46</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">digit</span> <span style="color:#7F0000;text-style:italic">nor</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">period</span> <span style="color:#7F0000;text-style:italic">(.)</span>
					<span style="color:#0000FF;font-weight: bold">exit</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">next</span>
			number = expr.Left(pos-<span style="color:#326598">1</span>).Val
			expr = expr.Mid(pos).Trim
			<span style="color:#0000FF;font-weight: bold">if</span> expr = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">absolute</span> <span style="color:#7F0000;text-style:italic">value</span>
				value = number
				<span style="color:#0000FF;font-weight: bold">return</span> columnWidthTypes.absolute
			<span style="color:#0000FF;font-weight: bold">elseif</span> expr = <span style="color:#6500FE">&quot;%&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">percentage</span>
				value = number
				<span style="color:#0000FF;font-weight: bold">return</span> columnWidthTypes.percentage
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">remaining</span> <span style="color:#7F0000;text-style:italic">space</span>
				value = Max (<span style="color:#326598">1</span>, number)
				<span style="color:#0000FF;font-weight: bold">return</span> columnWidthTypes.remain
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> handleMouseDown(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, modifiers <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> MouseDown (x, y) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">end</span>
			
			<span style="color:#0000FF">#if</span> Target64Bit
				<span style="color:#0000FF;font-weight: bold">declare</span> <span style="color:#0000FF;font-weight: bold">function</span> frameOfCellAtColumn_Row <span style="color:#0000FF;font-weight: bold">lib</span> <span style="color:#6500FE">&quot;Cocoa&quot;</span> selector <span style="color:#6500FE">&quot;frameOfCellAtColumn:row:&quot;</span> (o <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">as</span> NSRect64
			<span style="color:#0000FF">#else</span>
				<span style="color:#0000FF;font-weight: bold">declare</span> <span style="color:#0000FF;font-weight: bold">function</span> frameOfCellAtColumn_Row <span style="color:#0000FF;font-weight: bold">lib</span> <span style="color:#6500FE">&quot;Cocoa&quot;</span> selector <span style="color:#6500FE">&quot;frameOfCellAtColumn:row:&quot;</span> (o <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">as</span> NSRect32
			<span style="color:#0000FF">#endif</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> loc0 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> NSPointMBS (x, y)
			<span style="color:#0000FF;font-weight: bold">dim</span> loc <span style="color:#0000FF;font-weight: bold">as</span> NSPointMBS = mTableView.convertPointFromView (loc0, <span style="color:#0000FF;font-weight: bold">me</span>.ScrollView)
			<span style="color:#0000FF;font-weight: bold">dim</span> row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = mTableView.rowAtPoint (loc)
			<span style="color:#0000FF;font-weight: bold">dim</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = mTableView.columnAtPoint (loc)
			<span style="color:#0000FF;font-weight: bold">dim</span> cellFrame <span style="color:#0000FF;font-weight: bold">as</span> NSRectMBS = mTableView.frameOfCellAtColumnRow (col, row)
			<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">RaiseEvent</span> CellClick (row, col, loc.x - cellFrame.x, loc.y - cellFrame.y)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> setDelayedProperties()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Handle</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">delayed</span> <span style="color:#7F0000;text-style:italic">settings</span> <span style="color:#7F0000;text-style:italic">(appears</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">necessary</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">Real</span> <span style="color:#7F0000;text-style:italic">Studio</span> <span style="color:#7F0000;text-style:italic">2012</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">Xojo</span> <span style="color:#7F0000;text-style:italic">2016)</span>
			mHadOpenEvent = <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">me</span>.ColumnCount = mDelayedColumnCount
			<span style="color:#0000FF;font-weight: bold">me</span>.AutoHideScrollBars = mDelayedHideScrollers
			<span style="color:#0000FF;font-weight: bold">me</span>.ColumnsResizable = mDelayedColumnResizing
			<span style="color:#0000FF;font-weight: bold">me</span>.RequiresSelection = mDelayedRequiresSelection
			<span style="color:#0000FF;font-weight: bold">me</span>.ScrollbarHorizontal = mDelayedHorScroller
			<span style="color:#0000FF;font-weight: bold">me</span>.ScrollbarVertical = mDelayedVerScroller
			<span style="color:#0000FF;font-weight: bold">me</span>.SelectionType = mDelayedSelectionType
			<span style="color:#0000FF;font-weight: bold">me</span>.ColumnWidths = mDelayedColumnWidths
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">me</span>.Hierarchical <span style="color:#0000FF;font-weight: bold">then</span>
				break <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">supported</span> <span style="color:#7F0000;text-style:italic">here</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">code</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">&quot;ListBox</span> <span style="color:#7F0000;text-style:italic">OutlineView.rbp&quot;</span> <span style="color:#7F0000;text-style:italic">instead</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> setupFromInitialValue()
			<span style="color:#0000FF;font-weight: bold">dim</span> rows() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = ReplaceLineEndings(<span style="color:#0000FF;font-weight: bold">me</span>.InitialValue, EndOfLine).Split(EndOfLine)
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">me</span>.HasHeading <span style="color:#0000FF;font-weight: bold">and</span> rows.Ubound &gt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> cols() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = rows(<span style="color:#326598">0</span>).Split(Chr(<span style="color:#326598">9</span>))
				<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> Min (cols.Ubound, <span style="color:#0000FF;font-weight: bold">me</span>.ColumnCount-<span style="color:#326598">1</span>)
					<span style="color:#0000FF;font-weight: bold">me</span>.Heading(i) = cols(i)
				<span style="color:#0000FF;font-weight: bold">next</span>
				rows.Remove <span style="color:#326598">0</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> <span style="color:#0000FF;font-weight: bold">in</span> rows
				<span style="color:#0000FF;font-weight: bold">dim</span> cols() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = row.Split(Chr(<span style="color:#326598">9</span>))
				<span style="color:#0000FF;font-weight: bold">me</span>.AddRow cols(<span style="color:#326598">0</span>)
				<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">to</span> Min (cols.Ubound, <span style="color:#0000FF;font-weight: bold">me</span>.ColumnCount-<span style="color:#326598">1</span>)
					<span style="color:#0000FF;font-weight: bold">me</span>.Cell(mLastAddedIndex, i) = cols(i)
				<span style="color:#0000FF;font-weight: bold">next</span>
			<span style="color:#0000FF;font-weight: bold">next</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;About&quot;</span>
<div class="RB_Comment">			This is a (nearly complete) replacement for Xojo's ListBox control, for Mac OS X.
			
			It requires MBS Plugins 17.1 (March 9, 2017 or later)
			
			Advantages over Xojo's ListBox:
			‚Ä¢ Uses Apple's native NSTableView control, with its proper appearance, hence...
			‚Ä¢ Looks better in a Mac app.
			‚Ä¢ Column resizing works better (observing minimum widths and showing a horizontal scrollbar when necessary).
			‚Ä¢ Support column reordering.
			‚Ä¢ Supports right-clicks (CMM clicks) on the headers.
			‚Ä¢ Correct handling of multiple selected rows, including right-clicks.
			‚Ä¢ Offers more customization options (e.g., you get extra Events from the NSTableView).
			‚Ä¢ ConstructContextualMenu works as it should (i.e. for right clicks and ctrl-clicks).
			‚Ä¢ Faster.
			‚Ä¢ Open Source.
			
			Disadvantages:
			‚Ä¢ Mac-only.
			‚Ä¢ No custom drawing in cells via ...Paint events (but you can instead use NSGraphicsMBS functions).
			‚Ä¢ No support for Database Binding.
			‚Ä¢ Limited grid line options.
			‚Ä¢ A few functions where a -1 parameter designates ALL rows or columns do not work (leading to an OutOfRangeException),
			  such as InvalidateCell(-1,-1).
			
			To use it, copy the entire "ListBox_NSTableView" folder into your project, then change the Super class of your ListBox controls
			to ListBoxTV, and see if your project still compiles and runs.
			
			If you're using the CellBackgroundPaint or CellTextPaint events, see if you're only using it to change the color or
			font of the cells and text. See the note "Handling CellBackgroundPaint and CellTextPaint" for a possible solution.</div>
</div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;Attn</span> <span style="color:#6500FE">sortDescriptorsDidChange&quot;</span>
<div class="RB_Comment">			The sortDescriptorsDidChange event is not implemented here because we handle
			sorting in the tableView's didClickTableColumn event, which is called after this event.</div>
</div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;Authors</span> <span style="color:#6500FE">and</span> <span style="color:#6500FE">Copyright&quot;</span>
<div class="RB_Comment">			Initial author (Feb 2017): Thomas Tempelmann, tempelmann@gmail.com
			
			This code is free, i.e. no contributing author may claim rights (or copyright) on it.
			
			If you add new features, please send them back to Thomas for redistribution.
			Adding a test case for the new feature would be nice, too.</div>
</div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;Handling</span> <span style="color:#6500FE">CellBackgroundPaint</span> <span style="color:#6500FE">and</span> <span style="color:#6500FE">CellTextPaint&quot;</span>
<div class="RB_Comment">			If you implement either of these events to draw custom text or images, they won't work, because the "g as Graphics" parameter will be nil
			(that's a limitation caused by Xojo Inc. because their Plugin API does not supply the needed code for making use of the Graphics class).
			If you only want to have a particular background or text color, you can instead preset them like this:
			
			  myListbox.CellStyle (row, col).TextColor = ...
			  myListbox.CellStyle (row, col).BackgroundColor = ...</div>
</div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;Handling</span> <span style="color:#6500FE">contextual</span> <span style="color:#6500FE">clicks</span> <span style="color:#6500FE">(right</span> <span style="color:#6500FE">click;</span> <span style="color:#6500FE">ctrl-click)&quot;</span>
<div class="RB_Comment">			Since the Xojo ListBox's ConstructContextualMenu event does not handle right clicks (or ctrl-clicks)
			correctly with multiple selections, you may have tried to ignore the event and instead handle such
			clicks in the MouseDown event by checking "IsContextualClick". You may still do that.
			
			But if you plan to use the ConstructContextualMenu, you need to set the ListBoxTV's control's
			UseContextualClickEvent property to True, e.g. right in the Window layout editor for the control,
			so that ConstructContextualMenu gets called as desired.
			
			You should do that (i.e. set UseContextualClickEvent=true and use ConstructContextualMenu)
			over checking for IsContextualClick in the MouseDown event in order to have proper behavior,
			especially when you allow multi-selection in the Listbox.</div>
</div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;NSView</span> <span style="color:#6500FE">vs.</span> <span style="color:#6500FE">NSCell</span> <span style="color:#6500FE">based</span> <span style="color:#6500FE">TableView</span> <span style="color:#6500FE">cells&quot;</span>
<div class="RB_Comment">			By default, the TableView is in NSCell mode, which works with a limited set of predefined layout choices.
			The code handling this layout is found in the ListBoxTV.willDisplayCell() event.
			
			Alternatively, you can supply your own layout by returning a custom NSViewMBS from the ListBoxTV.view()
			event. If the view() event is added, the willDisplayCell() event becomes unused automatically. So, if you
			experiment with returning an NSView and are not happy with it, you need to remove the view() event
			entirely again to revert to using the NSCell mode.
			
			As a simple example, here's how to put a button into every cell. Place the following code into the view() event:
			
			  dim button as new NSButtonMBS
			  button.Title = "Button"
			  return button
			
			To add multiple views, see the forum: https://forum.xojo.com/49354-listboxtv-mbs-plugins</div>
</div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;On-demand</span> <span style="color:#6500FE">Cell</span> <span style="color:#6500FE">values</span> <span style="color:#6500FE">(custom</span> <span style="color:#6500FE">DataSource)&quot;</span>
<div class="RB_Comment">			If you have a lot (thousands) of rows, the performance of Xojo's ListBox will notably decrease.
			
			With this ListBoxTV, you can prevent this.
			
			The solution is to not add your rows and cells beforehand, by using AddRow(), but instead just
			tell the Listbox how many rows you have. The TableView class will then show an adequate scrollbar
			for the entire number of rows, but will only ask you to provide the data for the rows and cells
			it currently shows in the window, which will be usually only a few dozen values. If the user
			scrolls the list, your code will then be asked again for only those new cells, and so on.
			
			To accomplish that, implement the ListBoxTVDataSource interface. Either implement them in a new
			class, or add them to your window or other class that you already maintain for your data.
			You do not need to add code for all its functions, which all begin with "DataSource_". Most of
			them you may leave empty, unless you want to support sorting, row dragging, column dragging or
			editing.
			
			Then set the listbox's DataSource property to your class that implements the ListBoxTVDataSource interface.
			
			The minimum you have to add code to are:
			
			‚Ä¢ DataSource_RowCount() as Integer
			
			Here you need to return the total number of rows you want to be able to show.
			
			‚Ä¢ DataSource_Cell (row as Integer, column as Integer) as ListCellTV
			
			This returns an object of type ListCellTV, which contains the Text property for the cell's display,
			as well as other properties such as Indentation, Alignment etc.
			
			If you want to keep it simple, return this:
			
			  return new ListCellTV (row, column, "here goes the cell's text")
			
			Now, whenever you know the listbox needs to be refreshed, i.e. it should call your DataSource_RowCount()
			and DataSource_Cell() functions again, call the listbox's Reload() function.</div>
</div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;To</span> <span style="color:#6500FE">Do&quot;</span>
<div class="RB_Comment">			Not working, yet:
			
			‚Ä¢ Hierarchical (use the code from "ListBoxTV OutlineView.rbp" instead)
			‚Ä¢ Row Insert + Delete ("ListBoxTV OutlineView.rbp" has a RemoveRow method, at least)
			‚Ä¢ Font attributes (bold, italic) for entire list defaults and for individual cells</div>
</div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;Version</span> <span style="color:#6500FE">History&quot;</span>
<div class="RB_Comment">			Released Versions (oldest first)
			
			3 - (16 Aug 2018)
			
			‚Ä¢ Should now work in 64 bit builds (by fixing NSRect struct usage)
			
			4 - (18 Aug 2018)
			
			‚Ä¢ Fixes the vertical scrollbar gap no matter what the System Preferences "General" / "Show scroll bars" is set to.
			
			5 - (20 Aug 2018)
			
			‚Ä¢ Fixes placement of the ContainerControl (in some circumstance, its original would get moved to negative offsets).
			‚Ä¢ Can now add multiple columns in one AddRow() call.</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> DefaultRowHeight <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Hierarchical <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> InitialValue <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> _suppressReload <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mCols() <span style="color:#0000FF;font-weight: bold">As</span> ListColumnTV</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mColumnWidthsDirty <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mContextMenu <span style="color:#0000FF;font-weight: bold">As</span> ListBoxTV_Support.ListBoxTVContextMenu</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mDataSource <span style="color:#0000FF;font-weight: bold">As</span> ListBoxTVDataSource</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mDefaultColumnAutoresizingStyle <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mDelayedColumnCount <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mDelayedColumnResizing <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mDelayedColumnWidths <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mDelayedHideScrollers <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mDelayedHorScroller <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mDelayedRequiresSelection <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mDelayedSelectionType <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mDelayedVerScroller <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mEnableDrag <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mEnableDragReorder <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mHadOpenEvent <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mHasDynamicColumnWidths <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mHeaderView <span style="color:#0000FF;font-weight: bold">As</span> NSTableHeaderViewMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mIgnoreTileEvents <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mInsideHeaderDrag <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mLastAddedIndex <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mMaintainColumnWidths <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mPreviousCell <span style="color:#0000FF;font-weight: bold">As</span> ListCellTV</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mReloadTimer <span style="color:#0000FF;font-weight: bold">As</span> Timer</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mSelectionCache <span style="color:#0000FF;font-weight: bold">As</span> NSIndexSetMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mSelectionType <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mSelfRef <span style="color:#0000FF;font-weight: bold">As</span> WeakRef
<div class="RB_Comment">			Points to itself. This is an optimization so that we don't have to create multiple WeakRefs in each child object</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mTableView <span style="color:#0000FF;font-weight: bold">As</span> NSTableViewMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mTextFont <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mTextSize <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mUseContextualClickEvent <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Structure</span> NSRect32
			x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Single</span>
			y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Single</span>
			w <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Single</span>
			h <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Single</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Structure</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Structure</span> NSRect64
			x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			w <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			h <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Structure</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Module</span> ListBoxTV_Support</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Protected</span> <span style="color:#0000FF;font-weight: bold">Function</span> convertOSType(t <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">if</span> t.Len = <span style="color:#326598">4</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">convert</span> <span style="color:#7F0000;text-style:italic">OSType</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">UTI</span>
				t = UTTypeMBS.CreatePreferredIdentifierForTag (UTTypeMBS.kUTTagClassOSType, t, UTTypeMBS.kUTTypeData)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">return</span> t
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Protected</span> <span style="color:#0000FF;font-weight: bold">Function</span> trimPeriod(s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">if</span> s.Right(<span style="color:#326598">1</span>) = <span style="color:#6500FE">&quot;.&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">return</span> s.Left (s.Len-<span style="color:#326598">1</span>)
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#0000FF;font-weight: bold">return</span> s
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Module</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ListColumnTV <span style="color:#0000FF;font-weight: bold">Inherits</span> NSTableColumnMBS</div>
<div class="RB_Code">		ComputedProperty Alignment <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> mAlignment &lt;&gt; value <span style="color:#0000FF;font-weight: bold">then</span>
					mAlignment = value
					owner._needsReload()
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mAlignment
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty AlignmentOffset <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> mAlignmentOffset &lt;&gt; value <span style="color:#0000FF;font-weight: bold">then</span>
					mAlignmentOffset = value
					owner._needsReload()
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mAlignmentOffset
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty ColumnIndex <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mColumnIndex
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty MaxWidthActual <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				mMaxWidthExpr = Str(value,<span style="color:#6500FE">&quot;#&quot;</span>)
				owner._needsReload(<span style="color:#0000FF;font-weight: bold">true</span>)
				<span style="color:#0000FF;font-weight: bold">me</span>.maxWidth = value
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> Round (<span style="color:#0000FF;font-weight: bold">me</span>.maxWidth)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty MaxWidthExpression <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				mMaxWidthExpr = value
				owner._needsReload(<span style="color:#0000FF;font-weight: bold">true</span>, <span style="color:#0000FF;font-weight: bold">true</span>)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mMaxWidthExpr
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty MinWidthActual <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				mMinWidthExpr = Str(value,<span style="color:#6500FE">&quot;#&quot;</span>)
				owner._needsReload(<span style="color:#0000FF;font-weight: bold">true</span>)
				<span style="color:#0000FF;font-weight: bold">me</span>.minWidth = value
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> Round (<span style="color:#0000FF;font-weight: bold">me</span>.minWidth)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty MinWidthExpression <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				mMinWidthExpr = value
				owner._needsReload(<span style="color:#0000FF;font-weight: bold">true</span>, <span style="color:#0000FF;font-weight: bold">true</span>)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mMinWidthExpr
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty SortDirection <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">if</span> mSortDirection &lt;&gt; value <span style="color:#0000FF;font-weight: bold">then</span>
					mSortDirection = value
					owner._needsReload()
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mSortDirection
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty UserResizable <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				<span style="color:#0000FF;font-weight: bold">me</span>.Resizable = value
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">me</span>.Resizable
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty WidthActual <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				mWidthExpr = Str(value,<span style="color:#6500FE">&quot;#&quot;</span>)
				owner._needsReload(<span style="color:#0000FF;font-weight: bold">true</span>)
				<span style="color:#0000FF;font-weight: bold">me</span>.width = value
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> Round (<span style="color:#0000FF;font-weight: bold">me</span>.width)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		ComputedProperty WidthExpression <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				mWidthExpr = value
				owner._needsReload(<span style="color:#0000FF;font-weight: bold">true</span>, <span style="color:#0000FF;font-weight: bold">true</span>)
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mWidthExpr
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(ownerRef <span style="color:#0000FF;font-weight: bold">as</span> WeakRef, colNum <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			mOwner = ownerRef
			mColumnIndex = colNum
			
			<span style="color:#0000FF;font-weight: bold">static</span> lastID <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			lastID = lastID + <span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> id <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = Str(lastID,<span style="color:#6500FE">&quot;#&quot;</span>) <span style="color:#7F0000;text-style:italic">&#39;</span>  <span style="color:#7F0000;text-style:italic">Since</span> <span style="color:#7F0000;text-style:italic">columns</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">be</span> <span style="color:#7F0000;text-style:italic">reordered,</span> <span style="color:#7F0000;text-style:italic">id</span> <span style="color:#7F0000;text-style:italic">can&#39;t</span> <span style="color:#7F0000;text-style:italic">identify</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">column</span> <span style="color:#7F0000;text-style:italic">index,</span> <span style="color:#7F0000;text-style:italic">but</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">ColumnIndex</span> <span style="color:#7F0000;text-style:italic">can.</span>
			<span style="color:#0000FF;font-weight: bold">super</span>.Constructor (id)
			
			<span style="color:#0000FF;font-weight: bold">const</span> NSCaseInsensitiveSearch = <span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">const</span> NSLiteralSearch = <span style="color:#326598">2</span>
			<span style="color:#0000FF;font-weight: bold">const</span> NSBackwardsSearch = <span style="color:#326598">4</span>
			<span style="color:#0000FF;font-weight: bold">const</span> NSAnchoredSearch = <span style="color:#326598">8</span>
			<span style="color:#0000FF;font-weight: bold">const</span> NSNumericSearch = <span style="color:#326598">64</span> <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">-&gt;</span> <span style="color:#7F0000;text-style:italic">smart</span> <span style="color:#7F0000;text-style:italic">sort</span> <span style="color:#7F0000;text-style:italic">where</span> <span style="color:#7F0000;text-style:italic">numbers</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">ordered</span> <span style="color:#7F0000;text-style:italic">properly</span>
			<span style="color:#0000FF;font-weight: bold">const</span> NSDiacriticInsensitiveSearch = <span style="color:#326598">128</span>
			<span style="color:#0000FF;font-weight: bold">const</span> NSWidthInsensitiveSearch = <span style="color:#326598">256</span>
			<span style="color:#0000FF;font-weight: bold">const</span> NSForcedOrderingSearch = <span style="color:#326598">512</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">default</span> <span style="color:#7F0000;text-style:italic">sort</span> <span style="color:#7F0000;text-style:italic">handling,</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListboxTV.SortColumn</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">ListboxTV.CompareRows</span> <span style="color:#7F0000;text-style:italic">events</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">used</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> opts <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = NSCaseInsensitiveSearch + NSDiacriticInsensitiveSearch + NSNumericSearch
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Install</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">primary</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">secondary</span> <span style="color:#7F0000;text-style:italic">sort</span> <span style="color:#7F0000;text-style:italic">descriptors</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> sorter <span style="color:#0000FF;font-weight: bold">as</span> NSSortDescriptorMBS = NSSortDescriptorMBS.sortDescriptorWithKeyWithCompare (<span style="color:#6500FE">&quot;&quot;</span>, <span style="color:#0000FF;font-weight: bold">true</span>, opts) <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">sorter</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">used</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">CompareRows()</span> <span style="color:#7F0000;text-style:italic">event</span> <span style="color:#7F0000;text-style:italic">returns</span> <span style="color:#7F0000;text-style:italic">false</span>
			mSortHandler = <span style="color:#0000FF;font-weight: bold">new</span> ListRowComparator (mOwner, <span style="color:#0000FF;font-weight: bold">me</span>, sorter) <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">our</span> <span style="color:#7F0000;text-style:italic">internal</span> <span style="color:#7F0000;text-style:italic">sorter</span> <span style="color:#7F0000;text-style:italic">that</span> <span style="color:#7F0000;text-style:italic">invokes</span> <span style="color:#7F0000;text-style:italic">CompareRows()</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">falls</span> <span style="color:#7F0000;text-style:italic">back</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">above</span> <span style="color:#7F0000;text-style:italic">sorter</span>
			<span style="color:#0000FF;font-weight: bold">me</span>.sortDescriptorPrototype = mSortHandler
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Set</span> <span style="color:#7F0000;text-style:italic">some</span> <span style="color:#7F0000;text-style:italic">UI</span> <span style="color:#7F0000;text-style:italic">options</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> cell <span style="color:#0000FF;font-weight: bold">as</span> NSCellMBS = <span style="color:#0000FF;font-weight: bold">me</span>.headerCell
			cell.wraps = <span style="color:#0000FF;font-weight: bold">false</span>
			cell.lineBreakMode = NSParagraphStyleMBS.NSLineBreakByTruncatingTail
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> EffectiveType(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> myCell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = owner._cell(row, ColumnIndex)
			<span style="color:#0000FF;font-weight: bold">dim</span> t <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = myCell.Type
			<span style="color:#0000FF;font-weight: bold">if</span> t = ListBox.TypeDefault <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">me</span>.Type
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#0000FF;font-weight: bold">return</span> t
			<span style="color:#0000FF;font-weight: bold">end</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> SetFontAndSize(fontName <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>, size <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span> = <span style="color:#326598">0</span>)
			<span style="color:#0000FF;font-weight: bold">if</span> fontName = <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">or</span> fontName = <span style="color:#6500FE">&quot;System&quot;</span> <span style="color:#0000FF;font-weight: bold">or</span> fontName = <span style="color:#6500FE">&quot;SmallSystem&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">me</span>.headerCell.font = NSFontMBS.systemFontOfSize (size)
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#0000FF;font-weight: bold">me</span>.headerCell.font = NSFontMBS.fontWithName (fontName, size)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> _updateOwnIndex()
			mColumnIndex = <span style="color:#0000FF;font-weight: bold">me</span>.tableView.columnWithIdentifier (<span style="color:#0000FF;font-weight: bold">me</span>.identifier)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> owner() <span style="color:#0000FF;font-weight: bold">As</span> ListBoxTV
			<span style="color:#0000FF;font-weight: bold">return</span> ListBoxTV (mOwner.Value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Tag <span style="color:#0000FF;font-weight: bold">As</span> Variant
<div class="RB_Comment">			You may set this to anything you like - if the user drags the column to another position, this Tag will move along.</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Type <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mAlignment <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mAlignmentOffset <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mColumnIndex <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mMaxWidthExpr <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mMinWidthExpr <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mOwner <span style="color:#0000FF;font-weight: bold">As</span> WeakRef
<div class="RB_Comment">			ListBoxTV</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mSortDirection <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mSortHandler <span style="color:#0000FF;font-weight: bold">As</span> NSSortDescriptorMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mWidthExpr <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ListCellTV</div>
<div class="RB_Code">		ComputedProperty Picture <span style="color:#0000FF;font-weight: bold">As</span> Picture</div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Set</span>()
				mPicture = value
				<span style="color:#0000FF;font-weight: bold">me</span>.nsImage = <span style="color:#0000FF;font-weight: bold">new</span> NSImageMBS (value, value.Mask(<span style="color:#0000FF;font-weight: bold">false</span>))
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Set</span></div>
<div class="RB_Code">			<span style="color:#0000FF;font-weight: bold">Sub</span> <span style="color:#0000FF;font-weight: bold">Get</span>()
				<span style="color:#0000FF;font-weight: bold">return</span> mPicture
			<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Get</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> ComputedProperty</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(text <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = <span style="color:#6500FE">&quot;&quot;</span>, checked <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = <span style="color:#0000FF;font-weight: bold">false</span>)
			<span style="color:#0000FF;font-weight: bold">me</span>.Text = text
			<span style="color:#0000FF;font-weight: bold">me</span>.Checked = checked
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Alignment <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
<div class="RB_Comment">			Use ListBox.Align... constants here</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> BackgroundColor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Color</span> = &amp;c<span style="color:#FF0000">FF</span><span style="color:#00FF00">FF</span><span style="color:#0000FF">FF</span>FF</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Bold <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Checked <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Indentation <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Italic <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Tag <span style="color:#0000FF;font-weight: bold">As</span> Variant</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Text <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> TextColor <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Color</span> = &amp;c<span style="color:#FF0000">00</span><span style="color:#00FF00">00</span><span style="color:#0000FF">00</span>00</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> ToolTip <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Type <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
<div class="RB_Comment">			Use ListBox.Type... constants here</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> _internalUse <span style="color:#0000FF;font-weight: bold">As</span> Pair
<div class="RB_Comment">			This will be modified internally during Sort and Draw operations</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mPicture <span style="color:#0000FF;font-weight: bold">As</span> Picture</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> nsImage <span style="color:#0000FF;font-weight: bold">As</span> NSImageMBS</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> DragItemTV</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddItem(x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, w <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, h <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			mItems.Append <span style="color:#0000FF;font-weight: bold">new</span> NSPasteboardItemMBS
			mCurrentItemIdx = mItems.Ubound
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> BestType(<span style="color:#0000FF;font-weight: bold">paramarray</span> t() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mItems(mCurrentItemIdx).availableTypeFromArray(t)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(pb <span style="color:#0000FF;font-weight: bold">as</span> NSPasteboardMBS)
			mPboard = pb
			mItems = pb.pasteboardItems
			<span style="color:#0000FF;font-weight: bold">if</span> mItems.Ubound &lt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
				AddItem(<span style="color:#326598">0</span>,<span style="color:#326598">0</span>,<span style="color:#326598">0</span>,<span style="color:#326598">0</span>)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			Reset()
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> FinishAddedItems()
			<span style="color:#0000FF;font-weight: bold">call</span> mPboard.SetPasteboardItems mItems
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> FolderItem() <span style="color:#0000FF;font-weight: bold">As</span> FolderItem
			<span style="color:#0000FF;font-weight: bold">dim</span> f <span style="color:#0000FF;font-weight: bold">as</span> FolderItem
			<span style="color:#0000FF;font-weight: bold">dim</span> item <span style="color:#0000FF;font-weight: bold">as</span> NSPasteboardItemMBS = mItems(mCurrentItemIdx)
			<span style="color:#0000FF;font-weight: bold">dim</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = item.stringForType(NSPasteboardMBS.NSFilenamesPboardType).DefineEncoding(Encodings.UTF8)
			<span style="color:#0000FF;font-weight: bold">if</span> s &lt;&gt; <span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				f = PathToFolderItemMBS (s)
			<span style="color:#0000FF;font-weight: bold">else</span>
				s = item.stringForType(<span style="color:#6500FE">&quot;public.file-url&quot;</span>).DefineEncoding(Encodings.UTF8)
				f = <span style="color:#0000FF;font-weight: bold">new</span> FolderItem (s, FolderItem.PathTypeURL)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">return</span> f
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> FolderItem(<span style="color:#0000FF;font-weight: bold">assigns</span> f <span style="color:#0000FF;font-weight: bold">as</span> FolderItem)
			mItems(mCurrentItemIdx).stringForType(<span style="color:#6500FE">&quot;public.file-url&quot;</span>) = f.URLPath.ConvertEncoding(Encodings.UTF8)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> FolderItemAvailable() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> HasType(NSPasteboardMBS.NSFilenamesPboardType, <span style="color:#6500FE">&quot;public.file-url&quot;</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> HasType(<span style="color:#0000FF;font-weight: bold">paramarray</span> t() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mItems(mCurrentItemIdx).availableTypeFromArray(t) &lt;&gt; <span style="color:#6500FE">&quot;&quot;</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> NextItem() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> res <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = <span style="color:#0000FF;font-weight: bold">true</span>
			mCurrentItemIdx = mCurrentItemIdx + <span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">if</span> mCurrentItemIdx &gt; mItems.Ubound <span style="color:#0000FF;font-weight: bold">then</span>
				mCurrentItemIdx = <span style="color:#326598">0</span>
				res = <span style="color:#0000FF;font-weight: bold">false</span>
			<span style="color:#0000FF;font-weight: bold">end</span>
			mTypes = mItems(mCurrentItemIdx).types
			<span style="color:#0000FF;font-weight: bold">return</span> res
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> Pboard() <span style="color:#0000FF;font-weight: bold">As</span> NSPasteboardMBS
			<span style="color:#0000FF;font-weight: bold">return</span> mPboard
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> RawData(type <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			type = BestType (ListBoxTV_Support.convertOSType(type))
			<span style="color:#0000FF;font-weight: bold">dim</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = mItems(mCurrentItemIdx).stringForType(type)
			<span style="color:#0000FF;font-weight: bold">return</span> s
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> RawData(type <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			mItems(mCurrentItemIdx).stringForType(ListBoxTV_Support.convertOSType(type)) = s
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> RawDataAvailable(type <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> HasType (ListBoxTV_Support.convertOSType(type))
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Sub</span> Reset()
			mCurrentItemIdx = -<span style="color:#326598">1</span>
			<span style="color:#0000FF;font-weight: bold">call</span> NextItem
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> Text() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> t <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = BestType (NSPasteboardMBS.NSPasteboardTypeString, NSPasteboardMBS.NSStringPboardType)
			<span style="color:#0000FF;font-weight: bold">dim</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = mItems(mCurrentItemIdx).stringForType(t).DefineEncoding(Encodings.UTF8)
			<span style="color:#0000FF;font-weight: bold">return</span> s
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Text(<span style="color:#0000FF;font-weight: bold">assigns</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			mItems(mCurrentItemIdx).stringForType(NSPasteboardMBS.NSPasteboardTypeString) = s.ConvertEncoding(Encodings.UTF8)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> TextAvailable() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">return</span> HasType(NSPasteboardMBS.NSPasteboardTypeString, NSPasteboardMBS.NSStringPboardType)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mCurrentItemIdx <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mItems() <span style="color:#0000FF;font-weight: bold">As</span> NSPasteboardItemMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mPboard <span style="color:#0000FF;font-weight: bold">As</span> NSPasteboardMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mTypes() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Interface</span> ListBoxTVDataSource</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> DataSource_Cell(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> ListCellTV</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_CellDidUpdate(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV, updatesText <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>, updatesChecked <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_CellWillUpdate(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV, updatesText <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>, updatesChecked <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_DeleteAllRows()</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_MoveColumn(fromIdx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, toIdx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_MoveRows(fromIdxs() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, toAboveIdx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> DataSource_RowCount() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> DataSource_RowTag(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> Variant</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_RowTag(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> tag <span style="color:#0000FF;font-weight: bold">as</span> Variant)</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_SetColumnCount(colCount <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_SortRows(sorters() <span style="color:#0000FF;font-weight: bold">as</span> NSSortDescriptorMBS)</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Interface</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ListRowTV <span style="color:#0000FF;font-weight: bold">Inherits</span> KeyValueCodingMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> Description() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Lets</span> <span style="color:#7F0000;text-style:italic">return</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">cells&#39;</span> <span style="color:#7F0000;text-style:italic">values,</span> <span style="color:#7F0000;text-style:italic">TAB-separated</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> res() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>
			<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> c <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV <span style="color:#0000FF;font-weight: bold">in</span> cells
				<span style="color:#0000FF;font-weight: bold">dim</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span> = c.text
				<span style="color:#0000FF;font-weight: bold">if</span> s.Len &gt; <span style="color:#326598">20</span> <span style="color:#0000FF;font-weight: bold">then</span>
					s = s.Left(<span style="color:#326598">20</span>)+<span style="color:#6500FE">&quot;&hellip;&quot;</span>
				<span style="color:#0000FF;font-weight: bold">end</span>
				res.Append s
			<span style="color:#0000FF;font-weight: bold">next</span>
			<span style="color:#0000FF;font-weight: bold">return</span> Join(res, Chr(<span style="color:#326598">9</span>))
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> valueForKey(key <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>) <span style="color:#0000FF;font-weight: bold">As</span> Variant
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">called</span> <span style="color:#7F0000;text-style:italic">when</span> <span style="color:#7F0000;text-style:italic">performing</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">sort</span> <span style="color:#7F0000;text-style:italic">using</span> <span style="color:#7F0000;text-style:italic">sort</span> <span style="color:#7F0000;text-style:italic">descriptors</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">(see</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource.sortDescriptorsDidChange)</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = owner.TableView.columnWithIdentifier(key)
			<span style="color:#0000FF;font-weight: bold">dim</span> cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = cells(col)
			cell._internalUse = <span style="color:#0000FF;font-weight: bold">me</span>.row : col
			<span style="color:#0000FF;font-weight: bold">return</span> cell
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(ownerRef <span style="color:#0000FF;font-weight: bold">as</span> WeakRef, columnCount <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			mOwner = ownerRef
			<span style="color:#0000FF;font-weight: bold">me</span>.row = row
			<span style="color:#0000FF;font-weight: bold">redim</span> <span style="color:#0000FF;font-weight: bold">me</span>.cells(columnCount-<span style="color:#326598">1</span>)
			<span style="color:#0000FF;font-weight: bold">super</span>.Constructor
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> MoveColumn(fromIdx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, toIdx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = cells(fromIdx)
			cells.Remove fromIdx
			cells.Insert toIdx, c
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> owner() <span style="color:#0000FF;font-weight: bold">As</span> ListBoxTV
			<span style="color:#0000FF;font-weight: bold">return</span> ListBoxTV (mOwner.Value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> cells() <span style="color:#0000FF;font-weight: bold">As</span> ListCellTV</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mOwner <span style="color:#0000FF;font-weight: bold">As</span> WeakRef
<div class="RB_Comment">			ListBoxTV</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> row <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> tag <span style="color:#0000FF;font-weight: bold">As</span> Variant</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ListRowComparator <span style="color:#0000FF;font-weight: bold">Inherits</span> NSSortDescriptorMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> Comparator(obj1 <span style="color:#0000FF;font-weight: bold">as</span> variant, obj2 <span style="color:#0000FF;font-weight: bold">as</span> variant) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> c1 <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = obj1
			<span style="color:#0000FF;font-weight: bold">dim</span> c2 <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = obj2
			
			<span style="color:#0000FF">#if</span> DebugBuild
				<span style="color:#0000FF;font-weight: bold">if</span> c1._internalUse.Right &lt;&gt; column.ColumnIndex <span style="color:#0000FF;font-weight: bold">or</span> c1._internalUse.Right &lt;&gt; c2._internalUse.Right <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">raise</span> <span style="color:#0000FF;font-weight: bold">new</span> RuntimeException <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">happens,</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">forgot</span> <span style="color:#7F0000;text-style:italic">up</span> <span style="color:#7F0000;text-style:italic">update</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">Column</span> <span style="color:#7F0000;text-style:italic">somewhere</span>
			<span style="color:#0000FF">#endif</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> res <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">if</span> owner._compareRows (c1, c2, res) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">return</span> res
			<span style="color:#0000FF;font-weight: bold">end</span>
			
			<span style="color:#0000FF;font-weight: bold">declare</span> <span style="color:#0000FF;font-weight: bold">function</span> compareObjectTo <span style="color:#0000FF;font-weight: bold">lib</span> <span style="color:#6500FE">&quot;Cocoa&quot;</span> selector <span style="color:#6500FE">&quot;compareObject:toObject:&quot;</span> (h <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, o1 <span style="color:#0000FF;font-weight: bold">as</span> CFStringRef, o2 <span style="color:#0000FF;font-weight: bold">as</span> CFStringRef) <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			
			<span style="color:#0000FF;font-weight: bold">try</span>
				res = compareObjectTo (mSorter.Handle, c1.Text, c2.Text)
			<span style="color:#0000FF;font-weight: bold">catch</span> exc <span style="color:#0000FF;font-weight: bold">as</span> ObjCException
				break
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">try</span>
			
			<span style="color:#0000FF;font-weight: bold">return</span> res
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(ownerRef <span style="color:#0000FF;font-weight: bold">as</span> WeakRef, column <span style="color:#0000FF;font-weight: bold">as</span> ListColumnTV, sorter <span style="color:#0000FF;font-weight: bold">as</span> NSSortDescriptorMBS)
			<span style="color:#0000FF;font-weight: bold">super</span>.Constructor (column.identifier, <span style="color:#0000FF;font-weight: bold">true</span>)
			
			mOwner = ownerRef
			mColumn = <span style="color:#0000FF;font-weight: bold">new</span> WeakRef(column)
			mSorter = sorter
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> column() <span style="color:#0000FF;font-weight: bold">As</span> ListColumnTV
			<span style="color:#0000FF;font-weight: bold">return</span> ListColumnTV (mColumn.Value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> owner() <span style="color:#0000FF;font-weight: bold">As</span> ListBoxTV
			<span style="color:#0000FF;font-weight: bold">return</span> ListBoxTV (mOwner.Value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mColumn <span style="color:#0000FF;font-weight: bold">As</span> WeakRef
<div class="RB_Comment">			ListColumnTV</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mOwner <span style="color:#0000FF;font-weight: bold">As</span> WeakRef
<div class="RB_Comment">			ListBoxTV</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mSorter <span style="color:#0000FF;font-weight: bold">As</span> NSSortDescriptorMBS</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ListBoxTVStaticDataSource</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> AddRow(txt <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> ListRowTV (mOwner, mColumnCount, mRows.Ubound+<span style="color:#326598">1</span>)
			mRows.Append row
			
			<span style="color:#0000FF;font-weight: bold">dim</span> cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = <span style="color:#0000FF;font-weight: bold">me</span>.DataSource_Cell (mRows.Ubound, <span style="color:#326598">0</span>) <span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">-&gt;</span> <span style="color:#7F0000;text-style:italic">allocates</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">cell</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">row</span> <span style="color:#7F0000;text-style:italic">object</span>
			cell.Text = txt
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(ownerRef <span style="color:#0000FF;font-weight: bold">as</span> WeakRef)
			mOwner = ownerRef
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> DataSource_Cell(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> ListCellTV
			<span style="color:#0000FF;font-weight: bold">dim</span> cells() <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = mRows(row).cells
			<span style="color:#0000FF;font-weight: bold">dim</span> res <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = cells(column)
			
			<span style="color:#0000FF;font-weight: bold">if</span> res <span style="color:#0000FF;font-weight: bold">is</span> <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">This</span> <span style="color:#7F0000;text-style:italic">cell</span> <span style="color:#7F0000;text-style:italic">has</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">been</span> <span style="color:#7F0000;text-style:italic">accessed</span> <span style="color:#7F0000;text-style:italic">before</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">create</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">now</span>
				res = <span style="color:#0000FF;font-weight: bold">new</span> ListCellTV ()
				cells(column) = res
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">return</span> res
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_CellDidUpdate(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV, updatesText <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>, updatesChecked <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Nothing</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">do</span> <span style="color:#7F0000;text-style:italic">here</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">exists</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">custom</span> <span style="color:#7F0000;text-style:italic">implementations</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource</span> <span style="color:#7F0000;text-style:italic">interface</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_CellWillUpdate(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, column <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, cell <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV, updatesText <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>, updatesChecked <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Nothing</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">do</span> <span style="color:#7F0000;text-style:italic">here</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">exists</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">custom</span> <span style="color:#7F0000;text-style:italic">implementations</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">ListBoxTVDataSource</span> <span style="color:#7F0000;text-style:italic">interface</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_DeleteAllRows()
			<span style="color:#0000FF;font-weight: bold">redim</span> mRows(-<span style="color:#326598">1</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_MoveColumn(fromIdx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, toIdx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> row <span style="color:#0000FF;font-weight: bold">as</span> ListRowTV <span style="color:#0000FF;font-weight: bold">in</span> mRows
				row.MoveColumn fromIdx, toIdx
			<span style="color:#0000FF;font-weight: bold">next</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_MoveRows(fromIdxs() <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, toAboveIdx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			<span style="color:#0000FF;font-weight: bold">dim</span> oldIndexOffset, newIndexOffset, firstAffected, lastAffected <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			
			fromIdxs.Sort
			
			firstAffected = toAboveIdx
			lastAffected = toAboveIdx
			
			<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> oldIndex <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> <span style="color:#0000FF;font-weight: bold">in</span> fromIdxs
				<span style="color:#0000FF;font-weight: bold">dim</span> fromIdx, toIdx <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
				<span style="color:#0000FF;font-weight: bold">if</span> oldIndex &lt; toAboveIdx <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">if</span> oldIndex &lt; firstAffected <span style="color:#0000FF;font-weight: bold">then</span> firstAffected = oldIndex
					fromIdx = oldIndex + oldIndexOffset
					toIdx = toAboveIdx - <span style="color:#326598">1</span>
					oldIndexOffset = oldIndexOffset - <span style="color:#326598">1</span>
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#0000FF;font-weight: bold">if</span> oldIndex &gt; lastAffected <span style="color:#0000FF;font-weight: bold">then</span> lastAffected = oldIndex
					fromIdx = oldIndex
					toIdx = toAboveIdx + newIndexOffset
					newIndexOffset = newIndexOffset + <span style="color:#326598">1</span>
				<span style="color:#0000FF;font-weight: bold">end</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> row <span style="color:#0000FF;font-weight: bold">as</span> ListRowTV = mRows(fromIdx)
				mRows.Remove fromIdx
				mRows.Insert toIdx, row
			<span style="color:#0000FF;font-weight: bold">next</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> lastAffected &gt; mRows.Ubound <span style="color:#0000FF;font-weight: bold">then</span> lastAffected = mRows.Ubound
			
			<span style="color:#0000FF;font-weight: bold">for</span> row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = firstAffected <span style="color:#0000FF;font-weight: bold">to</span> lastAffected
				mRows(row).row = row
			<span style="color:#0000FF;font-weight: bold">next</span>
			
			owner._needsReload
			owner.DeselectAll
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> DataSource_RowCount() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>
			<span style="color:#0000FF;font-weight: bold">return</span> mRows.Ubound+<span style="color:#326598">1</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> DataSource_RowTag(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> Variant
			<span style="color:#0000FF;font-weight: bold">return</span> mRows(row).tag
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_RowTag(row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, <span style="color:#0000FF;font-weight: bold">assigns</span> tag <span style="color:#0000FF;font-weight: bold">as</span> Variant)
			mRows(row).tag = tag
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_SetColumnCount(colCount <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
			mColumnCount = colCount
			
			<span style="color:#0000FF;font-weight: bold">dim</span> newUbound <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = colCount-<span style="color:#326598">1</span>
			
			<span style="color:#0000FF;font-weight: bold">for</span> <span style="color:#0000FF;font-weight: bold">each</span> row <span style="color:#0000FF;font-weight: bold">as</span> ListRowTV <span style="color:#0000FF;font-weight: bold">in</span> mRows
				<span style="color:#0000FF;font-weight: bold">dim</span> cells() <span style="color:#0000FF;font-weight: bold">as</span> ListCellTV = row.cells
				<span style="color:#0000FF;font-weight: bold">redim</span> cells(newUbound)
			<span style="color:#0000FF;font-weight: bold">next</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DataSource_SortRows(sorters() <span style="color:#0000FF;font-weight: bold">as</span> NSSortDescriptorMBS)
			<span style="color:#0000FF;font-weight: bold">dim</span> newRows() <span style="color:#0000FF;font-weight: bold">as</span> KeyValueCodingMBS = KeyValueCodingMBS.sortedArrayUsingDescriptors (mRows, sorters)
			<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> newRows.Ubound
				<span style="color:#0000FF;font-weight: bold">dim</span> row <span style="color:#0000FF;font-weight: bold">as</span> ListRowTV = ListRowTV(newRows(i))
				row.row = i
				mRows(i) = row
			<span style="color:#0000FF;font-weight: bold">next</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> owner() <span style="color:#0000FF;font-weight: bold">As</span> ListBoxTV
			<span style="color:#0000FF;font-weight: bold">return</span> ListBoxTV (mOwner.Value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mColumnCount <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mOwner <span style="color:#0000FF;font-weight: bold">As</span> WeakRef
<div class="RB_Comment">			ListBoxTV</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mRows() <span style="color:#0000FF;font-weight: bold">As</span> ListRowTV</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ListDrawCellHandler <span style="color:#0000FF;font-weight: bold">Inherits</span> CustomNSTextFieldCellMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> ImageInset = <span style="color:#326598">3</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> drawWithFrame(cellFrame <span style="color:#0000FF;font-weight: bold">as</span> NSRectMBS, controlView <span style="color:#0000FF;font-weight: bold">as</span> NSViewMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">boolean</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> textFrame <span style="color:#0000FF;font-weight: bold">as</span> NSRectMBS = titleRectForBounds (cellFrame)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> lb <span style="color:#0000FF;font-weight: bold">as</span> ListBoxTV = ListBoxTV(mOwner.Value)
			
			lb._suppressReload = <span style="color:#0000FF;font-weight: bold">true</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#0000FF;font-weight: bold">me</span>.cell._internalUse.Left
			<span style="color:#0000FF;font-weight: bold">dim</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#0000FF;font-weight: bold">me</span>.cell._internalUse.Right
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> lb._cellBackgroundPaint (<span style="color:#0000FF;font-weight: bold">nil</span>, row, col, textFrame, controlView) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">draw</span> <span style="color:#7F0000;text-style:italic">background</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">entire</span> <span style="color:#7F0000;text-style:italic">cell,</span> <span style="color:#7F0000;text-style:italic">even</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">text</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">indented</span>
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">me</span>.backgroundColor &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> g <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> NSGraphicsMBS
					g.setFillColor <span style="color:#0000FF;font-weight: bold">me</span>.backgroundColor
					g.fillRect cellFrame
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> cell.nsImage &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF">#if</span> Target64Bit
					<span style="color:#0000FF;font-weight: bold">declare</span> <span style="color:#0000FF;font-weight: bold">sub</span> drawInRect <span style="color:#0000FF;font-weight: bold">lib</span> <span style="color:#6500FE">&quot;Cocoa&quot;</span> selector <span style="color:#6500FE">&quot;drawInRect:fromRect:operation:fraction:respectFlipped:hints:&quot;</span> ( _
							h <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, dst <span style="color:#0000FF;font-weight: bold">as</span> NSRect64, src <span style="color:#0000FF;font-weight: bold">as</span> NSRect64, operation <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, fraction <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>, respectFlipped <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>, hints <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Ptr</span>)
					<span style="color:#0000FF;font-weight: bold">dim</span> dr, zeroRect <span style="color:#0000FF;font-weight: bold">as</span> NSRect64
				<span style="color:#0000FF">#else</span>
					<span style="color:#0000FF;font-weight: bold">declare</span> <span style="color:#0000FF;font-weight: bold">sub</span> drawInRect <span style="color:#0000FF;font-weight: bold">lib</span> <span style="color:#6500FE">&quot;Cocoa&quot;</span> selector <span style="color:#6500FE">&quot;drawInRect:fromRect:operation:fraction:respectFlipped:hints:&quot;</span> ( _
							h <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, dst <span style="color:#0000FF;font-weight: bold">as</span> NSRect32, src <span style="color:#0000FF;font-weight: bold">as</span> NSRect32, operation <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span>, fraction <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Single</span>, respectFlipped <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>, hints <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Ptr</span>)
					<span style="color:#0000FF;font-weight: bold">dim</span> dr, zeroRect <span style="color:#0000FF;font-weight: bold">as</span> NSRect32
				<span style="color:#0000FF">#endif</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> img <span style="color:#0000FF;font-weight: bold">as</span> NSImageMBS = cell.nsImage
				dr.w = img.width
				dr.h = img.height
				dr.x = cellFrame.x + ImageInset
				dr.y = cellFrame.y + (cellFrame.Height - dr.h) \ <span style="color:#326598">2</span>
				drawInRect (img.Handle, dr, zeroRect, NSGraphicsMBS.NSCompositeSourceOver, <span style="color:#326598">1</span>, controlView.isFlipped, <span style="color:#0000FF;font-weight: bold">nil</span>)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> lb._cellTextPaint (<span style="color:#0000FF;font-weight: bold">nil</span>, row, col, <span style="color:#326598">0</span>, <span style="color:#326598">0</span>, textFrame, controlView) <span style="color:#0000FF;font-weight: bold">then</span>
				superDrawWithFrame textFrame, controlView
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			lb._suppressReload = <span style="color:#0000FF;font-weight: bold">false</span>
			
			<span style="color:#0000FF;font-weight: bold">return</span> <span style="color:#0000FF;font-weight: bold">true</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> titleRectForBounds(rect <span style="color:#0000FF;font-weight: bold">as</span> NSRectMBS) <span style="color:#0000FF;font-weight: bold">As</span> NSRectMBS
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Let&#39;s</span> <span style="color:#7F0000;text-style:italic">indent</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">text</span> <span style="color:#7F0000;text-style:italic">(based</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">cell&#39;s</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">column&#39;s</span> <span style="color:#7F0000;text-style:italic">AlignmentOffset,</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">ListBoxTV.dataCellForTableColumn)</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> ofs <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#0000FF;font-weight: bold">me</span>.cell.Indentation
			
			<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">me</span>.cell.nsImage &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				ofs = ofs + <span style="color:#0000FF;font-weight: bold">me</span>.cell.nsImage.width + (<span style="color:#326598">2</span> * ImageInset)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			rect.X = rect.X + ofs
			rect.Width = rect.Width - ofs
			
			<span style="color:#0000FF;font-weight: bold">return</span> rect
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(owner <span style="color:#0000FF;font-weight: bold">as</span> WeakRef)
			mOwner = owner
			<span style="color:#0000FF;font-weight: bold">super</span>.Constructor
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Note">		Note <span style="color:#6500FE">&quot;About&quot;</span>
<div class="RB_Comment">			This handles custom drawing for cells.
			
			Note: This only works for "normal" cells, not for Checkbox cells - they would need a different NSCell subclass implementation from MBS, which isn't available (yet).</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> cell <span style="color:#0000FF;font-weight: bold">As</span> ListCellTV</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mOwner <span style="color:#0000FF;font-weight: bold">As</span> WeakRef</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Structure</span> NSRect32
			x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Single</span>
			y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Single</span>
			w <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Single</span>
			h <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Single</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Structure</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Structure</span> NSRect64
			x <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			y <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			w <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
			h <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Double</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Structure</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ListBoxTVContextMenuItem <span style="color:#0000FF;font-weight: bold">Inherits</span> NSMenuItemMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
			owner.MenuItemAction (<span style="color:#0000FF;font-weight: bold">me</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(menu <span style="color:#0000FF;font-weight: bold">as</span> ListBoxTVContextMenu, item <span style="color:#0000FF;font-weight: bold">as</span> MenuItem)
			<span style="color:#0000FF;font-weight: bold">super</span>.Constructor (item.Text, <span style="color:#6500FE">&quot;&quot;</span>)
			mOwner = <span style="color:#0000FF;font-weight: bold">new</span> WeakRef (menu)
			<span style="color:#0000FF;font-weight: bold">me</span>.Item = item
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> owner() <span style="color:#0000FF;font-weight: bold">As</span> ListBoxTVContextMenu
			<span style="color:#0000FF;font-weight: bold">return</span> ListBoxTVContextMenu (mOwner.Value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Item <span style="color:#0000FF;font-weight: bold">As</span> MenuItem</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mOwner <span style="color:#0000FF;font-weight: bold">As</span> WeakRef
<div class="RB_Comment">			ListBoxTVContextMenu</div></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> ListBoxTVContextMenu <span style="color:#0000FF;font-weight: bold">Inherits</span> NSMenuMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> EnableMenuItems()
			<span style="color:#0000FF;font-weight: bold">me</span>.Clear
			
			<span style="color:#0000FF;font-weight: bold">dim</span> row <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = owner._clickedRow
			<span style="color:#0000FF;font-weight: bold">dim</span> col <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = owner._clickedColumn
			
			<span style="color:#0000FF;font-weight: bold">if</span> row &lt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Click</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">Header</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">clickedColumn</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">always</span> <span style="color:#7F0000;text-style:italic">-1</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">case,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">need</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">calculate</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">manually</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> ev <span style="color:#0000FF;font-weight: bold">as</span> NSEventMBS = NSApplicationMBS.sharedApplication.currentEvent
				<span style="color:#0000FF;font-weight: bold">dim</span> globalLocation <span style="color:#0000FF;font-weight: bold">as</span> NSPointMBS = ev.locationInWindow
				<span style="color:#0000FF;font-weight: bold">dim</span> localLocation <span style="color:#0000FF;font-weight: bold">as</span> NSPointMBS = owner.TableView.convertPointFromView (globalLocation, <span style="color:#0000FF;font-weight: bold">nil</span>)
				localLocation.Y = <span style="color:#326598">0</span>
				col = owner.TableView.columnAtPoint (localLocation)
				
			<span style="color:#0000FF;font-weight: bold">else</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Click</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">row</span> <span style="color:#7F0000;text-style:italic">/</span> <span style="color:#7F0000;text-style:italic">cell</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> owner.Selected (row) <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">deselect</span> <span style="color:#7F0000;text-style:italic">all</span> <span style="color:#7F0000;text-style:italic">others</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">right-click</span> <span style="color:#7F0000;text-style:italic">was</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">inside</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">current</span> <span style="color:#7F0000;text-style:italic">selection</span> <span style="color:#7F0000;text-style:italic">-</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">avoid</span> <span style="color:#7F0000;text-style:italic">confusion</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">user</span>
					owner.ListIndex = row
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> base <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> MenuItem
			<span style="color:#0000FF;font-weight: bold">if</span> owner._constructContextualMenu (base, System.MouseX, System.MouseY, row, col, <span style="color:#0000FF;font-weight: bold">me</span>) <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Integer</span> = <span style="color:#326598">1</span> <span style="color:#0000FF;font-weight: bold">to</span> base.Count
					<span style="color:#0000FF;font-weight: bold">dim</span> item <span style="color:#0000FF;font-weight: bold">as</span> ListBoxTVContextMenuItem = <span style="color:#0000FF;font-weight: bold">new</span> ListBoxTVContextMenuItem (<span style="color:#0000FF;font-weight: bold">me</span>, base.Item(i-<span style="color:#326598">1</span>))
					mItems.Append item
					<span style="color:#0000FF;font-weight: bold">super</span>.addItem item
				<span style="color:#0000FF;font-weight: bold">next</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			mMenu = base
			mRow = row
			mCol = col
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Clear()
			<span style="color:#0000FF;font-weight: bold">super</span>.removeAllItems
			<span style="color:#0000FF;font-weight: bold">redim</span> mItems(-<span style="color:#326598">1</span>)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Constructor(ownerRef <span style="color:#0000FF;font-weight: bold">as</span> WeakRef)
			<span style="color:#0000FF;font-weight: bold">super</span>.Constructor
			mOwner = ownerRef
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> MenuItemAction(sender <span style="color:#0000FF;font-weight: bold">as</span> ListBoxTVContextMenuItem)
			<span style="color:#0000FF;font-weight: bold">dim</span> item <span style="color:#0000FF;font-weight: bold">as</span> MenuItem = sender.Item
			owner._contextualMenuAction item, mRow, mCol
			<span style="color:#0000FF;font-weight: bold">me</span>.Clear
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Private</span> <span style="color:#0000FF;font-weight: bold">Function</span> owner() <span style="color:#0000FF;font-weight: bold">As</span> ListBoxTV
			<span style="color:#0000FF;font-weight: bold">return</span> ListBoxTV (mOwner.Value)
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mCol <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mItems() <span style="color:#0000FF;font-weight: bold">As</span> ListBoxTVContextMenuItem</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mMenu <span style="color:#0000FF;font-weight: bold">As</span> MenuItem</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mOwner <span style="color:#0000FF;font-weight: bold">As</span> WeakRef
<div class="RB_Comment">			ListBoxTV</div></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Private</span> mRow <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

<p>See also:<ul>
<li><A href="example-maccontrols-listboxandtableviewdemos-listboxtvdrop-in-flatonly-listboxtvdatabasewithdatasou.html">/MacControls/Listbox and TableView Demos/ListboxTV drop-in/Flat Only/ListBoxTV Database with DataSource</A></li>
<li><A href="example-maccontrols-listboxandtableviewdemos-listboxtvdrop-in-flatonly-listboxtvsimpledemowithdatas.html">/MacControls/Listbox and TableView Demos/ListboxTV drop-in/Flat Only/ListBoxTV Simple Demo with DataSource</A></li>
<li><A href="example-maccontrols-listboxandtableviewdemos-listboxtvdrop-in-flatonly-listboxtvtableview.html">/MacControls/Listbox and TableView Demos/ListboxTV drop-in/Flat Only/ListBoxTV TableView</A></li>
<li><A href="example-maccontrols-listboxandtableviewdemos-listboxtvdrop-in-hierarchicalflat-listboxtvoutlineview.html">/MacControls/Listbox and TableView Demos/ListboxTV drop-in/Hierarchical & Flat/ListBoxTV OutlineView</A></li>
<li><A href="example-maccontrols-listboxandtableviewdemos-nsoutlineview-diskbrowser.html">/MacControls/Listbox and TableView Demos/NSOutlineView/Disk Browser</A></li>
<li><A href="example-maccontrols-listboxandtableviewdemos-nsoutlineview-outlinecontrol.html">/MacControls/Listbox and TableView Demos/NSOutlineView/OutlineControl</A></li>
<li><A href="example-maccontrols-listboxrowcolors.html">/MacControls/Listbox Row Colors</A></li>
</ul></p>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmaccontrolsplugin.html">MBS MacControls Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-maccontrols-listboxandtableviewdemos-listboxtvdrop-in-flatonly-listboxtvwithcontainercontro">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

