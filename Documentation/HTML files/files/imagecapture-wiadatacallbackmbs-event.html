<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - WIADataCallbackMBS events</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="WIADataCallbackMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">WIADataCallbackMBS events</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-wiadatacallbackmbs.html">WIADataCallbackMBS</a> class.  </p>
<div class="W">
<b><a href="class-wiadatacallbackmbs.html">WIADataCallbackMBS</a>.<A name="1">BandedDataCallback(message as Integer, Status as Integer, PercentComplete as Integer, Offset as Integer, Length as Integer, Buffer as memoryblock) as Integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>event</td>
<td class=grau><A href="topic-imagecapture.html" translate="no">Image Capture</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion103.shtml" class=version>10.3</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau></td>
</tr>
</table>
<B>Function:</B> 
Provides data transfer status notifications. <BR>
<B>Notes:</B> 
<BR>
Windows Image Acquisition (WIA) data transfer methods of the WiaDataTransfer interface periodically call this method.<BR>
<BR>
Message: Specifies a constant that indicates the reason for the callback. Can be one of the kMessage* constants.<BR>
Status: Specifies a constant that indicates the status of the WIA device. Can be set to a combination of the kStatus* constants.<BR>
PercentComplete: Specifies the percentage of the total data that has been transferred so far.<BR>
Offset: Specifies an offset, in bytes, from the beginning of the buffer where the current band of data begins.<BR>
Length: Specifies the length, in bytes, of the current band of data.<BR>
Buffer: The data buffer.<BR>
<BR>
Lasterror is set.<BR>
<BR>
Your application must provide the BandedDataCallback event. This event is periodically invoked by the data transfer methods of the <A href="class-wiadatatransfermbs.html">WiaDataTransferMBS</A> interface. It provides status messages to the application during the data transfer. By returning false, your program can also use this method to prematurely terminate the data transfer.<BR>
<BR>
When this method is invoked, the Message parameter will contain the reason for the call. Not all parameters will contain data on all calls. For example, when BandedDataCallback is invoked with a message of kMessageTermination, it should not attempt to use the values in the Buffer, Offset, and Length parameters.<BR>
<BR>
If the value of Message is kMessageData, the buffer contains a band of image data. The Offset parameter contains an offset in bytes from the beginning of the buffer where the current band of data begins. The Length parameter specified the length in bytes of the current band of data.<BR>
<BR>
During calls where Message is set to kMessageData or kMessageStatus, the Status parameter contains a valid value. Its contents should not be used when Message contains other values.<BR>
<BR>
If Message is kMessageDataHeader, the Buffer parameter points to a WIA_DATA_CALLBACK_HEADER structure.<BR>
<BR>
When an error has occurred during an image data transfer, the driver sets Message to IT_MSG_DEVICE_STATUS. The proxy callback object calls ReportStatus, which handles the error and displays messages to the user.<BR>
<h4>Some examples using this event:</h4>
<ul translate="no">
<li><A href="example-win-wia-listitemswia1.html">/Win/WIA/List items WIA 1</A></li>
<li><A href="example-win-wia-wiascan.html">/Win/WIA/WIA Scan</A></li>
</ul>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbswinplugin.html">MBS Win Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=imagecapture-wiadatacallbackmbs-event">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

