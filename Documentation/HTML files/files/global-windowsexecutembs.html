<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Win: WindowsExecuteMBS</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Win">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Win: WindowsExecuteMBS</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="W">
<b><A name="1">WindowsExecuteMBS(ApplicationName as string, CommandLine as string, CurrentDirectory as string, byref PID as integer, Flags as integer = 0, ShowWindow as Integer = -1) as integer</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>global method</td>
<td class=grau><A href="topic-windows.html" translate="no">Windows</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion110.shtml" class=version>11.0</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Creates a new process and its primary thread. The new process runs in the security context of the calling process.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> error, pid <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">Integer</span><br /><br />pid = <span style="color: #336698;">0</span><br /><br />error = WindowsExecuteMBS(<span style="color: #6600FE;">&quot;&quot;</span>, <span style="color: #6600FE;">&quot;explorer.exe&quot;</span>, <span style="color: #6600FE;">&quot;&quot;</span>, pid)<br /><span style="color: #0000FF;">if</span> error = <span style="color: #336698;">0</span> <span style="color: #0000FF;">then</span><br />  MsgBox <span style="color: #6600FE;">&quot;Launched explorer with process id: &quot;</span>+str(pid)<br /><span style="color: #0000FF;">else</span><br />  MsgBox <span style="color: #6600FE;">&quot;Error: &quot;</span>+str(error)<br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span><br /><br />pid = <span style="color: #336698;">0</span><br /><br />error = WindowsExecuteMBS(<span style="color: #6600FE;">&quot;&quot;</span>, <span style="color: #6600FE;">&quot;notepad.exe &quot;</span><span style="color: #6600FE;">&quot;C:\boot.ini&quot;</span><span style="color: #6600FE;">&quot;&quot;</span>, <span style="color: #6600FE;">&quot;&quot;</span>, pid)<br /><span style="color: #0000FF;">if</span> error = <span style="color: #336698;">0</span> <span style="color: #0000FF;">then</span><br />  MsgBox <span style="color: #6600FE;">&quot;Launched Notepad with process id: &quot;</span>+str(pid)<br /><span style="color: #0000FF;">else</span><br />  MsgBox <span style="color: #6600FE;">&quot;Error: &quot;</span>+str(error)<br /><span style="color: #0000FF;">end</span> <span style="color: #0000FF;">if</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
ApplicationName: <BR>
The name of the module to be executed. This module can be a Windows-based application. It can be some other type of module (for example, MS-DOS or OS/2) if the appropriate subsystem is available on the local computer.<BR>
<BR>
The string can specify the full path and file name of the module to execute or it can specify a partial name. In the case of a partial name, the function uses the current drive and current directory to complete the specification. The function will not use the search path. This parameter must include the file name extension; no default extension is assumed.<BR>
<BR>
The ApplicationName parameter can be empty. In that case, the module name must be the first white space&ndash;delimited token in the CommandLine string. If you are using a long file name that contains a space, use quoted strings to indicate where the file name ends and the arguments begin; otherwise, the file name is ambiguous. For example, consider the string &quot;c:\program files\sub dir\program name&quot;. This string can be interpreted in a number of ways. The system tries to interpret the possibilities in the following order:<BR>
<BR>
<UL><LI>
c:\program.exe files\sub dir\program name
</LI><LI>
c:\program files\sub.exe dir\program name
</LI><LI>
c:\program files\sub dir\program.exe name
</LI><LI>
c:\program files\sub dir\program name.exe
</LI></UL>
<BR>
If the executable module is a 16-bit application, ApplicationName should be empty, and the string pointed to by CommandLine should specify the executable module as well as its arguments.<BR>
<BR>
To run a batch file, you must start the command interpreter; set ApplicationName to cmd.exe and set CommandLine to the following arguments: /c plus the name of the batch file.<BR>
<BR>
CommandLine:<BR>
The command line to be executed. The maximum length of this string is 32,767 characters.. If ApplicationName is empty, the module name portion of CommandLine is limited to MAX_PATH (256) characters.<BR>
<BR>
The CommandLine parameter can be empty. In that case, the function uses the string pointed to by ApplicationName as the command line.<BR>
<BR>
If both ApplicationName and CommandLine are non-empty, the ApplicationName string specifies the module to execute, and the CommandLine string specifies the command line. The new process can use GetCommandLine to retrieve the entire command line. Console processes written in C can use the argc and argv arguments to parse the command line. Because argv[0] is the module name, C programmers generally repeat the module name as the first token in the command line.<BR>
<BR>
If ApplicationName is empty, the first white space&ndash;delimited token of the command line specifies the module name. If you are using a long file name that contains a space, use quoted strings to indicate where the file name ends and the arguments begin (see the explanation for the ApplicationName parameter). If the file name does not contain an extension, .exe is appended. Therefore, if the file name extension is .com, this parameter must include the .com extension. If the file name ends in a period (.) with no extension, or if the file name contains a path, .exe is not appended. If the file name does not contain a directory path, the system searches for the executable file in the following sequence:<BR>
<BR>
<UL><LI>
The directory from which the application loaded.
</LI><LI>
The current directory for the parent process.
</LI><LI>
The 32-bit Windows system directory. Use the GetSystemDirectory function to get the path of this directory.
</LI><LI>
The 16-bit Windows system directory. There is no function that obtains the path of this directory, but it is searched. The name of this directory is System.
</LI><LI>
The Windows directory. Use the GetWindowsDirectory function to get the path of this directory.
</LI><LI>
The directories that are listed in the PATH environment variable. Note that this function does not search the per-application path specified by the App Paths registry key. To include this per-application path in the search sequence, use the ShellExecute function.
</LI><LI>
The system adds a terminating null character to the command-line string to separate the file name from the arguments. This divides the original string into two strings for internal processing.
</LI></UL>
<BR>
CurrentDirectory:<BR>
The full path to the current directory for the process. The string can also specify a UNC path.<BR>
<BR>
If this parameter is empty, the new process will have the same current drive and directory as the calling process. (This feature is provided primarily for shells that need to start an application and specify its initial drive and working directory.)<BR>
<BR>
pid:<BR>
The variable to store the process ID of the new process.<BR>
<BR>
Returns 0 for success or a windows error code for any error.<BR>
<BR>
Note that the function returns before the process has finished initialization. If a required DLL cannot be located or fails to initialize, the process is terminated. To get the termination status of a process, call GetExitCodeProcess.<BR>
<BR>
Possible Flags:<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Constant</TD><TD valign="top">Value</TD><TD valign="top">Description</TD></TR>
<TR><TD valign="top">CREATE_BREAKAWAY_FROM_JOB</TD><TD valign="top">&amp;h01000000</TD><TD valign="top">The child processes of a process associated with a job are not associated with the job. If the calling process is not associated with a job, this constant has no effect. If the calling process is associated with a job, the job must set the JOB_OBJECT_LIMIT_BREAKAWAY_OK limit.</TD></TR>
<TR><TD valign="top">CREATE_DEFAULT_ERROR_MODE</TD><TD valign="top">&amp;h04000000</TD><TD valign="top">The new process does not inherit the error mode of the calling process. Instead, the new process gets the default error mode. This feature is particularly useful for multi-threaded shell applications that run with hard errors disabled. The default behavior is for the new process to inherit the error mode of the caller. Setting this flag changes that default behavior.</TD></TR>
<TR><TD valign="top">CREATE_NEW_CONSOLE</TD><TD valign="top">&amp;h00000010</TD><TD valign="top">The new process has a new console, instead of inheriting its parent&#39;s console (the default). For more information, see Creation of a Console. This flag cannot be used with DETACHED_PROCESS.</TD></TR>
<TR><TD valign="top">CREATE_NEW_PROCESS_GROUP</TD><TD valign="top">&amp;h00000200</TD><TD valign="top">The new process is the root process of a new process group. The process group includes all processes that are descendants of this root process. The process identifier of the new process group is the same as the process identifier, which is returned in the lpProcessInformation parameter. Process groups are used by the GenerateConsoleCtrlEvent function to enable sending a CTRL+BREAK signal to a group of console processes. If this flag is specified, CTRL+C signals will be disabled for all processes within the new process group. This flag is ignored if specified with CREATE_NEW_CONSOLE.</TD></TR>
<TR><TD valign="top">CREATE_NO_WINDOW</TD><TD valign="top">&amp;h08000000</TD><TD valign="top">The process is a console application that is being run without a console window. Therefore, the console handle for the application is not set. This flag is ignored if the application is not a console application, or if it is used with either CREATE_NEW_CONSOLE or DETACHED_PROCESS.</TD></TR>
<TR><TD valign="top">CREATE_PROTECTED_PROCESS</TD><TD valign="top">&amp;h00040000</TD><TD valign="top">The process is to be run as a protected process. The system restricts access to protected processes and the threads of protected processes. For more information on how processes can interact with protected processes, see Process Security and Access Rights. To activate a protected process, the binary must have a special signature. This signature is provided by Microsoft but not currently available for non-Microsoft binaries. There are currently four protected processes: media foundation, audio engine, Windows error reporting, and system. Components that load into these binaries must also be signed. Multimedia companies can leverage the first two protected processes. For more information, see Overview of the Protected Media Path. Windows Server 2003 and Windows XP/2000:  This value is not supported.</TD></TR>
<TR><TD valign="top">CREATE_PRESERVE_CODE_AUTHZ_LEVEL</TD><TD valign="top">&amp;h02000000</TD><TD valign="top">Allows the caller to execute a child process that bypasses the process restrictions that would normally be applied automatically to the process. Windows 2000:  This value is not supported.</TD></TR>
<TR><TD valign="top">CREATE_SEPARATE_WOW_VDM</TD><TD valign="top">&amp;h00000800</TD><TD valign="top">This flag is valid only when starting a 16-bit Windows-based application. If set, the new process runs in a private Virtual DOS Machine (VDM). By default, all 16-bit Windows-based applications run as threads in a single, shared VDM. The advantage of running separately is that a crash only terminates the single VDM; any other programs running in distinct VDMs continue to function normally. Also, 16-bit Windows-based applications that are run in separate VDMs have separate input queues. That means that if one application stops responding momentarily, applications in separate VDMs continue to receive input. The disadvantage of running separately is that it takes significantly more memory to do so. You should use this flag only if the user requests that 16-bit applications should run in their own VDM.</TD></TR>
<TR><TD valign="top">CREATE_SHARED_WOW_VDM</TD><TD valign="top">&amp;h00001000</TD><TD valign="top">The flag is valid only when starting a 16-bit Windows-based application. If the DefaultSeparateVDM switch in the Windows section of WIN.INI is TRUE, this flag overrides the switch. The new process is run in the shared Virtual DOS Machine.</TD></TR>
<TR><TD valign="top">CREATE_SUSPENDED</TD><TD valign="top">&amp;h00000004</TD><TD valign="top">The primary thread of the new process is created in a suspended state, and does not run until the ResumeThread function is called.</TD></TR>
<TR><TD valign="top">CREATE_UNICODE_ENVIRONMENT</TD><TD valign="top">&amp;h00000400</TD><TD valign="top">If this flag is set, the environment block pointed to by lpEnvironment uses Unicode characters. Otherwise, the environment block uses ANSI characters.</TD></TR>
<TR><TD valign="top">DEBUG_ONLY_THIS_PROCESS</TD><TD valign="top">&amp;h00000002</TD><TD valign="top">The calling thread starts and debugs the new process. It can receive all related debug events using the WaitForDebugEvent function.</TD></TR>
<TR><TD valign="top">DEBUG_PROCESS</TD><TD valign="top">&amp;h00000001</TD><TD valign="top">The calling thread starts and debugs the new process and all child processes created by the new process. It can receive all related debug events using the WaitForDebugEvent function. A process that uses DEBUG_PROCESS becomes the root of a debugging chain. This continues until another process in the chain is created with DEBUG_PROCESS. If this flag is combined with DEBUG_ONLY_THIS_PROCESS, the caller debugs only the new process, not any child processes.</TD></TR>
<TR><TD valign="top">DETACHED_PROCESS</TD><TD valign="top">&amp;h00000008</TD><TD valign="top">For console processes, the new process does not inherit its parent&#39;s console (the default). The new process can call the AllocConsole function at a later time to create a console. For more information, see Creation of a Console. This value cannot be used with CREATE_NEW_CONSOLE.</TD></TR>
<TR><TD valign="top">EXTENDED_STARTUPINFO_PRESENT</TD><TD valign="top">&amp;h00080000</TD><TD valign="top">The process is created with extended startup information; the lpStartupInfo parameter specifies a STARTUPINFOEX structure. Windows Server 2003 and Windows XP/2000:  This value is not supported.</TD></TR>
<TR><TD valign="top">INHERIT_PARENT_AFFINITY</TD><TD valign="top">&amp;h00010000</TD><TD valign="top">The process inherits its parent&#39;s affinity. If the parent process has threads in more than one processor group, the new process inherits the group-relative affinity of an arbitrary group in use by the parent. Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP/2000:  This value is not supported.</TD></TR>
<TR><TD valign="top">ABOVE_NORMAL_PRIORITY_CLASS</TD><TD valign="top">&amp;h00008000</TD><TD valign="top">Process that has priority above NORMAL_PRIORITY_CLASS but below HIGH_PRIORITY_CLASS.</TD></TR>
<TR><TD valign="top">BELOW_NORMAL_PRIORITY_CLASS</TD><TD valign="top">&amp;h00004000</TD><TD valign="top">Process that has priority above IDLE_PRIORITY_CLASS but below NORMAL_PRIORITY_CLASS.</TD></TR>
<TR><TD valign="top">HIGH_PRIORITY_CLASS</TD><TD valign="top">&amp;h00000080</TD><TD valign="top">Process that performs time-critical tasks that must be executed immediately for it to run correctly. The threads of a high-priority class process preempt the threads of normal or idle priority class processes. An example is the Task List, which must respond quickly when called by the user, regardless of the load on the operating system. Use extreme care when using the high-priority class, because a high-priority class CPU-bound application can use nearly all available cycles.</TD></TR>
<TR><TD valign="top">IDLE_PRIORITY_CLASS</TD><TD valign="top">&amp;h00000040</TD><TD valign="top">Process whose threads run only when the system is idle and are preempted by the threads of any process running in a higher priority class. An example is a screen saver. The idle priority class is inherited by child processes.</TD></TR>
<TR><TD valign="top">NORMAL_PRIORITY_CLASS</TD><TD valign="top">&amp;h00000020</TD><TD valign="top">Process with no special scheduling needs.</TD></TR>
<TR><TD valign="top">REALTIME_PRIORITY_CLASS</TD><TD valign="top">&amp;h00000100</TD><TD valign="top">Process that has the highest possible priority. The threads of a real-time priority class process preempt the threads of all other processes, including operating system processes performing important tasks. For example, a real-time process that executes for more than a very brief interval can cause disk caches not to flush or cause the mouse to be unresponsive.</TD></TR>
</TABLE>
<BR>
ShowWindow can be values for ShowWindow function to define how first window of new application is shown. Available values:<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Constants</TD><TD valign="top">Value</TD><TD valign="top">Meaning</TD></TR>
<TR><TD valign="top">SW_FORCEMINIMIZE</TD><TD valign="top">11</TD><TD valign="top">Minimizes a window, even if the thread that owns the window is not responding. This flag should only be used when minimizing windows from a different thread.</TD></TR>
<TR><TD valign="top">SW_HIDE</TD><TD valign="top">0</TD><TD valign="top">Hides the window and activates another window.</TD></TR>
<TR><TD valign="top">SW_MAXIMIZE</TD><TD valign="top">3</TD><TD valign="top">Maximizes the specified window.</TD></TR>
<TR><TD valign="top">SW_MINIMIZE</TD><TD valign="top">6</TD><TD valign="top">Minimizes the specified window and activates the next top-level window in the Z order.</TD></TR>
<TR><TD valign="top">SW_RESTORE</TD><TD valign="top">9</TD><TD valign="top">Activates and displays the window. If the window is minimized or maximized, the system restores it to its original size and position. An application should specify this flag when restoring a minimized window.</TD></TR>
<TR><TD valign="top">SW_SHOW</TD><TD valign="top">5</TD><TD valign="top">Activates the window and displays it in its current size and position.</TD></TR>
<TR><TD valign="top">SW_SHOWDEFAULT</TD><TD valign="top">10</TD><TD valign="top">Sets the show state based on the SW_ value specified in the STARTUPINFO structure passed to the CreateProcess function by the program that started the application.</TD></TR>
<TR><TD valign="top">SW_SHOWMAXIMIZED</TD><TD valign="top">3</TD><TD valign="top">Activates the window and displays it as a maximized window.</TD></TR>
<TR><TD valign="top">SW_SHOWMINIMIZED</TD><TD valign="top">2</TD><TD valign="top">Activates the window and displays it as a minimized window.</TD></TR>
<TR><TD valign="top">SW_SHOWMINNOACTIVE</TD><TD valign="top">7</TD><TD valign="top">Displays the window as a minimized window. This value is similar to SW_SHOWMINIMIZED, except the window is not activated.</TD></TR>
<TR><TD valign="top">SW_SHOWNA</TD><TD valign="top">8</TD><TD valign="top">Displays the window in its current size and position. This value is similar to SW_SHOW, except that the window is not activated.</TD></TR>
<TR><TD valign="top">SW_SHOWNOACTIVATE</TD><TD valign="top">4</TD><TD valign="top">Displays a window in its most recent size and position. This value is similar to SW_SHOWNORMAL, except that the window is not activated.</TD></TR>
<TR><TD valign="top">SW_SHOWNORMAL</TD><TD valign="top">1</TD><TD valign="top">Activates and displays a window. If the window is minimized or maximized, the system restores it to its original size and position. An application should specify this flag when displaying the window for the first time.</TD></TR>
</TABLE>
<h4>Blog Entries</h4>
<ul>
<li><a href="https://www.mbsplugins.de/archive/2021-01-19/MonkeyBread_Software_Releases_/monkeybreadsoftware_blog_xojo">MonkeyBread Software Releases the MBS Xojo Plugins in version 21.0</a></li>
<li><a href="https://www.mbsplugins.de/archive/2021-01-16/MBS_Xojo_Plugins_version_210pr/monkeybreadsoftware_blog_xojo">MBS Xojo Plugins, version 21.0pr8</a></li>
<li><a href="https://www.mbsplugins.de/archive/2011-01-10/MBS_REALbasic_Plugins_version_/monkeybreadsoftware_blog_xojo">MBS REALbasic Plugins, version 11.0pr13</a></li>
</ul>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbswinplugin.html">MBS Win Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=global-windowsexecutembs">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

