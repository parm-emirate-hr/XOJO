<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - SmartCardMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="SmartCardMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">SmartCardMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-smartcardmbs.html">SmartCardMBS</a> class.  </p>
<div class="WLM">
<b><a href="class-smartcardmbs.html">SmartCardMBS</a>.<A name="1">BeginTransaction</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-smartcard.html" translate="no">SmartCard</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion163.shtml" class=version>16.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Starts a transaction.<BR>
<B>Notes:</B> 
<BR>
The function waits for the completion of all other transactions before it begins. After the transaction starts, all other applications are blocked from accessing the smart card while the transaction is in progress.<BR>
<BR>
If a transaction is held on the card for more than five seconds with no operations happening on that card, then the card is reset. Calling any of the Smart Card and Reader Access Functions or Direct Card Access Functions on the card that is transacted results in the timer being reset to continue allowing the transaction to be used.<BR>
The BeginTransaction function is a smart card and reader access function. For more information about other access functions, see Smart Card and Reader Access Functions.<BR>
<BR>
Lasterror is set.<BR>
</div>
<div class="WLM">
<b><a href="class-smartcardmbs.html">SmartCardMBS</a>.<A name="2">CancelTransaction</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-smartcard.html" translate="no">SmartCard</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion163.shtml" class=version>16.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Cancels current transaction.<BR>
<B>Notes:</B> 
Lasterror is set.<BR>
</div>
<div class="WLM">
<b><a href="class-smartcardmbs.html">SmartCardMBS</a>.<A name="3">Constructor</A></b> &nbsp; <b style="color: #8B0000"> Private </b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-smartcard.html" translate="no">SmartCard</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion163.shtml" class=version>16.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
The private constructor.<BR>
</div>
<div class="WLM">
<b><a href="class-smartcardmbs.html">SmartCardMBS</a>.<A name="4">Control(ControlCode as Integer, input as ptr, inputLength as UInt32, output as ptr, byref outputLength as UInt32)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-smartcard.html" translate="no">SmartCard</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion163.shtml" class=version>16.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Direct control of the reader. <BR>
<B>Notes:</B> 
<BR>
You can call it any time after a successful call to SmartCard.Connect and before a successful call to SmartCard.Disconnect. The effect on the state of the reader depends on the control code.<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">ControlCode: Control code for the operation. This value identifies the specific operation to be performed.</TD><TD valign="top"></TD></TR>
</TABLE>
Input: Pointer to a buffer that contains the data required to perform the operation. This parameter can be nil if the ControlCode parameter specifies an operation that does not require input data.<BR>
inputLength: Size, in bytes, of the buffer pointed to by Input.<BR>
output: Pointer to a buffer that receives the operation&#39;s output data. This parameter can be nil if the ControlCode parameter specifies an operation that does not produce output data.<BR>
outputLength: On input the size, in bytes, of the buffer pointed to by output. On output the receives the size, in bytes, of the data stored into the buffer pointed to by output.<BR>
<BR>
Lasterror is set.<BR>
</div>
<div class="WLM">
<b><a href="class-smartcardmbs.html">SmartCardMBS</a>.<A name="5">Disconnect(Disposition as Integer = 0)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-smartcard.html" translate="no">SmartCard</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion163.shtml" class=version>16.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Terminates a connection previously opened between the calling application and a smart card in the target reader.<BR>
<B>Notes:</B> 
<BR>
Disposition: Action to take on the card in the connected reader on close. <BR>
can be:<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">kUnpowerCard</TD><TD valign="top">Power down the card and reset it (Cold Reset).</TD></TR>
<TR><TD valign="top">kResetCard</TD><TD valign="top">Reset the card (Warm Reset).</TD></TR>
<TR><TD valign="top">kLeaveCard</TD><TD valign="top">Do not do anything special on reconnect.</TD></TR>
<TR><TD valign="top">kEjectCard</TD><TD valign="top">Eject card.</TD></TR>
</TABLE>
Lasterror is set.<BR>
</div>
<div class="WLM">
<b><a href="class-smartcardmbs.html">SmartCardMBS</a>.<A name="6">EndTransaction(Disposition as Integer = 0)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-smartcard.html" translate="no">SmartCard</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion163.shtml" class=version>16.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Ends transaction.<BR>
<B>Notes:</B> 
<BR>
Completes a previously declared transaction, allowing other applications to resume interactions with the card.<BR>
<BR>
Disposition: Action to take on the card in the connected reader on close. Can be Eject, Leave, Reset or Unpower. See constants.<BR>
<BR>
Lasterror is set.<BR>
</div>
<div class="WLM">
<b><a href="class-smartcardmbs.html">SmartCardMBS</a>.<A name="7">GetAttrib(AttrId as UInt32) as Memoryblock</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-smartcard.html" translate="no">SmartCard</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion163.shtml" class=version>16.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Retrieves the current reader attributes for the given handle.<BR>
<B>Notes:</B> 
<BR>
It does not affect the state of the reader, driver, or card.<BR>
The plugin first queries for size of attribute and on success queries again to get the data and return it as a memoryblock.<BR>
<BR>
AttrId: The attribute ID. See kAttribute* constants.<BR>
<BR>
Lasterror is set.<BR>
</div>
<div class="WLM">
<b><a href="class-smartcardmbs.html">SmartCardMBS</a>.<A name="8">ReadFile(FileID as MemoryBlock) as MemoryBlock</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-smartcard.html" translate="no">SmartCard</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion185.shtml" class=version>18.5</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Read file from smart card with APDU protocol.<BR>
<B>Notes:</B> 
<BR>
Returns data as MemoryBlock or error message.<BR>
The first two bytes are status code.<BR>
<BR>
For Swiss health cards, the relevant IDs are 2F06 and 2F07.<BR>
<BR>
For Belgian EID:<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">4031</TD><TD valign="top">ID RN</TD></TR>
<TR><TD valign="top">4032</TD><TD valign="top">SGN RN</TD></TR>
<TR><TD valign="top">4033</TD><TD valign="top">ID Address</TD></TR>
<TR><TD valign="top">4034</TD><TD valign="top">SGN Address</TD></TR>
<TR><TD valign="top">4035</TD><TD valign="top">ID Photo</TD></TR>
</TABLE>
<BR>
You find the IDs for files usually in documentation or your card!<BR>
For some cards you may first need to move down a hierarchy of folders to get an item via Transmit().<BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-tools-smartcard-smartcard.html">/Tools/SmartCard/SmartCard</A></li>
</ul>
</div>
<div class="WLM">
<b><a href="class-smartcardmbs.html">SmartCardMBS</a>.<A name="9">Reconnect(ShareMode as UInt32, PreferredProtocols as UInt32, Initialization as UInt32)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-smartcard.html" translate="no">SmartCard</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion163.shtml" class=version>16.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
The Reconnect function reestablishes an existing connection between the calling application and a smart card. <BR>
<B>Notes:</B> 
<BR>
This function moves a card handle from direct access to general access, or acknowledges and clears an error condition that is preventing further access to the card.<BR>
<BR>
Initialization can be one of the following:<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">kUnpowerCard</TD><TD valign="top">Power down the card and reset it (Cold Reset).</TD></TR>
<TR><TD valign="top">kResetCard</TD><TD valign="top">Reset the card (Warm Reset).</TD></TR>
<TR><TD valign="top">kLeaveCard</TD><TD valign="top">Do not do anything special on reconnect.</TD></TR>
</TABLE>
<BR>
ShareMode: A flag that indicates whether other applications may form connections to the card. Use one of <A href="class-smartcardmbs.html">SmartCardMBS</A>.kShare* constants. e.g. kShareExclusive<BR>
PreferredProtocols: A bitmask of acceptable protocols for the connection. Possible values may be combined with the OR operation. Use <A href="class-smartcardmbs.html">SmartCardMBS</A>.kProtocol* constants. e.g. kProtocolT1<BR>
<BR>
Lasterror and ActiveProtocol are set.<BR>
</div>
<div class="WLM">
<b><a href="class-smartcardmbs.html">SmartCardMBS</a>.<A name="10">SetAttrib(AttrId as UInt32, mem as Memoryblock)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-smartcard.html" translate="no">SmartCard</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion163.shtml" class=version>16.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Sets the given reader attribute.<BR>
<B>Notes:</B> 
<BR>
It does not affect the state of the reader, reader driver, or smart card. Not all attributes are supported by all readers (nor can they be set at all times) as many of the attributes are under direct control of the transport protocol.<BR>
<BR>
AttrId: The attribute ID. See kAttribute* constants.<BR>
Mem: The data to store.<BR>
<BR>
Lasterror is set.<BR>
</div>
<div class="WLM">
<b><a href="class-smartcardmbs.html">SmartCardMBS</a>.<A name="11">Status(byref Reader as string, byref State as Integer, byref Protocol as Integer, byref CardID as string)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-smartcard.html" translate="no">SmartCard</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion163.shtml" class=version>16.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Provides the current status of a smart card in a reader.<BR>
<B>Notes:</B> 
<BR>
You can call it any time after a successful call to SCardConnect and before a successful call to SCardDisconnect. It does not affect the state of the reader or reader driver.<BR>
<BR>
Provides reader name, state of card (see kState constants), Protocol (see kProtocol constants) and CardID.<BR>
<BR>
State: Current state of the smart card in the reader. Upon success, it receives one of the following state indicators.<BR>
Protocol: Current protocol, if any. The returned value is meaningful only if the returned value of pdwState is kCardStateSpecific.<BR>
CardID: 32-byte buffer that receives the ATR string from the currently inserted card, if available.<BR>
<BR>
Lasterror is set.<BR>
<p>See also:<ul>
<li><A href="smartcard-smartcardmbs-method.html#12">Status(byref State as Integer, byref Protocol as Integer, byref CardID as string)</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-smartcardmbs.html">SmartCardMBS</a>.<A name="12">Status(byref State as Integer, byref Protocol as Integer, byref CardID as string)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-smartcard.html" translate="no">SmartCard</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion163.shtml" class=version>16.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Provides the current status of a smart card in a reader.<BR>
<B>Notes:</B> 
<BR>
Same as other Status function, but without querying the name.<BR>
Lasterror is set.<BR>
<p>See also:<ul>
<li><A href="smartcard-smartcardmbs-method.html#11">Status(byref Reader as string, byref State as Integer, byref Protocol as Integer, byref CardID as string)</A></li>
</ul></p>
</div>
<div class="WLM">
<b><a href="class-smartcardmbs.html">SmartCardMBS</a>.<A name="13">Transmit(ioSendPci as Ptr, SendBuffer as ptr, SendLength as UInt32, ioRecvPci as ptr, RecvBuffer as Ptr, byref RecvLength as UInt32)</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-smartcard.html" translate="no">SmartCard</A></td>
<td class=grau><a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a></td>
<td class=grau><a href="newinversion163.shtml" class=version>16.3</a></td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop, Console & Web</td>
</tr>
</table>
<B>Function:</B> 
Sends a service request to the smart card and expects to receive data back from the card.<BR>
<B>Example:</B> 
<div class=CodeExample translate="no">
<pre>
<span style="color: #000000;"><span style="color: #0000FF;">dim</span> card <span style="color: #0000FF;">as</span> <A href="class-smartcardmbs.html">SmartCardMBS</A> <span style="color: #800000;">// your card</span><br /><br /><span style="color: #0000FF;">dim</span> header <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> memoryBlock(<span style="color: #336698;">8</span>)<br /><br />header.Int32Value(<span style="color: #336698;">0</span>) = <span style="color: #336698;">2</span> <span style="color: #800000;">// T1</span><br />header.Int32Value(<span style="color: #336698;">4</span>) = <span style="color: #336698;">8</span> <span style="color: #800000;">// size of this block</span><br /><br /><span style="color: #0000FF;">dim</span> command <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> MemoryBlock(<span style="color: #336698;">5</span>)<br />command.Int8Value(<span style="color: #336698;">0</span>) = <span style="color: #336698;">0</span><br />command.Int8Value(<span style="color: #336698;">1</span>) = <span style="color: #336698;">&amp;hCA</span><br />command.Int8Value(<span style="color: #336698;">2</span>) = <span style="color: #336698;">1</span><br />command.Int8Value(<span style="color: #336698;">3</span>) = <span style="color: #336698;">&amp;h82</span><br />command.Int8Value(<span style="color: #336698;">4</span>) = <span style="color: #336698;">2</span><br /><br /><span style="color: #0000FF;">dim</span> buffer <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> MemoryBlock(<span style="color: #336698;">512</span>)<br /><span style="color: #0000FF;">dim</span> ReceiveHeader <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">new</span> MemoryBlock(<span style="color: #336698;">8</span>)<br /><br /><span style="color: #0000FF;">dim</span> RecvLength <span style="color: #0000FF;">as</span> <span style="color: #0000FF;">UInt32</span><br />card.Transmit(header, command, command.Size, ReceiveHeader, buffer, RecvLength)<br /><br />MsgBox <span style="color: #6600FE;">&quot;Received &quot;</span>+str(RecvLength)+<span style="color: #6600FE;">&quot; bytes&quot;</span></span>
</pre>
</div>
<B>Notes:</B> 
<BR>
ioSendPci: <BR>
A pointer to the protocol header structure for the instruction. This buffer is in the format of an SCARD_IO_REQUEST structure, followed by the specific protocol control information (PCI).<BR>
For the T=0, T=1, and Raw protocols, the PCI structure is constant. The smart card subsystem supplies a global T=0, T=1, or Raw PCI structure, which you can reference by using the symbols SCARD_PCI_T0, SCARD_PCI_T1, and SCARD_PCI_RAW respectively.<BR>
<BR>
SendBuffer:<BR>
A pointer to the actual data to be written to the card.<BR>
For T=0, the data parameters are placed into the address pointed to by SendBuffer according to the following structure:<BR>
<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Type</TD><TD valign="top">name</TD><TD valign="top">Description</TD></TR>
<TR><TD valign="top">Byte</TD><TD valign="top">Cla</TD><TD valign="top">The instruction class</TD></TR>
<TR><TD valign="top">Byte</TD><TD valign="top">Ins</TD><TD valign="top">The instruction code </TD></TR>
<TR><TD valign="top">Byte</TD><TD valign="top">P1</TD><TD valign="top">Parameter to the instruction</TD></TR>
<TR><TD valign="top">Byte</TD><TD valign="top">P2</TD><TD valign="top">Parameter to the instruction</TD></TR>
<TR><TD valign="top">Byte</TD><TD valign="top">P3</TD><TD valign="top">Size of I/O transfer</TD></TR>
</TABLE>
<BR>
The data sent to the card should immediately follow the send buffer. In the special case where no data is sent to the card and no data is expected in return, P3 is not sent.<BR>
<BR>
SendLength:<BR>
The length, in bytes, of the SendBuffer parameter.<BR>
For T=0, in the special case where no data is sent to the card and no data expected in return, this length must reflect that the P3 member is not being sent; the length should be 4.<BR>
<BR>
ioRecvPci:<BR>
Pointer to the protocol header structure for the instruction, followed by a buffer in which to receive any returned protocol control information (PCI) specific to the protocol in use. This parameter can be nil if no PCI is returned.<BR>
<BR>
RecvBuffer:<BR>
Pointer to any data returned from the card.<BR>
For T=0, the data is immediately followed by the SW1 and SW2 status bytes. If no data is returned from the card, then this buffer will only contain the SW1 and SW2 status bytes.<BR>
<BR>
RecvLength:<BR>
Supplies the length, in bytes, of the RecvBuffer parameter and receives the actual number of bytes received from the smart card. This value cannot be SCARD_AUTOALLOCATE because Transmit does not support SCARD_AUTOALLOCATE.<BR>
For T=0, the receive buffer must be at least two bytes long to receive the SW1 and SW2 status bytes.<BR>
<BR>
see also<BR>
<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa379804(v=vs.85).aspx" target=_blank>https://msdn.microsoft.com/en-us/library/windows/desktop/aa379804(v=vs.85).aspx</a><BR>
<BR>
Lasterror is set.<BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbstoolsplugin.html">MBS Tools Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=smartcard-smartcardmbs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

