<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /MacCocoa/Addressbook/Show my entry</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /MacCocoa/Addressbook/Show my entry</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/MacCocoa/Addressbook/Show my entry</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS MacBase Plugin, MBS MacCocoa Plugin, MBS Main Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /MacCocoa/Addressbook/Show my entry<BR>
This example is the version from Sun, 4th Apr 2015.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;Show</span> <span style="color:#6500FE">my</span> <span style="color:#6500FE">entry.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> Window1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control lFirst <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance lFirst <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control vFirst <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance vFirst <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control lLast <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance lLast <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control vLast <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance vLast <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control lCompany <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance lCompany <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control vCompany <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance vCompany <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control ljobtitle <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance ljobtitle <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control vjobtitle <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance vjobtitle <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control lhome <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance lhome <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control vhome <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance vhome <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control lbirthday <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance lbirthday <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control vbirthday <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance vbirthday <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control lworkphone <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance lworkphone <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control lmobilephone <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance lmobilephone <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control vworkphone <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance vworkphone <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control vmobilephone <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance vmobilephone <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Canvas1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Canvas</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Canvas1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Canvas</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control EditField1 <span style="color:#0000FF;font-weight: bold">Inherits</span> TextArea</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance EditField1 <span style="color:#0000FF;font-weight: bold">Inherits</span> TextArea</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control lworkURL <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance lworkURL <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control lHomeURL <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance lHomeURL <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control vworkURL <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance vworkURL <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control vPrivateURL <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance vPrivateURL <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control lFlags <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance lFlags <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control vFlags <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance vFlags <span style="color:#0000FF;font-weight: bold">Inherits</span> Label</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			a=<span style="color:#0000FF;font-weight: bold">new</span> ABAddressbookMBS
			
			ShowMe
			ShowAddress
			ShowPicture
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Protected</span> <span style="color:#0000FF;font-weight: bold">Sub</span> ShowAddress()
			<span style="color:#0000FF;font-weight: bold">dim</span> a <span style="color:#0000FF;font-weight: bold">as</span> ABAddressbookMBS
			<span style="color:#0000FF;font-weight: bold">dim</span> p <span style="color:#0000FF;font-weight: bold">as</span> ABPersonMBS
			<span style="color:#0000FF;font-weight: bold">dim</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> m <span style="color:#0000FF;font-weight: bold">as</span> ABMultiValueMBS
			<span style="color:#0000FF;font-weight: bold">dim</span> id <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> index,pindex <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> count <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> first,last <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> d <span style="color:#0000FF;font-weight: bold">as</span> Dictionary
			<span style="color:#0000FF;font-weight: bold">dim</span> o <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> Variant
			<span style="color:#0000FF;font-weight: bold">dim</span> formattedAddress <span style="color:#0000FF;font-weight: bold">as</span> NSAttributedStringMBS
			<span style="color:#0000FF;font-weight: bold">dim</span> street,zip,city,Country,State <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
			
			a=<span style="color:#0000FF;font-weight: bold">new</span> ABAddressbookMBS
			
			p=a.owner
			
			<span style="color:#0000FF;font-weight: bold">if</span> p&lt;&gt;<span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				
				first=p.valueForProperty(a.kABFirstNameProperty)
				last=p.valueForProperty(a.kABLastNameProperty)
				
				s=first+<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&quot;</span>+last+EndOfLine+EndOfLine
				m=p.valueForProperty(a.kABAddressProperty)
				<span style="color:#0000FF;font-weight: bold">if</span> m&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
					id=m.primaryIdentifier
					pindex=m.IndexForIdentifier(id)
					count=m.Count-<span style="color:#326598">1</span>
					
					<span style="color:#0000FF;font-weight: bold">for</span> index=<span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> count
						s=s+<span style="color:#6500FE">&quot;Address</span> <span style="color:#6500FE">&quot;</span>+str(index+<span style="color:#326598">1</span>)+<span style="color:#6500FE">&quot;:&quot;</span>+chr(<span style="color:#326598">13</span>)
						<span style="color:#0000FF;font-weight: bold">if</span> index=pindex <span style="color:#0000FF;font-weight: bold">then</span>
							s=s+<span style="color:#6500FE">&quot;Primary:&quot;</span>+EndOfLine
						<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
						
						v=m.valueAtIndex(index)
						<span style="color:#0000FF;font-weight: bold">if</span> v <span style="color:#0000FF;font-weight: bold">isa</span> Dictionary <span style="color:#0000FF;font-weight: bold">then</span>
							d=v
							
							<span style="color:#0000FF;font-weight: bold">if</span> d.HasKey(a.kABAddressStreetKey) <span style="color:#0000FF;font-weight: bold">then</span>
								street=d.Value(a.kABAddressStreetKey)
							<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
							
							<span style="color:#0000FF;font-weight: bold">if</span> d.HasKey(a.kABAddressZipKey) <span style="color:#0000FF;font-weight: bold">then</span>
								zip=d.Value(a.kABAddressZipKey)
							<span style="color:#0000FF;font-weight: bold">else</span>
								zip=<span style="color:#6500FE">&quot;&quot;</span>
							<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
							
							<span style="color:#0000FF;font-weight: bold">if</span> d.HasKey(a.kABAddressCityKey) <span style="color:#0000FF;font-weight: bold">then</span>
								city=d.Value(a.kABAddressCityKey)
							<span style="color:#0000FF;font-weight: bold">else</span>
								city=<span style="color:#6500FE">&quot;&quot;</span>
							<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
							
							<span style="color:#0000FF;font-weight: bold">if</span> d.HasKey(a.kABAddressCityKey) <span style="color:#0000FF;font-weight: bold">then</span>
								State=d.Value(a.kABAddressCityKey)
							<span style="color:#0000FF;font-weight: bold">else</span>
								State=<span style="color:#6500FE">&quot;&quot;</span>
							<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
							
							<span style="color:#0000FF;font-weight: bold">if</span> d.HasKey(a.kABAddressCountryKey) <span style="color:#0000FF;font-weight: bold">then</span>
								Country=d.Value(a.kABAddressCountryKey)
							<span style="color:#0000FF;font-weight: bold">else</span>
								Country=<span style="color:#6500FE">&quot;&quot;</span>
							<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
							
							s=s+street+EndOfLine
							s=s+Zip+<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">&quot;</span>+City+EndOfLine
							
							<span style="color:#0000FF;font-weight: bold">if</span> state&lt;&gt;<span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">Germany</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">don&#39;t</span> <span style="color:#7F0000;text-style:italic">use</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">State</span> <span style="color:#7F0000;text-style:italic">Value</span>
								s=s+state+<span style="color:#6500FE">&quot;,</span> <span style="color:#6500FE">&quot;</span>
							<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
							s=s+country+EndOfLine+EndOfLine
							
							<span style="color:#0000FF;font-weight: bold">if</span> d&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
								formattedAddress=a.formattedAddressFromDictionary(d)
								<span style="color:#0000FF;font-weight: bold">if</span> formattedAddress&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
									s=s+<span style="color:#6500FE">&quot;Formatted</span> <span style="color:#6500FE">address:&quot;</span>+EndOfLine+<span style="color:#6500FE">&quot;(Mac</span> <span style="color:#6500FE">OS</span> <span style="color:#6500FE">X</span> <span style="color:#6500FE">10.3</span> <span style="color:#6500FE">only)&quot;</span>+EndOfLine+formattedAddress.text+EndOfLine+EndOfLine
								<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
							<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
							
						<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
					<span style="color:#0000FF;font-weight: bold">next</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				s=<span style="color:#6500FE">&quot;me</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">set.&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			editfield1.text=S
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Protected</span> <span style="color:#0000FF;font-weight: bold">Sub</span> ShowMe()
			<span style="color:#0000FF;font-weight: bold">dim</span> p <span style="color:#0000FF;font-weight: bold">as</span> ABPersonMBS
			<span style="color:#0000FF;font-weight: bold">dim</span> m <span style="color:#0000FF;font-weight: bold">as</span> ABMultiValueMBS
			<span style="color:#0000FF;font-weight: bold">dim</span> st <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> flags <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			
			p=a.Owner
			<span style="color:#0000FF;font-weight: bold">if</span> p&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Try</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">value</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">method</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">put</span> <span style="color:#7F0000;text-style:italic">it</span> <span style="color:#7F0000;text-style:italic">into</span> <span style="color:#7F0000;text-style:italic">fields</span>
				
				trystring(p,a.kABFirstNameProperty,lfirst,vfirst)
				trystring(p,a.kABLastNameProperty,llast,vlast)
				trystring(p,a.kABOrganizationProperty,lcompany,vcompany)
				trystring(p,a.kaBJobTitleProperty,ljobtitle,vjobtitle)
				
				<span style="color:#0000FF;font-weight: bold">if</span> a.kABURLsProperty=<span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">Mac</span> <span style="color:#7F0000;text-style:italic">OS</span> <span style="color:#7F0000;text-style:italic">X</span> <span style="color:#7F0000;text-style:italic">10.3</span>
					
					trystring(p,a.kABHomePageProperty,lhome,vhome)
					
				<span style="color:#0000FF;font-weight: bold">else</span>
					<span style="color:#7F0000;text-style:italic">&#39;</span> <span style="color:#7F0000;text-style:italic">Mac</span> <span style="color:#7F0000;text-style:italic">OS</span> <span style="color:#7F0000;text-style:italic">X</span> <span style="color:#7F0000;text-style:italic">10.4</span>
					m=p.valueForProperty(a.kABURLsProperty)
					trylabel(m,a.kABWorkLabel,lworkURL,vworkURL)
					trylabel(m,a.kABHomeLabel,lHomeURL,vPrivateURL)
					trylabel(m,a.kABHomePageLabel,lhome,vhome)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				trydate(p,a.kABBirthdayProperty,lbirthday,vbirthday)
				
				m=p.valueForProperty(a.kABPhoneProperty)
				trylabel(m,a.kABPhoneWorkLabel,lworkphone,vworkphone)
				trylabel(m,a.kABPhoneMobileLabel,lmobilephone,vmobilephone)
				
				<span style="color:#0000FF;font-weight: bold">if</span> a.kABPersonFlags=<span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
					vFlags.text=<span style="color:#6500FE">&quot;?&quot;</span>
				<span style="color:#0000FF;font-weight: bold">else</span>
					flags=p.valueForProperty(a.kABPersonFlags)
					
					<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">case</span> BitwiseAnd(flags,a.kABShowAsMask)
					<span style="color:#0000FF;font-weight: bold">case</span> a.kABShowAsPerson
						st=<span style="color:#6500FE">&quot;Person&quot;</span>
					<span style="color:#0000FF;font-weight: bold">case</span> a.kABShowAsCompany
						st=<span style="color:#6500FE">&quot;Company&quot;</span>
					<span style="color:#0000FF;font-weight: bold">else</span>
						st=<span style="color:#6500FE">&quot;Unkown</span> <span style="color:#6500FE">Show</span> <span style="color:#6500FE">value&quot;</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">Select</span>
					
					<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">case</span> BitwiseAnd(flags,a.kABNameOrderingMask)
					<span style="color:#0000FF;font-weight: bold">case</span> a.kABFirstNameFirst
						st=st+<span style="color:#6500FE">&quot;,</span> <span style="color:#6500FE">First</span> <span style="color:#6500FE">name</span> <span style="color:#6500FE">sorted</span> <span style="color:#6500FE">first.&quot;</span>
					<span style="color:#0000FF;font-weight: bold">case</span> a.kABLastNameFirst
						st=st+<span style="color:#6500FE">&quot;,</span> <span style="color:#6500FE">Last</span> <span style="color:#6500FE">name</span> <span style="color:#6500FE">sorted</span> <span style="color:#6500FE">first.&quot;</span>
					<span style="color:#0000FF;font-weight: bold">case</span> a.kABDefaultNameOrdering
						<span style="color:#7F0000;text-style:italic">&#39;nothing</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">Select</span>
					
					vFlags.text=str(flags)+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+st
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				
			<span style="color:#0000FF;font-weight: bold">else</span>
				msgBox <span style="color:#6500FE">&quot;Owner</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">found.&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> ShowPicture()
			<span style="color:#0000FF;font-weight: bold">dim</span> p <span style="color:#0000FF;font-weight: bold">as</span> ABPersonMBS = a.owner
			<span style="color:#0000FF;font-weight: bold">if</span> p&lt;&gt;<span style="color:#0000FF;font-weight: bold">NIL</span> <span style="color:#0000FF;font-weight: bold">THEN</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> n <span style="color:#0000FF;font-weight: bold">as</span> NSImageMBS = p.image
				
				<span style="color:#0000FF;font-weight: bold">if</span> n &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> pic <span style="color:#0000FF;font-weight: bold">as</span> Picture = n.CopyPictureWithMask
					canvas1.backdrop=pic
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> trydate(person <span style="color:#0000FF;font-weight: bold">as</span> abpersonmbs,p <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>,label <span style="color:#0000FF;font-weight: bold">as</span> label,text <span style="color:#0000FF;font-weight: bold">as</span> label)
			<span style="color:#0000FF;font-weight: bold">dim</span> d <span style="color:#0000FF;font-weight: bold">as</span> Date
			<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> Variant
			<span style="color:#0000FF;font-weight: bold">dim</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>
			
			s=a.LocalizedPropertyOrLabel(p)
			<span style="color:#0000FF;font-weight: bold">if</span> s=<span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				label.text=p
			<span style="color:#0000FF;font-weight: bold">else</span>
				label.text=s
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			v=person.valueForProperty(p)
			
			<span style="color:#0000FF;font-weight: bold">if</span> v <span style="color:#0000FF;font-weight: bold">isa</span> date <span style="color:#0000FF;font-weight: bold">then</span>
				d=v
				text.text=d.longdate
			<span style="color:#0000FF;font-weight: bold">else</span>
				text.text=<span style="color:#6500FE">&quot;?&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> trylabel(multi <span style="color:#0000FF;font-weight: bold">as</span> ABMultiValueMBS,p <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>,label <span style="color:#0000FF;font-weight: bold">as</span> label,text <span style="color:#0000FF;font-weight: bold">as</span> label)
			<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> Variant
			<span style="color:#0000FF;font-weight: bold">dim</span> index <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> i,c <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			
			v=a.LocalizedPropertyOrLabel(p)
			<span style="color:#0000FF;font-weight: bold">if</span> v=<span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				label.text=p
			<span style="color:#0000FF;font-weight: bold">else</span>
				label.text=V
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> multi&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				index=-<span style="color:#326598">1</span>
				c=multi.Count-<span style="color:#326598">1</span>
				<span style="color:#0000FF;font-weight: bold">for</span> i=<span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> c
					<span style="color:#0000FF;font-weight: bold">if</span> multi.labelAtIndex(i)=p <span style="color:#0000FF;font-weight: bold">then</span>
						index=i
						<span style="color:#0000FF;font-weight: bold">exit</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">next</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> index&gt;=<span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					v=multi.valueAtIndex(index)
					text.text=v
					
				<span style="color:#0000FF;font-weight: bold">else</span>
					text.text=<span style="color:#6500FE">&quot;?&quot;</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> trystring(person <span style="color:#0000FF;font-weight: bold">as</span> abpersonmbs,p <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>,label <span style="color:#0000FF;font-weight: bold">as</span> label,text <span style="color:#0000FF;font-weight: bold">as</span> label)
			<span style="color:#0000FF;font-weight: bold">dim</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">String</span>
			
			s=a.LocalizedPropertyOrLabel(p)
			<span style="color:#0000FF;font-weight: bold">if</span> s=<span style="color:#6500FE">&quot;&quot;</span> <span style="color:#0000FF;font-weight: bold">then</span>
				label.text=p
			<span style="color:#0000FF;font-weight: bold">else</span>
				label.text=s
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> Variant
			
			v=person.valueForProperty(p)
			text.text=v
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> <span style="color:#0000FF;font-weight: bold">Protected</span> a <span style="color:#0000FF;font-weight: bold">As</span> ABAddressBookMBS</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar Menu</div>
<div class="RB_Code">		MenuItem UntitledMenu3 = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		MenuItem UntitledMenu2 = <span style="color:#6500FE">&quot;File&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;Quit&quot;</span></div>
<div class="RB_Code">		MenuItem UntitledMenu0 = <span style="color:#6500FE">&quot;Edit&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;Undo&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu1 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;Cut&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;Copy&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;Paste&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;Clear&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			<span style="color:#0000FF;font-weight: bold">if</span> TargetMachO=<span style="color:#0000FF;font-weight: bold">false</span> <span style="color:#0000FF;font-weight: bold">then</span>
				MsgBox <span style="color:#6500FE">&quot;This</span> <span style="color:#6500FE">example</span> <span style="color:#6500FE">needs</span> <span style="color:#6500FE">a</span> <span style="color:#6500FE">MachO</span> <span style="color:#6500FE">target</span> <span style="color:#6500FE">running</span> <span style="color:#6500FE">on</span> <span style="color:#6500FE">Mac</span> <span style="color:#6500FE">OS</span> <span style="color:#6500FE">X.&quot;</span>
				quit
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbsmaccocoaplugin.html">MBS MacCocoa Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-maccocoa-addressbook-showmyentry">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

