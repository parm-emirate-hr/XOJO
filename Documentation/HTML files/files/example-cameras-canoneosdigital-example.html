<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - Example: /Cameras/CanonEOSDigital/Example</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="Example">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">Example: /Cameras/CanonEOSDigital/Example</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<div class="">
<b><A name="1">/Cameras/CanonEOSDigital/Example</A></b><br>
<B>Function:</B> 
<br>
Required plugins for this example: MBS Cameras Plugin, MBS Images Plugin<BR>
You find this example project in your Plugins Download as a Xojo project file within the examples folder: /Cameras/CanonEOSDigital/Example<BR>
This example is the version from Tue, 26th Sep 2016.<BR>

<div class="RB_Code">Project <span style="color:#6500FE">&quot;Example.xojo_binary_project&quot;</span></div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> App <span style="color:#0000FF;font-weight: bold">Inherits</span> Application</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kEditClear = <span style="color:#6500FE">&quot;&amp;L&ouml;schen&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuit = <span style="color:#6500FE">&quot;Beenden&quot;</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Const</span> kFileQuitShortcut = <span style="color:#6500FE">&quot;&quot;</span></div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Close()
			<span style="color:#0000FF;font-weight: bold">if</span> inited <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">can</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">trouble</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">don&#39;t</span> <span style="color:#7F0000;text-style:italic">cleanup</span> <span style="color:#7F0000;text-style:italic">properly</span>
				EDSModuleMBS.Terminate
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Open()
			DebugCopyFrameworks
			
			<span style="color:#0000FF;font-weight: bold">dim</span> file <span style="color:#0000FF;font-weight: bold">as</span> FolderItem
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">find</span> <span style="color:#7F0000;text-style:italic">DLL</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">application</span> <span style="color:#7F0000;text-style:italic">folder</span>
			<span style="color:#0000FF;font-weight: bold">if</span> TargetWin32 <span style="color:#0000FF;font-weight: bold">then</span>
				file = FindFile(<span style="color:#6500FE">&quot;EDSDK.dll&quot;</span>)
			<span style="color:#0000FF;font-weight: bold">elseif</span> TargetMacOS <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">find</span> <span style="color:#7F0000;text-style:italic">Framework</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">inside</span> <span style="color:#7F0000;text-style:italic">frameworks</span> <span style="color:#7F0000;text-style:italic">folder</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">app</span> <span style="color:#7F0000;text-style:italic">bundle</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> frameworks <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = app.ExecutableFile.Parent.parent.Child(<span style="color:#6500FE">&quot;Frameworks&quot;</span>)
				
				file = frameworks.Child(<span style="color:#6500FE">&quot;EDSDK.framework&quot;</span>)
			<span style="color:#0000FF;font-weight: bold">else</span>
				MsgBox <span style="color:#6500FE">&quot;not</span> <span style="color:#6500FE">supported.&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">pass</span> <span style="color:#7F0000;text-style:italic">true</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">version</span> <span style="color:#7F0000;text-style:italic">2.x</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">SDK</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">false</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">3.x</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> isVersion2 <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span> = <span style="color:#0000FF;font-weight: bold">true</span>
			
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">load</span> <span style="color:#7F0000;text-style:italic">framework</span> <span style="color:#7F0000;text-style:italic">or</span> <span style="color:#7F0000;text-style:italic">DLL</span>
			<span style="color:#0000FF;font-weight: bold">if</span> EDSModuleMBS.LoadLibrary(file, isVersion2) <span style="color:#0000FF;font-weight: bold">then</span>
				
				EDSModuleMBS.Initialize
				<span style="color:#0000FF;font-weight: bold">dim</span> e <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = EDSModuleMBS.Lasterror
				<span style="color:#0000FF;font-weight: bold">if</span> e = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					Inited = <span style="color:#0000FF;font-weight: bold">true</span>
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">okay,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">wait</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">cameras</span>
					cah = <span style="color:#0000FF;font-weight: bold">new</span> MyEdsCameraAddedHandlerMBS
					
					MainWindow.OpenDevice
					
				<span style="color:#0000FF;font-weight: bold">else</span>
					MsgBox <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">initialize:</span> <span style="color:#6500FE">&quot;</span>+str(e)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
			<span style="color:#0000FF;font-weight: bold">else</span>
				MsgBox <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">load</span> <span style="color:#6500FE">library.&quot;</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> DebugCopyFrameworks()
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">debug</span> <span style="color:#7F0000;text-style:italic">mode</span> <span style="color:#7F0000;text-style:italic">I</span> <span style="color:#7F0000;text-style:italic">used</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">copy</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">framework</span> <span style="color:#7F0000;text-style:italic">files</span> <span style="color:#7F0000;text-style:italic">into</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">app</span> <span style="color:#7F0000;text-style:italic">on</span> <span style="color:#7F0000;text-style:italic">startup</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">makes</span> <span style="color:#7F0000;text-style:italic">debugging</span> <span style="color:#7F0000;text-style:italic">much</span> <span style="color:#7F0000;text-style:italic">easier!</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> DebugBuild <span style="color:#0000FF;font-weight: bold">and</span> TargetMachO <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> frameworks <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = app.ExecutableFile.Parent.parent.Child(<span style="color:#6500FE">&quot;Frameworks&quot;</span>)
				
				<span style="color:#0000FF;font-weight: bold">dim</span> f <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = FindFile(<span style="color:#6500FE">&quot;EDSDK.framework&quot;</span>)
				
				f.CopyFileTo frameworks
				
				f = FindFile(<span style="color:#6500FE">&quot;DPP.framework&quot;</span>)
				f.CopyFileTo frameworks
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> FindFile(name <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span>) <span style="color:#0000FF;font-weight: bold">As</span> FolderItem
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">Look</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">file</span> <span style="color:#7F0000;text-style:italic">in</span> <span style="color:#7F0000;text-style:italic">parent</span> <span style="color:#7F0000;text-style:italic">folders</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">executable</span> <span style="color:#7F0000;text-style:italic">on</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> parent <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = app.ExecutableFile.Parent
			
			<span style="color:#0000FF;font-weight: bold">while</span> parent&lt;&gt;<span style="color:#0000FF;font-weight: bold">Nil</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> file <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = parent.Child(name)
				
				<span style="color:#0000FF;font-weight: bold">if</span> file&lt;&gt;<span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">and</span> file.Exists <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">Return</span> file
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				parent = parent.Parent
			<span style="color:#0000FF;font-weight: bold">wend</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Inited <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> cah <span style="color:#0000FF;font-weight: bold">As</span> MyEdsCameraAddedHandlerMBS</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MainWindow <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control List <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance List <span style="color:#0000FF;font-weight: bold">Inherits</span> Listbox</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Change()
				UpdateButton
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> ExpandRow(row <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Integer</span>)
				<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> Variant = <span style="color:#0000FF;font-weight: bold">me</span>.RowTag(row)
				
				<span style="color:#0000FF;font-weight: bold">if</span> v <span style="color:#0000FF;font-weight: bold">isa</span> EdsCameraMBS <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> camera <span style="color:#0000FF;font-weight: bold">as</span> EdsCameraMBS = v
					
					camera.OpenSession
					
					<span style="color:#0000FF;font-weight: bold">dim</span> u <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = camera.ChildCount-<span style="color:#326598">1</span>
					CheckError camera
					
					<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> u
						Add camera.Child(i)
					<span style="color:#0000FF;font-weight: bold">next</span>
					
				<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> EdsVolumeMBS <span style="color:#0000FF;font-weight: bold">then</span>
					
					<span style="color:#0000FF;font-weight: bold">dim</span> volume <span style="color:#0000FF;font-weight: bold">as</span> EdsVolumeMBS = v
					<span style="color:#0000FF;font-weight: bold">dim</span> u <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = volume.ChildCount-<span style="color:#326598">1</span>
					System.DebugLog <span style="color:#6500FE">&quot;Lasterror:</span> <span style="color:#6500FE">&quot;</span>+str(volume.Lasterror)
					
					
					<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> u
						add volume.Child(i)
					<span style="color:#0000FF;font-weight: bold">next</span>
					
				<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> EdsDirectoryItemMBS <span style="color:#0000FF;font-weight: bold">then</span>
					
					<span style="color:#0000FF;font-weight: bold">dim</span> folder <span style="color:#0000FF;font-weight: bold">as</span> EdsDirectoryItemMBS = v
					<span style="color:#0000FF;font-weight: bold">dim</span> u <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = folder.ChildCount-<span style="color:#326598">1</span>
					System.DebugLog <span style="color:#6500FE">&quot;Lasterror:</span> <span style="color:#6500FE">&quot;</span>+str(folder.Lasterror)
					
					
					<span style="color:#0000FF;font-weight: bold">for</span> i <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">to</span> u
						add folder.Child(i)
					<span style="color:#0000FF;font-weight: bold">next</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control TakePictureButton <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance TakePictureButton <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">send</span> <span style="color:#7F0000;text-style:italic">take</span> <span style="color:#7F0000;text-style:italic">picture</span> <span style="color:#7F0000;text-style:italic">command</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">save</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">host</span> <span style="color:#7F0000;text-style:italic">if</span> <span style="color:#7F0000;text-style:italic">you</span> <span style="color:#7F0000;text-style:italic">don&#39;t</span> <span style="color:#7F0000;text-style:italic">have</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">SD</span> <span style="color:#7F0000;text-style:italic">card</span>
				<span style="color:#7F0000;text-style:italic">&#39;camera.SetPropertyDataInt32(camera.kEdsPropID_SaveTo,</span> <span style="color:#7F0000;text-style:italic">0,</span> <span style="color:#7F0000;text-style:italic">EDSModuleMBS.kEdsSaveTo_Host)</span>
				<span style="color:#7F0000;text-style:italic">&#39;CheckError</span> <span style="color:#7F0000;text-style:italic">camera</span>
				
				camera.SendCommand camera.kEdsCameraCommand_TakePicture
				CheckError camera
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control ShowPictureButton <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance ShowPictureButton <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">download</span> <span style="color:#7F0000;text-style:italic">selected</span> <span style="color:#7F0000;text-style:italic">file</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> EdsDirectoryItemMBS = List.RowTag(List.ListIndex)
				<span style="color:#0000FF;font-weight: bold">dim</span> info <span style="color:#0000FF;font-weight: bold">as</span> EdsDirectoryItemInfoMBS = c.DirectoryItemInfo
				<span style="color:#0000FF;font-weight: bold">dim</span> file <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = SpecialFolder.Desktop.Child(info.FileName)
				
				stream = <span style="color:#0000FF;font-weight: bold">new</span> EdsStreamMBS(file, EdsStreamMBS.kEdsFileCreateDisposition_CreateNew, EdsStreamMBS.kEdsAccess_Write)
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">with</span> <span style="color:#7F0000;text-style:italic">progress,</span> <span style="color:#7F0000;text-style:italic">so</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">install</span> <span style="color:#7F0000;text-style:italic">progress</span> <span style="color:#7F0000;text-style:italic">callback</span>
				bar.Value = <span style="color:#326598">0</span>
				bar.Visible = <span style="color:#0000FF;font-weight: bold">true</span>
				Progress = <span style="color:#0000FF;font-weight: bold">new</span> MyEdsProgressMBS
				
				stream.SetProgress Progress, c.kEdsProgressOption_Periodically
				CheckError c
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">run</span> <span style="color:#7F0000;text-style:italic">download</span>
				c.Download(info.Size, stream)
				CheckError c
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">tell</span> <span style="color:#7F0000;text-style:italic">camera</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">are</span> <span style="color:#7F0000;text-style:italic">done</span>
				c.DownloadComplete
				CheckError c
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">cleanup</span>
				stream = <span style="color:#0000FF;font-weight: bold">nil</span>
				bar.Visible = <span style="color:#0000FF;font-weight: bold">false</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">and</span> <span style="color:#7F0000;text-style:italic">show</span> <span style="color:#7F0000;text-style:italic">file</span>
				file.Launch
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control bar <span style="color:#0000FF;font-weight: bold">Inherits</span> ProgressBar</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance bar <span style="color:#0000FF;font-weight: bold">Inherits</span> ProgressBar</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control DeleteFileButton <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance DeleteFileButton <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">delete</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">file</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> EdsDirectoryItemMBS = List.RowTag(List.ListIndex)
				
				c.DeleteDirectoryItem
				CheckError c
				
				List.RemoveRow List.ListIndex
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control StartLiveButton <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance StartLiveButton <span style="color:#0000FF;font-weight: bold">Inherits</span> PushButton</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				StartLiveView camera
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Timer1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Timer</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Timer1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Timer</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				EDSModuleMBS.GetEvent
				
				<span style="color:#0000FF;font-weight: bold">if</span> EDSModuleMBS.Lasterror &lt;&gt; <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">me</span>.Mode = <span style="color:#326598">0</span>
					MsgBox <span style="color:#6500FE">&quot;Error</span> <span style="color:#6500FE">&quot;</span>+str(EDSModuleMBS.Lasterror)+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+GetErrorMessage(EDSModuleMBS.Lasterror)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Add(v <span style="color:#0000FF;font-weight: bold">as</span> EdsDirectoryItemMBS)
			<span style="color:#0000FF;font-weight: bold">if</span> v&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> info <span style="color:#0000FF;font-weight: bold">as</span> EdsDirectoryItemInfoMBS = v.DirectoryItemInfo
				
				<span style="color:#0000FF;font-weight: bold">if</span> info.IsFolder <span style="color:#0000FF;font-weight: bold">then</span>
					List.AddFolder info.FileName
				<span style="color:#0000FF;font-weight: bold">else</span>
					List.AddRow info.FileName
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				List.RowTag(List.LastIndex) = v
				
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Add(v <span style="color:#0000FF;font-weight: bold">as</span> EdsVolumeMBS)
			<span style="color:#0000FF;font-weight: bold">if</span> v&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> info <span style="color:#0000FF;font-weight: bold">as</span> EdsVolumeInfoMBS = v.VolumeInfo
				
				List.AddFolder info.VolumeLabel
				List.RowTag(List.LastIndex) = v
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> Clear()
			List.DeleteAllRows
			TakePictureButton.Enabled = <span style="color:#0000FF;font-weight: bold">false</span>
			StartLiveButton.Enabled = <span style="color:#0000FF;font-weight: bold">false</span>
			
			camera = <span style="color:#0000FF;font-weight: bold">nil</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> OpenDevice()
			<span style="color:#0000FF;font-weight: bold">if</span> camera &lt;&gt; <span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">ignore</span> <span style="color:#7F0000;text-style:italic">second</span> <span style="color:#7F0000;text-style:italic">device</span>
			
			List.DeleteAllRows
			
			<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> EdsCameraListMBS = EDSModuleMBS.GetCameraList
			
			<span style="color:#0000FF;font-weight: bold">if</span> c&lt;&gt;<span style="color:#0000FF;font-weight: bold">Nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> count <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = c.ChildCount
				
				<span style="color:#0000FF;font-weight: bold">if</span> count&gt;<span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">only</span> <span style="color:#7F0000;text-style:italic">care</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">first</span> <span style="color:#7F0000;text-style:italic">device</span>
					
					camera = c.Child(<span style="color:#326598">0</span>)
					camera.OpenSession
					
					<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">install</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">couple</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">handlers</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">get</span> <span style="color:#7F0000;text-style:italic">events</span> <span style="color:#7F0000;text-style:italic">from</span> <span style="color:#7F0000;text-style:italic">device</span>
					MyEdsObjectEventHandler = <span style="color:#0000FF;font-weight: bold">new</span> MyEdsObjectEventHandlerMBS(camera, EDSModuleMBS.kEdsObjectEvent_All)
					MyEdsCameraStateEventHandler = <span style="color:#0000FF;font-weight: bold">new</span> MyEdsCameraStateEventHandlerMBS(camera, EDSModuleMBS.kEdsStateEvent_All)
					MyEdsPropertyEventHandler = <span style="color:#0000FF;font-weight: bold">new</span> MyEdsPropertyEventHandlerMBS(camera, EDSModuleMBS.kEdsPropertyEvent_All)
					MyEdsPropertyEventHandler.camera = camera
					
					
					timer1.Mode = <span style="color:#326598">2</span>
					
					
					<span style="color:#0000FF;font-weight: bold">dim</span> d <span style="color:#0000FF;font-weight: bold">as</span> EdsDeviceInfoMBS = camera.DeviceInfo
					
					List.AddFolder d.DeviceDescription
					List.RowTag(MainWindow.List.LastIndex) = camera
					
					
					TakePictureButton.Enabled = <span style="color:#0000FF;font-weight: bold">true</span>
					StartLiveButton.Enabled = <span style="color:#0000FF;font-weight: bold">true</span>
					
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> StartLiveView(camera <span style="color:#0000FF;font-weight: bold">as</span> EdsCameraMBS)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">set</span> <span style="color:#7F0000;text-style:italic">bit</span> <span style="color:#7F0000;text-style:italic">for</span> <span style="color:#7F0000;text-style:italic">redirecting</span> <span style="color:#7F0000;text-style:italic">output</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">PC,</span> <span style="color:#7F0000;text-style:italic">leave</span> <span style="color:#7F0000;text-style:italic">other</span> <span style="color:#7F0000;text-style:italic">bits</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">they</span> <span style="color:#7F0000;text-style:italic">are.</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> device <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt32</span> = camera.GetPropertyDataUInt32(camera.kEdsPropID_Evf_OutputDevice)
			
			CheckError camera
			
			<span style="color:#0000FF;font-weight: bold">if</span> camera.lasterror = EDSModuleMBS.EDS_ERR_OK <span style="color:#0000FF;font-weight: bold">then</span>
				
				device = Bitwise.BitOr(device, EDSModuleMBS.kEdsEvfOutputDevice_PC)
				
				camera.SetPropertyDataUInt32 camera.kEdsPropID_Evf_OutputDevice, <span style="color:#326598">0</span>, device
				CheckError camera
				
				System.DebugLog <span style="color:#6500FE">&quot;Set</span> <span style="color:#6500FE">Property&quot;</span>
				
				PicWindow.Camera = camera
				PicWindow.show
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> StopLiveView(camera <span style="color:#0000FF;font-weight: bold">as</span> EdsCameraMBS)
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">reset</span> <span style="color:#7F0000;text-style:italic">the</span> <span style="color:#7F0000;text-style:italic">output</span> <span style="color:#7F0000;text-style:italic">device</span> <span style="color:#7F0000;text-style:italic">bits</span> <span style="color:#7F0000;text-style:italic">to</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">include</span> <span style="color:#7F0000;text-style:italic">PC</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> device <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt32</span> = camera.GetPropertyDataUInt32(camera.kEdsPropID_Evf_OutputDevice)
			
			CheckError camera
			
			<span style="color:#0000FF;font-weight: bold">if</span> camera.lasterror = EDSModuleMBS.EDS_ERR_OK <span style="color:#0000FF;font-weight: bold">then</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> n <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Uint32</span> = EDSModuleMBS.kEdsEvfOutputDevice_PC
				n = Bitwise.OnesComplement(n)
				device = Bitwise.BitAnd(device, n)
				
				camera.SetPropertyDataUInt32 camera.kEdsPropID_Evf_OutputDevice, <span style="color:#326598">0</span>, device
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> UpdateButton()
			<span style="color:#0000FF;font-weight: bold">if</span> camera&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				TakePictureButton.enabled = <span style="color:#0000FF;font-weight: bold">true</span>
				StartLiveButton.Enabled = <span style="color:#0000FF;font-weight: bold">true</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				TakePictureButton.enabled = <span style="color:#0000FF;font-weight: bold">false</span>
				StartLiveButton.Enabled = <span style="color:#0000FF;font-weight: bold">false</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> List.ListIndex &gt;= <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> v <span style="color:#0000FF;font-weight: bold">as</span> Variant = List.RowTag(List.ListIndex)
				<span style="color:#0000FF;font-weight: bold">if</span> v <span style="color:#0000FF;font-weight: bold">isa</span> EdsCameraMBS <span style="color:#0000FF;font-weight: bold">then</span>
					ShowPictureButton.Enabled = <span style="color:#0000FF;font-weight: bold">false</span>
					DeleteFileButton.Enabled = <span style="color:#0000FF;font-weight: bold">false</span>
				<span style="color:#0000FF;font-weight: bold">elseif</span> v <span style="color:#0000FF;font-weight: bold">isa</span> EdsDirectoryItemMBS <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> d <span style="color:#0000FF;font-weight: bold">as</span> EdsDirectoryItemMBS = v
					<span style="color:#0000FF;font-weight: bold">if</span> d.DirectoryItemInfo.IsFolder <span style="color:#0000FF;font-weight: bold">then</span>
						ShowPictureButton.Enabled = <span style="color:#0000FF;font-weight: bold">false</span>
						DeleteFileButton.Enabled = <span style="color:#0000FF;font-weight: bold">false</span>
					<span style="color:#0000FF;font-weight: bold">else</span>
						ShowPictureButton.Enabled = <span style="color:#0000FF;font-weight: bold">true</span>
						DeleteFileButton.Enabled = <span style="color:#0000FF;font-weight: bold">true</span>
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">else</span>
					ShowPictureButton.Enabled = <span style="color:#0000FF;font-weight: bold">false</span>
					DeleteFileButton.Enabled = <span style="color:#0000FF;font-weight: bold">false</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
			<span style="color:#0000FF;font-weight: bold">else</span>
				DeleteFileButton.Enabled = <span style="color:#0000FF;font-weight: bold">false</span>
				ShowPictureButton.Enabled = <span style="color:#0000FF;font-weight: bold">false</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> MyEdsCameraStateEventHandler <span style="color:#0000FF;font-weight: bold">As</span> MyEdsCameraStateEventHandlerMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> MyEdsObjectEventHandler <span style="color:#0000FF;font-weight: bold">As</span> MyEdsObjectEventHandlerMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> MyEdsPropertyEventHandler <span style="color:#0000FF;font-weight: bold">As</span> MyEdsPropertyEventHandlerMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Progress <span style="color:#0000FF;font-weight: bold">As</span> MyEdsProgressMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> camera <span style="color:#0000FF;font-weight: bold">As</span> EdsCameraMBS</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> stream <span style="color:#0000FF;font-weight: bold">As</span> EdsStreamMBS</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	MenuBar MenuBar1</div>
<div class="RB_Code">		MenuItem FileMenu = <span style="color:#6500FE">&quot;&amp;Ablage&quot;</span></div>
<div class="RB_Code">			MenuItem FileQuit = <span style="color:#6500FE">&quot;#App.kFileQuit&quot;</span></div>
<div class="RB_Code">		MenuItem EditMenu = <span style="color:#6500FE">&quot;&amp;Bearbeiten&quot;</span></div>
<div class="RB_Code">			MenuItem EditUndo = <span style="color:#6500FE">&quot;&amp;R&uuml;ckg&auml;ngig&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu1 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditCut = <span style="color:#6500FE">&quot;&amp;Ausschneiden&quot;</span></div>
<div class="RB_Code">			MenuItem EditCopy = <span style="color:#6500FE">&quot;&amp;Kopieren&quot;</span></div>
<div class="RB_Code">			MenuItem EditPaste = <span style="color:#6500FE">&quot;&amp;Einf&uuml;gen&quot;</span></div>
<div class="RB_Code">			MenuItem EditClear = <span style="color:#6500FE">&quot;#App.kEditClear&quot;</span></div>
<div class="RB_Code">			MenuItem UntitledMenu0 = <span style="color:#6500FE">&quot;-&quot;</span></div>
<div class="RB_Code">			MenuItem EditSelectAll = <span style="color:#6500FE">&quot;&amp;Alles</span> <span style="color:#6500FE">ausw&auml;hlen&quot;</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> MenuBar</div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MyEdsProgressMBS <span style="color:#0000FF;font-weight: bold">Inherits</span> EdsProgressMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> Progress(Percent <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt32</span>, <span style="color:#0000FF;font-weight: bold">byref</span> Cancel <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">boolean</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">we</span> <span style="color:#7F0000;text-style:italic">got</span> <span style="color:#7F0000;text-style:italic">progress</span> <span style="color:#7F0000;text-style:italic">of</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">long</span> <span style="color:#7F0000;text-style:italic">time</span> <span style="color:#7F0000;text-style:italic">operation</span>
			
			MainWindow.bar.Value = Percent
			MainWindow.UpdateNow
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MyEdsObjectEventHandlerMBS <span style="color:#0000FF;font-weight: bold">Inherits</span> EdsObjectEventHandlerMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> ObjectChanged(EventCode <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>, obj <span style="color:#0000FF;font-weight: bold">as</span> EdsBaseMBS) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			System.DebugLog CurrentMethodName+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+str(EventCode)
			
			<span style="color:#0000FF;font-weight: bold">if</span> EventCode = EDSModuleMBS.kEdsObjectEvent_DirItemRequestTransfer <span style="color:#0000FF;font-weight: bold">then</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">cast</span> <span style="color:#7F0000;text-style:italic">object</span> <span style="color:#7F0000;text-style:italic">manually</span> <span style="color:#7F0000;text-style:italic">by</span> <span style="color:#7F0000;text-style:italic">moving</span> <span style="color:#7F0000;text-style:italic">handle.</span> <span style="color:#7F0000;text-style:italic">Plugin</span> <span style="color:#7F0000;text-style:italic">does</span> <span style="color:#7F0000;text-style:italic">not</span> <span style="color:#7F0000;text-style:italic">know</span> <span style="color:#7F0000;text-style:italic">this</span> <span style="color:#7F0000;text-style:italic">is</span> <span style="color:#7F0000;text-style:italic">a</span> <span style="color:#7F0000;text-style:italic">directory</span> <span style="color:#7F0000;text-style:italic">item!</span>
				<span style="color:#0000FF;font-weight: bold">dim</span> c <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> EdsDirectoryItemMBS
				
				c.Handle = obj.Handle
				obj.Handle = <span style="color:#326598">0</span>
				
				<span style="color:#7F0000;text-style:italic">&#39;MsgBox</span> <span style="color:#7F0000;text-style:italic">d.DirectoryItemInfo.FileName</span>
				
				<span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">download</span> <span style="color:#7F0000;text-style:italic">picture</span> <span style="color:#7F0000;text-style:italic">without</span> <span style="color:#7F0000;text-style:italic">progress</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> info <span style="color:#0000FF;font-weight: bold">as</span> EdsDirectoryItemInfoMBS = c.DirectoryItemInfo
				<span style="color:#0000FF;font-weight: bold">if</span> info&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
					<span style="color:#0000FF;font-weight: bold">dim</span> file <span style="color:#0000FF;font-weight: bold">as</span> FolderItem = SpecialFolder.Desktop.Child(info.FileName)
					
					<span style="color:#0000FF;font-weight: bold">dim</span> stream <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> EdsStreamMBS(file, EdsStreamMBS.kEdsFileCreateDisposition_CreateNew, EdsStreamMBS.kEdsAccess_Write)
					
					c.Download(info.Size, stream)
					CheckError c
					
					c.DownloadComplete
					CheckError c
					
					stream = <span style="color:#0000FF;font-weight: bold">nil</span>
					
					file.Launch
					
					
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Module</span> Module1</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> CheckError(o <span style="color:#0000FF;font-weight: bold">as</span> EdsBaseMBS)
			<span style="color:#0000FF;font-weight: bold">dim</span> n <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span> = o.Lasterror
			
			<span style="color:#0000FF;font-weight: bold">if</span> n = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span> <span style="color:#0000FF;font-weight: bold">Return</span> <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">ok</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> message <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = getErrorMessage(n)
			
			<span style="color:#0000FF;font-weight: bold">dim</span> m <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = <span style="color:#6500FE">&quot;Error</span> <span style="color:#6500FE">&quot;</span>+str(n)+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+Message
			
			System.DebugLog m
			MsgBox m
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Function</span> GetErrorMessage(n <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">integer</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">string</span>
			<span style="color:#0000FF;font-weight: bold">dim</span> message <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = <span style="color:#6500FE">&quot;?&quot;</span>
			
			<span style="color:#0000FF;font-weight: bold">Select</span> <span style="color:#0000FF;font-weight: bold">case</span> n
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_UNIMPLEMENTED
				message = <span style="color:#6500FE">&quot;Not</span> <span style="color:#6500FE">implemented&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INTERNAL_ERROR
				message = <span style="color:#6500FE">&quot;Internal</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_MEM_ALLOC_FAILED
				message = <span style="color:#6500FE">&quot;Memory</span> <span style="color:#6500FE">allocation</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_MEM_FREE_FAILED
				message = <span style="color:#6500FE">&quot;Memory</span> <span style="color:#6500FE">release</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_OPERATION_CANCELLED
				message = <span style="color:#6500FE">&quot;Operation</span> <span style="color:#6500FE">canceled&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INCOMPATIBLE_VERSION
				message = <span style="color:#6500FE">&quot;Version</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_NOT_SUPPORTED
				message = <span style="color:#6500FE">&quot;Not</span> <span style="color:#6500FE">supported&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_UNEXPECTED_EXCEPTION
				message = <span style="color:#6500FE">&quot;Unexpected</span> <span style="color:#6500FE">exception&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_PROTECTION_VIOLATION
				message = <span style="color:#6500FE">&quot;Protection</span> <span style="color:#6500FE">violation&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_MISSING_SUBCOMPONENT
				message = <span style="color:#6500FE">&quot;Missing</span> <span style="color:#6500FE">subcomponent&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_SELECTION_UNAVAILABLE
				message = <span style="color:#6500FE">&quot;Selection</span> <span style="color:#6500FE">unavailable&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_IO_ERROR
				message = <span style="color:#6500FE">&quot;IO</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_TOO_MANY_OPEN
				message = <span style="color:#6500FE">&quot;Too</span> <span style="color:#6500FE">many</span> <span style="color:#6500FE">files</span> <span style="color:#6500FE">open&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_NOT_FOUND
				message = <span style="color:#6500FE">&quot;File</span> <span style="color:#6500FE">does</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">exist&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_OPEN_ERROR
				message = <span style="color:#6500FE">&quot;Open</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_CLOSE_ERROR
				message = <span style="color:#6500FE">&quot;Close</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_SEEK_ERROR
				message = <span style="color:#6500FE">&quot;Seek</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_TELL_ERROR
				message = <span style="color:#6500FE">&quot;Tell</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_READ_ERROR
				message = <span style="color:#6500FE">&quot;Read</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_WRITE_ERROR
				message = <span style="color:#6500FE">&quot;Write</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_PERMISSION_ERROR
				message = <span style="color:#6500FE">&quot;Permission</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_DISK_FULL_ERROR
				message = <span style="color:#6500FE">&quot;Disk</span> <span style="color:#6500FE">full&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_ALREADY_EXISTS
				message = <span style="color:#6500FE">&quot;File</span> <span style="color:#6500FE">already</span> <span style="color:#6500FE">exists&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_FORMAT_UNRECOGNIZED
				message = <span style="color:#6500FE">&quot;Format</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_DATA_CORRUPT
				message = <span style="color:#6500FE">&quot;Invaliddata&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_FILE_NAMING_NA
				message = <span style="color:#6500FE">&quot;File</span> <span style="color:#6500FE">naming</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DIR_NOT_FOUND
				message = <span style="color:#6500FE">&quot;Directory</span> <span style="color:#6500FE">does</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">exist&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DIR_IO_ERROR
				message = <span style="color:#6500FE">&quot;I/O</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DIR_ENTRY_NOT_FOUND
				message = <span style="color:#6500FE">&quot;No</span> <span style="color:#6500FE">file</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">directory&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DIR_ENTRY_EXISTS
				message = <span style="color:#6500FE">&quot;File</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">directory&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DIR_NOT_EMPTY
				message = <span style="color:#6500FE">&quot;Directory</span> <span style="color:#6500FE">full&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_PROPERTIES_UNAVAILABLE
				message = <span style="color:#6500FE">&quot;Property</span> <span style="color:#6500FE">(and</span> <span style="color:#6500FE">additional</span> <span style="color:#6500FE">property</span> <span style="color:#6500FE">information)</span> <span style="color:#6500FE">unavailable&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_PROPERTIES_MISMATCH
				message = <span style="color:#6500FE">&quot;Property</span> <span style="color:#6500FE">mismatch&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_PROPERTIES_NOT_LOADED
				message = <span style="color:#6500FE">&quot;Property</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">loaded&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_PARAMETER
				message = <span style="color:#6500FE">&quot;Invalid</span> <span style="color:#6500FE">function</span> <span style="color:#6500FE">parameter&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_HANDLE
				message = <span style="color:#6500FE">&quot;Handle</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_POINTER
				message = <span style="color:#6500FE">&quot;Pointer</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_INDEX
				message = <span style="color:#6500FE">&quot;Index</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_LENGTH
				message = <span style="color:#6500FE">&quot;Length</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_FN_POINTER
				message = <span style="color:#6500FE">&quot;FN</span> <span style="color:#6500FE">pointer</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_SORT_FN
				message = <span style="color:#6500FE">&quot;Sort</span> <span style="color:#6500FE">FN</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_NOT_FOUND
				message = <span style="color:#6500FE">&quot;Device</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">found&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_BUSY
				message = <span style="color:#6500FE">&quot;Device</span> <span style="color:#6500FE">busy</span> <span style="color:#6500FE">Note:</span> <span style="color:#6500FE">If</span> <span style="color:#6500FE">a</span> <span style="color:#6500FE">device</span> <span style="color:#6500FE">busy</span> <span style="color:#6500FE">error</span> <span style="color:#6500FE">occurs,</span> <span style="color:#6500FE">reissue</span> <span style="color:#6500FE">the</span> <span style="color:#6500FE">command</span> <span style="color:#6500FE">after</span> <span style="color:#6500FE">a</span> <span style="color:#6500FE">while.</span> <span style="color:#6500FE">The</span> <span style="color:#6500FE">camera</span> <span style="color:#6500FE">will</span> <span style="color:#6500FE">become</span> <span style="color:#6500FE">unstable.&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_INVALID
				message = <span style="color:#6500FE">&quot;Device</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_EMERGENCY
				message = <span style="color:#6500FE">&quot;Device</span> <span style="color:#6500FE">emergency&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_MEMORY_FULL
				message = <span style="color:#6500FE">&quot;Device</span> <span style="color:#6500FE">memory</span> <span style="color:#6500FE">full&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_INTERNAL_ERROR
				message = <span style="color:#6500FE">&quot;Internal</span> <span style="color:#6500FE">device</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_INVALID_PARAMETER
				message = <span style="color:#6500FE">&quot;Device</span> <span style="color:#6500FE">parameter</span> <span style="color:#6500FE">invalid&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_NO_DISK
				message = <span style="color:#6500FE">&quot;No</span> <span style="color:#6500FE">disk&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_DISK_ERROR
				message = <span style="color:#6500FE">&quot;Disk</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_CF_GATE_CHANGED
				message = <span style="color:#6500FE">&quot;The</span> <span style="color:#6500FE">CF</span> <span style="color:#6500FE">gate</span> <span style="color:#6500FE">has</span> <span style="color:#6500FE">been</span> <span style="color:#6500FE">changed&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_DIAL_CHANGED
				message = <span style="color:#6500FE">&quot;The</span> <span style="color:#6500FE">dial</span> <span style="color:#6500FE">has</span> <span style="color:#6500FE">been</span> <span style="color:#6500FE">changed&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_NOT_INSTALLED
				message = <span style="color:#6500FE">&quot;Device</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">installed&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_STAY_AWAKE
				message = <span style="color:#6500FE">&quot;Device</span> <span style="color:#6500FE">connected</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">awake</span> <span style="color:#6500FE">mode&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_NOT_RELEASED
				message = <span style="color:#6500FE">&quot;Device</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">released&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STREAM_IO_ERROR
				message = <span style="color:#6500FE">&quot;Stream</span> <span style="color:#6500FE">I/O</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STREAM_NOT_OPEN
				message = <span style="color:#6500FE">&quot;Stream</span> <span style="color:#6500FE">open</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STREAM_ALREADY_OPEN
				message = <span style="color:#6500FE">&quot;Stream</span> <span style="color:#6500FE">already</span> <span style="color:#6500FE">open&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STREAM_OPEN_ERROR
				message = <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">open</span> <span style="color:#6500FE">stream&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STREAM_CLOSE_ERROR
				message = <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">close</span> <span style="color:#6500FE">stream&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STREAM_SEEK_ERROR
				message = <span style="color:#6500FE">&quot;Stream</span> <span style="color:#6500FE">seek</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STREAM_TELL_ERROR
				message = <span style="color:#6500FE">&quot;Stream</span> <span style="color:#6500FE">tell</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STREAM_READ_ERROR
				message = <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">read</span> <span style="color:#6500FE">stream&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STREAM_WRITE_ERROR
				message = <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">write</span> <span style="color:#6500FE">stream&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STREAM_PERMISSION_ERROR
				message = <span style="color:#6500FE">&quot;Permission</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STREAM_COULDNT_BEGIN_THREAD
				message = <span style="color:#6500FE">&quot;Could</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">start</span> <span style="color:#6500FE">reading</span> <span style="color:#6500FE">thumbnail&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STREAM_BAD_OPTIONS
				message = <span style="color:#6500FE">&quot;Invalid</span> <span style="color:#6500FE">stream</span> <span style="color:#6500FE">option&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STREAM_END_OF_STREAM
				message = <span style="color:#6500FE">&quot;Invalid</span> <span style="color:#6500FE">stream</span> <span style="color:#6500FE">termination&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_COMM_PORT_IS_IN_USE
				message = <span style="color:#6500FE">&quot;Port</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">use&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_COMM_DISCONNECTED
				message = <span style="color:#6500FE">&quot;Port</span> <span style="color:#6500FE">disconnected&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_COMM_DEVICE_INCOMPATIBLE
				message = <span style="color:#6500FE">&quot;Incompatible</span> <span style="color:#6500FE">device&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_COMM_BUFFER_FULL
				message = <span style="color:#6500FE">&quot;Buffer</span> <span style="color:#6500FE">full&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_COMM_USB_BUS_ERR
				message = <span style="color:#6500FE">&quot;USB</span> <span style="color:#6500FE">bus</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_USB_DEVICE_LOCK_ERROR
				message = <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">lock</span> <span style="color:#6500FE">the</span> <span style="color:#6500FE">UI&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_USB_DEVICE_UNLOCK_ERROR
				message = <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">unlock</span> <span style="color:#6500FE">the</span> <span style="color:#6500FE">UI&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STI_UNKNOWN_ERROR
				message = <span style="color:#6500FE">&quot;Unknown</span> <span style="color:#6500FE">STI&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STI_INTERNAL_ERROR
				message = <span style="color:#6500FE">&quot;Internal</span> <span style="color:#6500FE">STI</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STI_DEVICE_CREATE_ERROR
				message = <span style="color:#6500FE">&quot;Device</span> <span style="color:#6500FE">creation</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_STI_DEVICE_RELEASE_ERROR
				message = <span style="color:#6500FE">&quot;Device</span> <span style="color:#6500FE">release</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICE_NOT_LAUNCHED
				message = <span style="color:#6500FE">&quot;Device</span> <span style="color:#6500FE">startup</span> <span style="color:#6500FE">failed&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_ENUM_NA
				message = <span style="color:#6500FE">&quot;Enumeration</span> <span style="color:#6500FE">terminated</span> <span style="color:#6500FE">(there</span> <span style="color:#6500FE">was</span> <span style="color:#6500FE">no</span> <span style="color:#6500FE">suitableenumeration</span> <span style="color:#6500FE">item)&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_FN_CALL
				message = <span style="color:#6500FE">&quot;Called</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">a</span> <span style="color:#6500FE">mode</span> <span style="color:#6500FE">when</span> <span style="color:#6500FE">the</span> <span style="color:#6500FE">function</span> <span style="color:#6500FE">could</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">be</span> <span style="color:#6500FE">used&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_HANDLE_NOT_FOUND
				message = <span style="color:#6500FE">&quot;Handle</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">found&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_ID
				message = <span style="color:#6500FE">&quot;Invalid</span> <span style="color:#6500FE">ID&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_WAIT_TIMEOUT_ERROR
				message = <span style="color:#6500FE">&quot;Timeout&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_SESSION_NOT_OPEN
				message = <span style="color:#6500FE">&quot;Session</span> <span style="color:#6500FE">open</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_TRANSACTIONID
				message = <span style="color:#6500FE">&quot;Invalid</span> <span style="color:#6500FE">transaction</span> <span style="color:#6500FE">ID&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INCOMPLETE_TRANSFER
				message = <span style="color:#6500FE">&quot;Transfer</span> <span style="color:#6500FE">problem&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_STRAGEID
				message = <span style="color:#6500FE">&quot;Storage</span> <span style="color:#6500FE">error&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_DEVICEPROP_NOT_SUPPORTED
				message = <span style="color:#6500FE">&quot;Unsupported</span> <span style="color:#6500FE">device</span> <span style="color:#6500FE">property&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_OBJECTFORMATCODE
				message = <span style="color:#6500FE">&quot;Invalid</span> <span style="color:#6500FE">object</span> <span style="color:#6500FE">format</span> <span style="color:#6500FE">code&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_SELF_TEST_FAILED
				message = <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">self-diagnosis&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_PARTIAL_DELETION
				message = <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">in</span> <span style="color:#6500FE">partial</span> <span style="color:#6500FE">deletion&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_SPECIFICATION_BY_FORMAT_UNSUPPORTED
				message = <span style="color:#6500FE">&quot;Unsupported</span> <span style="color:#6500FE">format</span> <span style="color:#6500FE">specification&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_NO_VALID_OBJECTINFO
				message = <span style="color:#6500FE">&quot;Invalid</span> <span style="color:#6500FE">object</span> <span style="color:#6500FE">information&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_CODE_FORMAT
				message = <span style="color:#6500FE">&quot;Invalid</span> <span style="color:#6500FE">code</span> <span style="color:#6500FE">format&quot;</span>
				<span style="color:#7F0000;text-style:italic">&#39;case</span> <span style="color:#7F0000;text-style:italic">EDSModuleMBS.EDS_ERR_UNKNOWN_VENDER_CODE</span>
				<span style="color:#7F0000;text-style:italic">&#39;message</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">&quot;Unknown</span> <span style="color:#7F0000;text-style:italic">vendor</span> <span style="color:#7F0000;text-style:italic">code&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_CAPTURE_ALREADY_TERMINATED
				message = <span style="color:#6500FE">&quot;Capture</span> <span style="color:#6500FE">already</span> <span style="color:#6500FE">terminated&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_PARENTOBJECT
				message = <span style="color:#6500FE">&quot;Invalid</span> <span style="color:#6500FE">parent</span> <span style="color:#6500FE">object&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_DEVICEPROP_FORMAT
				message = <span style="color:#6500FE">&quot;Invalid</span> <span style="color:#6500FE">property</span> <span style="color:#6500FE">format&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_INVALID_DEVICEPROP_VALUE
				message = <span style="color:#6500FE">&quot;Invalid</span> <span style="color:#6500FE">property</span> <span style="color:#6500FE">value&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_SESSION_ALREADY_OPEN
				message = <span style="color:#6500FE">&quot;Session</span> <span style="color:#6500FE">already</span> <span style="color:#6500FE">open&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_TRANSACTION_CANCELLED
				message = <span style="color:#6500FE">&quot;Transaction</span> <span style="color:#6500FE">canceled&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_SPECIFICATION_OF_DESTINATION_UNSUPPORTED
				message = <span style="color:#6500FE">&quot;Unsupported</span> <span style="color:#6500FE">destination</span> <span style="color:#6500FE">specification&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_UNKNOWN_COMMAND
				message = <span style="color:#6500FE">&quot;Unknown</span> <span style="color:#6500FE">command&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_OPERATION_REFUSED
				message = <span style="color:#6500FE">&quot;Operation</span> <span style="color:#6500FE">refused&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_LENS_COVER_CLOSE
				message = <span style="color:#6500FE">&quot;Lens</span> <span style="color:#6500FE">cover</span> <span style="color:#6500FE">closed&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_OBJECT_NOTREADY
				message = <span style="color:#6500FE">&quot;Image</span> <span style="color:#6500FE">data</span> <span style="color:#6500FE">set</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">ready</span> <span style="color:#6500FE">for</span> <span style="color:#6500FE">live</span> <span style="color:#6500FE">view&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_TAKE_PICTURE_AF_NG
				message = <span style="color:#6500FE">&quot;Focus</span> <span style="color:#6500FE">failed&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_TAKE_PICTURE_RESERVED
				message = <span style="color:#6500FE">&quot;Reserved&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_TAKE_PICTURE_MIRROR_UP_NG
				message = <span style="color:#6500FE">&quot;Currently</span> <span style="color:#6500FE">configuring</span> <span style="color:#6500FE">mirror</span> <span style="color:#6500FE">up&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_TAKE_PICTURE_SENSOR_CLEANING_NG
				message = <span style="color:#6500FE">&quot;Currently</span> <span style="color:#6500FE">cleaning</span> <span style="color:#6500FE">sensor&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_TAKE_PICTURE_SILENCE_NG
				message = <span style="color:#6500FE">&quot;Currently</span> <span style="color:#6500FE">performing</span> <span style="color:#6500FE">silent</span> <span style="color:#6500FE">operations&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_TAKE_PICTURE_NO_CARD_NG
				message = <span style="color:#6500FE">&quot;Card</span> <span style="color:#6500FE">not</span> <span style="color:#6500FE">installed&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_TAKE_PICTURE_CARD_NG
				message = <span style="color:#6500FE">&quot;Error</span> <span style="color:#6500FE">writing</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">card&quot;</span>
			<span style="color:#0000FF;font-weight: bold">case</span> EDSModuleMBS.EDS_ERR_TAKE_PICTURE_CARD_PROTECT_NG
				message = <span style="color:#6500FE">&quot;Card</span> <span style="color:#6500FE">write</span> <span style="color:#6500FE">protected&quot;</span>
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">Select</span>
			
			<span style="color:#0000FF;font-weight: bold">Return</span> Message
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Function</span></div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Module</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> PicWindow <span style="color:#0000FF;font-weight: bold">Inherits</span> Window</div>
<div class="RB_MainItem">
<div class="RB_Code">		Control Timer1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Timer</div>
<div class="RB_MainItem">
<div class="RB_Code">			ControlInstance Timer1 <span style="color:#0000FF;font-weight: bold">Inherits</span> Timer</div>
</div>
<div class="RB_Code">			EventHandler <span style="color:#0000FF;font-weight: bold">Sub</span> Action()
				NextFrame
			<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">End</span> Control</div>
</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> CancelClose(appQuitting <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span>
			<span style="color:#0000FF;font-weight: bold">if</span> Camera&lt;&gt;<span style="color:#0000FF;font-weight: bold">nil</span> <span style="color:#0000FF;font-weight: bold">then</span>
				MainWindow.StopLiveView Camera
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Sub</span> NextFrame()
			System.DebugLog <span style="color:#6500FE">&quot;Update</span> <span style="color:#6500FE">live</span> <span style="color:#6500FE">video...&quot;</span>
			
			<span style="color:#0000FF;font-weight: bold">dim</span> stream <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> EdsStreamMBS(<span style="color:#326598">0</span>) <span style="color:#7F0000;text-style:italic">//</span> <span style="color:#7F0000;text-style:italic">memory</span> <span style="color:#7F0000;text-style:italic">stream</span>
			
			<span style="color:#0000FF;font-weight: bold">if</span> stream.Lasterror = EDSModuleMBS.EDS_ERR_OK <span style="color:#0000FF;font-weight: bold">then</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> image <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">new</span> EdsEvfImageMBS(stream)
				
				<span style="color:#0000FF;font-weight: bold">if</span> image.Lasterror = EDSModuleMBS.EDS_ERR_OK <span style="color:#0000FF;font-weight: bold">then</span>
					Camera.DownloadEvfImage image, <span style="color:#0000FF;font-weight: bold">false</span>
					
					<span style="color:#0000FF;font-weight: bold">if</span> Camera.Lasterror = EDSModuleMBS.EDS_ERR_OK <span style="color:#0000FF;font-weight: bold">then</span>
						<span style="color:#7F0000;text-style:italic">&#39;dim</span> <span style="color:#7F0000;text-style:italic">zoom</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">UInt32</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">image.GetPropertyDataUInt32(EdsEvfImageMBS.kEdsPropID_Evf_Zoom)</span>
						<span style="color:#7F0000;text-style:italic">&#39;dim</span> <span style="color:#7F0000;text-style:italic">zoompoint</span> <span style="color:#7F0000;text-style:italic">as</span> <span style="color:#7F0000;text-style:italic">EdsPointMBS</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">image.GetPropertyDataPoint(EdsEvfImageMBS.kEdsPropID_Evf_ZoomPosition)</span>
						
						<span style="color:#0000FF;font-weight: bold">dim</span> p <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">ptr</span> = stream.Pointer
						<span style="color:#0000FF;font-weight: bold">dim</span> len <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt32</span> = stream.Length
						
						System.DebugLog <span style="color:#6500FE">&quot;Got</span> <span style="color:#6500FE">&quot;</span>+str(len)+<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">bytes.&quot;</span>
						
						stream.Seek(<span style="color:#326598">0</span>, stream.kEdsSeek_Begin)
						
						<span style="color:#0000FF;font-weight: bold">dim</span> s <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">string</span> = stream.Read(len)
						System.DebugLog <span style="color:#6500FE">&quot;Read</span> <span style="color:#6500FE">&quot;</span>+str(lenb(s))+<span style="color:#6500FE">&quot;</span> <span style="color:#6500FE">bytes.&quot;</span>
						
						<span style="color:#0000FF;font-weight: bold">self</span>.Backdrop = JPEGStringToPictureMBS(s,<span style="color:#0000FF;font-weight: bold">true</span>)
						
					<span style="color:#0000FF;font-weight: bold">else</span>
						System.DebugLog <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">download</span> <span style="color:#6500FE">image</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">error</span> <span style="color:#6500FE">&quot;</span>+str(Camera.Lasterror)+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+GetErrorMessage(Camera.Lasterror)
					<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				<span style="color:#0000FF;font-weight: bold">else</span>
					System.DebugLog <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">create</span> <span style="color:#6500FE">image</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">error</span> <span style="color:#6500FE">&quot;</span>+str(image.Lasterror)+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+GetErrorMessage(image.Lasterror)
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
			<span style="color:#0000FF;font-weight: bold">else</span>
				System.DebugLog <span style="color:#6500FE">&quot;Failed</span> <span style="color:#6500FE">to</span> <span style="color:#6500FE">create</span> <span style="color:#6500FE">memory</span> <span style="color:#6500FE">stream</span> <span style="color:#6500FE">with</span> <span style="color:#6500FE">error</span> <span style="color:#6500FE">&quot;</span>+str(stream.Lasterror)+<span style="color:#6500FE">&quot;:</span> <span style="color:#6500FE">&quot;</span>+GetErrorMessage(stream.Lasterror)
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Sub</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Camera <span style="color:#0000FF;font-weight: bold">As</span> EdsCameraMBS</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MyEdsPropertyEventHandlerMBS <span style="color:#0000FF;font-weight: bold">Inherits</span> EdsPropertyEventHandlerMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> PropertyChanged(PropertyEvent <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt32</span>, PropertyID <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt32</span>, Param <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt32</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			System.DebugLog CurrentMethodName
			
			<span style="color:#0000FF;font-weight: bold">if</span> PropertyID = EdsBaseMBS.kEdsPropID_Evf_OutputDevice <span style="color:#0000FF;font-weight: bold">then</span>
				System.DebugLog <span style="color:#6500FE">&quot;kEdsPropID_Evf_OutputDevice&quot;</span>
				
				<span style="color:#0000FF;font-weight: bold">dim</span> device <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt32</span> = camera.GetPropertyDataUInt32(camera.kEdsPropID_Evf_OutputDevice)
				
				<span style="color:#0000FF;font-weight: bold">if</span> <span style="color:#0000FF;font-weight: bold">not</span> Active <span style="color:#0000FF;font-weight: bold">and</span> BitwiseAnd(device, EDSModuleMBS.kEdsEvfOutputDevice_PC)&lt;&gt;<span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					System.DebugLog <span style="color:#6500FE">&quot;Output</span> <span style="color:#6500FE">To</span> <span style="color:#6500FE">PC</span> <span style="color:#6500FE">started...&quot;</span>
					
					Active = <span style="color:#0000FF;font-weight: bold">true</span>
					PicWindow.timer1.Mode = <span style="color:#326598">2</span>
					
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				<span style="color:#0000FF;font-weight: bold">if</span> Active <span style="color:#0000FF;font-weight: bold">and</span> BitwiseAnd(device, EDSModuleMBS.kEdsEvfOutputDevice_PC) = <span style="color:#326598">0</span> <span style="color:#0000FF;font-weight: bold">then</span>
					
					System.DebugLog <span style="color:#6500FE">&quot;Output</span> <span style="color:#6500FE">To</span> <span style="color:#6500FE">PC</span> <span style="color:#6500FE">stopped...&quot;</span>
					
					<span style="color:#7F0000;text-style:italic">&#39;PicWindow.timer1.Mode</span> <span style="color:#7F0000;text-style:italic">=</span> <span style="color:#7F0000;text-style:italic">0</span>
					Active = <span style="color:#0000FF;font-weight: bold">false</span>
				<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
				
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> Active <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">Boolean</span></div>
<div class="RB_Code">		<span style="color:#0000FF;font-weight: bold">Property</span> camera <span style="color:#0000FF;font-weight: bold">As</span> EdsCameraMBS</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MyEdsCameraAddedHandlerMBS <span style="color:#0000FF;font-weight: bold">Inherits</span> EdsCameraAddedHandlerMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> CameraAdded() <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			MainWindow.OpenDevice
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_MainItem">
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">Class</span> MyEdsCameraStateEventHandlerMBS <span style="color:#0000FF;font-weight: bold">Inherits</span> EdsCameraStateEventHandlerMBS</div>
<div class="RB_Code">		EventHandler <span style="color:#0000FF;font-weight: bold">Function</span> StateChanged(StateEvent <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt32</span>, EventData <span style="color:#0000FF;font-weight: bold">as</span> <span style="color:#0000FF;font-weight: bold">UInt32</span>) <span style="color:#0000FF;font-weight: bold">As</span> <span style="color:#0000FF;font-weight: bold">integer</span>
			<span style="color:#0000FF;font-weight: bold">if</span> StateEvent = EDSModuleMBS.kEdsStateEvent_Shutdown <span style="color:#0000FF;font-weight: bold">then</span>
				PicWindow.close
				MainWindow.clear
				
				MsgBox <span style="color:#6500FE">&quot;Camera</span> <span style="color:#6500FE">disconnected.&quot;</span>
				
			<span style="color:#0000FF;font-weight: bold">end</span> <span style="color:#0000FF;font-weight: bold">if</span>
		<span style="color:#0000FF;font-weight: bold">End</span> EventHandler</div>
<div class="RB_Code">	<span style="color:#0000FF;font-weight: bold">End</span> <span style="color:#0000FF;font-weight: bold">Class</span></div>
</div>
<div class="RB_Code"><span style="color:#0000FF;font-weight: bold">End</span> Project</div>

</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbscamerasplugin.html">MBS Cameras Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=example-cameras-canoneosdigital-example">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

