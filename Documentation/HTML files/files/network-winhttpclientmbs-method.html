<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Frameset//EN" >
<HTML>
<HEAD>
<TITLE>Monkeybread Xojo plugin - WinHTTPClientMBS methods</TITLE>
<script src="../platforms.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="../help.css" >
<link rel="stylesheet" type="text/css" href="../screen.css" media="screen">
<link rel="stylesheet" type="text/css" href="../print.css" media="print">
<link rel="stylesheet" type="text/css" href="../allitems.css" title="Default">
<link rel="alternate stylesheet" type="text/css" href="../macitems.css" title="Mac">
<link rel="alternate stylesheet" type="text/css" href="../winitems.css" title="Win">
<link rel="alternate stylesheet" type="text/css" href="../linuxitems.css" title="Linux">
<link rel="alternate stylesheet" type="text/css" href="../crossitems.css" title="Crossplatform">
<meta http-equiv="content-type" content="text/html; charset=x-mac-roman">
<META NAME="description" CONTENT="WinHTTPClientMBS">
</head>
<BODY BGCOLOR="#FFFFFF">
<H2 lang="en">WinHTTPClientMBS methods</h2>
<p><a href="http://www.monkeybreadsoftware.net">Online Documentation</a> &nbsp; - &nbsp; <a href="stats.html">Statistics</a> &nbsp; - &nbsp; <a href="topic-faq.html">FAQ</a> &nbsp; - &nbsp; <a href="parts.html">Plugin Parts</a> (<a href="partsall.html">All</a>, <a href="plugindeps.html">Dependencies</a>) &nbsp; - &nbsp; <a href="hierarchy.html">Class hierarchy</a></p>
<p>New in Version 
<a href="newinversion213.html">21.3</a> 
<a href="newinversion214.html">21.4</a> 
<a href="newinversion215.html">21.5</a> 
<a href="newinversion220.html">22.0</a> 
<a href="newinversion221.html">22.1</a> 
<a href="newinversion222.html">22.2</a> 
<a href="newinversion223.html">22.3</a> 
<a href="newinversion224.html">22.4</a> 
<a href="newinversion225.html">22.5</a> 
<a href="newinversion230.html">23.0</a> 
<a href="newinversion231.html">23.1</a> 
<a href="newinversion232.html">23.2</a> 
</p>
<p>The list of the &nbsp; <a href="themes.html">topics</a>, 
 &nbsp; <a href="classes.html">classes</a>,
 &nbsp; <a href="interfaces.html">interfaces</a>,
 &nbsp; <a href="controls.html">controls</a>,
 &nbsp; <a href="modules.html">modules</a>,
 &nbsp; <a href="globaltopic.html">global methods by category</a>,
 &nbsp; <a href="globalname.html">global methods by name</a>,
 &nbsp; <a href="screenshots.html">screenshots</a>,
 &nbsp; <a href="licenses.html">licenses</a> &nbsp;
 and &nbsp; <a href="examples.html">examples</a>.</p>
<p id=PlatformChooserMBS>Platforms to show: <a class="isA" href="javascript:all();">All</a> <a class="isM" href="javascript:mac();">Mac</a> <a class="isW" href="javascript:win();">Windows</a> <a class="isL" href="javascript:linux();">Linux</a> <a class="isC" href="javascript:crossplatform();">Cross-Platform</a></p>
<p>Back to <A href="class-winhttpclientmbs.html">WinHTTPClientMBS</a> class.  </p>
<div class="W">
<b><a href="class-winhttpclientmbs.html">WinHTTPClientMBS</a>.<A name="1">Close as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-network.html" translate="no">Network</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion141.shtml" class=version>14.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Closes the session.<BR>
</div>
<div class="W">
<b><a href="class-winhttpclientmbs.html">WinHTTPClientMBS</a>.<A name="2">Constructor</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-network.html" translate="no">Network</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion141.shtml" class=version>14.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
The constructor.<BR>
</div>
<div class="W">
<b><a href="class-winhttpclientmbs.html">WinHTTPClientMBS</a>.<A name="3">GetProxyForUrl(URL as string, AutoProxyOptions as <A href="class-winhttpclientautoproxyoptionsmbs.html">WinHTTPClientAutoProxyOptionsMBS</A>, byref ProxyInfo as <A href="class-winhttpclientproxyinfombs.html">WinHTTPClientProxyInfoMBS</A>) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-network.html" translate="no">Network</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion141.shtml" class=version>14.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Retrieves the proxy data for the specified URL.<BR>
<B>Notes:</B> 
<BR>
Url: Contains the URL of the HTTP request that the application is preparing to send.<BR>
AutoProxyOptions: Specifies the auto-proxy options to use.<BR>
ProxyInfo: Receives the proxy setting. <BR>
<BR>
If the function succeeds, the function returns true.<BR>
If the function fails, it returns false. Lasterror is set.<BR>
<BR>
This function implements the Web Proxy Auto-Discovery (WPAD) protocol for automatically configuring the proxy settings for an HTTP request. The WPAD protocol downloads a Proxy Auto-Configuration (PAC) file, which is a script that identifies the proxy server to use for a given target URL. PAC files are typically deployed by the IT department within a corporate network environment. The URL of the PAC file can either be specified explicitly or GetProxyForUrl can be instructed to automatically discover the location of the PAC file on the local network.<BR>
<BR>
GetProxyForUrl supports only ECMAScript-based PAC files.<BR>
GetProxyForUrl must be called on a per-URL basis, because the PAC file can return a different proxy server for different URLs. This is useful because the PAC file enables an IT department to implement proxy server load balancing by mapping (hashing) the target URL (specified by the lpcwszUrl parameter) to a certain proxy in a proxy server array.<BR>
GetProxyForUrl caches the autoproxy URL and the autoproxy script when auto-discovery is specified in the dwFlags member of the pAutoProxyOptions structure. For more information, see Autoproxy Cache.<BR>
<BR>
see also<BR>
<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa384097(v=vs.85).aspx" target=_blank>http://msdn.microsoft.com/en-us/library/windows/desktop/aa384097(v=vs.85).aspx</a><BR>
<h4>Some examples using this method:</h4>
<ul translate="no">
<li><A href="example-win-proxy-windowsproxydetection.html">/Win/Proxy/Windows Proxy Detection</A></li>
</ul>
</div>
<div class="W">
<b><a href="class-winhttpclientmbs.html">WinHTTPClientMBS</a>.<A name="4">Open(UserAgent as string, AccessType as Integer, ProxyName as string = &quot;&quot;, ProxyByPass as string = &quot;&quot;) as boolean</A></b><br>

<table cellpadding=3>
<tr>
<td class=grau>Type</td>
<td class=grau>Topic</td>
<td class=grau>Plugin</td>
<td class=grau>Version</td>
<td class=grau>macOS</td>
<td class=grau>Windows</td>
<td class=grau>Linux</td>
<td class=grau>iOS</td>
<td class=grau>Targets</td>
</tr>
<tr>
<td class=grau>method</td>
<td class=grau><A href="topic-network.html" translate="no">Network</A></td>
<td class=grau><a href="plugins-mbswinplugin.html">MBS Win Plugin</a></td>
<td class=grau><a href="newinversion141.shtml" class=version>14.1</a></td>
<td class=grau>&#10060; No</td>
<td class=grau>&#9989; Yes</td>
<td class=grau>&#10060; No</td>
<td class=grau>&#10060; No</td>
<td class=grau>Desktop only</td>
</tr>
</table>
<B>Function:</B> 
Initializes an application&#39;s use of the WinINet functions.<BR>
<B>Notes:</B> 
<BR>
lUserAgent: Specifies the name of the application or entity calling the WinINet functions. This name is used as the user agent in the HTTP protocol.<BR>
AccessType: Type of access required. This parameter can be one of the following values.<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Value</TD><TD valign="top">Meaning</TD></TR>
<TR><TD valign="top">INTERNET_OPEN_TYPE_DIRECT</TD><TD valign="top">Resolves all host names locally.</TD></TR>
<TR><TD valign="top">INTERNET_OPEN_TYPE_PRECONFIG</TD><TD valign="top">Retrieves the proxy or direct configuration from the registry.</TD></TR>
<TR><TD valign="top">INTERNET_OPEN_TYPE_PRECONFIG_WITH_NO_AUTOPROXY</TD><TD valign="top">Retrieves the proxy or direct configuration from the registry and prevents the use of a startup Microsoft JScript or Internet Setup (INS) file.</TD></TR>
<TR><TD valign="top">INTERNET_OPEN_TYPE_PROXY</TD><TD valign="top">Passes requests to the proxy unless a proxy bypass list is supplied and the name to be resolved bypasses the proxy. In this case, the function uses INTERNET_OPEN_TYPE_DIRECT.</TD></TR>
</TABLE>
<BR>
ProxyName: String that specifies the name of the proxy server(s) to use when proxy access is specified by setting dwAccessType to INTERNET_OPEN_TYPE_PROXY. Do not use an empty string, because InternetOpen will use it as the proxy name. The WinINet functions recognize only CERN type proxies (HTTP only) and the TIS FTP gateway (FTP only). If Microsoft Internet Explorer is installed, these functions also support SOCKS proxies. FTP requests can be made through a CERN type proxy either by changing them to an HTTP request or by using InternetOpenUrl. If dwAccessType is not set to INTERNET_OPEN_TYPE_PROXY, this parameter is ignored and should be NULL. For more information about listing proxy servers, see the Listing Proxy Servers section of Enabling Internet Functionality.<BR>
ProxyBypass: Specifies an optional list of host names or IP addresses, or both, that should not be routed through the proxy when dwAccessType is set to INTERNET_OPEN_TYPE_PROXY. The list can contain wildcards. Do not use an empty string, because InternetOpen will use it as the proxy bypass list. If this parameter specifies the &quot;&lt;local&gt;&quot; macro, the function bypasses the proxy for any host name that does not contain a period.<BR>
By default, WinINet will bypass the proxy for requests that use the host names &quot;localhost&quot;, &quot;loopback&quot;, &quot;127.0.0.1&quot;, or &quot;[::1]&quot;. This behavior exists because a remote proxy server typically will not resolve these addresses properly.<BR>
Internet Explorer 9:  You can remove the local computer from the proxy bypass list using the &quot;&lt;-loopback&gt;&quot; macro.<BR>
If dwAccessType is not set to INTERNET_OPEN_TYPE_PROXY, this parameter is ignored and should be NULL.<BR>
Flags: Options. This parameter can be a combination of the following values.<BR>
<TABLE cellpadding=3 border=0>
<TR><TD valign="top">Value</TD><TD valign="top">Meaning</TD></TR>
<TR><TD valign="top">INTERNET_FLAG_ASYNC</TD><TD valign="top">Makes only asynchronous requests on handles descended from the handle returned from this function.</TD></TR>
<TR><TD valign="top">INTERNET_FLAG_FROM_CACHE</TD><TD valign="top">Does not make network requests. All entities are returned from the cache. If the requested item is not in the cache, a suitable error, such as ERROR_FILE_NOT_FOUND, is returned.</TD></TR>
<TR><TD valign="top">INTERNET_FLAG_OFFLINE</TD><TD valign="top">Identical to INTERNET_FLAG_FROM_CACHE. Does not make network requests. All entities are returned from the cache. If the requested item is not in the cache, a suitable error, such as ERROR_FILE_NOT_FOUND, is returned.</TD></TR>
</TABLE>
<BR>
Returns a valid handle that the application passes to subsequent WinINet functions. If Open fails, it returns false. To retrieve a specific error message, call GetLastError.<BR>
<BR>
see also<BR>
<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa385096(v=vs.85).aspx" target=_blank>http://msdn.microsoft.com/en-us/library/windows/desktop/aa385096(v=vs.85).aspx</a><BR>
</div>
<p>The items on this page are in the following plugins: <a href="plugins-mbswinplugin.html">MBS Win Plugin</a>.</p>
<!-- Ende Content-->

<br>
<div style="width: 200pt; margin: 0pt; padding: 5pt; border-color:#ccc; border-style:solid; background-color: #eee; border-width: 2pt; border-radius: 10pt; " lang="en">
&#128172; <a href="https://www.monkeybreadsoftware.com/feedback/?what=xojo&path=network-winhttpclientmbs-method">Ask a question or report a problem</a>
</div>

</BODY>
</HTML>

